<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE PackageImports #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Metrics.Network.Forwarder</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.Metrics.Network.Forwarder.html#connectToAcceptor"><span class="hs-identifier">connectToAcceptor</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Export this function for Mux purpose.</span></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetrics"><span class="hs-identifier">forwardEKGMetrics</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsDummy"><span class="hs-identifier">forwardEKGMetricsDummy</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsResp"><span class="hs-identifier">forwardEKGMetricsResp</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsRespDummy"><span class="hs-identifier">forwardEKGMetricsRespDummy</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Term</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="hs-string">&quot;contra-tracer&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Control.Tracer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nullTracer</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Void.html"><span class="hs-identifier">Data.Void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier">Void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.Socket</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Socket</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Context</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MinimalInitiatorContext</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ResponderContext</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Driver.Simple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runPeer</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Driver.Limits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProtocolTimeLimits</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.IOManager</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">withIOManager</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Mux</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MiniProtocol</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MiniProtocolCb</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                                        </span><span class="annot"><span class="hs-identifier">MiniProtocolLimits</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MiniProtocolNum</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                                        </span><span class="annot"><span class="hs-identifier">MuxMode</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OuroborosApplication</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                                        </span><span class="annot"><span class="hs-identifier">RunMiniProtocol</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>                                        </span><span class="annot"><span class="hs-identifier">miniProtocolLimits</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">miniProtocolNum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">miniProtocolRun</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.Handshake.Codec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">noTimeLimitsHandshake</span></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>                                                             </span><span class="annot"><span class="hs-identifier">timeLimitsHandshake</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.Handshake.Type</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Handshake</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.Handshake.Unversioned</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UnversionedProtocol</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                                                   </span><span class="annot"><span class="hs-identifier">UnversionedProtocolData</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>                                                                   </span><span class="annot"><span class="hs-identifier">unversionedHandshakeCodec</span></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>                                                                   </span><span class="annot"><span class="hs-identifier">unversionedProtocolDataCodec</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.Handshake.Version</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">acceptableVersion</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">queryVersion</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">simpleSingletonVersions</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Snocket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MakeBearer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Snocket</span></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>                                            </span><span class="annot"><span class="hs-identifier">localAddressFromPath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">localSnocket</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">socketSnocket</span></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>                                            </span><span class="annot"><span class="hs-identifier">makeLocalBearer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeSocketBearer</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Socket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HandshakeCallbacks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">connectToNode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nullNetworkConnectTracers</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Metrics</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EKG</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="System.Metrics.Configuration.html"><span class="hs-identifier">System.Metrics.Configuration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Metrics.Configuration.html#ForwarderConfiguration"><span class="hs-identifier">ForwarderConfiguration</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Metrics.Configuration.html#HowToConnect"><span class="hs-identifier">HowToConnect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="System.Metrics.Store.Forwarder.html"><span class="hs-identifier">System.Metrics.Store.Forwarder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Metrics.Store.Forwarder.html#mkResponse"><span class="hs-identifier">mkResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Metrics.Store.Forwarder.html#mkResponseDummy"><span class="hs-identifier">mkResponseDummy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="System.Metrics.Protocol.Forwarder.html"><span class="hs-identifier">System.Metrics.Protocol.Forwarder</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Forwarder</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="System.Metrics.Protocol.Codec.html"><span class="hs-identifier">System.Metrics.Protocol.Codec</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Forwarder</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="System.Metrics.Network.Forwarder.html#connectToAcceptor"><span class="hs-identifier hs-type">connectToAcceptor</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Metrics.Configuration.html#ForwarderConfiguration"><span class="hs-identifier hs-type">ForwarderConfiguration</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EKG.Store</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span id="connectToAcceptor"><span class="annot"><span class="annottext">connectToAcceptor :: ForwarderConfiguration -&gt; Store -&gt; IO ()
</span><a href="System.Metrics.Network.Forwarder.html#connectToAcceptor"><span class="hs-identifier hs-var hs-var">connectToAcceptor</span></a></span></span><span> </span><span id="local-6989586621679111116"><span class="annot"><span class="annottext">config :: ForwarderConfiguration
</span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="System.Metrics.Configuration.html#ForwarderConfiguration"><span class="hs-identifier hs-type">ForwarderConfiguration</span></a></span><span class="hs-special">{</span><span id="local-6989586621679111118"><span id="local-6989586621679111119"><span id="local-6989586621679111120"><span id="local-6989586621679111121"><span class="annot"><span class="annottext">NominalDiffTime
Tracer IO (TraceSendRecv (EKGForward Request Response))
HowToConnect
Request -&gt; IO ()
forwarderTracer :: Tracer IO (TraceSendRecv (EKGForward Request Response))
acceptorEndpoint :: HowToConnect
reConnectFrequency :: NominalDiffTime
actionOnRequest :: Request -&gt; IO ()
forwarderTracer :: ForwarderConfiguration
-&gt; Tracer IO (TraceSendRecv (EKGForward Request Response))
acceptorEndpoint :: ForwarderConfiguration -&gt; HowToConnect
reConnectFrequency :: ForwarderConfiguration -&gt; NominalDiffTime
actionOnRequest :: ForwarderConfiguration -&gt; Request -&gt; IO ()
</span><a href="#local-6989586621679111118"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679111126"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IOManager -&gt; IO ()) -&gt; IO ()
WithIOManager
</span><span class="hs-identifier hs-var">withIOManager</span></span><span> </span><span class="annot"><span class="annottext">((IOManager -&gt; IO ()) -&gt; IO ()) -&gt; (IOManager -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679111127"><span class="annot"><span class="annottext">IOManager
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">iocp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111128"><span class="annot"><span class="annottext">app :: OuroborosApplication
  'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
-&gt; Store
-&gt; OuroborosApplication
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall initiatorCtx responderCtx.
ForwarderConfiguration
-&gt; Store
-&gt; OuroborosApplication
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="System.Metrics.Network.Forwarder.html#forwarderApp"><span class="hs-identifier hs-var">forwarderApp</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HowToConnect
</span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">acceptorEndpoint</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="System.Metrics.Configuration.html#LocalPipe"><span class="hs-identifier hs-type">LocalPipe</span></a></span><span> </span><span id="local-6989586621679111131"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679111131"><span class="hs-identifier hs-var">localPipe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-57"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111132"><span class="annot"><span class="annottext">snocket :: LocalSnocket
</span><a href="#local-6989586621679111132"><span class="hs-identifier hs-var hs-var">snocket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOManager -&gt; LocalSnocket
</span><span class="hs-identifier hs-var">localSnocket</span></span><span> </span><span class="annot"><span class="annottext">IOManager
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">iocp</span></a></span><span>
</span><span id="line-58"></span><span>          </span><span id="local-6989586621679111133"><span class="annot"><span class="annottext">address :: LocalAddress
</span><a href="#local-6989586621679111133"><span class="hs-identifier hs-var hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; LocalAddress
</span><span class="hs-identifier hs-var">localAddressFromPath</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679111131"><span class="hs-identifier hs-var">localPipe</span></a></span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><span class="annottext">LocalSnocket
-&gt; MakeBearer IO LocalSocket
-&gt; (LocalSocket -&gt; IO ())
-&gt; LocalAddress
-&gt; ProtocolTimeLimits (Handshake UnversionedProtocol Term)
-&gt; OuroborosApplication
     'InitiatorMode
     (MinimalInitiatorContext LocalAddress)
     (ResponderContext LocalAddress)
     ByteString
     IO
     ()
     Void
-&gt; IO ()
forall fd addr.
Snocket IO fd addr
-&gt; MakeBearer IO fd
-&gt; (fd -&gt; IO ())
-&gt; addr
-&gt; ProtocolTimeLimits (Handshake UnversionedProtocol Term)
-&gt; OuroborosApplication
     'InitiatorMode
     (MinimalInitiatorContext addr)
     (ResponderContext addr)
     ByteString
     IO
     ()
     Void
-&gt; IO ()
</span><a href="System.Metrics.Network.Forwarder.html#doConnectToAcceptor"><span class="hs-identifier hs-var">doConnectToAcceptor</span></a></span><span> </span><span class="annot"><span class="annottext">LocalSnocket
</span><a href="#local-6989586621679111132"><span class="hs-identifier hs-var">snocket</span></a></span><span> </span><span class="annot"><span class="annottext">MakeBearer IO LocalSocket
</span><span class="hs-identifier hs-var">makeLocalBearer</span></span><span> </span><span class="annot"><span class="annottext">LocalSocket -&gt; IO ()
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">LocalAddress
</span><a href="#local-6989586621679111133"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolTimeLimits (Handshake UnversionedProtocol Term)
forall {k} (vNumber :: k).
ProtocolTimeLimits (Handshake vNumber Term)
</span><span class="hs-identifier hs-var">noTimeLimitsHandshake</span></span><span> </span><span class="annot"><span class="annottext">OuroborosApplication
  'InitiatorMode
  (MinimalInitiatorContext LocalAddress)
  (ResponderContext LocalAddress)
  ByteString
  IO
  ()
  Void
forall {initiatorCtx} {responderCtx}.
OuroborosApplication
  'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">app</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="System.Metrics.Configuration.html#RemoteSocket"><span class="hs-identifier hs-type">RemoteSocket</span></a></span><span> </span><span id="local-6989586621679111136"><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679111136"><span class="hs-identifier hs-var">host</span></a></span></span><span> </span><span id="local-6989586621679111137"><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621679111137"><span class="hs-identifier hs-var">port</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>      </span><span id="local-6989586621679111138"><span class="annot"><span class="annottext">AddrInfo
</span><a href="#local-6989586621679111138"><span class="hs-identifier hs-var">acceptorAddr</span></a></span></span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[AddrInfo]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe AddrInfo -&gt; Maybe FilePath -&gt; Maybe FilePath -&gt; IO [AddrInfo]
</span><span class="hs-identifier hs-var">Socket.getAddrInfo</span></span><span> </span><span class="annot"><span class="annottext">Maybe AddrInfo
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath) -&gt; FilePath -&gt; Maybe FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Host -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Host
</span><a href="#local-6989586621679111136"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath) -&gt; FilePath -&gt; Maybe FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Port -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621679111137"><span class="hs-identifier hs-var">port</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111142"><span class="annot"><span class="annottext">snocket :: SocketSnocket
</span><a href="#local-6989586621679111142"><span class="hs-identifier hs-var hs-var">snocket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOManager -&gt; SocketSnocket
</span><span class="hs-identifier hs-var">socketSnocket</span></span><span> </span><span class="annot"><span class="annottext">IOManager
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">iocp</span></a></span><span>
</span><span id="line-63"></span><span>          </span><span id="local-6989586621679111143"><span class="annot"><span class="annottext">address :: SockAddr
</span><a href="#local-6989586621679111143"><span class="hs-identifier hs-var hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrInfo -&gt; SockAddr
</span><span class="hs-identifier hs-var">Socket.addrAddress</span></span><span> </span><span class="annot"><span class="annottext">AddrInfo
</span><a href="#local-6989586621679111138"><span class="hs-identifier hs-var">acceptorAddr</span></a></span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><span class="annottext">SocketSnocket
-&gt; MakeBearer IO Socket
-&gt; (Socket -&gt; IO ())
-&gt; SockAddr
-&gt; ProtocolTimeLimits (Handshake UnversionedProtocol Term)
-&gt; OuroborosApplication
     'InitiatorMode
     (MinimalInitiatorContext SockAddr)
     (ResponderContext SockAddr)
     ByteString
     IO
     ()
     Void
-&gt; IO ()
forall fd addr.
Snocket IO fd addr
-&gt; MakeBearer IO fd
-&gt; (fd -&gt; IO ())
-&gt; addr
-&gt; ProtocolTimeLimits (Handshake UnversionedProtocol Term)
-&gt; OuroborosApplication
     'InitiatorMode
     (MinimalInitiatorContext addr)
     (ResponderContext addr)
     ByteString
     IO
     ()
     Void
-&gt; IO ()
</span><a href="System.Metrics.Network.Forwarder.html#doConnectToAcceptor"><span class="hs-identifier hs-var">doConnectToAcceptor</span></a></span><span> </span><span class="annot"><span class="annottext">SocketSnocket
</span><a href="#local-6989586621679111142"><span class="hs-identifier hs-var">snocket</span></a></span><span> </span><span class="annot"><span class="annottext">MakeBearer IO Socket
</span><span class="hs-identifier hs-var">makeSocketBearer</span></span><span> </span><span class="annot"><span class="annottext">Socket -&gt; IO ()
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">SockAddr
</span><a href="#local-6989586621679111143"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolTimeLimits (Handshake UnversionedProtocol Term)
forall {k} (vNumber :: k).
ProtocolTimeLimits (Handshake vNumber Term)
</span><span class="hs-identifier hs-var">timeLimitsHandshake</span></span><span> </span><span class="annot"><span class="annottext">OuroborosApplication
  'InitiatorMode
  (MinimalInitiatorContext SockAddr)
  (ResponderContext SockAddr)
  ByteString
  IO
  ()
  Void
forall {initiatorCtx} {responderCtx}.
OuroborosApplication
  'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">app</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span id="local-6989586621679110941"><span id="local-6989586621679110942"><span class="annot"><a href="System.Metrics.Network.Forwarder.html#doConnectToAcceptor"><span class="hs-identifier hs-type">doConnectToAcceptor</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snocket</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679110941"><span class="hs-identifier hs-type">fd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679110942"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MakeBearer</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679110941"><span class="hs-identifier hs-type">fd</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679110941"><span class="hs-identifier hs-type">fd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ configure socket</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679110942"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolTimeLimits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Handshake</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnversionedProtocol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OuroborosApplication</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">InitiatorMode</span></span><span>
</span><span id="line-73"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MinimalInitiatorContext</span></span><span> </span><span class="annot"><a href="#local-6989586621679110942"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ResponderContext</span></span><span> </span><span class="annot"><a href="#local-6989586621679110942"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>                          </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">LBS.ByteString</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-77"></span><span id="doConnectToAcceptor"><span class="annot"><span class="annottext">doConnectToAcceptor :: forall fd addr.
Snocket IO fd addr
-&gt; MakeBearer IO fd
-&gt; (fd -&gt; IO ())
-&gt; addr
-&gt; ProtocolTimeLimits (Handshake UnversionedProtocol Term)
-&gt; OuroborosApplication
     'InitiatorMode
     (MinimalInitiatorContext addr)
     (ResponderContext addr)
     ByteString
     IO
     ()
     Void
-&gt; IO ()
</span><a href="System.Metrics.Network.Forwarder.html#doConnectToAcceptor"><span class="hs-identifier hs-var hs-var">doConnectToAcceptor</span></a></span></span><span> </span><span id="local-6989586621679111158"><span class="annot"><span class="annottext">Snocket IO fd addr
</span><a href="#local-6989586621679111158"><span class="hs-identifier hs-var">snocket</span></a></span></span><span> </span><span id="local-6989586621679111159"><span class="annot"><span class="annottext">MakeBearer IO fd
</span><a href="#local-6989586621679111159"><span class="hs-identifier hs-var">makeBearer</span></a></span></span><span> </span><span id="local-6989586621679111160"><span class="annot"><span class="annottext">fd -&gt; IO ()
</span><a href="#local-6989586621679111160"><span class="hs-identifier hs-var">configureSocket</span></a></span></span><span> </span><span id="local-6989586621679111161"><span class="annot"><span class="annottext">addr
</span><a href="#local-6989586621679111161"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span id="local-6989586621679111162"><span class="annot"><span class="annottext">ProtocolTimeLimits (Handshake UnversionedProtocol Term)
</span><a href="#local-6989586621679111162"><span class="hs-identifier hs-var">timeLimits</span></a></span></span><span> </span><span id="local-6989586621679111163"><span class="annot"><span class="annottext">OuroborosApplication
  'InitiatorMode
  (MinimalInitiatorContext addr)
  (ResponderContext addr)
  ByteString
  IO
  ()
  Void
</span><a href="#local-6989586621679111163"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">Snocket IO fd addr
-&gt; MakeBearer IO fd
-&gt; (fd -&gt; IO ())
-&gt; Codec
     (Handshake UnversionedProtocol Term)
     DeserialiseFailure
     IO
     ByteString
-&gt; ProtocolTimeLimits (Handshake UnversionedProtocol Term)
-&gt; VersionDataCodec
     Term UnversionedProtocol UnversionedProtocolData
-&gt; NetworkConnectTracers addr UnversionedProtocol
-&gt; HandshakeCallbacks UnversionedProtocolData
-&gt; Versions
     UnversionedProtocol
     UnversionedProtocolData
     (OuroborosApplication
        'InitiatorMode
        (MinimalInitiatorContext addr)
        (ResponderContext addr)
        ByteString
        IO
        ()
        Void)
-&gt; Maybe addr
-&gt; addr
-&gt; IO ()
forall (appType :: MuxMode) vNumber vData fd addr a b.
(Ord vNumber, Typeable vNumber, Show vNumber,
 HasInitiator appType ~ 'True) =&gt;
Snocket IO fd addr
-&gt; MakeBearer IO fd
-&gt; (fd -&gt; IO ())
-&gt; Codec (Handshake vNumber Term) DeserialiseFailure IO ByteString
-&gt; ProtocolTimeLimits (Handshake vNumber Term)
-&gt; VersionDataCodec Term vNumber vData
-&gt; NetworkConnectTracers addr vNumber
-&gt; HandshakeCallbacks vData
-&gt; Versions
     vNumber
     vData
     (OuroborosApplicationWithMinimalCtx appType addr ByteString IO a b)
-&gt; Maybe addr
-&gt; addr
-&gt; IO ()
</span><span class="hs-identifier hs-var">connectToNode</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">Snocket IO fd addr
</span><a href="#local-6989586621679111158"><span class="hs-identifier hs-var">snocket</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">MakeBearer IO fd
</span><a href="#local-6989586621679111159"><span class="hs-identifier hs-var">makeBearer</span></a></span><span> </span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">fd -&gt; IO ()
</span><a href="#local-6989586621679111160"><span class="hs-identifier hs-var">configureSocket</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">Codec
  (Handshake UnversionedProtocol Term)
  DeserialiseFailure
  IO
  ByteString
forall (m :: * -&gt; *).
MonadST m =&gt;
Codec
  (Handshake UnversionedProtocol Term)
  DeserialiseFailure
  m
  ByteString
</span><span class="hs-identifier hs-var">unversionedHandshakeCodec</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">ProtocolTimeLimits (Handshake UnversionedProtocol Term)
</span><a href="#local-6989586621679111162"><span class="hs-identifier hs-var">timeLimits</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">VersionDataCodec Term UnversionedProtocol UnversionedProtocolData
</span><span class="hs-identifier hs-var">unversionedProtocolDataCodec</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">NetworkConnectTracers addr UnversionedProtocol
forall addr vNumber. NetworkConnectTracers addr vNumber
</span><span class="hs-identifier hs-var">nullNetworkConnectTracers</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnversionedProtocolData
 -&gt; UnversionedProtocolData -&gt; Accept UnversionedProtocolData)
-&gt; (UnversionedProtocolData -&gt; Bool)
-&gt; HandshakeCallbacks UnversionedProtocolData
forall vData.
(vData -&gt; vData -&gt; Accept vData)
-&gt; (vData -&gt; Bool) -&gt; HandshakeCallbacks vData
</span><span class="hs-identifier hs-var">HandshakeCallbacks</span></span><span> </span><span class="annot"><span class="annottext">UnversionedProtocolData
-&gt; UnversionedProtocolData -&gt; Accept UnversionedProtocolData
forall v. Acceptable v =&gt; v -&gt; v -&gt; Accept v
</span><span class="hs-identifier hs-var">acceptableVersion</span></span><span> </span><span class="annot"><span class="annottext">UnversionedProtocolData -&gt; Bool
forall v. Queryable v =&gt; v -&gt; Bool
</span><span class="hs-identifier hs-var">queryVersion</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnversionedProtocol
-&gt; UnversionedProtocolData
-&gt; OuroborosApplication
     'InitiatorMode
     (MinimalInitiatorContext addr)
     (ResponderContext addr)
     ByteString
     IO
     ()
     Void
-&gt; Versions
     UnversionedProtocol
     UnversionedProtocolData
     (OuroborosApplication
        'InitiatorMode
        (MinimalInitiatorContext addr)
        (ResponderContext addr)
        ByteString
        IO
        ()
        Void)
forall vNum vData r. vNum -&gt; vData -&gt; r -&gt; Versions vNum vData r
</span><span class="hs-identifier hs-var">simpleSingletonVersions</span></span><span>
</span><span id="line-88"></span><span>       </span><span class="annot"><span class="annottext">UnversionedProtocol
</span><span class="hs-identifier hs-var">UnversionedProtocol</span></span><span>
</span><span id="line-89"></span><span>       </span><span class="annot"><span class="annottext">UnversionedProtocolData
</span><span class="hs-identifier hs-var">UnversionedProtocolData</span></span><span>
</span><span id="line-90"></span><span>       </span><span class="annot"><span class="annottext">OuroborosApplication
  'InitiatorMode
  (MinimalInitiatorContext addr)
  (ResponderContext addr)
  ByteString
  IO
  ()
  Void
</span><a href="#local-6989586621679111163"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Maybe addr
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">addr
</span><a href="#local-6989586621679111161"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679110929"><span id="local-6989586621679110930"><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwarderApp"><span class="hs-identifier hs-type">forwarderApp</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Metrics.Configuration.html#ForwarderConfiguration"><span class="hs-identifier hs-type">ForwarderConfiguration</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EKG.Store</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OuroborosApplication</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">InitiatorMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679110929"><span class="hs-identifier hs-type">initiatorCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679110930"><span class="hs-identifier hs-type">responderCtx</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">LBS.ByteString</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span></span></span><span>
</span><span id="line-98"></span><span id="forwarderApp"><span class="annot"><span class="annottext">forwarderApp :: forall initiatorCtx responderCtx.
ForwarderConfiguration
-&gt; Store
-&gt; OuroborosApplication
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="System.Metrics.Network.Forwarder.html#forwarderApp"><span class="hs-identifier hs-var hs-var">forwarderApp</span></a></span></span><span> </span><span id="local-6989586621679111171"><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111171"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679111172"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111172"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">[MiniProtocol
   'InitiatorMode initiatorCtx responderCtx ByteString IO () Void]
-&gt; OuroborosApplication
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall (mode :: MuxMode) initiatorCtx responderCtx bytes
       (m :: * -&gt; *) a b.
[MiniProtocol mode initiatorCtx responderCtx bytes m a b]
-&gt; OuroborosApplication mode initiatorCtx responderCtx bytes m a b
</span><span class="hs-identifier hs-var">OuroborosApplication</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MiniProtocol</span></span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">miniProtocolNum :: MiniProtocolNum
</span><span class="hs-identifier hs-var">miniProtocolNum</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Port -&gt; MiniProtocolNum
</span><span class="hs-identifier hs-var">MiniProtocolNum</span></span><span> </span><span class="annot"><span class="annottext">Port
</span><span class="hs-number">2</span></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">miniProtocolLimits :: MiniProtocolLimits
</span><span class="hs-identifier hs-var">miniProtocolLimits</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MiniProtocolLimits</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">maximumIngressQueue :: Int
</span><span class="hs-identifier hs-var">maximumIngressQueue</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">miniProtocolRun :: RunMiniProtocol
  'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><span class="hs-identifier hs-var">miniProtocolRun</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
-&gt; Store
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall initiatorCtx responderCtx.
ForwarderConfiguration
-&gt; Store
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetrics"><span class="hs-identifier hs-var">forwardEKGMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111171"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111172"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621679111001"><span id="local-6989586621679111002"><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetrics"><span class="hs-identifier hs-type">forwardEKGMetrics</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Metrics.Configuration.html#ForwarderConfiguration"><span class="hs-identifier hs-type">ForwarderConfiguration</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EKG.Store</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunMiniProtocol</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">InitiatorMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679111001"><span class="hs-identifier hs-type">initiatorCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111002"><span class="hs-identifier hs-type">responderCtx</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">LBS.ByteString</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span></span></span><span>
</span><span id="line-111"></span><span id="forwardEKGMetrics"><span class="annot"><span class="annottext">forwardEKGMetrics :: forall initiatorCtx responderCtx.
ForwarderConfiguration
-&gt; Store
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetrics"><span class="hs-identifier hs-var hs-var">forwardEKGMetrics</span></a></span></span><span> </span><span id="local-6989586621679111197"><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111197"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679111198"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111198"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">MiniProtocolCb initiatorCtx ByteString IO ()
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall initiatorCtx bytes (m :: * -&gt; *) a responderCtx.
MiniProtocolCb initiatorCtx bytes m a
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx bytes m a Void
</span><span class="hs-identifier hs-var">InitiatorProtocolOnly</span></span><span> </span><span class="annot"><span class="annottext">(MiniProtocolCb initiatorCtx ByteString IO ()
 -&gt; RunMiniProtocol
      'InitiatorMode initiatorCtx responderCtx ByteString IO () Void)
-&gt; MiniProtocolCb initiatorCtx ByteString IO ()
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(initiatorCtx
 -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb initiatorCtx ByteString IO ()
forall ctx (m :: * -&gt; *) bytes a.
(ctx -&gt; Channel m bytes -&gt; m (a, Maybe bytes))
-&gt; MiniProtocolCb ctx bytes m a
</span><span class="hs-identifier hs-var">MiniProtocolCb</span></span><span> </span><span class="annot"><span class="annottext">((initiatorCtx
  -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
 -&gt; MiniProtocolCb initiatorCtx ByteString IO ())
-&gt; (initiatorCtx
    -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb initiatorCtx ByteString IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679111201"><span class="annot"><span class="annottext">initiatorCtx
</span><a href="#local-6989586621679111201"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span id="local-6989586621679111202"><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111202"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO (TraceSendRecv (EKGForward Request Response))
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
-&gt; Channel IO ByteString
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
-&gt; IO ((), Maybe ByteString)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><span class="hs-identifier hs-var">runPeer</span></span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForwarderConfiguration
-&gt; Tracer IO (TraceSendRecv (EKGForward Request Response))
</span><a href="System.Metrics.Configuration.html#forwarderTracer"><span class="hs-identifier hs-var">forwarderTracer</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111197"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request -&gt; Encoding)
-&gt; (forall s. Decoder s Request)
-&gt; (Response -&gt; Encoding)
-&gt; (forall s. Decoder s Response)
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
forall req resp (m :: * -&gt; *).
MonadST m =&gt;
(req -&gt; Encoding)
-&gt; (forall s. Decoder s req)
-&gt; (resp -&gt; Encoding)
-&gt; (forall s. Decoder s resp)
-&gt; Codec (EKGForward req resp) DeserialiseFailure m ByteString
</span><a href="System.Metrics.Protocol.Codec.html#codecEKGForward"><span class="hs-identifier hs-var">Forwarder.codecEKGForward</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Request
forall s. Decoder s Request
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span>
</span><span id="line-116"></span><span>                                 </span><span class="annot"><span class="annottext">Response -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Response
forall s. Decoder s Response
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>      </span><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111202"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EKGForwarder Request Response IO ()
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
forall (m :: * -&gt; *) req resp a.
Monad m =&gt;
EKGForwarder req resp m a
-&gt; Peer (EKGForward req resp) 'AsServer 'StIdle m a
</span><a href="System.Metrics.Protocol.Forwarder.html#ekgForwarderPeer"><span class="hs-identifier hs-var">Forwarder.ekgForwarderPeer</span></a></span><span> </span><span class="annot"><span class="annottext">(EKGForwarder Request Response IO ()
 -&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ())
-&gt; EKGForwarder Request Response IO ()
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
-&gt; Store -&gt; EKGForwarder Request Response IO ()
</span><a href="System.Metrics.Store.Forwarder.html#mkResponse"><span class="hs-identifier hs-var">mkResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111197"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111198"><span class="hs-identifier hs-var">ekgStore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679111055"><span id="local-6989586621679111056"><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsResp"><span class="hs-identifier hs-type">forwardEKGMetricsResp</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Metrics.Configuration.html#ForwarderConfiguration"><span class="hs-identifier hs-type">ForwarderConfiguration</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EKG.Store</span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunMiniProtocol</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ResponderMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679111055"><span class="hs-identifier hs-type">initiatorCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111056"><span class="hs-identifier hs-type">responderCtx</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">LBS.ByteString</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-124"></span><span id="forwardEKGMetricsResp"><span class="annot"><span class="annottext">forwardEKGMetricsResp :: forall initiatorCtx responderCtx.
ForwarderConfiguration
-&gt; Store
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx ByteString IO Void ()
</span><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsResp"><span class="hs-identifier hs-var hs-var">forwardEKGMetricsResp</span></a></span></span><span> </span><span id="local-6989586621679111220"><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111220"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679111221"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111221"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">MiniProtocolCb responderCtx ByteString IO ()
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx ByteString IO Void ()
forall responderCtx bytes (m :: * -&gt; *) b initiatorCtx.
MiniProtocolCb responderCtx bytes m b
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx bytes m Void b
</span><span class="hs-identifier hs-var">ResponderProtocolOnly</span></span><span> </span><span class="annot"><span class="annottext">(MiniProtocolCb responderCtx ByteString IO ()
 -&gt; RunMiniProtocol
      'ResponderMode initiatorCtx responderCtx ByteString IO Void ())
-&gt; MiniProtocolCb responderCtx ByteString IO ()
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx ByteString IO Void ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(responderCtx
 -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb responderCtx ByteString IO ()
forall ctx (m :: * -&gt; *) bytes a.
(ctx -&gt; Channel m bytes -&gt; m (a, Maybe bytes))
-&gt; MiniProtocolCb ctx bytes m a
</span><span class="hs-identifier hs-var">MiniProtocolCb</span></span><span> </span><span class="annot"><span class="annottext">((responderCtx
  -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
 -&gt; MiniProtocolCb responderCtx ByteString IO ())
-&gt; (responderCtx
    -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb responderCtx ByteString IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679111223"><span class="annot"><span class="annottext">responderCtx
</span><a href="#local-6989586621679111223"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span id="local-6989586621679111224"><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111224"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO (TraceSendRecv (EKGForward Request Response))
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
-&gt; Channel IO ByteString
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
-&gt; IO ((), Maybe ByteString)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><span class="hs-identifier hs-var">runPeer</span></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForwarderConfiguration
-&gt; Tracer IO (TraceSendRecv (EKGForward Request Response))
</span><a href="System.Metrics.Configuration.html#forwarderTracer"><span class="hs-identifier hs-var">forwarderTracer</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111220"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request -&gt; Encoding)
-&gt; (forall s. Decoder s Request)
-&gt; (Response -&gt; Encoding)
-&gt; (forall s. Decoder s Response)
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
forall req resp (m :: * -&gt; *).
MonadST m =&gt;
(req -&gt; Encoding)
-&gt; (forall s. Decoder s req)
-&gt; (resp -&gt; Encoding)
-&gt; (forall s. Decoder s resp)
-&gt; Codec (EKGForward req resp) DeserialiseFailure m ByteString
</span><a href="System.Metrics.Protocol.Codec.html#codecEKGForward"><span class="hs-identifier hs-var">Forwarder.codecEKGForward</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Request
forall s. Decoder s Request
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span>
</span><span id="line-129"></span><span>                                 </span><span class="annot"><span class="annottext">Response -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Response
forall s. Decoder s Response
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111224"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EKGForwarder Request Response IO ()
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
forall (m :: * -&gt; *) req resp a.
Monad m =&gt;
EKGForwarder req resp m a
-&gt; Peer (EKGForward req resp) 'AsServer 'StIdle m a
</span><a href="System.Metrics.Protocol.Forwarder.html#ekgForwarderPeer"><span class="hs-identifier hs-var">Forwarder.ekgForwarderPeer</span></a></span><span> </span><span class="annot"><span class="annottext">(EKGForwarder Request Response IO ()
 -&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ())
-&gt; EKGForwarder Request Response IO ()
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
-&gt; Store -&gt; EKGForwarder Request Response IO ()
</span><a href="System.Metrics.Store.Forwarder.html#mkResponse"><span class="hs-identifier hs-var">mkResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ForwarderConfiguration
</span><a href="#local-6989586621679111220"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679111221"><span class="hs-identifier hs-var">ekgStore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679111062"><span id="local-6989586621679111063"><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsDummy"><span class="hs-identifier hs-type">forwardEKGMetricsDummy</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunMiniProtocol</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">InitiatorMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679111062"><span class="hs-identifier hs-type">initiatorCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111063"><span class="hs-identifier hs-type">responderCtx</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">LBS.ByteString</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span></span></span><span>
</span><span id="line-135"></span><span id="forwardEKGMetricsDummy"><span class="annot"><span class="annottext">forwardEKGMetricsDummy :: forall initiatorCtx responderCtx.
RunMiniProtocol
  'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
</span><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsDummy"><span class="hs-identifier hs-var hs-var">forwardEKGMetricsDummy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="annottext">MiniProtocolCb initiatorCtx ByteString IO ()
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall initiatorCtx bytes (m :: * -&gt; *) a responderCtx.
MiniProtocolCb initiatorCtx bytes m a
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx bytes m a Void
</span><span class="hs-identifier hs-var">InitiatorProtocolOnly</span></span><span> </span><span class="annot"><span class="annottext">(MiniProtocolCb initiatorCtx ByteString IO ()
 -&gt; RunMiniProtocol
      'InitiatorMode initiatorCtx responderCtx ByteString IO () Void)
-&gt; MiniProtocolCb initiatorCtx ByteString IO ()
-&gt; RunMiniProtocol
     'InitiatorMode initiatorCtx responderCtx ByteString IO () Void
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(initiatorCtx
 -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb initiatorCtx ByteString IO ()
forall ctx (m :: * -&gt; *) bytes a.
(ctx -&gt; Channel m bytes -&gt; m (a, Maybe bytes))
-&gt; MiniProtocolCb ctx bytes m a
</span><span class="hs-identifier hs-var">MiniProtocolCb</span></span><span> </span><span class="annot"><span class="annottext">((initiatorCtx
  -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
 -&gt; MiniProtocolCb initiatorCtx ByteString IO ())
-&gt; (initiatorCtx
    -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb initiatorCtx ByteString IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679111240"><span class="annot"><span class="annottext">initiatorCtx
</span><a href="#local-6989586621679111240"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span id="local-6989586621679111241"><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111241"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO (TraceSendRecv (EKGForward Request Response))
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
-&gt; Channel IO ByteString
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
-&gt; IO ((), Maybe ByteString)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><span class="hs-identifier hs-var">runPeer</span></span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">Tracer IO (TraceSendRecv (EKGForward Request Response))
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><span class="hs-identifier hs-var">nullTracer</span></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request -&gt; Encoding)
-&gt; (forall s. Decoder s Request)
-&gt; (Response -&gt; Encoding)
-&gt; (forall s. Decoder s Response)
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
forall req resp (m :: * -&gt; *).
MonadST m =&gt;
(req -&gt; Encoding)
-&gt; (forall s. Decoder s req)
-&gt; (resp -&gt; Encoding)
-&gt; (forall s. Decoder s resp)
-&gt; Codec (EKGForward req resp) DeserialiseFailure m ByteString
</span><a href="System.Metrics.Protocol.Codec.html#codecEKGForward"><span class="hs-identifier hs-var">Forwarder.codecEKGForward</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Request
forall s. Decoder s Request
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span>
</span><span id="line-140"></span><span>                                 </span><span class="annot"><span class="annottext">Response -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Response
forall s. Decoder s Response
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111241"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EKGForwarder Request Response IO ()
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
forall (m :: * -&gt; *) req resp a.
Monad m =&gt;
EKGForwarder req resp m a
-&gt; Peer (EKGForward req resp) 'AsServer 'StIdle m a
</span><a href="System.Metrics.Protocol.Forwarder.html#ekgForwarderPeer"><span class="hs-identifier hs-var">Forwarder.ekgForwarderPeer</span></a></span><span> </span><span class="annot"><span class="annottext">EKGForwarder Request Response IO ()
</span><a href="System.Metrics.Store.Forwarder.html#mkResponseDummy"><span class="hs-identifier hs-var">mkResponseDummy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679111070"><span id="local-6989586621679111071"><span class="annot"><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsRespDummy"><span class="hs-identifier hs-type">forwardEKGMetricsRespDummy</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunMiniProtocol</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ResponderMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679111070"><span class="hs-identifier hs-type">initiatorCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111071"><span class="hs-identifier hs-type">responderCtx</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">LBS.ByteString</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-146"></span><span id="forwardEKGMetricsRespDummy"><span class="annot"><span class="annottext">forwardEKGMetricsRespDummy :: forall initiatorCtx responderCtx.
RunMiniProtocol
  'ResponderMode initiatorCtx responderCtx ByteString IO Void ()
</span><a href="System.Metrics.Network.Forwarder.html#forwardEKGMetricsRespDummy"><span class="hs-identifier hs-var hs-var">forwardEKGMetricsRespDummy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="annottext">MiniProtocolCb responderCtx ByteString IO ()
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx ByteString IO Void ()
forall responderCtx bytes (m :: * -&gt; *) b initiatorCtx.
MiniProtocolCb responderCtx bytes m b
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx bytes m Void b
</span><span class="hs-identifier hs-var">ResponderProtocolOnly</span></span><span> </span><span class="annot"><span class="annottext">(MiniProtocolCb responderCtx ByteString IO ()
 -&gt; RunMiniProtocol
      'ResponderMode initiatorCtx responderCtx ByteString IO Void ())
-&gt; MiniProtocolCb responderCtx ByteString IO ()
-&gt; RunMiniProtocol
     'ResponderMode initiatorCtx responderCtx ByteString IO Void ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(responderCtx
 -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb responderCtx ByteString IO ()
forall ctx (m :: * -&gt; *) bytes a.
(ctx -&gt; Channel m bytes -&gt; m (a, Maybe bytes))
-&gt; MiniProtocolCb ctx bytes m a
</span><span class="hs-identifier hs-var">MiniProtocolCb</span></span><span> </span><span class="annot"><span class="annottext">((responderCtx
  -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
 -&gt; MiniProtocolCb responderCtx ByteString IO ())
-&gt; (responderCtx
    -&gt; Channel IO ByteString -&gt; IO ((), Maybe ByteString))
-&gt; MiniProtocolCb responderCtx ByteString IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679111256"><span class="annot"><span class="annottext">responderCtx
</span><a href="#local-6989586621679111256"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span id="local-6989586621679111257"><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111257"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO (TraceSendRecv (EKGForward Request Response))
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
-&gt; Channel IO ByteString
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
-&gt; IO ((), Maybe ByteString)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><span class="hs-identifier hs-var">runPeer</span></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">Tracer IO (TraceSendRecv (EKGForward Request Response))
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><span class="hs-identifier hs-var">nullTracer</span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request -&gt; Encoding)
-&gt; (forall s. Decoder s Request)
-&gt; (Response -&gt; Encoding)
-&gt; (forall s. Decoder s Response)
-&gt; Codec
     (EKGForward Request Response) DeserialiseFailure IO ByteString
forall req resp (m :: * -&gt; *).
MonadST m =&gt;
(req -&gt; Encoding)
-&gt; (forall s. Decoder s req)
-&gt; (resp -&gt; Encoding)
-&gt; (forall s. Decoder s resp)
-&gt; Codec (EKGForward req resp) DeserialiseFailure m ByteString
</span><a href="System.Metrics.Protocol.Codec.html#codecEKGForward"><span class="hs-identifier hs-var">Forwarder.codecEKGForward</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Request
forall s. Decoder s Request
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span>
</span><span id="line-151"></span><span>                                 </span><span class="annot"><span class="annottext">Response -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">CBOR.encode</span></span><span> </span><span class="annot"><span class="annottext">Decoder s Response
forall s. Decoder s Response
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">CBOR.decode</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><span class="annottext">Channel IO ByteString
</span><a href="#local-6989586621679111257"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EKGForwarder Request Response IO ()
-&gt; Peer (EKGForward Request Response) 'AsServer 'StIdle IO ()
forall (m :: * -&gt; *) req resp a.
Monad m =&gt;
EKGForwarder req resp m a
-&gt; Peer (EKGForward req resp) 'AsServer 'StIdle m a
</span><a href="System.Metrics.Protocol.Forwarder.html#ekgForwarderPeer"><span class="hs-identifier hs-var">Forwarder.ekgForwarderPeer</span></a></span><span> </span><span class="annot"><span class="annottext">EKGForwarder Request Response IO ()
</span><a href="System.Metrics.Store.Forwarder.html#mkResponseDummy"><span class="hs-identifier hs-var">mkResponseDummy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span></pre></body></html>