<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE StrictData        #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusLedgerApi.Common.Eval</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier">EvaluationError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier">EvaluationContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#AsScriptDecodeError"><span class="hs-identifier">AsScriptDecodeError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#LogOutput"><span class="hs-identifier">LogOutput</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#VerboseMode"><span class="hs-identifier">VerboseMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateScriptRestricting"><span class="hs-identifier">evaluateScriptRestricting</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateScriptCounting"><span class="hs-identifier">evaluateScriptCounting</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateTerm"><span class="hs-identifier">evaluateTerm</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#mkDynEvaluationContext"><span class="hs-identifier">mkDynEvaluationContext</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#toMachineParameters"><span class="hs-identifier">toMachineParameters</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#mkTermToEvaluate"><span class="hs-identifier">mkTermToEvaluate</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#assertWellFormedCostModelParams"><span class="hs-identifier">assertWellFormedCostModelParams</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Data</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Default</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Evaluation.Machine.CostModelInterface</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExBudget</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExBudgetingDefaults</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Evaluation.Machine.MachineParameters.Default</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.MkPlc</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Pretty</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html"><span class="hs-identifier">PlutusLedgerApi.Common.SerialisedScript</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Versions.html"><span class="hs-identifier">PlutusLedgerApi.Common.Versions</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusPrelude</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">UntypedPlutusCore</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">UntypedPlutusCore.Evaluation.Machine.Cek</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Error.Lens</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#MonadError"><span class="hs-identifier">MonadError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#liftEither"><span class="hs-identifier">liftEither</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier">runExceptT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Writer.html"><span class="hs-identifier">Control.Monad.Writer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Writer.Class.html#MonadWriter"><span class="hs-identifier">MonadWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Writer.Lazy.html#runWriter"><span class="hs-identifier">runWriter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html"><span class="hs-identifier">Data.Tuple</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- | Errors that can be thrown when evaluating a Plutus script.</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">data</span><span> </span><span id="EvaluationError"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier hs-var">EvaluationError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>    </span><span id="CekError"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#CekError"><span class="hs-identifier hs-var">CekError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UPLC.CekEvaluationException</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedDeBruijn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultUni</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ An error from the evaluator itself</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DeBruijnError"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#DeBruijnError"><span class="hs-identifier hs-var">DeBruijnError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">FreeVariableError</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An error in the pre-evaluation step of converting from de-Bruijn indices</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CodecError"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#CodecError"><span class="hs-identifier hs-var">CodecError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#ScriptDecodeError"><span class="hs-identifier hs-type">ScriptDecodeError</span></a></span><span> </span><span class="hs-comment">-- ^ A deserialisation error</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">-- TODO: make this error more informative when we have more information about what went wrong</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CostModelParameterMismatch"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#CostModelParameterMismatch"><span class="hs-identifier hs-var">CostModelParameterMismatch</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An error indicating that the cost model parameters didn't match what we expected</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680434661"><span id="local-6989586621680434675"><span id="local-6989586621680434679"><span class="annot"><span class="annottext">Int -&gt; EvaluationError -&gt; ShowS
[EvaluationError] -&gt; ShowS
EvaluationError -&gt; String
(Int -&gt; EvaluationError -&gt; ShowS)
-&gt; (EvaluationError -&gt; String)
-&gt; ([EvaluationError] -&gt; ShowS)
-&gt; Show EvaluationError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; EvaluationError -&gt; ShowS
showsPrec :: Int -&gt; EvaluationError -&gt; ShowS
$cshow :: EvaluationError -&gt; String
show :: EvaluationError -&gt; String
$cshowList :: [EvaluationError] -&gt; ShowS
showList :: [EvaluationError] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680434778"><span id="local-6989586621680434788"><span class="annot"><span class="annottext">EvaluationError -&gt; EvaluationError -&gt; Bool
(EvaluationError -&gt; EvaluationError -&gt; Bool)
-&gt; (EvaluationError -&gt; EvaluationError -&gt; Bool)
-&gt; Eq EvaluationError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: EvaluationError -&gt; EvaluationError -&gt; Bool
== :: EvaluationError -&gt; EvaluationError -&gt; Bool
$c/= :: EvaluationError -&gt; EvaluationError -&gt; Bool
/= :: EvaluationError -&gt; EvaluationError -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span id="AsEvaluationError"><span id="local-6989586621680434362"><span id="local-6989586621680434838"><span id="local-6989586621680434848"><span id="local-6989586621680434857"><span id="local-6989586621680434866"><span id="local-6989586621680434876"><span id="local-6989586621680434880"><span id="local-6989586621680434886"><span id="local-6989586621680434892"><span id="local-6989586621680434898"><span id="_EvaluationError"><span id="_CekError"><span id="_DeBruijnError"><span id="_CodecError"><span id="_CostModelParameterMismatch"><span class="hs-identifier">makeClassyPrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">EvaluationError</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680434924"><span id="local-6989586621680434932"><span id="local-6989586621680434939"><span id="local-6989586621680434946"><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#AsScriptDecodeError"><span class="hs-identifier hs-type">AsScriptDecodeError</span></a></span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621680434958"><span class="annot"><span class="annottext">_ScriptDecodeError :: Prism' EvaluationError ScriptDecodeError
</span><a href="#local-6989586621680434958"><span class="hs-identifier hs-var hs-var hs-var hs-var">_ScriptDecodeError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p ScriptDecodeError (f ScriptDecodeError)
-&gt; p EvaluationError (f EvaluationError)
forall r. AsEvaluationError r =&gt; Prism' r ScriptDecodeError
Prism' EvaluationError ScriptDecodeError
</span><a href="PlutusLedgerApi.Common.Eval.html#_CodecError"><span class="hs-identifier hs-var">_CodecError</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680434962"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621680435033"><span class="annot"><span class="annottext">pretty :: forall ann. EvaluationError -&gt; Doc ann
</span><a href="#local-6989586621680435033"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#CekError"><span class="hs-identifier hs-type">CekError</span></a></span><span> </span><span id="local-6989586621680435035"><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
</span><a href="#local-6989586621680435035"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; Doc ann
forall a ann. PrettyClassic a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">prettyClassicDef</span></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
</span><a href="#local-6989586621680435035"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#DeBruijnError"><span class="hs-identifier hs-type">DeBruijnError</span></a></span><span> </span><span id="local-6989586621680435037"><span class="annot"><span class="annottext">FreeVariableError
</span><a href="#local-6989586621680435037"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVariableError -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
forall ann. FreeVariableError -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">FreeVariableError
</span><a href="#local-6989586621680435037"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#CodecError"><span class="hs-identifier hs-type">CodecError</span></a></span><span> </span><span id="local-6989586621680435038"><span class="annot"><span class="annottext">ScriptDecodeError
</span><a href="#local-6989586621680435038"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptDecodeError -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">viaShow</span></span><span> </span><span class="annot"><span class="annottext">ScriptDecodeError
</span><a href="#local-6989586621680435038"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">EvaluationError
</span><a href="PlutusLedgerApi.Common.Eval.html#CostModelParameterMismatch"><span class="hs-identifier hs-var">CostModelParameterMismatch</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Cost model parameters were not as we expected&quot;</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">-- | A simple toggle indicating whether or not we should accumulate logs during script execution.</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">data</span><span> </span><span id="VerboseMode"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#VerboseMode"><span class="hs-identifier hs-var">VerboseMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>    </span><span id="Verbose"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ accumulate all traces</span></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Quiet"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ don't accumulate anything</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680435043"><span id="local-6989586621680435045"><span class="annot"><span class="annottext">VerboseMode -&gt; VerboseMode -&gt; Bool
(VerboseMode -&gt; VerboseMode -&gt; Bool)
-&gt; (VerboseMode -&gt; VerboseMode -&gt; Bool) -&gt; Eq VerboseMode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: VerboseMode -&gt; VerboseMode -&gt; Bool
== :: VerboseMode -&gt; VerboseMode -&gt; Bool
$c/= :: VerboseMode -&gt; VerboseMode -&gt; Bool
/= :: VerboseMode -&gt; VerboseMode -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">{-| The type of the executed script's accumulated log output: a list of 'Text'.

It will be an empty list if the `VerboseMode` is set to `Quiet`.
-}</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">type</span><span> </span><span id="LogOutput"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#LogOutput"><span class="hs-identifier hs-var">LogOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text.Text</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">{-| Shared helper for the evaluation functions: 'evaluateScriptCounting' and 'evaluateScriptRestricting',

Given a 'ScriptForEvaluation':

1) applies the term to a list of 'Data' arguments (e.g. Datum, Redeemer, `ScriptContext`)
2) checks that the applied-term is well-scoped
3) returns the applied-term
-}</span></span><span>
</span><span id="line-89"></span><span id="local-6989586621680434424"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#mkTermToEvaluate"><span class="hs-identifier hs-type">mkTermToEvaluate</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#MonadError"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680434424"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Versions.html#PlutusLedgerLanguage"><span class="hs-identifier hs-type">PlutusLedgerLanguage</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the Plutus ledger language of the script under execution.</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.ProtocolVersions.html#MajorProtocolVersion"><span class="hs-identifier hs-type">MajorProtocolVersion</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ which major protocol version to run the operation in</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#ScriptForEvaluation"><span class="hs-identifier hs-type">ScriptForEvaluation</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the script to evaluate</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Plutus.Data</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ the arguments that the script's underlying term will be applied to</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680434424"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UPLC.Term</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.NamedDeBruijn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultUni</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-96"></span><span id="mkTermToEvaluate"><span class="annot"><span class="annottext">mkTermToEvaluate :: forall (m :: * -&gt; *).
MonadError EvaluationError m =&gt;
PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="PlutusLedgerApi.Common.Eval.html#mkTermToEvaluate"><span class="hs-identifier hs-var hs-var">mkTermToEvaluate</span></a></span></span><span> </span><span id="local-6989586621680435074"><span class="annot"><span class="annottext">PlutusLedgerLanguage
</span><a href="#local-6989586621680435074"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span id="local-6989586621680435075"><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435075"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621680435076"><span class="annot"><span class="annottext">ScriptForEvaluation
</span><a href="#local-6989586621680435076"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span id="local-6989586621680435077"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621680435077"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#ScriptNamedDeBruijn"><span class="hs-identifier hs-type">ScriptNamedDeBruijn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UPLC.Program</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680435080"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621680435080"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680435081"><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435081"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptForEvaluation -&gt; ScriptNamedDeBruijn
</span><a href="PlutusLedgerApi.Common.SerialisedScript.html#deserialisedScript"><span class="hs-identifier hs-var">deserialisedScript</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptForEvaluation
</span><a href="#local-6989586621680435076"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span id="local-6989586621680435091"><span class="annot"><span class="annottext">termArgs :: [Term NamedDeBruijn DefaultUni DefaultFun ()]
</span><a href="#local-6989586621680435091"><span class="hs-identifier hs-var hs-var">termArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Term NamedDeBruijn DefaultUni DefaultFun ())
-&gt; [Data] -&gt; [Term NamedDeBruijn DefaultUni DefaultFun ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Data -&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
forall a (uni :: * -&gt; *) fun (term :: * -&gt; *) tyname name ann.
(TermLike term tyname name uni fun, HasTermLevel uni a) =&gt;
ann -&gt; a -&gt; term ann
</span><span class="hs-identifier hs-var">UPLC.mkConstant</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621680435077"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span id="local-6989586621680435094"><span class="annot"><span class="annottext">appliedT :: Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435094"><span class="hs-identifier hs-var hs-var">appliedT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; [Term NamedDeBruijn DefaultUni DefaultFun ()]
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun.
TermLike term tyname name uni fun =&gt;
term () -&gt; [term ()] -&gt; term ()
</span><span class="hs-identifier hs-var">UPLC.mkIterAppNoAnn</span></span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435081"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Term NamedDeBruijn DefaultUni DefaultFun ()]
</span><a href="#local-6989586621680435091"><span class="hs-identifier hs-var">termArgs</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- check that the Plutus Core language version is available</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- See Note [Checking the Plutus Core language version]</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621680435080"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Set Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusLedgerLanguage -&gt; MajorProtocolVersion -&gt; Set Version
</span><a href="PlutusLedgerApi.Common.Versions.html#plcVersionsAvailableIn"><span class="hs-identifier hs-var">plcVersionsAvailableIn</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusLedgerLanguage
</span><a href="#local-6989586621680435074"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435075"><span class="hs-identifier hs-var">pv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview EvaluationError ScriptDecodeError
-&gt; ScriptDecodeError -&gt; m ()
forall e (m :: * -&gt; *) t x.
MonadError e m =&gt;
AReview e t -&gt; t -&gt; m x
</span><span class="hs-identifier hs-var">throwing</span></span><span> </span><span class="annot"><span class="annottext">AReview EvaluationError ScriptDecodeError
forall r. AsScriptDecodeError r =&gt; Prism' r ScriptDecodeError
Prism' EvaluationError ScriptDecodeError
</span><a href="PlutusLedgerApi.Common.SerialisedScript.html#_ScriptDecodeError"><span class="hs-identifier hs-var">_ScriptDecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptDecodeError -&gt; m ()) -&gt; ScriptDecodeError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; MajorProtocolVersion -&gt; ScriptDecodeError
</span><a href="PlutusLedgerApi.Common.SerialisedScript.html#PlutusCoreLanguageNotAvailableError"><span class="hs-identifier hs-var">PlutusCoreLanguageNotAvailableError</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621680435080"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435075"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- make sure that term is closed, i.e. well-scoped</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">(Term NamedDeBruijn DefaultUni DefaultFun () -&gt; m ())
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">through</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either EvaluationError () -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#liftEither"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError () -&gt; m ())
-&gt; (Term NamedDeBruijn DefaultUni DefaultFun ()
    -&gt; Either EvaluationError ())
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVariableError -&gt; EvaluationError)
-&gt; Either FreeVariableError () -&gt; Either EvaluationError ()
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Bifunctor.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVariableError -&gt; EvaluationError
</span><a href="PlutusLedgerApi.Common.Eval.html#DeBruijnError"><span class="hs-identifier hs-var">DeBruijnError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either FreeVariableError () -&gt; Either EvaluationError ())
-&gt; (Term NamedDeBruijn DefaultUni DefaultFun ()
    -&gt; Either FreeVariableError ())
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; Either EvaluationError ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; Either FreeVariableError ()
forall e (m :: * -&gt; *) name (uni :: * -&gt; *) fun a.
(HasIndex name, MonadError e m, AsFreeVariableError e) =&gt;
Term name uni fun a -&gt; m ()
</span><span class="hs-identifier hs-var">UPLC.checkScope</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435094"><span class="hs-identifier hs-var">appliedT</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#toMachineParameters"><span class="hs-identifier hs-type">toMachineParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.ProtocolVersions.html#MajorProtocolVersion"><span class="hs-identifier hs-type">MajorProtocolVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultMachineParameters</span></span><span>
</span><span id="line-109"></span><span id="toMachineParameters"><span class="annot"><span class="annottext">toMachineParameters :: MajorProtocolVersion
-&gt; EvaluationContext -&gt; DefaultMachineParameters
</span><a href="PlutusLedgerApi.Common.Eval.html#toMachineParameters"><span class="hs-identifier hs-var hs-var">toMachineParameters</span></a></span></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EvaluationContext -&gt; DefaultMachineParameters
</span><a href="PlutusLedgerApi.Common.Eval.html#machineParameters"><span class="hs-identifier hs-var">machineParameters</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">{-| An opaque type that contains all the static parameters that the evaluator needs to evaluate a
script.  This is so that they can be computed once and cached, rather than being recomputed on every
evaluation.
-}</span></span><span>
</span><span id="line-115"></span><span class="hs-keyword">newtype</span><span> </span><span id="EvaluationContext"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-var">EvaluationContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EvaluationContext"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-var">EvaluationContext</span></a></span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="machineParameters"><span class="annot"><span class="annottext">EvaluationContext -&gt; DefaultMachineParameters
</span><a href="PlutusLedgerApi.Common.Eval.html#machineParameters"><span class="hs-identifier hs-var hs-var">machineParameters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultMachineParameters</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621680435106"><span id="local-6989586621680435108"><span class="annot"><span class="annottext">(forall x. EvaluationContext -&gt; Rep EvaluationContext x)
-&gt; (forall x. Rep EvaluationContext x -&gt; EvaluationContext)
-&gt; Generic EvaluationContext
forall x. Rep EvaluationContext x -&gt; EvaluationContext
forall x. EvaluationContext -&gt; Rep EvaluationContext x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. EvaluationContext -&gt; Rep EvaluationContext x
from :: forall x. EvaluationContext -&gt; Rep EvaluationContext x
$cto :: forall x. Rep EvaluationContext x -&gt; EvaluationContext
to :: forall x. Rep EvaluationContext x -&gt; EvaluationContext
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680435112"><span class="annot"><span class="annottext">EvaluationContext -&gt; ()
(EvaluationContext -&gt; ()) -&gt; NFData EvaluationContext
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: EvaluationContext -&gt; ()
rnf :: EvaluationContext -&gt; ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680435146"><span id="local-6989586621680435150"><span id="local-6989586621680435156"><span class="annot"><span class="annottext">Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
Proxy EvaluationContext -&gt; String
(Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy EvaluationContext -&gt; String)
-&gt; NoThunks EvaluationContext
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: Proxy EvaluationContext -&gt; String
showTypeOf :: Proxy EvaluationContext -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">{-|  Create an 'EvaluationContext' for a given builtin semantics variant.

The input is a `Map` of `Text`s to cost integer values (aka `Plutus.CostModelParams`, `Alonzo.CostModel`)
See Note [Inlining meanings of builtins].

IMPORTANT: The evaluation context of every Plutus version must be recreated upon a protocol update
with the updated cost model parameters.
-}</span></span><span>
</span><span id="line-129"></span><span id="local-6989586621680434559"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#mkDynEvaluationContext"><span class="hs-identifier hs-type">mkDynEvaluationContext</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#MonadError"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CostModelApplyError</span></span><span> </span><span class="annot"><a href="#local-6989586621680434559"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BuiltinSemanticsVariant</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plutus.CostModelParams</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680434559"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span></span><span>
</span><span id="line-134"></span><span id="mkDynEvaluationContext"><span class="annot"><span class="annottext">mkDynEvaluationContext :: forall (m :: * -&gt; *).
MonadError CostModelApplyError m =&gt;
BuiltinSemanticsVariant DefaultFun
-&gt; CostModelParams -&gt; m EvaluationContext
</span><a href="PlutusLedgerApi.Common.Eval.html#mkDynEvaluationContext"><span class="hs-identifier hs-var hs-var">mkDynEvaluationContext</span></a></span></span><span> </span><span id="local-6989586621680435206"><span class="annot"><span class="annottext">BuiltinSemanticsVariant DefaultFun
</span><a href="#local-6989586621680435206"><span class="hs-identifier hs-var">semvar</span></a></span></span><span> </span><span id="local-6989586621680435207"><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621680435207"><span class="hs-identifier hs-var">newCMP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">DefaultMachineParameters -&gt; EvaluationContext
</span><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-var">EvaluationContext</span></a></span><span> </span><span class="annot"><span class="annottext">(DefaultMachineParameters -&gt; EvaluationContext)
-&gt; m DefaultMachineParameters -&gt; m EvaluationContext
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinSemanticsVariant DefaultFun
-&gt; CostModelParams -&gt; m DefaultMachineParameters
forall (m :: * -&gt; *).
MonadError CostModelApplyError m =&gt;
BuiltinSemanticsVariant DefaultFun
-&gt; CostModelParams -&gt; m DefaultMachineParameters
</span><span class="hs-identifier hs-var">mkMachineParametersFor</span></span><span> </span><span class="annot"><span class="annottext">BuiltinSemanticsVariant DefaultFun
</span><a href="#local-6989586621680435206"><span class="hs-identifier hs-var">semvar</span></a></span><span> </span><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621680435207"><span class="hs-identifier hs-var">newCMP</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- FIXME: remove this function</span><span>
</span><span id="line-138"></span><span id="local-6989586621680434567"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#assertWellFormedCostModelParams"><span class="hs-identifier hs-type">assertWellFormedCostModelParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#MonadError"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CostModelApplyError</span></span><span> </span><span class="annot"><a href="#local-6989586621680434567"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plutus.CostModelParams</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680434567"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-139"></span><span id="assertWellFormedCostModelParams"><span class="annot"><span class="annottext">assertWellFormedCostModelParams :: forall (m :: * -&gt; *).
MonadError CostModelApplyError m =&gt;
CostModelParams -&gt; m ()
</span><a href="PlutusLedgerApi.Common.Eval.html#assertWellFormedCostModelParams"><span class="hs-identifier hs-var hs-var">assertWellFormedCostModelParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (CostModel (CekMachineCostsBase Identity) BuiltinCostModel)
-&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(m (CostModel (CekMachineCostsBase Identity) BuiltinCostModel)
 -&gt; m ())
-&gt; (CostModelParams
    -&gt; m (CostModel (CekMachineCostsBase Identity) BuiltinCostModel))
-&gt; CostModelParams
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CostModel (CekMachineCostsBase Identity) BuiltinCostModel
-&gt; CostModelParams
-&gt; m (CostModel (CekMachineCostsBase Identity) BuiltinCostModel)
forall evaluatorcosts builtincosts (m :: * -&gt; *).
(FromJSON evaluatorcosts, FromJSON builtincosts,
 ToJSON evaluatorcosts, ToJSON builtincosts,
 MonadError CostModelApplyError m) =&gt;
CostModel evaluatorcosts builtincosts
-&gt; CostModelParams -&gt; m (CostModel evaluatorcosts builtincosts)
</span><span class="hs-identifier hs-var">Plutus.applyCostModelParams</span></span><span> </span><span class="annot"><span class="annottext">CostModel (CekMachineCostsBase Identity) BuiltinCostModel
</span><span class="hs-identifier hs-var">Plutus.defaultCekCostModel</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Evaluate a fully-applied term using the CEK machine. Useful for mimicking the behaviour of the</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- on-chain evaluator.</span><span>
</span><span id="line-143"></span><span id="local-6989586621680434578"><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateTerm"><span class="hs-identifier hs-type">evaluateTerm</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.ExBudgetMode</span></span><span> </span><span class="annot"><a href="#local-6989586621680434578"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultUni</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.ProtocolVersions.html#MajorProtocolVersion"><span class="hs-identifier hs-type">MajorProtocolVersion</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#VerboseMode"><span class="hs-identifier hs-type">VerboseMode</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.Term</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.NamedDeBruijn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultUni</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UPLC.CekEvaluationException</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedDeBruijn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultUni</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UPLC.Term</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.NamedDeBruijn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultUni</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680434578"><span class="hs-identifier hs-type">cost</span></a></span><span>
</span><span id="line-153"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>       </span><span class="hs-special">)</span></span><span>
</span><span id="line-155"></span><span id="evaluateTerm"><span class="annot"><span class="annottext">evaluateTerm :: forall cost.
ExBudgetMode cost DefaultUni DefaultFun
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    cost, LogOutput)
</span><a href="PlutusLedgerApi.Common.Eval.html#evaluateTerm"><span class="hs-identifier hs-var hs-var">evaluateTerm</span></a></span></span><span> </span><span id="local-6989586621680435279"><span class="annot"><span class="annottext">ExBudgetMode cost DefaultUni DefaultFun
</span><a href="#local-6989586621680435279"><span class="hs-identifier hs-var">budgetMode</span></a></span></span><span> </span><span id="local-6989586621680435280"><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435280"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621680435281"><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621680435281"><span class="hs-identifier hs-var">verbose</span></a></span></span><span> </span><span id="local-6989586621680435282"><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621680435282"><span class="hs-identifier hs-var">ectx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">DefaultMachineParameters
-&gt; ExBudgetMode cost DefaultUni DefaultFun
-&gt; EmitterMode DefaultUni DefaultFun
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    cost, LogOutput)
forall (uni :: * -&gt; *) fun ann cost.
ThrowableBuiltins uni fun =&gt;
MachineParameters
  (CekMachineCostsBase Identity) fun (CekValue uni fun ann)
-&gt; ExBudgetMode cost uni fun
-&gt; EmitterMode uni fun
-&gt; NTerm uni fun ann
-&gt; (Either
      (CekEvaluationException NamedDeBruijn uni fun) (NTerm uni fun ()),
    cost, LogOutput)
</span><span class="hs-identifier hs-var">UPLC.runCekDeBruijn</span></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MajorProtocolVersion
-&gt; EvaluationContext -&gt; DefaultMachineParameters
</span><a href="PlutusLedgerApi.Common.Eval.html#toMachineParameters"><span class="hs-identifier hs-var">toMachineParameters</span></a></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435280"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621680435282"><span class="hs-identifier hs-var">ectx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">ExBudgetMode cost DefaultUni DefaultFun
</span><a href="#local-6989586621680435279"><span class="hs-identifier hs-var">budgetMode</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621680435281"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode -&gt; VerboseMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="PlutusLedgerApi.Common.Eval.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EmitterMode DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. EmitterMode uni fun
</span><span class="hs-identifier hs-var">UPLC.logEmitter</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EmitterMode DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. EmitterMode uni fun
</span><span class="hs-identifier hs-var">UPLC.noEmitter</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- Just replicating the old behavior, probably doesn't matter.</span><span>
</span><span id="line-161"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateTerm"><span class="hs-pragma hs-type">evaluateTerm</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><span class="hs-comment">{-| Evaluates a script, with a cost model and a budget that restricts how many
resources it can use according to the cost model. Also returns the budget that
was actually used.

Can be used to calculate budgets for scripts, but even in this case you must give
a limit to guard against scripts that run for a long time or loop.

Note: Parameterized over the 'LedgerPlutusVersion' since
1. The builtins allowed (during decoding) differ, and
2. The Plutus language versions allowed differ.
-}</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateScriptRestricting"><span class="hs-identifier hs-type">evaluateScriptRestricting</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Versions.html#PlutusLedgerLanguage"><span class="hs-identifier hs-type">PlutusLedgerLanguage</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The Plutus ledger language of the script under execution.</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.ProtocolVersions.html#MajorProtocolVersion"><span class="hs-identifier hs-type">MajorProtocolVersion</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Which major protocol version to run the operation in</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#VerboseMode"><span class="hs-identifier hs-type">VerboseMode</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Whether to produce log output</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Includes the cost model to use for tallying up the execution costs</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExBudget</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ The resource budget which must not be exceeded during evaluation</span></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#ScriptForEvaluation"><span class="hs-identifier hs-type">ScriptForEvaluation</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The script to evaluate</span></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Plutus.Data</span></span><span class="hs-special">]</span><span>        </span><span class="annot"><span class="hs-comment">-- ^ The arguments to the script</span></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExBudget</span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span id="evaluateScriptRestricting"><span class="annot"><span class="annottext">evaluateScriptRestricting :: PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; ExBudget
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; (LogOutput, Either EvaluationError ExBudget)
</span><a href="PlutusLedgerApi.Common.Eval.html#evaluateScriptRestricting"><span class="hs-identifier hs-var hs-var">evaluateScriptRestricting</span></a></span></span><span> </span><span id="local-6989586621680435286"><span class="annot"><span class="annottext">PlutusLedgerLanguage
</span><a href="#local-6989586621680435286"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span id="local-6989586621680435287"><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435287"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621680435288"><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621680435288"><span class="hs-identifier hs-var">verbose</span></a></span></span><span> </span><span id="local-6989586621680435289"><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621680435289"><span class="hs-identifier hs-var">ectx</span></a></span></span><span> </span><span id="local-6989586621680435290"><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435290"><span class="hs-identifier hs-var">budget</span></a></span></span><span> </span><span id="local-6989586621680435291"><span class="annot"><span class="annottext">ScriptForEvaluation
</span><a href="#local-6989586621680435291"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680435292"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621680435292"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a, b) -&gt; (b, a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">((Either EvaluationError ExBudget, LogOutput)
 -&gt; (LogOutput, Either EvaluationError ExBudget))
-&gt; (Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; (a, w)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Writer.Lazy.html#runWriter"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer LogOutput (Either EvaluationError ExBudget)
 -&gt; (Either EvaluationError ExBudget, LogOutput))
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
-&gt; (Either EvaluationError ExBudget, LogOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
 -&gt; Writer LogOutput (Either EvaluationError ExBudget))
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621680435294"><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435294"><span class="hs-identifier hs-var">appliedTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; ExceptT
     EvaluationError
     (WriterT LogOutput Identity)
     (Term NamedDeBruijn DefaultUni DefaultFun ())
forall (m :: * -&gt; *).
MonadError EvaluationError m =&gt;
PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="PlutusLedgerApi.Common.Eval.html#mkTermToEvaluate"><span class="hs-identifier hs-var">mkTermToEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusLedgerLanguage
</span><a href="#local-6989586621680435286"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435287"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptForEvaluation
</span><a href="#local-6989586621680435291"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621680435292"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680435346"><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621680435346"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.RestrictingSt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExRestrictingBudget</span></span><span> </span><span id="local-6989586621680435349"><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435349"><span class="hs-identifier hs-var">final</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680435350"><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621680435350"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>            </span><span class="annot"><span class="annottext">ExBudgetMode RestrictingSt DefaultUni DefaultFun
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    RestrictingSt, LogOutput)
forall cost.
ExBudgetMode cost DefaultUni DefaultFun
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    cost, LogOutput)
</span><a href="PlutusLedgerApi.Common.Eval.html#evaluateTerm"><span class="hs-identifier hs-var">evaluateTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExRestrictingBudget
-&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun.
ThrowableBuiltins uni fun =&gt;
ExRestrictingBudget -&gt; ExBudgetMode RestrictingSt uni fun
</span><span class="hs-identifier hs-var">UPLC.restricting</span></span><span> </span><span class="annot"><span class="annottext">(ExRestrictingBudget
 -&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun)
-&gt; ExRestrictingBudget
-&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget -&gt; ExRestrictingBudget
</span><span class="hs-identifier hs-var">ExRestrictingBudget</span></span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435290"><span class="hs-identifier hs-var">budget</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435287"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621680435288"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621680435289"><span class="hs-identifier hs-var">ectx</span></a></span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435294"><span class="hs-identifier hs-var">appliedTerm</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">LogOutput
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Writer.Class.html#tell"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621680435350"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#liftEither"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ()
 -&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ())
-&gt; Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
 -&gt; EvaluationError)
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Bifunctor.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; EvaluationError
</span><a href="PlutusLedgerApi.Common.Eval.html#CekError"><span class="hs-identifier hs-var">CekError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
 -&gt; Either EvaluationError ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621680435346"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">ExBudget
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
forall a.
a -&gt; ExceptT EvaluationError (WriterT LogOutput Identity) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435290"><span class="hs-identifier hs-var">budget</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget -&gt; ExBudget -&gt; ExBudget
</span><span class="hs-operator hs-var">`minusExBudget`</span></span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435349"><span class="hs-identifier hs-var">final</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><span class="hs-comment">{-| Evaluates a script, returning the minimum budget that the script would need
to evaluate successfully. This will take as long as the script takes, if you need to
limit the execution time of the script also, you can use 'evaluateScriptRestricting', which
also returns the used budget.

Note: Parameterized over the ledger-plutus-version since the builtins allowed (during decoding) differs.
-}</span></span><span>
</span><span id="line-198"></span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#evaluateScriptCounting"><span class="hs-identifier hs-type">evaluateScriptCounting</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Versions.html#PlutusLedgerLanguage"><span class="hs-identifier hs-type">PlutusLedgerLanguage</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The Plutus ledger language of the script under execution.</span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.ProtocolVersions.html#MajorProtocolVersion"><span class="hs-identifier hs-type">MajorProtocolVersion</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Which major protocol version to run the operation in</span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#VerboseMode"><span class="hs-identifier hs-type">VerboseMode</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Whether to produce log output</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Includes the cost model to use for tallying up the execution costs</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.SerialisedScript.html#ScriptForEvaluation"><span class="hs-identifier hs-type">ScriptForEvaluation</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The script to evaluate</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Plutus.Data</span></span><span class="hs-special">]</span><span>        </span><span class="annot"><span class="hs-comment">-- ^ The arguments to the script</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExBudget</span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span id="evaluateScriptCounting"><span class="annot"><span class="annottext">evaluateScriptCounting :: PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; (LogOutput, Either EvaluationError ExBudget)
</span><a href="PlutusLedgerApi.Common.Eval.html#evaluateScriptCounting"><span class="hs-identifier hs-var hs-var">evaluateScriptCounting</span></a></span></span><span> </span><span id="local-6989586621680435354"><span class="annot"><span class="annottext">PlutusLedgerLanguage
</span><a href="#local-6989586621680435354"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span id="local-6989586621680435355"><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435355"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621680435356"><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621680435356"><span class="hs-identifier hs-var">verbose</span></a></span></span><span> </span><span id="local-6989586621680435357"><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621680435357"><span class="hs-identifier hs-var">ectx</span></a></span></span><span> </span><span id="local-6989586621680435358"><span class="annot"><span class="annottext">ScriptForEvaluation
</span><a href="#local-6989586621680435358"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680435359"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621680435359"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a, b) -&gt; (b, a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">((Either EvaluationError ExBudget, LogOutput)
 -&gt; (LogOutput, Either EvaluationError ExBudget))
-&gt; (Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; (a, w)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Writer.Lazy.html#runWriter"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="PlutusLedgerApi.Common.Eval.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer LogOutput (Either EvaluationError ExBudget)
 -&gt; (Either EvaluationError ExBudget, LogOutput))
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
-&gt; (Either EvaluationError ExBudget, LogOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
 -&gt; Writer LogOutput (Either EvaluationError ExBudget))
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621680435360"><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435360"><span class="hs-identifier hs-var">appliedTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; ExceptT
     EvaluationError
     (WriterT LogOutput Identity)
     (Term NamedDeBruijn DefaultUni DefaultFun ())
forall (m :: * -&gt; *).
MonadError EvaluationError m =&gt;
PlutusLedgerLanguage
-&gt; MajorProtocolVersion
-&gt; ScriptForEvaluation
-&gt; [Data]
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="PlutusLedgerApi.Common.Eval.html#mkTermToEvaluate"><span class="hs-identifier hs-var">mkTermToEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusLedgerLanguage
</span><a href="#local-6989586621680435354"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435355"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptForEvaluation
</span><a href="#local-6989586621680435358"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621680435359"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680435361"><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621680435361"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UPLC.CountingSt</span></span><span> </span><span id="local-6989586621680435363"><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435363"><span class="hs-identifier hs-var">final</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680435364"><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621680435364"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><span class="annottext">ExBudgetMode CountingSt DefaultUni DefaultFun
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    CountingSt, LogOutput)
forall cost.
ExBudgetMode cost DefaultUni DefaultFun
-&gt; MajorProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    cost, LogOutput)
</span><a href="PlutusLedgerApi.Common.Eval.html#evaluateTerm"><span class="hs-identifier hs-var">evaluateTerm</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudgetMode CountingSt DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. ExBudgetMode CountingSt uni fun
</span><span class="hs-identifier hs-var">UPLC.counting</span></span><span> </span><span class="annot"><span class="annottext">MajorProtocolVersion
</span><a href="#local-6989586621680435355"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621680435356"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621680435357"><span class="hs-identifier hs-var">ectx</span></a></span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621680435360"><span class="hs-identifier hs-var">appliedTerm</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">LogOutput
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Writer.Class.html#tell"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621680435364"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#liftEither"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ()
 -&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ())
-&gt; Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
 -&gt; EvaluationError)
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Bifunctor.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; EvaluationError
</span><a href="PlutusLedgerApi.Common.Eval.html#CekError"><span class="hs-identifier hs-var">CekError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
 -&gt; Either EvaluationError ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621680435361"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">ExBudget
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
forall a.
a -&gt; ExceptT EvaluationError (WriterT LogOutput Identity) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621680435363"><span class="hs-identifier hs-var">final</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">{- Note [Checking the Plutus Core language version]
Since long ago this check has been in `mkTermToEvaluate`, which makes it a phase 2 failure.
But this is really far too strict: we can check when deserializing, so it can be a phase 1
failure, like the other such checks that we have. For now we keep it as it is, but we may
try to move it later.
-}</span><span>
</span><span id="line-220"></span></pre></body></html>