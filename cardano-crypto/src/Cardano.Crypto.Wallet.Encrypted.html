<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Crypto.Wallet.Encrypted</span><span>
</span><span id="line-2"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier">EncryptedKey</span></a></span><span>
</span><span id="line-3"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKey"><span class="hs-identifier">encryptedKey</span></a></span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#unEncryptedKey"><span class="hs-identifier">unEncryptedKey</span></a></span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier">Signature</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Methods</span></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreate"><span class="hs-identifier">encryptedCreate</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreateDirectWithTweak"><span class="hs-identifier">encryptedCreateDirectWithTweak</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChangePass"><span class="hs-identifier">encryptedChangePass</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedSign"><span class="hs-identifier">encryptedSign</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedPublic"><span class="hs-identifier">encryptedPublic</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChainCode"><span class="hs-identifier">encryptedChainCode</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePrivate"><span class="hs-identifier">encryptedDerivePrivate</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePublic"><span class="hs-identifier">encryptedDerivePublic</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Error</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withByteArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier">DerivationScheme</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier">DerivationIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-type">totalKeySize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-31"></span><span id="totalKeySize"><span class="annot"><span class="annottext">totalKeySize :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-var hs-var">totalKeySize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKeySize"><span class="hs-identifier hs-var">encryptedKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#ccSize"><span class="hs-identifier hs-var">ccSize</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">--totalPublicKeySize :: Int</span><span>
</span><span id="line-34"></span><span class="hs-comment">--totalPublicKeySize = publicKeySize + ccSize</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKeySize"><span class="hs-identifier hs-type">encryptedKeySize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-37"></span><span id="encryptedKeySize"><span class="annot"><span class="annottext">encryptedKeySize :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKeySize"><span class="hs-identifier hs-var hs-var">encryptedKeySize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeySize"><span class="hs-identifier hs-type">publicKeySize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-40"></span><span id="publicKeySize"><span class="annot"><span class="annottext">publicKeySize :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeySize"><span class="hs-identifier hs-var hs-var">publicKeySize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ccSize"><span class="hs-identifier hs-type">ccSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-43"></span><span id="ccSize"><span class="annot"><span class="annottext">ccSize :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#ccSize"><span class="hs-identifier hs-var hs-var">ccSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#signatureSize"><span class="hs-identifier hs-type">signatureSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-46"></span><span id="signatureSize"><span class="annot"><span class="annottext">signatureSize :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#signatureSize"><span class="hs-identifier hs-var hs-var">signatureSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeyOffset"><span class="hs-identifier hs-type">publicKeyOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-49"></span><span id="publicKeyOffset"><span class="annot"><span class="annottext">publicKeyOffset :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeyOffset"><span class="hs-identifier hs-var hs-var">publicKeyOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKeySize"><span class="hs-identifier hs-var">encryptedKeySize</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ccOffset"><span class="hs-identifier hs-type">ccOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-52"></span><span id="ccOffset"><span class="annot"><span class="annottext">ccOffset :: Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#ccOffset"><span class="hs-identifier hs-var hs-var">ccOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeyOffset"><span class="hs-identifier hs-var">publicKeyOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">newtype</span><span> </span><span id="Signature"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091395"><span class="annot"><span class="annottext">Signature -&gt; ()
(Signature -&gt; ()) -&gt; NFData Signature
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: Signature -&gt; ()
rnf :: Signature -&gt; ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">newtype</span><span> </span><span id="EncryptedKey"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EncryptedKey"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091403"><span class="annot"><span class="annottext">EncryptedKey -&gt; ()
(EncryptedKey -&gt; ()) -&gt; NFData EncryptedKey
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: EncryptedKey -&gt; ()
rnf :: EncryptedKey -&gt; ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091408"><span id="local-6989586621679091412"><span id="local-6989586621679091416"><span class="annot"><span class="annottext">EncryptedKey -&gt; Int
(EncryptedKey -&gt; Int)
-&gt; (forall p a. EncryptedKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. EncryptedKey -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess EncryptedKey
forall p. EncryptedKey -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall p a. EncryptedKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$clength :: EncryptedKey -&gt; Int
length :: EncryptedKey -&gt; Int
$cwithByteArray :: forall p a. EncryptedKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
withByteArray :: forall p a. EncryptedKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$ccopyByteArrayToPtr :: forall p. EncryptedKey -&gt; Ptr p -&gt; IO ()
copyByteArrayToPtr :: forall p. EncryptedKey -&gt; Ptr p -&gt; IO ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">type</span><span> </span><span id="PublicKey"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="ChainCode"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="PassPhrase"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-var">PassPhrase</span></a></span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Create an encryped key from binary representation.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- If the binary is not of the right size, Nothing is returned</span><span>
</span><span id="line-68"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKey"><span class="hs-identifier hs-type">encryptedKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-69"></span><span id="encryptedKey"><span class="annot"><span class="annottext">encryptedKey :: PublicKey -&gt; Maybe EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKey"><span class="hs-identifier hs-var hs-var">encryptedKey</span></a></span></span><span> </span><span id="local-6989586621679091422"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">ba</span></a></span></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-var">totalKeySize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; Maybe EncryptedKey
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(EncryptedKey -&gt; Maybe EncryptedKey)
-&gt; EncryptedKey -&gt; Maybe EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe EncryptedKey
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#unEncryptedKey"><span class="hs-identifier hs-type">unEncryptedKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-74"></span><span id="unEncryptedKey"><span class="annot"><span class="annottext">unEncryptedKey :: EncryptedKey -&gt; PublicKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#unEncryptedKey"><span class="hs-identifier hs-var hs-var">unEncryptedKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span id="local-6989586621679091424"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Create a new encrypted key from the secret, encrypting the secret in memory</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- using the passphrase.</span><span>
</span><span id="line-78"></span><span id="local-6989586621679091293"><span id="local-6989586621679091294"><span id="local-6989586621679091295"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreate"><span class="hs-identifier hs-type">encryptedCreate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091293"><span class="hs-identifier hs-type">passphrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091294"><span class="hs-identifier hs-type">secret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091295"><span class="hs-identifier hs-type">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091294"><span class="hs-identifier hs-type">secret</span></a></span><span>
</span><span id="line-80"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091293"><span class="hs-identifier hs-type">passphrase</span></a></span><span>
</span><span id="line-81"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091295"><span class="hs-identifier hs-type">cc</span></a></span><span>
</span><span id="line-82"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailable</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span></span></span></span><span>
</span><span id="line-83"></span><span id="encryptedCreate"><span class="annot"><span class="annottext">encryptedCreate :: forall passphrase secret cc.
(ByteArrayAccess passphrase, ByteArrayAccess secret,
 ByteArrayAccess cc) =&gt;
secret -&gt; passphrase -&gt; cc -&gt; CryptoFailable EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreate"><span class="hs-identifier hs-var hs-var">encryptedCreate</span></a></span></span><span> </span><span id="local-6989586621679091444"><span class="annot"><span class="annottext">secret
</span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621679091445"><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621679091446"><span class="annot"><span class="annottext">cc
</span><a href="#local-6989586621679091446"><span class="hs-identifier hs-var">cc</span></a></span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">secret -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">secret
</span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoFailable EncryptedKey
forall a. CryptoError -&gt; CryptoFailable a
</span><span class="hs-identifier hs-var">CryptoFailed</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier hs-var">CryptoError_SecretKeySizeInvalid</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (CryptoFailable EncryptedKey) -&gt; CryptoFailable EncryptedKey
forall a. IO a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (CryptoFailable EncryptedKey) -&gt; CryptoFailable EncryptedKey)
-&gt; IO (CryptoFailable EncryptedKey) -&gt; CryptoFailable EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679091451"><span class="annot"><span class="annottext">CDerivationScheme
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091452"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091452"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Ptr EncryptedKey -&gt; IO CDerivationScheme)
-&gt; IO (CDerivationScheme, PublicKey)
forall ba p a. ByteArray ba =&gt; Int -&gt; (Ptr p -&gt; IO a) -&gt; IO (a, ba)
forall p a. Int -&gt; (Ptr p -&gt; IO a) -&gt; IO (a, PublicKey)
</span><span class="hs-identifier hs-var">B.allocRet</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-var">totalKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO CDerivationScheme)
 -&gt; IO (CDerivationScheme, PublicKey))
-&gt; (Ptr EncryptedKey -&gt; IO CDerivationScheme)
-&gt; IO (CDerivationScheme, PublicKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091454"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091454"><span class="hs-identifier hs-var">ekey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><span class="annottext">secret
-&gt; (Ptr Word8 -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. secret -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">secret
</span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">sec</span></a></span><span>  </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme)
-&gt; (Ptr Word8 -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091455"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">psec</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>            </span><span class="annot"><span class="annottext">passphrase
-&gt; (Ptr PassPhrase -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. passphrase -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr PassPhrase -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme)
-&gt; (Ptr PassPhrase -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091456"><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091456"><span class="hs-identifier hs-var">ppass</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>            </span><span class="annot"><span class="annottext">cc -&gt; (Ptr Word8 -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. cc -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">cc
</span><a href="#local-6989586621679091446"><span class="hs-identifier hs-var">cc</span></a></span><span>   </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme)
-&gt; (Ptr Word8 -&gt; IO CDerivationScheme) -&gt; IO CDerivationScheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091457"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">pcc</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>                </span><span class="annot"><span class="annottext">Ptr PassPhrase
-&gt; DerivationIndex
-&gt; Ptr Word8
-&gt; Ptr Word8
-&gt; Ptr EncryptedKey
-&gt; IO CDerivationScheme
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_from_secret"><span class="hs-identifier hs-var">wallet_encrypted_from_secret</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091456"><span class="hs-identifier hs-var">ppass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">passphrase -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">psec</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">pcc</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091454"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CDerivationScheme
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CDerivationScheme -&gt; CDerivationScheme -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CDerivationScheme
</span><span class="hs-number">0</span></span><span>
</span><span id="line-92"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CryptoFailable EncryptedKey -&gt; IO (CryptoFailable EncryptedKey)
forall a. a -&gt; IO a
forall (m :: Type -&gt; Type) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable EncryptedKey -&gt; IO (CryptoFailable EncryptedKey))
-&gt; CryptoFailable EncryptedKey -&gt; IO (CryptoFailable EncryptedKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; CryptoFailable EncryptedKey
forall a. a -&gt; CryptoFailable a
</span><span class="hs-identifier hs-var">CryptoPassed</span></span><span> </span><span class="annot"><span class="annottext">(EncryptedKey -&gt; CryptoFailable EncryptedKey)
-&gt; EncryptedKey -&gt; CryptoFailable EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091452"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-93"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CryptoFailable EncryptedKey -&gt; IO (CryptoFailable EncryptedKey)
forall a. a -&gt; IO a
forall (m :: Type -&gt; Type) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable EncryptedKey -&gt; IO (CryptoFailable EncryptedKey))
-&gt; CryptoFailable EncryptedKey -&gt; IO (CryptoFailable EncryptedKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoFailable EncryptedKey
forall a. CryptoError -&gt; CryptoFailable a
</span><span class="hs-identifier hs-var">CryptoFailed</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Create a new encrypted key using the output of the masterKeyGeneration directly (96 bytes)</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- using the encryption passphrase.</span><span>
</span><span id="line-97"></span><span id="local-6989586621679091311"><span id="local-6989586621679091312"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreateDirectWithTweak"><span class="hs-identifier hs-type">encryptedCreateDirectWithTweak</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091311"><span class="hs-identifier hs-type">passphrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091312"><span class="hs-identifier hs-type">secret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>                               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091312"><span class="hs-identifier hs-type">secret</span></a></span><span>
</span><span id="line-99"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091311"><span class="hs-identifier hs-type">passphrase</span></a></span><span>
</span><span id="line-100"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span></span></span><span>
</span><span id="line-101"></span><span id="encryptedCreateDirectWithTweak"><span class="annot"><span class="annottext">encryptedCreateDirectWithTweak :: forall passphrase secret.
(ByteArrayAccess passphrase, ByteArrayAccess secret) =&gt;
secret -&gt; passphrase -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreateDirectWithTweak"><span class="hs-identifier hs-var hs-var">encryptedCreateDirectWithTweak</span></a></span></span><span> </span><span id="local-6989586621679091469"><span class="annot"><span class="annottext">secret
</span><a href="#local-6989586621679091469"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621679091470"><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091470"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">PublicKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; EncryptedKey) -&gt; PublicKey -&gt; EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey
forall a p. ByteArray a =&gt; Int -&gt; (Ptr p -&gt; IO ()) -&gt; a
</span><span class="hs-identifier hs-var">B.allocAndFreeze</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-var">totalKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey)
-&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091472"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091472"><span class="hs-identifier hs-var">ekey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">secret -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. secret -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">secret
</span><a href="#local-6989586621679091469"><span class="hs-identifier hs-var">sec</span></a></span><span>  </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091473"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091473"><span class="hs-identifier hs-var">psec</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">passphrase -&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. passphrase -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091470"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr PassPhrase -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091474"><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091474"><span class="hs-identifier hs-var">ppass</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">Ptr PassPhrase
-&gt; DerivationIndex -&gt; Ptr Word8 -&gt; Ptr EncryptedKey -&gt; IO ()
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_new_from_mkg"><span class="hs-identifier hs-var">wallet_encrypted_new_from_mkg</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091474"><span class="hs-identifier hs-var">ppass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">passphrase -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091470"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091473"><span class="hs-identifier hs-var">psec</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091472"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">-- | Create a new encrypted key that uses a different passphrase</span></span><span>
</span><span id="line-108"></span><span id="local-6989586621679091317"><span id="local-6989586621679091318"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChangePass"><span class="hs-identifier hs-type">encryptedChangePass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091317"><span class="hs-identifier hs-type">oldPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091318"><span class="hs-identifier hs-type">newPassPhrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091317"><span class="hs-identifier hs-type">oldPassPhrase</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ passphrase to decrypt the current encrypted key</span></span><span>
</span><span id="line-110"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091318"><span class="hs-identifier hs-type">newPassPhrase</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ new passphrase to use for the new encrypted key</span></span><span>
</span><span id="line-111"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Key using the old pass phrase</span></span><span>
</span><span id="line-112"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Key using the new pass phrase</span></span><span>
</span><span id="line-113"></span><span id="encryptedChangePass"><span class="annot"><span class="annottext">encryptedChangePass :: forall oldPassPhrase newPassPhrase.
(ByteArrayAccess oldPassPhrase, ByteArrayAccess newPassPhrase) =&gt;
oldPassPhrase -&gt; newPassPhrase -&gt; EncryptedKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChangePass"><span class="hs-identifier hs-var hs-var">encryptedChangePass</span></a></span></span><span> </span><span id="local-6989586621679091488"><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679091488"><span class="hs-identifier hs-var">oldPass</span></a></span></span><span> </span><span id="local-6989586621679091489"><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679091489"><span class="hs-identifier hs-var">newPass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span id="local-6989586621679091490"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091490"><span class="hs-identifier hs-var">okey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">PublicKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; EncryptedKey) -&gt; PublicKey -&gt; EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey
forall a p. ByteArray a =&gt; Int -&gt; (Ptr p -&gt; IO ()) -&gt; a
</span><span class="hs-identifier hs-var">B.allocAndFreeze</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-var">totalKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey)
-&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091491"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091491"><span class="hs-identifier hs-var">ekey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">oldPassPhrase -&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. oldPassPhrase -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679091488"><span class="hs-identifier hs-var">oldPass</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr PassPhrase -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091492"><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091492"><span class="hs-identifier hs-var">opass</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><span class="annottext">newPassPhrase -&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. newPassPhrase -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679091489"><span class="hs-identifier hs-var">newPass</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr PassPhrase -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091493"><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091493"><span class="hs-identifier hs-var">npass</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="annottext">PublicKey -&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. PublicKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091490"><span class="hs-identifier hs-var">okey</span></a></span><span>    </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091494"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091494"><span class="hs-identifier hs-var">oldkey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">Ptr EncryptedKey
-&gt; Ptr PassPhrase
-&gt; DerivationIndex
-&gt; Ptr PassPhrase
-&gt; DerivationIndex
-&gt; Ptr EncryptedKey
-&gt; IO ()
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_change_pass"><span class="hs-identifier hs-var">wallet_encrypted_change_pass</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091494"><span class="hs-identifier hs-var">oldkey</span></a></span><span>
</span><span id="line-119"></span><span>                         </span><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091492"><span class="hs-identifier hs-var">opass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">oldPassPhrase -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679091488"><span class="hs-identifier hs-var">oldPass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                         </span><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091493"><span class="hs-identifier hs-var">npass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">newPassPhrase -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679091489"><span class="hs-identifier hs-var">newPass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                         </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091491"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | Sign using the encrypted keys and temporarly decrypt the secret in memory</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- with a minimal memory footprint.</span><span>
</span><span id="line-125"></span><span id="local-6989586621679091321"><span id="local-6989586621679091322"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedSign"><span class="hs-identifier hs-type">encryptedSign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091321"><span class="hs-identifier hs-type">passphrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091322"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-127"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091321"><span class="hs-identifier hs-type">passphrase</span></a></span><span>
</span><span id="line-128"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091322"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-129"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span></span></span><span>
</span><span id="line-130"></span><span id="encryptedSign"><span class="annot"><span class="annottext">encryptedSign :: forall passphrase msg.
(ByteArrayAccess passphrase, ByteArrayAccess msg) =&gt;
EncryptedKey -&gt; passphrase -&gt; msg -&gt; Signature
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedSign"><span class="hs-identifier hs-var hs-var">encryptedSign</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span id="local-6989586621679091508"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091508"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091509"><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091509"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621679091510"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679091510"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">PublicKey -&gt; Signature
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature) -&gt; PublicKey -&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Ptr Signature -&gt; IO ()) -&gt; PublicKey
forall a p. ByteArray a =&gt; Int -&gt; (Ptr p -&gt; IO ()) -&gt; a
</span><span class="hs-identifier hs-var">B.allocAndFreeze</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Signature -&gt; IO ()) -&gt; PublicKey)
-&gt; (Ptr Signature -&gt; IO ()) -&gt; PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091511"><span class="annot"><span class="annottext">Ptr Signature
</span><a href="#local-6989586621679091511"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">PublicKey -&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. PublicKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091508"><span class="hs-identifier hs-var">ekey</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091512"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091512"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">passphrase -&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. passphrase -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091509"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr PassPhrase -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091513"><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091513"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">msg -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. msg -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679091510"><span class="hs-identifier hs-var">msg</span></a></span><span>  </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091514"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091514"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">Ptr EncryptedKey
-&gt; Ptr PassPhrase
-&gt; DerivationIndex
-&gt; Ptr Word8
-&gt; DerivationIndex
-&gt; Ptr Signature
-&gt; IO ()
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_sign"><span class="hs-identifier hs-var">wallet_encrypted_sign</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091512"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091513"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">passphrase -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091509"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679091514"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">msg -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679091510"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr Signature
</span><a href="#local-6989586621679091511"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679091325"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePrivate"><span class="hs-identifier hs-type">encryptedDerivePrivate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679091325"><span class="hs-identifier hs-type">passphrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span>
</span><span id="line-139"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-140"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091325"><span class="hs-identifier hs-type">passphrase</span></a></span><span>
</span><span id="line-141"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span>
</span><span id="line-142"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span></span><span>
</span><span id="line-143"></span><span id="encryptedDerivePrivate"><span class="annot"><span class="annottext">encryptedDerivePrivate :: forall passphrase.
ByteArrayAccess passphrase =&gt;
DerivationScheme
-&gt; EncryptedKey -&gt; passphrase -&gt; DerivationIndex -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePrivate"><span class="hs-identifier hs-var hs-var">encryptedDerivePrivate</span></a></span></span><span> </span><span id="local-6989586621679091523"><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679091523"><span class="hs-identifier hs-var">dscheme</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span id="local-6989586621679091524"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091524"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091525"><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091525"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621679091526"><span class="annot"><span class="annottext">DerivationIndex
</span><a href="#local-6989586621679091526"><span class="hs-identifier hs-var">childIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">PublicKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; EncryptedKey) -&gt; PublicKey -&gt; EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey
forall a p. ByteArray a =&gt; Int -&gt; (Ptr p -&gt; IO ()) -&gt; a
</span><span class="hs-identifier hs-var">B.allocAndFreeze</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#totalKeySize"><span class="hs-identifier hs-var">totalKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey)
-&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091527"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091527"><span class="hs-identifier hs-var">ekey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">passphrase -&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. passphrase -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091525"><span class="hs-identifier hs-var">pass</span></a></span><span>   </span><span class="annot"><span class="annottext">((Ptr PassPhrase -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PassPhrase -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091528"><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091528"><span class="hs-identifier hs-var">ppass</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">PublicKey -&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. PublicKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091524"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr EncryptedKey -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr EncryptedKey -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091529"><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091529"><span class="hs-identifier hs-var">pparent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>            </span><span class="annot"><span class="annottext">Ptr EncryptedKey
-&gt; Ptr PassPhrase
-&gt; DerivationIndex
-&gt; DerivationIndex
-&gt; Ptr EncryptedKey
-&gt; CDerivationScheme
-&gt; IO ()
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_derive_private"><span class="hs-identifier hs-var">wallet_encrypted_derive_private</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091529"><span class="hs-identifier hs-var">pparent</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PassPhrase
</span><a href="#local-6989586621679091528"><span class="hs-identifier hs-var">ppass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DerivationIndex
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DerivationIndex) -&gt; Int -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">passphrase -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">passphrase
</span><a href="#local-6989586621679091525"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivationIndex
</span><a href="#local-6989586621679091526"><span class="hs-identifier hs-var">childIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr EncryptedKey
</span><a href="#local-6989586621679091527"><span class="hs-identifier hs-var">ekey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationScheme -&gt; CDerivationScheme
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#dschemeToC"><span class="hs-identifier hs-var">dschemeToC</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679091523"><span class="hs-identifier hs-var">dscheme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePublic"><span class="hs-identifier hs-type">encryptedDerivePublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span>
</span><span id="line-150"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span>
</span><span id="line-152"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span id="encryptedDerivePublic"><span class="annot"><span class="annottext">encryptedDerivePublic :: DerivationScheme
-&gt; (PublicKey, PublicKey)
-&gt; DerivationIndex
-&gt; (PublicKey, PublicKey)
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePublic"><span class="hs-identifier hs-var hs-var">encryptedDerivePublic</span></a></span></span><span> </span><span id="local-6989586621679091532"><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679091532"><span class="hs-identifier hs-var">dscheme</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091533"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091533"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091534"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091534"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091535"><span class="annot"><span class="annottext">DerivationIndex
</span><a href="#local-6989586621679091535"><span class="hs-identifier hs-var">childIndex</span></a></span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DerivationIndex
</span><a href="#local-6989586621679091535"><span class="hs-identifier hs-var">childIndex</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex -&gt; DerivationIndex -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex
</span><span class="hs-number">0x80000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (PublicKey, PublicKey)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cannot derive hardened in derive public&quot;</span></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (PublicKey, PublicKey) -&gt; (PublicKey, PublicKey)
forall a. IO a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (PublicKey, PublicKey) -&gt; (PublicKey, PublicKey))
-&gt; IO (PublicKey, PublicKey) -&gt; (PublicKey, PublicKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679091537"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091537"><span class="hs-identifier hs-var">newCC</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091538"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091538"><span class="hs-identifier hs-var">newPub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-157"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; (Ptr PublicKey -&gt; IO PublicKey) -&gt; IO (PublicKey, PublicKey)
forall ba p a. ByteArray ba =&gt; Int -&gt; (Ptr p -&gt; IO a) -&gt; IO (a, ba)
forall p a. Int -&gt; (Ptr p -&gt; IO a) -&gt; IO (a, PublicKey)
</span><span class="hs-identifier hs-var">B.allocRet</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr PublicKey -&gt; IO PublicKey) -&gt; IO (PublicKey, PublicKey))
-&gt; (Ptr PublicKey -&gt; IO PublicKey) -&gt; IO (PublicKey, PublicKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091539"><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091539"><span class="hs-identifier hs-var">outPub</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; (Ptr PublicKey -&gt; IO ()) -&gt; IO PublicKey
forall ba p. ByteArray ba =&gt; Int -&gt; (Ptr p -&gt; IO ()) -&gt; IO ba
</span><span class="hs-identifier hs-var">B.alloc</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#ccSize"><span class="hs-identifier hs-var">ccSize</span></a></span><span>           </span><span class="annot"><span class="annottext">((Ptr PublicKey -&gt; IO ()) -&gt; IO PublicKey)
-&gt; (Ptr PublicKey -&gt; IO ()) -&gt; IO PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091541"><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091541"><span class="hs-identifier hs-var">outCc</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>                </span><span class="annot"><span class="annottext">PublicKey -&gt; (Ptr PublicKey -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. PublicKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091533"><span class="hs-identifier hs-var">pub</span></a></span><span>        </span><span class="annot"><span class="annottext">((Ptr PublicKey -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PublicKey -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091542"><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091542"><span class="hs-identifier hs-var">ppub</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>                </span><span class="annot"><span class="annottext">PublicKey -&gt; (Ptr PublicKey -&gt; IO ()) -&gt; IO ()
forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall p a. PublicKey -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withByteArray</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091534"><span class="hs-identifier hs-var">cc</span></a></span><span>         </span><span class="annot"><span class="annottext">((Ptr PublicKey -&gt; IO ()) -&gt; IO ())
-&gt; (Ptr PublicKey -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091543"><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091543"><span class="hs-identifier hs-var">pcc</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>                    </span><span id="local-6989586621679091544"><span class="annot"><span class="annottext">CDerivationScheme
</span><a href="#local-6989586621679091544"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr PublicKey
-&gt; Ptr PublicKey
-&gt; DerivationIndex
-&gt; Ptr PublicKey
-&gt; Ptr PublicKey
-&gt; CDerivationScheme
-&gt; IO CDerivationScheme
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_derive_public"><span class="hs-identifier hs-var">wallet_encrypted_derive_public</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091542"><span class="hs-identifier hs-var">ppub</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091543"><span class="hs-identifier hs-var">pcc</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex
</span><a href="#local-6989586621679091535"><span class="hs-identifier hs-var">childIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091539"><span class="hs-identifier hs-var">outPub</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr PublicKey
</span><a href="#local-6989586621679091541"><span class="hs-identifier hs-var">outCc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationScheme -&gt; CDerivationScheme
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#dschemeToC"><span class="hs-identifier hs-var">dschemeToC</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679091532"><span class="hs-identifier hs-var">dscheme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CDerivationScheme
</span><a href="#local-6989586621679091544"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CDerivationScheme -&gt; CDerivationScheme -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">CDerivationScheme
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;encrypted derive public assumption about index failed&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: Type -&gt; Type) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">(PublicKey, PublicKey) -&gt; IO (PublicKey, PublicKey)
forall a. a -&gt; IO a
forall (m :: Type -&gt; Type) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091538"><span class="hs-identifier hs-var">newPub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091537"><span class="hs-identifier hs-var">newCC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><span class="hs-comment">-- | Get the public part of an encrypted key</span></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedPublic"><span class="hs-identifier hs-type">encryptedPublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-167"></span><span id="encryptedPublic"><span class="annot"><span class="annottext">encryptedPublic :: EncryptedKey -&gt; PublicKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedPublic"><span class="hs-identifier hs-var hs-var">encryptedPublic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span id="local-6989586621679091546"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091546"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; PublicKey -&gt; PublicKey
forall c. ByteArray c =&gt; Int -&gt; Int -&gt; c -&gt; c
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#sub"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeyOffset"><span class="hs-identifier hs-var">publicKeyOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091546"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | Get the chain code part of an encrypted key</span></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChainCode"><span class="hs-identifier hs-type">encryptedChainCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-171"></span><span id="encryptedChainCode"><span class="annot"><span class="annottext">encryptedChainCode :: EncryptedKey -&gt; PublicKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChainCode"><span class="hs-identifier hs-var hs-var">encryptedChainCode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span> </span><span id="local-6989586621679091548"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091548"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; PublicKey -&gt; PublicKey
forall c. ByteArray c =&gt; Int -&gt; Int -&gt; c -&gt; c
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#sub"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#ccOffset"><span class="hs-identifier hs-var">ccOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#ccSize"><span class="hs-identifier hs-var">ccSize</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679091548"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span id="local-6989586621679091333"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#sub"><span class="hs-identifier hs-type">sub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679091333"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091333"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091333"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-174"></span><span id="sub"><span class="annot"><span class="annottext">sub :: forall c. ByteArray c =&gt; Int -&gt; Int -&gt; c -&gt; c
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#sub"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679091552"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679091552"><span class="hs-identifier hs-var">ofs</span></a></span></span><span> </span><span id="local-6989586621679091553"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679091553"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; c -&gt; c
forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; bs
</span><span class="hs-identifier hs-var">B.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679091553"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; c) -&gt; (c -&gt; c) -&gt; c -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; c -&gt; c
forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; bs
</span><span class="hs-identifier hs-var">B.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679091552"><span class="hs-identifier hs-var">ofs</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- map to the C enum : derivation_scheme_mode</span><span>
</span><span id="line-177"></span><span class="hs-keyword">type</span><span> </span><span id="CDerivationScheme"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#CDerivationScheme"><span class="hs-identifier hs-var">CDerivationScheme</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#dschemeToC"><span class="hs-identifier hs-type">dschemeToC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#CDerivationScheme"><span class="hs-identifier hs-type">CDerivationScheme</span></a></span><span>
</span><span id="line-180"></span><span id="dschemeToC"><span class="annot"><span class="annottext">dschemeToC :: DerivationScheme -&gt; CDerivationScheme
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#dschemeToC"><span class="hs-identifier hs-var hs-var">dschemeToC</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme1"><span class="hs-identifier hs-var">DerivationScheme1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CDerivationScheme
</span><span class="hs-number">1</span></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#dschemeToC"><span class="hs-identifier hs-var">dschemeToC</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme2"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CDerivationScheme
</span><span class="hs-number">2</span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- return 0 if success, otherwise 1 if structure of seed not proper</span><span>
</span><span id="line-184"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wallet_encrypted_from_secret&quot;</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="wallet_encrypted_from_secret"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_from_secret"><span class="hs-identifier hs-var">wallet_encrypted_from_secret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-type">PassPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-186"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-comment">-- 32 bytes &quot;seed secret key&quot; (non extended)</span><span>
</span><span id="line-187"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-comment">-- 32 bytes ChainCode</span><span>
</span><span id="line-188"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-189"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wallet_encrypted_new_from_mkg&quot;</span></span><span>
</span><span id="line-192"></span><span>    </span><span id="wallet_encrypted_new_from_mkg"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_new_from_mkg"><span class="hs-identifier hs-var">wallet_encrypted_new_from_mkg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-type">PassPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-193"></span><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-comment">-- 96 bytes master key generation</span><span>
</span><span id="line-194"></span><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-195"></span><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wallet_encrypted_sign&quot;</span></span><span>
</span><span id="line-198"></span><span>    </span><span id="wallet_encrypted_sign"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_sign"><span class="hs-identifier hs-var">wallet_encrypted_sign</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-199"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-type">PassPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-200"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-201"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-202"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wallet_encrypted_derive_private&quot;</span></span><span>
</span><span id="line-205"></span><span>    </span><span id="wallet_encrypted_derive_private"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_derive_private"><span class="hs-identifier hs-var">wallet_encrypted_derive_private</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-206"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-type">PassPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-207"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span> </span><span class="hs-comment">-- index</span><span>
</span><span id="line-208"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-209"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#CDerivationScheme"><span class="hs-identifier hs-type">CDerivationScheme</span></a></span><span>
</span><span id="line-210"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wallet_encrypted_derive_public&quot;</span></span><span>
</span><span id="line-213"></span><span>    </span><span id="wallet_encrypted_derive_public"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_derive_public"><span class="hs-identifier hs-var">wallet_encrypted_derive_public</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span>
</span><span id="line-214"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span>
</span><span id="line-215"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span>
</span><span id="line-216"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span>
</span><span id="line-217"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span>
</span><span id="line-218"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#CDerivationScheme"><span class="hs-identifier hs-type">CDerivationScheme</span></a></span><span>
</span><span id="line-219"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;wallet_encrypted_change_pass&quot;</span></span><span>
</span><span id="line-222"></span><span>    </span><span id="wallet_encrypted_change_pass"><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#wallet_encrypted_change_pass"><span class="hs-identifier hs-var">wallet_encrypted_change_pass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-223"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-type">PassPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-224"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#PassPhrase"><span class="hs-identifier hs-type">PassPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-225"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-226"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span></pre></body></html>