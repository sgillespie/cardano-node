<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, FlexibleInstances, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- |
   Module      : Data.GraphViz.Types.Graph
   Description : A graph-like representation of Dot graphs.
   Copyright   : (c) Ivan Lazar Miljenovic
   License     : 3-Clause BSD-style
   Maintainer  : Ivan.Miljenovic@gmail.com

   It is sometimes useful to be able to manipulate a Dot graph /as/ an
   actual graph.  This representation lets you do so, using an
   inductive approach based upon that from FGL (note that 'DotGraph'
   is /not/ an instance of the FGL classes due to having the wrong
   kind).  Note, however, that the API is not as complete as proper
   graph implementations.

   For purposes of manipulation, all edges are found in the root graph
   and not in a cluster; as such, having 'EdgeAttrs' in a cluster's
   'GlobalAttributes' is redundant.

   Printing is achieved via &quot;Data.GraphViz.Types.Canonical&quot; (using
   'toCanonical') and parsing via &quot;Data.GraphViz.Types.Generalised&quot;
   (so /any/ piece of Dot code can be parsed in).

   This representation doesn't allow non-cluster sub-graphs.  Also, all
   clusters /must/ have a unique identifier.  For those functions (with
   the exception of 'DotRepr' methods) that take or return a \&quot;@Maybe
   GraphID@\&quot;, a value of \&quot;@Nothing@\&quot; refers to the root graph; \&quot;@Just
   clust@\&quot; refers to the cluster with the identifier \&quot;@clust@\&quot;.

   You would not typically explicitly create these values, instead
   converting existing Dot graphs (via 'fromDotRepr').  However, one
   way of constructing the sample graph would be:

   &gt; setID (Str &quot;G&quot;)
   &gt; . setStrictness False
   &gt; . setIsDirected True
   &gt; . setClusterAttributes (Int 0) [GraphAttrs [style filled, color LightGray, textLabel &quot;process #1&quot;], NodeAttrs [style filled, color White]]
   &gt; . setClusterAttributes (Int 1) [GraphAttrs [textLabel &quot;process #2&quot;, color Blue], NodeAttrs [style filled]]
   &gt; $ composeList [ Cntxt &quot;a0&quot;    (Just $ Int 0)   []               [(&quot;a3&quot;,[]),(&quot;start&quot;,[])] [(&quot;a1&quot;,[])]
   &gt;               , Cntxt &quot;a1&quot;    (Just $ Int 0)   []               []                       [(&quot;a2&quot;,[]),(&quot;b3&quot;,[])]
   &gt;               , Cntxt &quot;a2&quot;    (Just $ Int 0)   []               []                       [(&quot;a3&quot;,[])]
   &gt;               , Cntxt &quot;a3&quot;    (Just $ Int 0)   []               [(&quot;b2&quot;,[])]              [(&quot;end&quot;,[])]
   &gt;               , Cntxt &quot;b0&quot;    (Just $ Int 1)   []               [(&quot;start&quot;,[])]           [(&quot;b1&quot;,[])]
   &gt;               , Cntxt &quot;b1&quot;    (Just $ Int 1)   []               []                       [(&quot;b2&quot;,[])]
   &gt;               , Cntxt &quot;b2&quot;    (Just $ Int 1)   []               []                       [(&quot;b3&quot;,[])]
   &gt;               , Cntxt &quot;b3&quot;    (Just $ Int 1)   []               []                       [(&quot;end&quot;,[])]
   &gt;               , Cntxt &quot;end&quot;   Nothing          [shape MSquare]  []                       []
   &gt;               , Cntxt &quot;start&quot; Nothing          [shape MDiamond] []                       []]

 -}</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.GraphViz.Types.Graph</span><span>
</span><span id="line-53"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier">DotGraph</span></a></span><span>
</span><span id="line-54"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier">GraphID</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier">Context</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Conversions</span></span><span>
</span><span id="line-57"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#toCanonical"><span class="hs-identifier">toCanonical</span></a></span><span>
</span><span id="line-58"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#unsafeFromCanonical"><span class="hs-identifier">unsafeFromCanonical</span></a></span><span>
</span><span id="line-59"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#fromDotRepr"><span class="hs-identifier">fromDotRepr</span></a></span><span>
</span><span id="line-60"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Graph information</span></span><span>
</span><span id="line-61"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span>
</span><span id="line-62"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#hasClusters"><span class="hs-identifier">hasClusters</span></a></span><span>
</span><span id="line-63"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#isEmptyGraph"><span class="hs-identifier">isEmptyGraph</span></a></span><span>
</span><span id="line-64"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#graphAttributes"><span class="hs-identifier">graphAttributes</span></a></span><span>
</span><span id="line-65"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#parentOf"><span class="hs-identifier">parentOf</span></a></span><span>
</span><span id="line-66"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusterAttributes"><span class="hs-identifier">clusterAttributes</span></a></span><span>
</span><span id="line-67"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#foundInCluster"><span class="hs-identifier">foundInCluster</span></a></span><span>
</span><span id="line-68"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#attributesOf"><span class="hs-identifier">attributesOf</span></a></span><span>
</span><span id="line-69"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#predecessorsOf"><span class="hs-identifier">predecessorsOf</span></a></span><span>
</span><span id="line-70"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#successorsOf"><span class="hs-identifier">successorsOf</span></a></span><span>
</span><span id="line-71"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#adjacentTo"><span class="hs-identifier">adjacentTo</span></a></span><span>
</span><span id="line-72"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#adjacent"><span class="hs-identifier">adjacent</span></a></span><span>
</span><span id="line-73"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Graph construction</span></span><span>
</span><span id="line-74"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#mkGraph"><span class="hs-identifier">mkGraph</span></a></span><span>
</span><span id="line-75"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#emptyGraph"><span class="hs-identifier">emptyGraph</span></a></span><span>
</span><span id="line-76"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#%26"><span class="hs-operator">(&amp;)</span></a></span><span>
</span><span id="line-77"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#composeList"><span class="hs-identifier">composeList</span></a></span><span>
</span><span id="line-78"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addNode"><span class="hs-identifier">addNode</span></a></span><span>
</span><span id="line-79"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier">DotNode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addDotNode"><span class="hs-identifier">addDotNode</span></a></span><span>
</span><span id="line-81"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addEdge"><span class="hs-identifier">addEdge</span></a></span><span>
</span><span id="line-82"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier">DotEdge</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addDotEdge"><span class="hs-identifier">addDotEdge</span></a></span><span>
</span><span id="line-84"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addCluster"><span class="hs-identifier">addCluster</span></a></span><span>
</span><span id="line-85"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#setClusterParent"><span class="hs-identifier">setClusterParent</span></a></span><span>
</span><span id="line-86"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#setClusterAttributes"><span class="hs-identifier">setClusterAttributes</span></a></span><span>
</span><span id="line-87"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Graph deconstruction</span></span><span>
</span><span id="line-88"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#decompose"><span class="hs-identifier">decompose</span></a></span><span>
</span><span id="line-89"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#decomposeAny"><span class="hs-identifier">decomposeAny</span></a></span><span>
</span><span id="line-90"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#decomposeList"><span class="hs-identifier">decomposeList</span></a></span><span>
</span><span id="line-91"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteNode"><span class="hs-identifier">deleteNode</span></a></span><span>
</span><span id="line-92"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteAllEdges"><span class="hs-identifier">deleteAllEdges</span></a></span><span>
</span><span id="line-93"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteEdge"><span class="hs-identifier">deleteEdge</span></a></span><span>
</span><span id="line-94"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteDotEdge"><span class="hs-identifier">deleteDotEdge</span></a></span><span>
</span><span id="line-95"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteCluster"><span class="hs-identifier">deleteCluster</span></a></span><span>
</span><span id="line-96"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#removeEmptyClusters"><span class="hs-identifier">removeEmptyClusters</span></a></span><span>
</span><span id="line-97"></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Algorithms.html"><span class="hs-identifier">Data.GraphViz.Algorithms</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier">CanonicaliseOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>                                                      </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#canonicaliseOptions"><span class="hs-identifier">canonicaliseOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Algorithms.Clustering.html"><span class="hs-identifier">Data.GraphViz.Algorithms.Clustering</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html"><span class="hs-identifier">Data.GraphViz.Attributes.Complete</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier">Attributes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html"><span class="hs-identifier">Data.GraphViz.Attributes.Same</span></a></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Internal.Util.html"><span class="hs-identifier">Data.GraphViz.Internal.Util</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Internal.Util.html#groupSortBy"><span class="hs-identifier">groupSortBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>                                                      </span><span class="annot"><a href="Data.GraphViz.Internal.Util.html#groupSortCollectBy"><span class="hs-identifier">groupSortCollectBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Types.html"><span class="hs-identifier">Data.GraphViz.Types</span></a></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html"><span class="hs-identifier">Data.GraphViz.Types.Canonical</span></a></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Generalised.html"><span class="hs-identifier">Data.GraphViz.Types.Generalised</span></a></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html"><span class="hs-identifier">Data.GraphViz.Types.Internal.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#partitionGlobal"><span class="hs-identifier">partitionGlobal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html"><span class="hs-identifier">Data.GraphViz.Types.State</span></a></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">St</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftA2"><span class="hs-identifier">liftA2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Arrow.html#%2A%2A%2A"><span class="hs-operator">(***)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>                       </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#delete"><span class="hs-identifier">delete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#unfoldr"><span class="hs-identifier">unfoldr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>                                                  </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybeToList"><span class="hs-identifier">maybeToList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.ParserCombinators.ReadPrec.html"><span class="hs-identifier">Text.ParserCombinators.ReadPrec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.ParserCombinators.ReadPrec.html#prec"><span class="hs-identifier">prec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.html"><span class="hs-identifier">Text.Read</span></a></span><span>                       </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.Lex.html#Lexeme"><span class="hs-identifier">Lexeme</span></a></span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.Lex.html#Ident"><span class="hs-identifier">Ident</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#lexP"><span class="hs-identifier">lexP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#parens"><span class="hs-identifier">parens</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>                                                  </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#readPrec"><span class="hs-identifier">readPrec</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if !(MIN_VERSION_base (4,8,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><span class="hs-comment">-- | A Dot graph that allows graph operations on it.</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">data</span><span> </span><span id="DotGraph"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-var">DotGraph</span></a></span></span><span> </span><span id="local-6989586621679227963"><span class="annot"><a href="#local-6989586621679227963"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DG"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DG"><span class="hs-identifier hs-var">DG</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="strictGraph"><span class="annot"><span class="annottext">forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#strictGraph"><span class="hs-identifier hs-var hs-var">strictGraph</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-134"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="directedGraph"><span class="annot"><span class="annottext">forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var hs-var">directedGraph</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-135"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="graphAttrs"><span class="annot"><span class="annottext">forall n. DotGraph n -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var hs-var">graphAttrs</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-type">GlobAttrs</span></a></span><span>
</span><span id="line-136"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="graphID"><span class="annot"><span class="annottext">forall n. DotGraph n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#graphID"><span class="hs-identifier hs-var hs-var">graphID</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="clusters"><span class="annot"><span class="annottext">forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var hs-var">clusters</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#ClusterInfo"><span class="hs-identifier hs-type">ClusterInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="values"><span class="annot"><span class="annottext">forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var hs-var">values</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679227963"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228479"><span id="local-6989586621679228494"><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n -&gt; Bool
(DotGraph n -&gt; DotGraph n -&gt; Bool)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; Bool) -&gt; Eq (DotGraph n)
forall n. Eq n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall n. Eq n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
== :: DotGraph n -&gt; DotGraph n -&gt; Bool
$c/= :: forall n. Eq n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
/= :: DotGraph n -&gt; DotGraph n -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228506"><span id="local-6989586621679228521"><span id="local-6989586621679228532"><span id="local-6989586621679228536"><span id="local-6989586621679228539"><span id="local-6989586621679228542"><span id="local-6989586621679228545"><span class="annot"><span class="annottext">Eq (DotGraph n)
Eq (DotGraph n) =&gt;
(DotGraph n -&gt; DotGraph n -&gt; Ordering)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; Bool)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; Bool)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; Bool)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; Bool)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotGraph n -&gt; DotGraph n)
-&gt; Ord (DotGraph n)
DotGraph n -&gt; DotGraph n -&gt; Bool
DotGraph n -&gt; DotGraph n -&gt; Ordering
DotGraph n -&gt; DotGraph n -&gt; DotGraph n
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall n. Ord n =&gt; Eq (DotGraph n)
forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Ordering
forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; DotGraph n
$ccompare :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Ordering
compare :: DotGraph n -&gt; DotGraph n -&gt; Ordering
$c&lt; :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
&lt; :: DotGraph n -&gt; DotGraph n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
&lt;= :: DotGraph n -&gt; DotGraph n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
&gt; :: DotGraph n -&gt; DotGraph n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; Bool
&gt;= :: DotGraph n -&gt; DotGraph n -&gt; Bool
$cmax :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; DotGraph n
max :: DotGraph n -&gt; DotGraph n -&gt; DotGraph n
$cmin :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n -&gt; DotGraph n
min :: DotGraph n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | It should be safe to substitute 'unsafeFromCanonical' for</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   'fromCanonical' in the output of this.</span><span>
</span><span id="line-144"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679227994"><span id="local-6989586621679228556"><span id="local-6989586621679228560"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679227994"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679227994"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679228569"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; DotGraph n -&gt; ShowS
</span><a href="#local-6989586621679228569"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679228571"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679228571"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679228572"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679228572"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#showParen"><span class="hs-identifier hs-var">showParen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679228571"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-146"></span><span>                   </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#showString"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromCanonical &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#shows"><span class="hs-identifier hs-var">shows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall n. DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#toCanonical"><span class="hs-identifier hs-var">toCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679228572"><span class="hs-identifier hs-var">dg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | If the graph is the output from 'show', then it should be safe to</span><span>
</span><span id="line-149"></span><span class="hs-comment">--   substitute 'unsafeFromCanonical' for 'fromCanonical'.</span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228009"><span id="local-6989586621679228582"><span id="local-6989586621679228586"><span id="local-6989586621679228590"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228009"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228009"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228009"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679228603"><span class="annot"><span class="annottext">readPrec :: ReadPrec (DotGraph n)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#readPrec"><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadPrec (DotGraph n) -&gt; ReadPrec (DotGraph n)
forall a. ReadPrec a -&gt; ReadPrec a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="annot"><span class="annottext">(ReadPrec (DotGraph n) -&gt; ReadPrec (DotGraph n))
-&gt; (ReadPrec (DotGraph n) -&gt; ReadPrec (DotGraph n))
-&gt; ReadPrec (DotGraph n)
-&gt; ReadPrec (DotGraph n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ReadPrec (DotGraph n) -&gt; ReadPrec (DotGraph n)
forall a. Int -&gt; ReadPrec a -&gt; ReadPrec a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.ParserCombinators.ReadPrec.html#prec"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-152"></span><span>             </span><span class="annot"><span class="annottext">(ReadPrec (DotGraph n) -&gt; ReadPrec (DotGraph n))
-&gt; ReadPrec (DotGraph n) -&gt; ReadPrec (DotGraph n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.Lex.html#Ident"><span class="hs-identifier hs-type">Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromCanonical&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadPrec Lexeme
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#lexP"><span class="hs-identifier hs-var">lexP</span></a></span><span>
</span><span id="line-153"></span><span>                  </span><span id="local-6989586621679228604"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679228604"><span class="hs-identifier hs-var">cdg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadPrec (DotGraph n)
forall a. Read a =&gt; ReadPrec a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#readPrec"><span class="hs-identifier hs-var">readPrec</span></a></span><span>
</span><span id="line-154"></span><span>                  </span><span class="annot"><span class="annottext">DotGraph n -&gt; ReadPrec (DotGraph n)
forall a. a -&gt; ReadPrec a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; ReadPrec (DotGraph n))
-&gt; DotGraph n -&gt; ReadPrec (DotGraph n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; DotGraph n -&gt; dg n
</span><a href="Data.GraphViz.Types.html#fromCanonical"><span class="hs-identifier hs-var">fromCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679228604"><span class="hs-identifier hs-var">cdg</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">data</span><span> </span><span id="GlobAttrs"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-var">GlobAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GA"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GA"><span class="hs-identifier hs-var">GA</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="graphAs"><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAs"><span class="hs-identifier hs-var hs-var">graphAs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html#SAttrs"><span class="hs-identifier hs-type">SAttrs</span></a></span><span>
</span><span id="line-157"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="nodeAs"><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="Data.GraphViz.Types.Graph.html#nodeAs"><span class="hs-identifier hs-var hs-var">nodeAs</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html#SAttrs"><span class="hs-identifier hs-type">SAttrs</span></a></span><span>
</span><span id="line-158"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="edgeAs"><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="Data.GraphViz.Types.Graph.html#edgeAs"><span class="hs-identifier hs-var hs-var">edgeAs</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html#SAttrs"><span class="hs-identifier hs-type">SAttrs</span></a></span><span>
</span><span id="line-159"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-160"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228610"><span id="local-6989586621679228617"><span class="annot"><span class="annottext">GlobAttrs -&gt; GlobAttrs -&gt; Bool
(GlobAttrs -&gt; GlobAttrs -&gt; Bool)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; Bool) -&gt; Eq GlobAttrs
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
== :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
$c/= :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
/= :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228623"><span id="local-6989586621679228630"><span id="local-6989586621679228636"><span id="local-6989586621679228639"><span id="local-6989586621679228642"><span id="local-6989586621679228645"><span id="local-6989586621679228648"><span class="annot"><span class="annottext">Eq GlobAttrs
Eq GlobAttrs =&gt;
(GlobAttrs -&gt; GlobAttrs -&gt; Ordering)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; Bool)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; Bool)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; Bool)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; Bool)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs)
-&gt; (GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs)
-&gt; Ord GlobAttrs
GlobAttrs -&gt; GlobAttrs -&gt; Bool
GlobAttrs -&gt; GlobAttrs -&gt; Ordering
GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: GlobAttrs -&gt; GlobAttrs -&gt; Ordering
compare :: GlobAttrs -&gt; GlobAttrs -&gt; Ordering
$c&lt; :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
&lt; :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
$c&lt;= :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
&lt;= :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
$c&gt; :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
&gt; :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
$c&gt;= :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
&gt;= :: GlobAttrs -&gt; GlobAttrs -&gt; Bool
$cmax :: GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs
max :: GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs
$cmin :: GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs
min :: GlobAttrs -&gt; GlobAttrs -&gt; GlobAttrs
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228652"><span id="local-6989586621679228660"><span id="local-6989586621679228664"><span class="annot"><span class="annottext">Int -&gt; GlobAttrs -&gt; ShowS
[GlobAttrs] -&gt; ShowS
GlobAttrs -&gt; String
(Int -&gt; GlobAttrs -&gt; ShowS)
-&gt; (GlobAttrs -&gt; String)
-&gt; ([GlobAttrs] -&gt; ShowS)
-&gt; Show GlobAttrs
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; GlobAttrs -&gt; ShowS
showsPrec :: Int -&gt; GlobAttrs -&gt; ShowS
$cshow :: GlobAttrs -&gt; String
show :: GlobAttrs -&gt; String
$cshowList :: [GlobAttrs] -&gt; ShowS
showList :: [GlobAttrs] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228668"><span id="local-6989586621679228672"><span id="local-6989586621679228675"><span id="local-6989586621679228692"><span class="annot"><span class="annottext">ReadPrec [GlobAttrs]
ReadPrec GlobAttrs
Int -&gt; ReadS GlobAttrs
ReadS [GlobAttrs]
(Int -&gt; ReadS GlobAttrs)
-&gt; ReadS [GlobAttrs]
-&gt; ReadPrec GlobAttrs
-&gt; ReadPrec [GlobAttrs]
-&gt; Read GlobAttrs
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS GlobAttrs
readsPrec :: Int -&gt; ReadS GlobAttrs
$creadList :: ReadS [GlobAttrs]
readList :: ReadS [GlobAttrs]
$creadPrec :: ReadPrec GlobAttrs
readPrec :: ReadPrec GlobAttrs
$creadListPrec :: ReadPrec [GlobAttrs]
readListPrec :: ReadPrec [GlobAttrs]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">data</span><span> </span><span id="NodeInfo"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a></span></span><span> </span><span id="local-6989586621679228027"><span class="annot"><a href="#local-6989586621679228027"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NI"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-var">NI</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_inCluster"><span class="annot"><span class="annottext">forall n. NodeInfo n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var hs-var">_inCluster</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_attributes"><span class="annot"><span class="annottext">forall n. NodeInfo n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Graph.html#_attributes"><span class="hs-identifier hs-var hs-var">_attributes</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span>
</span><span id="line-164"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_predecessors"><span class="annot"><span class="annottext">forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var hs-var">_predecessors</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228027"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_successors"><span class="annot"><span class="annottext">forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var hs-var">_successors</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228027"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228702"><span id="local-6989586621679228712"><span class="annot"><span class="annottext">NodeInfo n -&gt; NodeInfo n -&gt; Bool
(NodeInfo n -&gt; NodeInfo n -&gt; Bool)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; Bool) -&gt; Eq (NodeInfo n)
forall n. Eq n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall n. Eq n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
== :: NodeInfo n -&gt; NodeInfo n -&gt; Bool
$c/= :: forall n. Eq n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
/= :: NodeInfo n -&gt; NodeInfo n -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228720"><span id="local-6989586621679228730"><span id="local-6989586621679228739"><span id="local-6989586621679228742"><span id="local-6989586621679228745"><span id="local-6989586621679228748"><span id="local-6989586621679228751"><span class="annot"><span class="annottext">Eq (NodeInfo n)
Eq (NodeInfo n) =&gt;
(NodeInfo n -&gt; NodeInfo n -&gt; Ordering)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; Bool)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; Bool)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; Bool)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; Bool)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; (NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; Ord (NodeInfo n)
NodeInfo n -&gt; NodeInfo n -&gt; Bool
NodeInfo n -&gt; NodeInfo n -&gt; Ordering
NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall n. Ord n =&gt; Eq (NodeInfo n)
forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Ordering
forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
$ccompare :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Ordering
compare :: NodeInfo n -&gt; NodeInfo n -&gt; Ordering
$c&lt; :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
&lt; :: NodeInfo n -&gt; NodeInfo n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
&lt;= :: NodeInfo n -&gt; NodeInfo n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
&gt; :: NodeInfo n -&gt; NodeInfo n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; Bool
&gt;= :: NodeInfo n -&gt; NodeInfo n -&gt; Bool
$cmax :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
max :: NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
$cmin :: forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
min :: NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228756"><span id="local-6989586621679228769"><span id="local-6989586621679228773"><span class="annot"><span class="annottext">Int -&gt; NodeInfo n -&gt; ShowS
[NodeInfo n] -&gt; ShowS
NodeInfo n -&gt; String
(Int -&gt; NodeInfo n -&gt; ShowS)
-&gt; (NodeInfo n -&gt; String)
-&gt; ([NodeInfo n] -&gt; ShowS)
-&gt; Show (NodeInfo n)
forall n. Show n =&gt; Int -&gt; NodeInfo n -&gt; ShowS
forall n. Show n =&gt; [NodeInfo n] -&gt; ShowS
forall n. Show n =&gt; NodeInfo n -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall n. Show n =&gt; Int -&gt; NodeInfo n -&gt; ShowS
showsPrec :: Int -&gt; NodeInfo n -&gt; ShowS
$cshow :: forall n. Show n =&gt; NodeInfo n -&gt; String
show :: NodeInfo n -&gt; String
$cshowList :: forall n. Show n =&gt; [NodeInfo n] -&gt; ShowS
showList :: [NodeInfo n] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228780"><span id="local-6989586621679228784"><span id="local-6989586621679228787"><span id="local-6989586621679228810"><span class="annot"><span class="annottext">ReadPrec [NodeInfo n]
ReadPrec (NodeInfo n)
Int -&gt; ReadS (NodeInfo n)
ReadS [NodeInfo n]
(Int -&gt; ReadS (NodeInfo n))
-&gt; ReadS [NodeInfo n]
-&gt; ReadPrec (NodeInfo n)
-&gt; ReadPrec [NodeInfo n]
-&gt; Read (NodeInfo n)
forall n. (Ord n, Read n) =&gt; ReadPrec [NodeInfo n]
forall n. (Ord n, Read n) =&gt; ReadPrec (NodeInfo n)
forall n. (Ord n, Read n) =&gt; Int -&gt; ReadS (NodeInfo n)
forall n. (Ord n, Read n) =&gt; ReadS [NodeInfo n]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: forall n. (Ord n, Read n) =&gt; Int -&gt; ReadS (NodeInfo n)
readsPrec :: Int -&gt; ReadS (NodeInfo n)
$creadList :: forall n. (Ord n, Read n) =&gt; ReadS [NodeInfo n]
readList :: ReadS [NodeInfo n]
$creadPrec :: forall n. (Ord n, Read n) =&gt; ReadPrec (NodeInfo n)
readPrec :: ReadPrec (NodeInfo n)
$creadListPrec :: forall n. (Ord n, Read n) =&gt; ReadPrec [NodeInfo n]
readListPrec :: ReadPrec [NodeInfo n]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">data</span><span> </span><span id="ClusterInfo"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#ClusterInfo"><span class="hs-identifier hs-var">ClusterInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CI"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#CI"><span class="hs-identifier hs-var">CI</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="parentCluster"><span class="annot"><span class="annottext">ClusterInfo -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var hs-var">parentCluster</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="clusterAttrs"><span class="annot"><span class="annottext">ClusterInfo -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#clusterAttrs"><span class="hs-identifier hs-var hs-var">clusterAttrs</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-type">GlobAttrs</span></a></span><span>
</span><span id="line-171"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-172"></span><span>                 </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228818"><span id="local-6989586621679228823"><span class="annot"><span class="annottext">ClusterInfo -&gt; ClusterInfo -&gt; Bool
(ClusterInfo -&gt; ClusterInfo -&gt; Bool)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; Bool) -&gt; Eq ClusterInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
== :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
$c/= :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
/= :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228828"><span id="local-6989586621679228833"><span id="local-6989586621679228838"><span id="local-6989586621679228841"><span id="local-6989586621679228844"><span id="local-6989586621679228847"><span id="local-6989586621679228850"><span class="annot"><span class="annottext">Eq ClusterInfo
Eq ClusterInfo =&gt;
(ClusterInfo -&gt; ClusterInfo -&gt; Ordering)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; Bool)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; Bool)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; Bool)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; Bool)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo)
-&gt; (ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo)
-&gt; Ord ClusterInfo
ClusterInfo -&gt; ClusterInfo -&gt; Bool
ClusterInfo -&gt; ClusterInfo -&gt; Ordering
ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: ClusterInfo -&gt; ClusterInfo -&gt; Ordering
compare :: ClusterInfo -&gt; ClusterInfo -&gt; Ordering
$c&lt; :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
&lt; :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
$c&lt;= :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
&lt;= :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
$c&gt; :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
&gt; :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
$c&gt;= :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
&gt;= :: ClusterInfo -&gt; ClusterInfo -&gt; Bool
$cmax :: ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo
max :: ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo
$cmin :: ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo
min :: ClusterInfo -&gt; ClusterInfo -&gt; ClusterInfo
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228853"><span id="local-6989586621679228859"><span id="local-6989586621679228863"><span class="annot"><span class="annottext">Int -&gt; ClusterInfo -&gt; ShowS
[ClusterInfo] -&gt; ShowS
ClusterInfo -&gt; String
(Int -&gt; ClusterInfo -&gt; ShowS)
-&gt; (ClusterInfo -&gt; String)
-&gt; ([ClusterInfo] -&gt; ShowS)
-&gt; Show ClusterInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ClusterInfo -&gt; ShowS
showsPrec :: Int -&gt; ClusterInfo -&gt; ShowS
$cshow :: ClusterInfo -&gt; String
show :: ClusterInfo -&gt; String
$cshowList :: [ClusterInfo] -&gt; ShowS
showList :: [ClusterInfo] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228866"><span id="local-6989586621679228870"><span id="local-6989586621679228873"><span id="local-6989586621679228885"><span class="annot"><span class="annottext">ReadPrec [ClusterInfo]
ReadPrec ClusterInfo
Int -&gt; ReadS ClusterInfo
ReadS [ClusterInfo]
(Int -&gt; ReadS ClusterInfo)
-&gt; ReadS [ClusterInfo]
-&gt; ReadPrec ClusterInfo
-&gt; ReadPrec [ClusterInfo]
-&gt; Read ClusterInfo
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS ClusterInfo
readsPrec :: Int -&gt; ReadS ClusterInfo
$creadList :: ReadS [ClusterInfo]
readList :: ReadS [ClusterInfo]
$creadPrec :: ReadPrec ClusterInfo
readPrec :: ReadPrec ClusterInfo
$creadListPrec :: ReadPrec [ClusterInfo]
readListPrec :: ReadPrec [ClusterInfo]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">type</span><span> </span><span id="NodeMap"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-var">NodeMap</span></a></span></span><span> </span><span id="local-6989586621679228887"><span class="annot"><a href="#local-6989586621679228887"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228887"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228887"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">type</span><span> </span><span id="EdgeMap"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-var">EdgeMap</span></a></span></span><span> </span><span id="local-6989586621679228888"><span class="annot"><a href="#local-6989586621679228888"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228888"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | The decomposition of a node from a dot graph.  Any loops should</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   be found in 'successors' rather than 'predecessors'.  Note also</span><span>
</span><span id="line-180"></span><span class="hs-comment">--   that these are created\/consumed as if for /directed/ graphs.</span><span>
</span><span id="line-181"></span><span class="hs-keyword">data</span><span> </span><span id="Context"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-var">Context</span></a></span></span><span> </span><span id="local-6989586621679228051"><span class="annot"><a href="#local-6989586621679228051"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cntxt"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Cntxt"><span class="hs-identifier hs-var">Cntxt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="node"><span class="annot"><span class="annottext">forall n. Context n -&gt; n
</span><a href="Data.GraphViz.Types.Graph.html#node"><span class="hs-identifier hs-var hs-var">node</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679228051"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-182"></span><span>                         </span><span class="hs-comment">-- | The cluster this node can be found in;</span><span>
</span><span id="line-183"></span><span>                         </span><span class="hs-comment">--   @Nothing@ indicates the node can be</span><span>
</span><span id="line-184"></span><span>                         </span><span class="hs-comment">--   found in the root graph.</span><span>
</span><span id="line-185"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="inCluster"><span class="annot"><span class="annottext">forall n. Context n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#inCluster"><span class="hs-identifier hs-var hs-var">inCluster</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="attributes"><span class="annot"><span class="annottext">forall n. Context n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Graph.html#attributes"><span class="hs-identifier hs-var hs-var">attributes</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span>
</span><span id="line-187"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="predecessors"><span class="annot"><span class="annottext">forall n. Context n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#predecessors"><span class="hs-identifier hs-var hs-var">predecessors</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228051"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="successors"><span class="annot"><span class="annottext">forall n. Context n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#successors"><span class="hs-identifier hs-var hs-var">successors</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228051"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-190"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228897"><span id="local-6989586621679228907"><span class="annot"><span class="annottext">Context n -&gt; Context n -&gt; Bool
(Context n -&gt; Context n -&gt; Bool)
-&gt; (Context n -&gt; Context n -&gt; Bool) -&gt; Eq (Context n)
forall n. Eq n =&gt; Context n -&gt; Context n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall n. Eq n =&gt; Context n -&gt; Context n -&gt; Bool
== :: Context n -&gt; Context n -&gt; Bool
$c/= :: forall n. Eq n =&gt; Context n -&gt; Context n -&gt; Bool
/= :: Context n -&gt; Context n -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228916"><span id="local-6989586621679228926"><span id="local-6989586621679228936"><span id="local-6989586621679228940"><span id="local-6989586621679228943"><span id="local-6989586621679228946"><span id="local-6989586621679228949"><span class="annot"><span class="annottext">Eq (Context n)
Eq (Context n) =&gt;
(Context n -&gt; Context n -&gt; Ordering)
-&gt; (Context n -&gt; Context n -&gt; Bool)
-&gt; (Context n -&gt; Context n -&gt; Bool)
-&gt; (Context n -&gt; Context n -&gt; Bool)
-&gt; (Context n -&gt; Context n -&gt; Bool)
-&gt; (Context n -&gt; Context n -&gt; Context n)
-&gt; (Context n -&gt; Context n -&gt; Context n)
-&gt; Ord (Context n)
Context n -&gt; Context n -&gt; Bool
Context n -&gt; Context n -&gt; Ordering
Context n -&gt; Context n -&gt; Context n
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall n. Ord n =&gt; Eq (Context n)
forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Bool
forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Ordering
forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Context n
$ccompare :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Ordering
compare :: Context n -&gt; Context n -&gt; Ordering
$c&lt; :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Bool
&lt; :: Context n -&gt; Context n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Bool
&lt;= :: Context n -&gt; Context n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Bool
&gt; :: Context n -&gt; Context n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Bool
&gt;= :: Context n -&gt; Context n -&gt; Bool
$cmax :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Context n
max :: Context n -&gt; Context n -&gt; Context n
$cmin :: forall n. Ord n =&gt; Context n -&gt; Context n -&gt; Context n
min :: Context n -&gt; Context n -&gt; Context n
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228954"><span id="local-6989586621679228965"><span id="local-6989586621679228969"><span class="annot"><span class="annottext">Int -&gt; Context n -&gt; ShowS
[Context n] -&gt; ShowS
Context n -&gt; String
(Int -&gt; Context n -&gt; ShowS)
-&gt; (Context n -&gt; String)
-&gt; ([Context n] -&gt; ShowS)
-&gt; Show (Context n)
forall n. Show n =&gt; Int -&gt; Context n -&gt; ShowS
forall n. Show n =&gt; [Context n] -&gt; ShowS
forall n. Show n =&gt; Context n -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall n. Show n =&gt; Int -&gt; Context n -&gt; ShowS
showsPrec :: Int -&gt; Context n -&gt; ShowS
$cshow :: forall n. Show n =&gt; Context n -&gt; String
show :: Context n -&gt; String
$cshowList :: forall n. Show n =&gt; [Context n] -&gt; ShowS
showList :: [Context n] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228974"><span id="local-6989586621679228978"><span id="local-6989586621679228981"><span id="local-6989586621679229004"><span class="annot"><span class="annottext">ReadPrec [Context n]
ReadPrec (Context n)
Int -&gt; ReadS (Context n)
ReadS [Context n]
(Int -&gt; ReadS (Context n))
-&gt; ReadS [Context n]
-&gt; ReadPrec (Context n)
-&gt; ReadPrec [Context n]
-&gt; Read (Context n)
forall n. Read n =&gt; ReadPrec [Context n]
forall n. Read n =&gt; ReadPrec (Context n)
forall n. Read n =&gt; Int -&gt; ReadS (Context n)
forall n. Read n =&gt; ReadS [Context n]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: forall n. Read n =&gt; Int -&gt; ReadS (Context n)
readsPrec :: Int -&gt; ReadS (Context n)
$creadList :: forall n. Read n =&gt; ReadS [Context n]
readList :: ReadS [Context n]
$creadPrec :: forall n. Read n =&gt; ReadPrec (Context n)
readPrec :: ReadPrec (Context n)
$creadListPrec :: forall n. Read n =&gt; ReadPrec [Context n]
readListPrec :: ReadPrec [Context n]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span id="local-6989586621679228074"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#adjacent"><span class="hs-identifier hs-type">adjacent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228074"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228074"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-193"></span><span id="adjacent"><span class="annot"><span class="annottext">adjacent :: forall n. Context n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#adjacent"><span class="hs-identifier hs-var hs-var">adjacent</span></a></span></span><span> </span><span id="local-6989586621679229007"><span class="annot"><span class="annottext">Context n
</span><a href="#local-6989586621679229007"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; [(n, Attributes)] -&gt; [DotEdge n]
forall {a} {b} {b}. (a -&gt; b -&gt; b) -&gt; [(a, b)] -&gt; [b]
</span><a href="#local-6989586621679229008"><span class="hs-identifier hs-var">mapU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-operator hs-var">`DotEdge`</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229010"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context n -&gt; [(n, Attributes)]
forall n. Context n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#predecessors"><span class="hs-identifier hs-var">predecessors</span></a></span><span> </span><span class="annot"><span class="annottext">Context n
</span><a href="#local-6989586621679229007"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>             </span><span class="annot"><span class="annottext">[DotEdge n] -&gt; [DotEdge n] -&gt; [DotEdge n]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; [(n, Attributes)] -&gt; [DotEdge n]
forall {a} {b} {b}. (a -&gt; b -&gt; b) -&gt; [(a, b)] -&gt; [b]
</span><a href="#local-6989586621679229008"><span class="hs-identifier hs-var">mapU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-var">DotEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229010"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context n -&gt; [(n, Attributes)]
forall n. Context n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a></span><span> </span><span class="annot"><span class="annottext">Context n
</span><a href="#local-6989586621679229007"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679229010"><span class="annot"><span class="annottext">n :: n
</span><a href="#local-6989586621679229010"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context n -&gt; n
forall n. Context n -&gt; n
</span><a href="Data.GraphViz.Types.Graph.html#node"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">Context n
</span><a href="#local-6989586621679229007"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679229008"><span class="annot"><span class="annottext">mapU :: (a -&gt; b -&gt; b) -&gt; [(a, b)] -&gt; [b]
</span><a href="#local-6989586621679229008"><span class="hs-identifier hs-var hs-var">mapU</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; b) -&gt; [(a, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(((a, b) -&gt; b) -&gt; [(a, b)] -&gt; [b])
-&gt; ((a -&gt; b -&gt; b) -&gt; (a, b) -&gt; b)
-&gt; (a -&gt; b -&gt; b)
-&gt; [(a, b)]
-&gt; [b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; (a, b) -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621679228087"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#emptyGraph"><span class="hs-identifier hs-type">emptyGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228087"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-200"></span><span id="emptyGraph"><span class="annot"><span class="annottext">emptyGraph :: forall n. DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#emptyGraph"><span class="hs-identifier hs-var hs-var">emptyGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DG"><span class="hs-identifier hs-type">DG</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">strictGraph :: Bool
</span><a href="Data.GraphViz.Types.Graph.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-201"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">directedGraph :: Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-202"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphID :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-203"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphAttrs :: GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var">graphAttrs</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#emptyGA"><span class="hs-identifier hs-var">emptyGA</span></a></span><span>
</span><span id="line-204"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusters :: Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span>
</span><span id="line-205"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">values :: NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeMap n
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span>
</span><span id="line-206"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#emptyGA"><span class="hs-identifier hs-type">emptyGA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-type">GlobAttrs</span></a></span><span>
</span><span id="line-209"></span><span id="emptyGA"><span class="annot"><span class="annottext">emptyGA :: GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#emptyGA"><span class="hs-identifier hs-var hs-var">emptyGA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#GA"><span class="hs-identifier hs-var">GA</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
forall a. Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
forall a. Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
forall a. Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Construction</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Merge the 'Context' into the graph.  Assumes that the specified</span><span>
</span><span id="line-215"></span><span class="hs-comment">--   node is not in the graph but that all endpoints in the</span><span>
</span><span id="line-216"></span><span class="hs-comment">--   'successors' and 'predecessors' (with the exception of loops)</span><span>
</span><span id="line-217"></span><span class="hs-comment">--   are.  If the cluster is not present in the graph, then it will be</span><span>
</span><span id="line-218"></span><span class="hs-comment">--   added with no attributes with a parent of the root graph.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   Note that @&amp;@ and @'decompose'@ are /not/ quite inverses, as this</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   function will add in the cluster if it does not yet exist in the</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   graph, but 'decompose' will not delete it.</span><span>
</span><span id="line-223"></span><span id="local-6989586621679228093"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#%26"><span class="hs-operator hs-type">(&amp;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228093"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228093"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228093"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228093"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-224"></span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Cntxt"><span class="hs-identifier hs-type">Cntxt</span></a></span><span> </span><span id="local-6989586621679229017"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229018"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229018"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621679229019"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229019"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679229020"><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229020"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679229021"><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229021"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span id="%26"><span class="annot"><span class="annottext">&amp; :: forall n. Ord n =&gt; Context n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#%26"><span class="hs-operator hs-var hs-var">&amp;</span></a></span></span><span> </span><span id="local-6989586621679229022"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229022"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
forall n. (NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-var">withValues</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229024"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229025"><span class="hs-identifier hs-var">dg'</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679229028"><span class="annot"><span class="annottext">ps' :: EdgeMap n
</span><a href="#local-6989586621679229028"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)] -&gt; EdgeMap n
forall n. Ord n =&gt; [(n, Attributes)] -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#toMap"><span class="hs-identifier hs-var">toMap</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229020"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679229032"><span class="annot"><span class="annottext">ps'' :: [(n, Attributes)]
</span><a href="#local-6989586621679229032"><span class="hs-identifier hs-var hs-var">ps''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EdgeMap n -&gt; [(n, Attributes)]
forall n. EdgeMap n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-var">fromMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">M.delete</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229028"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679229037"><span class="annot"><span class="annottext">ss' :: EdgeMap n
</span><a href="#local-6989586621679229037"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)] -&gt; EdgeMap n
forall n. Ord n =&gt; [(n, Attributes)] -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#toMap"><span class="hs-identifier hs-var">toMap</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229021"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679229040"><span class="annot"><span class="annottext">ss'' :: [(n, Attributes)]
</span><a href="#local-6989586621679229040"><span class="hs-identifier hs-var hs-var">ss''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EdgeMap n -&gt; [(n, Attributes)]
forall n. EdgeMap n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-var">fromMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">M.delete</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229037"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679229025"><span class="annot"><span class="annottext">dg' :: DotGraph n
</span><a href="#local-6989586621679229025"><span class="hs-identifier hs-var hs-var">dg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Maybe GraphID -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
forall n.
Ord n =&gt;
n -&gt; Maybe GraphID -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addNode"><span class="hs-identifier hs-var">addNode</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229018"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229019"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229022"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679229024"><span class="annot"><span class="annottext">merge :: NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229024"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; [(n, Attributes)] -&gt; NodeMap n -&gt; NodeMap n
forall n. Ord n =&gt; n -&gt; [(n, Attributes)] -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addSuccRev"><span class="hs-identifier hs-var">addSuccRev</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229032"><span class="hs-identifier hs-var">ps''</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n)
-&gt; (NodeMap n -&gt; NodeMap n) -&gt; NodeMap n -&gt; NodeMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; [(n, Attributes)] -&gt; NodeMap n -&gt; NodeMap n
forall n. Ord n =&gt; n -&gt; [(n, Attributes)] -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addPredRev"><span class="hs-identifier hs-var">addPredRev</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229040"><span class="hs-identifier hs-var">ss''</span></a></span><span>
</span><span id="line-234"></span><span>            </span><span class="hs-comment">-- Add reverse edges</span><span>
</span><span id="line-235"></span><span>            </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n)
-&gt; (NodeMap n -&gt; NodeMap n) -&gt; NodeMap n -&gt; NodeMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n) -&gt; n -&gt; NodeMap n -&gt; NodeMap n
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679229050"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229050"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229050"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var">_predecessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229028"><span class="hs-identifier hs-type">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229037"><span class="hs-identifier hs-type">ss'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229017"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-comment">-- Add actual edges</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#%26"><span class="hs-operator hs-type">&amp;</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Recursively merge the list of contexts.</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   &gt; composeList = foldr (&amp;) emptyGraph</span><span>
</span><span id="line-243"></span><span id="local-6989586621679228104"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#composeList"><span class="hs-identifier hs-type">composeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228104"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228104"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228104"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-244"></span><span id="composeList"><span class="annot"><span class="annottext">composeList :: forall n. Ord n =&gt; [Context n] -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#composeList"><span class="hs-identifier hs-var hs-var">composeList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context n -&gt; DotGraph n -&gt; DotGraph n)
-&gt; DotGraph n -&gt; [Context n] -&gt; DotGraph n
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Context n -&gt; DotGraph n -&gt; DotGraph n
forall n. Ord n =&gt; Context n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#%26"><span class="hs-operator hs-var">(&amp;)</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
forall n. DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#emptyGraph"><span class="hs-identifier hs-var">emptyGraph</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span id="local-6989586621679228101"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addSuccRev"><span class="hs-identifier hs-type">addSuccRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228101"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228101"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228101"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228101"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228101"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-247"></span><span id="addSuccRev"><span class="annot"><span class="annottext">addSuccRev :: forall n. Ord n =&gt; n -&gt; [(n, Attributes)] -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addSuccRev"><span class="hs-identifier hs-var hs-var">addSuccRev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
forall n.
Ord n =&gt;
UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addEdgeLinks"><span class="hs-identifier hs-var">addEdgeLinks</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSkip"><span class="hs-identifier hs-var">niSkip</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSucc"><span class="hs-identifier hs-var">niSucc</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621679229060"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addPredRev"><span class="hs-identifier hs-type">addPredRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229060"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229060"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229060"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229060"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229060"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-250"></span><span id="addPredRev"><span class="annot"><span class="annottext">addPredRev :: forall n. Ord n =&gt; n -&gt; [(n, Attributes)] -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addPredRev"><span class="hs-identifier hs-var hs-var">addPredRev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
forall n.
Ord n =&gt;
UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addEdgeLinks"><span class="hs-identifier hs-var">addEdgeLinks</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSkip"><span class="hs-identifier hs-var">niSkip</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niPred"><span class="hs-identifier hs-var">niPred</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span id="local-6989586621679228111"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addEdgeLinks"><span class="hs-identifier hs-type">addEdgeLinks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#UpdateEdgeMap"><span class="hs-identifier hs-type">UpdateEdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#UpdateEdgeMap"><span class="hs-identifier hs-type">UpdateEdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228111"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-254"></span><span id="addEdgeLinks"><span class="annot"><span class="annottext">addEdgeLinks :: forall n.
Ord n =&gt;
UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addEdgeLinks"><span class="hs-identifier hs-var hs-var">addEdgeLinks</span></a></span></span><span> </span><span id="local-6989586621679229066"><span class="annot"><span class="annottext">UpdateEdgeMap n
</span><a href="#local-6989586621679229066"><span class="hs-identifier hs-var">fwd</span></a></span></span><span> </span><span id="local-6989586621679229067"><span class="annot"><span class="annottext">UpdateEdgeMap n
</span><a href="#local-6989586621679229067"><span class="hs-identifier hs-var">rev</span></a></span></span><span> </span><span id="local-6989586621679229068"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229068"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229069"><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229069"><span class="hs-identifier hs-var">tas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
</span><a href="#local-6989586621679229070"><span class="hs-identifier hs-var">updRev</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; Map n (NodeInfo n))
-&gt; (Map n (NodeInfo n) -&gt; Map n (NodeInfo n))
-&gt; Map n (NodeInfo n)
-&gt; Map n (NodeInfo n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
</span><a href="#local-6989586621679229071"><span class="hs-identifier hs-var">updFwd</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679229071"><span class="annot"><span class="annottext">updFwd :: Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
</span><a href="#local-6989586621679229071"><span class="hs-identifier hs-var hs-var">updFwd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229074"><span class="hs-identifier hs-var">addFwd</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229068"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679229074"><span class="annot"><span class="annottext">addFwd :: NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229074"><span class="hs-identifier hs-var hs-var">addFwd</span></a></span></span><span> </span><span id="local-6989586621679229078"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229078"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; (n, Attributes) -&gt; NodeInfo n)
-&gt; NodeInfo n -&gt; [(n, Attributes)] -&gt; NodeInfo n
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679229079"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229079"><span class="hs-identifier hs-var">ni'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229080"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229080"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229081"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229081"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
</span><a href="#local-6989586621679229066"><span class="hs-identifier hs-var">fwd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Attributes] -&gt; [Attributes] -&gt; [Attributes])
-&gt; n -&gt; [Attributes] -&gt; Map n [Attributes] -&gt; Map n [Attributes]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes] -&gt; [Attributes] -&gt; [Attributes]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229080"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229081"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229079"><span class="hs-identifier hs-var">ni'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229078"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229069"><span class="hs-identifier hs-var">tas</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679229070"><span class="annot"><span class="annottext">updRev :: Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
</span><a href="#local-6989586621679229070"><span class="hs-identifier hs-var hs-var">updRev</span></a></span></span><span> </span><span id="local-6989586621679229086"><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229086"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; (n, Attributes) -&gt; Map n (NodeInfo n))
-&gt; Map n (NodeInfo n) -&gt; [(n, Attributes)] -&gt; Map n (NodeInfo n)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679229087"><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229087"><span class="hs-identifier hs-var">nm'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229088"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229088"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229089"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229089"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229090"><span class="hs-identifier hs-var">addRev</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229089"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229088"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229087"><span class="hs-identifier hs-var">nm'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229086"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)]
</span><a href="#local-6989586621679229069"><span class="hs-identifier hs-var">tas</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679229090"><span class="annot"><span class="annottext">addRev :: Attributes -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229090"><span class="hs-identifier hs-var hs-var">addRev</span></a></span></span><span> </span><span id="local-6989586621679229093"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229093"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
</span><a href="#local-6989586621679229067"><span class="hs-identifier hs-var">rev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Attributes] -&gt; [Attributes] -&gt; [Attributes])
-&gt; n -&gt; [Attributes] -&gt; Map n [Attributes] -&gt; Map n [Attributes]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes] -&gt; [Attributes] -&gt; [Attributes]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229068"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229093"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Add a node to the current graph. Merges attributes and edges if</span><span>
</span><span id="line-265"></span><span class="hs-comment">--   the node already exists in the graph.</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   If the specified cluster does not yet exist in the graph, then it</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   will be added (as a sub-graph of the overall graph and no</span><span>
</span><span id="line-269"></span><span class="hs-comment">--   attributes).</span><span>
</span><span id="line-270"></span><span id="local-6989586621679228100"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addNode"><span class="hs-identifier hs-type">addNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228100"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228100"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-272"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-comment">-- ^ The cluster the node can be found in</span><span>
</span><span id="line-273"></span><span>                            </span><span class="hs-comment">--   (@Nothing@ refers to the root graph).</span><span>
</span><span id="line-274"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span>
</span><span id="line-275"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228100"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-276"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228100"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-277"></span><span id="addNode"><span class="annot"><span class="annottext">addNode :: forall n.
Ord n =&gt;
n -&gt; Maybe GraphID -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addNode"><span class="hs-identifier hs-var hs-var">addNode</span></a></span></span><span> </span><span id="local-6989586621679229096"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229096"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229097"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229097"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621679229098"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229098"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679229099"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229099"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
forall n. Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-var">addEmptyCluster</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229097"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229099"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229101"><span class="hs-identifier hs-type">ns'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679229102"><span class="annot"><span class="annottext">ns :: Map n (NodeInfo n)
</span><a href="#local-6989586621679229102"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229099"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679229101"><span class="annot"><span class="annottext">ns' :: Map n (NodeInfo n)
</span><a href="#local-6989586621679229101"><span class="hs-identifier hs-var hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; NodeInfo n -&gt; Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
forall n. Ord n =&gt; NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229106"><span class="hs-identifier hs-var">mergeLogic</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229096"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe GraphID -&gt; Attributes -&gt; EdgeMap n -&gt; EdgeMap n -&gt; NodeInfo n
forall n.
Maybe GraphID -&gt; Attributes -&gt; EdgeMap n -&gt; EdgeMap n -&gt; NodeInfo n
</span><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-var">NI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229097"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229098"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229102"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679229106"><span class="annot"><span class="annottext">mergeLogic :: NodeInfo n -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229106"><span class="hs-identifier hs-var hs-var">mergeLogic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-type">NI</span></a></span><span> </span><span id="local-6989586621679229109"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229109"><span class="hs-identifier hs-var">newClust</span></a></span></span><span> </span><span id="local-6989586621679229110"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229110"><span class="hs-identifier hs-var">newAttrs</span></a></span></span><span> </span><span id="local-6989586621679229111"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229111"><span class="hs-identifier hs-var">newPreds</span></a></span></span><span> </span><span id="local-6989586621679229112"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229112"><span class="hs-identifier hs-var">newSuccs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-type">NI</span></a></span><span> </span><span id="local-6989586621679229113"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229113"><span class="hs-identifier hs-var">oldClust</span></a></span></span><span> </span><span id="local-6989586621679229114"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229114"><span class="hs-identifier hs-var">oldAttrs</span></a></span></span><span> </span><span id="local-6989586621679229115"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229115"><span class="hs-identifier hs-var">oldPreds</span></a></span></span><span> </span><span id="local-6989586621679229116"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229116"><span class="hs-identifier hs-var">oldSuccs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; Attributes -&gt; EdgeMap n -&gt; EdgeMap n -&gt; NodeInfo n
forall n.
Maybe GraphID -&gt; Attributes -&gt; EdgeMap n -&gt; EdgeMap n -&gt; NodeInfo n
</span><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-var">NI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229117"><span class="hs-identifier hs-var">resClust</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229118"><span class="hs-identifier hs-var">resAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229119"><span class="hs-identifier hs-var">resPreds</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229120"><span class="hs-identifier hs-var">resSuccs</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679229117"><span class="annot"><span class="annottext">resClust :: Maybe GraphID
</span><a href="#local-6989586621679229117"><span class="hs-identifier hs-var hs-var">resClust</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229109"><span class="hs-identifier hs-var">newClust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; Maybe GraphID -&gt; Maybe GraphID
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229113"><span class="hs-identifier hs-var">oldClust</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621679229118"><span class="annot"><span class="annottext">resAttrs :: Attributes
</span><a href="#local-6989586621679229118"><span class="hs-identifier hs-var hs-var">resAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span> </span><span class="annot"><span class="annottext">(SAttrs -&gt; Attributes) -&gt; SAttrs -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229110"><span class="hs-identifier hs-var">newAttrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229114"><span class="hs-identifier hs-var">oldAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>        </span><span id="local-6989586621679229119"><span class="annot"><span class="annottext">resPreds :: EdgeMap n
</span><a href="#local-6989586621679229119"><span class="hs-identifier hs-var hs-var">resPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Attributes] -&gt; [Attributes] -&gt; [Attributes])
-&gt; EdgeMap n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#unionWith"><span class="hs-identifier hs-var">M.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes] -&gt; [Attributes] -&gt; [Attributes]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229111"><span class="hs-identifier hs-var">newPreds</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229115"><span class="hs-identifier hs-var">oldPreds</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span id="local-6989586621679229120"><span class="annot"><span class="annottext">resSuccs :: EdgeMap n
</span><a href="#local-6989586621679229120"><span class="hs-identifier hs-var hs-var">resSuccs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Attributes] -&gt; [Attributes] -&gt; [Attributes])
-&gt; EdgeMap n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#unionWith"><span class="hs-identifier hs-var">M.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes] -&gt; [Attributes] -&gt; [Attributes]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229112"><span class="hs-identifier hs-var">newSuccs</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229116"><span class="hs-identifier hs-var">oldSuccs</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | A variant of 'addNode' that takes in a DotNode (not in a</span><span>
</span><span id="line-290"></span><span class="hs-comment">--   cluster).</span><span>
</span><span id="line-291"></span><span id="local-6989586621679228128"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addDotNode"><span class="hs-identifier hs-type">addDotNode</span></a></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228128"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228128"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228128"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228128"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-292"></span><span id="addDotNode"><span class="annot"><span class="annottext">addDotNode :: forall n. Ord n =&gt; DotNode n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addDotNode"><span class="hs-identifier hs-var hs-var">addDotNode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span id="local-6989586621679229135"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229135"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229136"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229136"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Maybe GraphID -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
forall n.
Ord n =&gt;
n -&gt; Maybe GraphID -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addNode"><span class="hs-identifier hs-var">addNode</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229135"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229136"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Add the specified edge to the graph; assumes both node values are</span><span>
</span><span id="line-295"></span><span class="hs-comment">--   already present in the graph.  If the graph is undirected then</span><span>
</span><span id="line-296"></span><span class="hs-comment">--   the order of nodes doesn't matter.</span><span>
</span><span id="line-297"></span><span id="local-6989586621679228131"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addEdge"><span class="hs-identifier hs-type">addEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228131"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228131"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228131"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228131"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228131"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-298"></span><span id="addEdge"><span class="annot"><span class="annottext">addEdge :: forall n. Ord n =&gt; n -&gt; n -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEdge"><span class="hs-identifier hs-var hs-var">addEdge</span></a></span></span><span> </span><span id="local-6989586621679229139"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229140"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229140"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679229141"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229141"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
forall n. (NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-var">withValues</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229142"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679229142"><span class="annot"><span class="annottext">merge :: NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229142"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
forall n.
Ord n =&gt;
UpdateEdgeMap n
-&gt; UpdateEdgeMap n
-&gt; n
-&gt; [(n, Attributes)]
-&gt; NodeMap n
-&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#addEdgeLinks"><span class="hs-identifier hs-var">addEdgeLinks</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSucc"><span class="hs-identifier hs-var">niSucc</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niPred"><span class="hs-identifier hs-var">niPred</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229139"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229140"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229141"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><span class="hs-comment">-- | A variant of 'addEdge' that takes a 'DotEdge' value.</span></span><span>
</span><span id="line-303"></span><span id="local-6989586621679228133"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addDotEdge"><span class="hs-identifier hs-type">addDotEdge</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228133"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228133"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228133"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228133"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-304"></span><span id="addDotEdge"><span class="annot"><span class="annottext">addDotEdge :: forall n. Ord n =&gt; DotEdge n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addDotEdge"><span class="hs-identifier hs-var hs-var">addDotEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span id="local-6989586621679229147"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229147"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229148"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229148"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679229149"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229149"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
forall n. Ord n =&gt; n -&gt; n -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEdge"><span class="hs-identifier hs-var">addEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229147"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229148"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229149"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | Add a new cluster to the graph; throws an error if the cluster</span><span>
</span><span id="line-307"></span><span class="hs-comment">--   already exists.  Assumes that it doesn't match the identifier of</span><span>
</span><span id="line-308"></span><span class="hs-comment">--   the overall graph.  If the parent cluster doesn't already exist</span><span>
</span><span id="line-309"></span><span class="hs-comment">--   in the graph then it will be added.</span><span>
</span><span id="line-310"></span><span id="local-6989586621679228136"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addCluster"><span class="hs-identifier hs-type">addCluster</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ The identifier for this cluster.</span></span><span>
</span><span id="line-311"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-comment">-- ^ The parent of this cluster</span><span>
</span><span id="line-312"></span><span>                               </span><span class="hs-comment">--   (@Nothing@ refers to the root</span><span>
</span><span id="line-313"></span><span>                               </span><span class="hs-comment">--   graph)</span><span>
</span><span id="line-314"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-315"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228136"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-316"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228136"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-317"></span><span id="addCluster"><span class="annot"><span class="annottext">addCluster :: forall n.
GraphID
-&gt; Maybe GraphID -&gt; [GlobalAttributes] -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addCluster"><span class="hs-identifier hs-var hs-var">addCluster</span></a></span></span><span> </span><span id="local-6989586621679229154"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229154"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229155"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229155"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span id="local-6989586621679229156"><span class="annot"><span class="annottext">[GlobalAttributes]
</span><a href="#local-6989586621679229156"><span class="hs-identifier hs-var">gas</span></a></span></span><span> </span><span id="local-6989586621679229157"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229157"><span class="hs-identifier hs-var">dg</span></a></span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229154"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID ClusterInfo -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#member"><span class="hs-operator hs-var">`M.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229159"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DotGraph n
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cluster already exists in the graph&quot;</span></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
forall n. Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-var">addEmptyCluster</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229155"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-320"></span><span>                      </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229157"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-type">M.insert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229154"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229162"><span class="hs-identifier hs-type">ci</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229159"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679229159"><span class="annot"><span class="annottext">cs :: Map GraphID ClusterInfo
</span><a href="#local-6989586621679229159"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229157"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679229162"><span class="annot"><span class="annottext">ci :: ClusterInfo
</span><a href="#local-6989586621679229162"><span class="hs-identifier hs-var hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; GlobAttrs -&gt; ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#CI"><span class="hs-identifier hs-var">CI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229155"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; ClusterInfo) -&gt; GlobAttrs -&gt; ClusterInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes] -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#toGlobAttrs"><span class="hs-identifier hs-var">toGlobAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes]
</span><a href="#local-6989586621679229156"><span class="hs-identifier hs-var">gas</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- Used to make sure that the parent cluster exists</span><span>
</span><span id="line-326"></span><span id="local-6989586621679228120"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-type">addEmptyCluster</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228120"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228120"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-327"></span><span id="addEmptyCluster"><span class="annot"><span class="annottext">addEmptyCluster :: forall n. Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-var hs-var">addEmptyCluster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (GraphID -&gt; DotGraph n -&gt; DotGraph n)
-&gt; Maybe GraphID
-&gt; DotGraph n
-&gt; DotGraph n
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
forall n.
(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withClusters"><span class="hs-identifier hs-var">withClusters</span></a></span><span> </span><span class="annot"><span class="annottext">((Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
 -&gt; DotGraph n -&gt; DotGraph n)
-&gt; (GraphID -&gt; Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; GraphID
-&gt; DotGraph n
-&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID
-&gt; ClusterInfo
-&gt; Map GraphID ClusterInfo
-&gt; Map GraphID ClusterInfo
forall {a}. GraphID -&gt; a -&gt; Map GraphID a -&gt; Map GraphID a
</span><a href="#local-6989586621679229167"><span class="hs-operator hs-var">`dontReplace`</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229168"><span class="hs-identifier hs-var">defCI</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679229167"><span class="annot"><span class="annottext">dontReplace :: GraphID -&gt; a -&gt; Map GraphID a -&gt; Map GraphID a
</span><a href="#local-6989586621679229167"><span class="hs-identifier hs-var hs-var">dontReplace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; GraphID -&gt; a -&gt; Map GraphID a -&gt; Map GraphID a
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a -&gt; a
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679229168"><span class="annot"><span class="annottext">defCI :: ClusterInfo
</span><a href="#local-6989586621679229168"><span class="hs-identifier hs-var hs-var">defCI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; GlobAttrs -&gt; ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#CI"><span class="hs-identifier hs-var">CI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#emptyGA"><span class="hs-identifier hs-var">emptyGA</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-comment">-- | Specify the parent of the cluster; adds both in if not already present.</span></span><span>
</span><span id="line-333"></span><span id="local-6989586621679228153"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#setClusterParent"><span class="hs-identifier hs-type">setClusterParent</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228153"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228153"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-334"></span><span id="setClusterParent"><span class="annot"><span class="annottext">setClusterParent :: forall n. GraphID -&gt; Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#setClusterParent"><span class="hs-identifier hs-var hs-var">setClusterParent</span></a></span></span><span> </span><span id="local-6989586621679229173"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229173"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229174"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229174"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
forall n.
(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withClusters"><span class="hs-identifier hs-var">withClusters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ClusterInfo -&gt; ClusterInfo)
-&gt; GraphID -&gt; Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; ClusterInfo
</span><a href="#local-6989586621679229175"><span class="hs-identifier hs-var">setP</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229173"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall {n}. DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229176"><span class="hs-identifier hs-var">addCs</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679229176"><span class="annot"><span class="annottext">addCs :: DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229176"><span class="hs-identifier hs-var hs-var">addCs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
forall n. Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-var">addEmptyCluster</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229174"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
forall n. Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-var">addEmptyCluster</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Maybe GraphID
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229173"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679229175"><span class="annot"><span class="annottext">setP :: ClusterInfo -&gt; ClusterInfo
</span><a href="#local-6989586621679229175"><span class="hs-identifier hs-var hs-var">setP</span></a></span></span><span> </span><span id="local-6989586621679229177"><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229177"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229177"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229174"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- | Specify the attributes of the cluster; adds it if not already</span><span>
</span><span id="line-340"></span><span class="hs-comment">--   present.</span><span>
</span><span id="line-341"></span><span id="local-6989586621679228156"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#setClusterAttributes"><span class="hs-identifier hs-type">setClusterAttributes</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228156"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228156"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-343"></span><span id="setClusterAttributes"><span class="annot"><span class="annottext">setClusterAttributes :: forall n. GraphID -&gt; [GlobalAttributes] -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#setClusterAttributes"><span class="hs-identifier hs-var hs-var">setClusterAttributes</span></a></span></span><span> </span><span id="local-6989586621679229179"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229179"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229180"><span class="annot"><span class="annottext">[GlobalAttributes]
</span><a href="#local-6989586621679229180"><span class="hs-identifier hs-var">gas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
forall n.
(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withClusters"><span class="hs-identifier hs-var">withClusters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ClusterInfo -&gt; ClusterInfo)
-&gt; GraphID -&gt; Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; ClusterInfo
</span><a href="#local-6989586621679229181"><span class="hs-identifier hs-var">setAs</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229179"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>                             </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
forall n. Maybe GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addEmptyCluster"><span class="hs-identifier hs-var">addEmptyCluster</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Maybe GraphID
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229179"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679229181"><span class="annot"><span class="annottext">setAs :: ClusterInfo -&gt; ClusterInfo
</span><a href="#local-6989586621679229181"><span class="hs-identifier hs-var hs-var">setAs</span></a></span></span><span> </span><span id="local-6989586621679229182"><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229182"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229182"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusterAttrs"><span class="hs-identifier hs-var">clusterAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#toGlobAttrs"><span class="hs-identifier hs-type">toGlobAttrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229180"><span class="hs-identifier hs-type">gas</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><span class="hs-comment">-- | Create a graph with no clusters.</span></span><span>
</span><span id="line-349"></span><span id="local-6989586621679228158"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#mkGraph"><span class="hs-identifier hs-type">mkGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228158"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228158"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228158"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228158"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-350"></span><span id="mkGraph"><span class="annot"><span class="annottext">mkGraph :: forall n. Ord n =&gt; [DotNode n] -&gt; [DotEdge n] -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#mkGraph"><span class="hs-identifier hs-var hs-var">mkGraph</span></a></span></span><span> </span><span id="local-6989586621679229188"><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679229188"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621679229189"><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679229189"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; [DotEdge n] -&gt; DotGraph n)
-&gt; [DotEdge n] -&gt; DotGraph n -&gt; DotGraph n
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotEdge n -&gt; DotGraph n)
-&gt; DotGraph n -&gt; [DotEdge n] -&gt; DotGraph n
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">((DotGraph n -&gt; DotEdge n -&gt; DotGraph n)
 -&gt; DotGraph n -&gt; [DotEdge n] -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotEdge n -&gt; DotGraph n)
-&gt; DotGraph n
-&gt; [DotEdge n]
-&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; DotGraph n -&gt; DotGraph n)
-&gt; DotGraph n -&gt; DotEdge n -&gt; DotGraph n
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; DotGraph n -&gt; DotGraph n
forall n. Ord n =&gt; DotEdge n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addDotEdge"><span class="hs-identifier hs-var">addDotEdge</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679229189"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-351"></span><span>                </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotNode n -&gt; DotGraph n)
-&gt; DotGraph n -&gt; [DotNode n] -&gt; DotGraph n
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DotNode n -&gt; DotGraph n -&gt; DotGraph n)
-&gt; DotGraph n -&gt; DotNode n -&gt; DotGraph n
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">DotNode n -&gt; DotGraph n -&gt; DotGraph n
forall n. Ord n =&gt; DotNode n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#addDotNode"><span class="hs-identifier hs-var">addDotNode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DotGraph n
forall n. DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#emptyGraph"><span class="hs-identifier hs-var">emptyGraph</span></a></span><span> </span><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679229188"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | Convert this DotGraph into canonical form.  All edges are found</span><span>
</span><span id="line-354"></span><span class="hs-comment">--   in the outer graph rather than in clusters.</span><span>
</span><span id="line-355"></span><span id="local-6989586621679228004"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#toCanonical"><span class="hs-identifier hs-type">toCanonical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228004"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">C.DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228004"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-356"></span><span id="toCanonical"><span class="annot"><span class="annottext">toCanonical :: forall n. DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#toCanonical"><span class="hs-identifier hs-var hs-var">toCanonical</span></a></span></span><span> </span><span id="local-6989586621679229191"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">C.DotGraph</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">strictGraph :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#strictGraph"><span class="hs-identifier hs-var">C.strictGraph</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-357"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">directedGraph :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#directedGraph"><span class="hs-identifier hs-var">C.directedGraph</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-358"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphID :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#graphID"><span class="hs-identifier hs-var">C.graphID</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Maybe GraphID
forall n. DotGraph n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-359"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphStatements :: DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#graphStatements"><span class="hs-identifier hs-var">C.graphStatements</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229197"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-360"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679229197"><span class="annot"><span class="annottext">stmts :: DotStatements n
</span><a href="#local-6989586621679229197"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStmts"><span class="hs-identifier hs-type">C.DotStmts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">attrStmts :: [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">C.attrStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#fromGlobAttrs"><span class="hs-identifier hs-var">fromGlobAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; [GlobalAttributes])
-&gt; GlobAttrs -&gt; [GlobalAttributes]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; GlobAttrs
forall n. DotGraph n -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var">graphAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-363"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">subGraphs :: [DotSubGraph n]
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">C.subGraphs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679229202"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-364"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nodeStmts :: [DotNode n]
</span><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">C.nodeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679229204"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-365"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgeStmts :: [DotEdge n]
</span><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">C.edgeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DotGraph n -&gt; [DotEdge n]
forall n. Bool -&gt; DotGraph n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-366"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679229207"><span class="annot"><span class="annottext">cls :: Map GraphID ClusterInfo
</span><a href="#local-6989586621679229207"><span class="hs-identifier hs-var hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span id="local-6989586621679229208"><span class="annot"><span class="annottext">pM :: Map GraphID (Seq GraphID)
</span><a href="#local-6989586621679229208"><span class="hs-identifier hs-var hs-var">pM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID (Seq GraphID)
forall n. DotGraph n -&gt; Map GraphID (Seq GraphID)
</span><a href="Data.GraphViz.Types.Graph.html#clusterPath%27"><span class="hs-identifier hs-var">clusterPath'</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621679229211"><span class="annot"><span class="annottext">clustAs :: GraphID -&gt; [GlobalAttributes]
</span><a href="#local-6989586621679229211"><span class="hs-identifier hs-var hs-var">clustAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes]
-&gt; (ClusterInfo -&gt; [GlobalAttributes])
-&gt; Maybe ClusterInfo
-&gt; [GlobalAttributes]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobAttrs -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#fromGlobAttrs"><span class="hs-identifier hs-var">fromGlobAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; [GlobalAttributes])
-&gt; (ClusterInfo -&gt; GlobAttrs) -&gt; ClusterInfo -&gt; [GlobalAttributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#clusterAttrs"><span class="hs-identifier hs-var">clusterAttrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe ClusterInfo -&gt; [GlobalAttributes])
-&gt; (GraphID -&gt; Maybe ClusterInfo) -&gt; GraphID -&gt; [GlobalAttributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID ClusterInfo -&gt; Maybe ClusterInfo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229207"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679229213"><span class="annot"><span class="annottext">lns :: [(n, (Maybe GraphID, Attributes))]
</span><a href="#local-6989586621679229213"><span class="hs-identifier hs-var hs-var">lns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, NodeInfo n) -&gt; (n, (Maybe GraphID, Attributes)))
-&gt; [(n, NodeInfo n)] -&gt; [(n, (Maybe GraphID, Attributes))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229214"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229214"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229215"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229215"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229214"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeInfo n -&gt; Maybe GraphID
forall n. NodeInfo n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229215"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Attributes
forall n. NodeInfo n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Graph.html#_attributes"><span class="hs-identifier hs-var">_attributes</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229215"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>          </span><span class="annot"><span class="annottext">([(n, NodeInfo n)] -&gt; [(n, (Maybe GraphID, Attributes))])
-&gt; (Map n (NodeInfo n) -&gt; [(n, NodeInfo n)])
-&gt; Map n (NodeInfo n)
-&gt; [(n, (Maybe GraphID, Attributes))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n) -&gt; [(n, NodeInfo n)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#assocs"><span class="hs-identifier hs-var">M.assocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; [(n, (Maybe GraphID, Attributes))])
-&gt; Map n (NodeInfo n) -&gt; [(n, (Maybe GraphID, Attributes))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229191"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679229202"><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679229202"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229204"><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679229204"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, (Maybe GraphID, Attributes))
 -&gt; NodeCluster GraphID (n, Attributes))
-&gt; (GraphID -&gt; Bool)
-&gt; (GraphID -&gt; GraphID)
-&gt; (GraphID -&gt; [GlobalAttributes])
-&gt; ((n, Attributes) -&gt; Attributes)
-&gt; [(n, (Maybe GraphID, Attributes))]
-&gt; ([DotSubGraph n], [DotNode n])
forall c n a l.
Ord c =&gt;
((n, a) -&gt; NodeCluster c (n, l))
-&gt; (c -&gt; Bool)
-&gt; (c -&gt; GraphID)
-&gt; (c -&gt; [GlobalAttributes])
-&gt; ((n, l) -&gt; Attributes)
-&gt; [(n, a)]
-&gt; ([DotSubGraph n], [DotNode n])
</span><a href="Data.GraphViz.Algorithms.Clustering.html#clustersToNodes"><span class="hs-identifier hs-var">clustersToNodes</span></a></span><span> </span><span class="annot"><span class="annottext">(n, (Maybe GraphID, Attributes))
-&gt; NodeCluster GraphID (n, Attributes)
forall {a} {b}.
(a, (Maybe GraphID, b)) -&gt; NodeCluster GraphID (a, b)
</span><a href="#local-6989586621679229219"><span class="hs-identifier hs-var">pathOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; GraphID -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; GraphID
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; [GlobalAttributes]
</span><a href="#local-6989586621679229211"><span class="hs-identifier hs-var">clustAs</span></a></span><span> </span><span class="annot"><span class="annottext">(n, Attributes) -&gt; Attributes
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, (Maybe GraphID, Attributes))]
</span><a href="#local-6989586621679229213"><span class="hs-identifier hs-var">lns</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679229219"><span class="annot"><span class="annottext">pathOf :: (a, (Maybe GraphID, b)) -&gt; NodeCluster GraphID (a, b)
</span><a href="#local-6989586621679229219"><span class="hs-identifier hs-var hs-var">pathOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229221"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229221"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679229222"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229222"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229223"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679229223"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; (a, b) -&gt; NodeCluster GraphID (a, b)
forall {a}. Maybe GraphID -&gt; a -&gt; NodeCluster GraphID a
</span><a href="#local-6989586621679229224"><span class="hs-identifier hs-var">pathFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229222"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229221"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679229223"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621679229224"><span class="annot"><span class="annottext">pathFrom :: Maybe GraphID -&gt; a -&gt; NodeCluster GraphID a
</span><a href="#local-6989586621679229224"><span class="hs-identifier hs-var hs-var">pathFrom</span></a></span></span><span> </span><span id="local-6989586621679229230"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229230"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229231"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229231"><span class="hs-identifier hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; NodeCluster GraphID a -&gt; NodeCluster GraphID a)
-&gt; NodeCluster GraphID a -&gt; Seq GraphID -&gt; NodeCluster GraphID a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Seq a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">F.foldr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; NodeCluster GraphID a -&gt; NodeCluster GraphID a
forall c a. c -&gt; NodeCluster c a -&gt; NodeCluster c a
</span><a href="Data.GraphViz.Algorithms.Clustering.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; NodeCluster GraphID a
forall c a. a -&gt; NodeCluster c a
</span><a href="Data.GraphViz.Algorithms.Clustering.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229231"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq GraphID -&gt; NodeCluster GraphID a)
-&gt; (Maybe (Seq GraphID) -&gt; Seq GraphID)
-&gt; Maybe (Seq GraphID)
-&gt; NodeCluster GraphID a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Seq GraphID -&gt; Maybe (Seq GraphID) -&gt; Seq GraphID
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Seq GraphID
forall a. Seq a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">Seq.empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Seq GraphID) -&gt; NodeCluster GraphID a)
-&gt; Maybe (Seq GraphID) -&gt; NodeCluster GraphID a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID (Seq GraphID) -&gt; Maybe (Seq GraphID)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span class="annot"><span class="annottext">Map GraphID (Seq GraphID)
</span><a href="#local-6989586621679229208"><span class="hs-identifier hs-var">pM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe (Seq GraphID))
-&gt; Maybe GraphID -&gt; Maybe (Seq GraphID)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229230"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- Deconstruction</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | A partial inverse of @'&amp;'@, in that if a node exists in a graph</span><span>
</span><span id="line-385"></span><span class="hs-comment">--   then it will be decomposed, but will not remove the cluster that</span><span>
</span><span id="line-386"></span><span class="hs-comment">--   it was in even if it was the only node in that cluster.</span><span>
</span><span id="line-387"></span><span id="local-6989586621679228190"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#decompose"><span class="hs-identifier hs-type">decompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228190"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228190"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228190"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228190"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228190"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-388"></span><span id="decompose"><span class="annot"><span class="annottext">decompose :: forall n. Ord n =&gt; n -&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
</span><a href="Data.GraphViz.Types.Graph.html#decompose"><span class="hs-identifier hs-var hs-var">decompose</span></a></span></span><span> </span><span id="local-6989586621679229239"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229239"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229240"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229240"><span class="hs-identifier hs-var">dg</span></a></span></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229239"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; Map n (NodeInfo n) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#notMember"><span class="hs-operator hs-var">`M.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229242"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Context n, DotGraph n)
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context n, DotGraph n) -&gt; Maybe (Context n, DotGraph n)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context n
</span><a href="#local-6989586621679229243"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229244"><span class="hs-identifier hs-var">dg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679229242"><span class="annot"><span class="annottext">ns :: Map n (NodeInfo n)
</span><a href="#local-6989586621679229242"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229240"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-type">NI</span></a></span><span> </span><span id="local-6989586621679229247"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229247"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621679229248"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229248"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679229249"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229249"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679229250"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229250"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229251"><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229251"><span class="hs-identifier hs-var">ns'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; NodeInfo n -&gt; Maybe (NodeInfo n))
-&gt; n
-&gt; Map n (NodeInfo n)
-&gt; (Maybe (NodeInfo n), Map n (NodeInfo n))
forall k a.
Ord k =&gt;
(k -&gt; a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; (Maybe a, Map k a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#updateLookupWithKey"><span class="hs-identifier hs-var">M.updateLookupWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (NodeInfo n) -&gt; NodeInfo n -&gt; Maybe (NodeInfo n)
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (NodeInfo n) -&gt; NodeInfo n -&gt; Maybe (NodeInfo n))
-&gt; (n -&gt; Maybe (NodeInfo n))
-&gt; n
-&gt; NodeInfo n
-&gt; Maybe (NodeInfo n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NodeInfo n) -&gt; n -&gt; Maybe (NodeInfo n)
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NodeInfo n)
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229239"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229242"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679229243"><span class="annot"><span class="annottext">c :: Context n
</span><a href="#local-6989586621679229243"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
-&gt; Maybe GraphID
-&gt; Attributes
-&gt; [(n, Attributes)]
-&gt; [(n, Attributes)]
-&gt; Context n
forall n.
n
-&gt; Maybe GraphID
-&gt; Attributes
-&gt; [(n, Attributes)]
-&gt; [(n, Attributes)]
-&gt; Context n
</span><a href="Data.GraphViz.Types.Graph.html#Cntxt"><span class="hs-identifier hs-var">Cntxt</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229239"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229247"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229248"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeMap n -&gt; [(n, Attributes)]
forall n. EdgeMap n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-var">fromMap</span></a></span><span> </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; [(n, Attributes)]) -&gt; EdgeMap n -&gt; [(n, Attributes)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229239"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-operator hs-var">`M.delete`</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229249"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeMap n -&gt; [(n, Attributes)]
forall n. EdgeMap n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-var">fromMap</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229250"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>    </span><span id="local-6989586621679229244"><span class="annot"><span class="annottext">dg' :: DotGraph n
</span><a href="#local-6989586621679229244"><span class="hs-identifier hs-var hs-var">dg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229240"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#delSucc"><span class="hs-identifier hs-type">delSucc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229239"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229249"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#delPred"><span class="hs-identifier hs-type">delPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229239"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229250"><span class="hs-identifier hs-type">ss</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229251"><span class="hs-identifier hs-type">ns'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | As with 'decompose', but do not specify /which/ node to</span><span>
</span><span id="line-399"></span><span class="hs-comment">--   decompose.</span><span>
</span><span id="line-400"></span><span id="local-6989586621679228195"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#decomposeAny"><span class="hs-identifier hs-type">decomposeAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228195"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228195"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228195"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228195"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-401"></span><span id="decomposeAny"><span class="annot"><span class="annottext">decomposeAny :: forall n. Ord n =&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
</span><a href="Data.GraphViz.Types.Graph.html#decomposeAny"><span class="hs-identifier hs-var hs-var">decomposeAny</span></a></span></span><span> </span><span id="local-6989586621679229262"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229262"><span class="hs-identifier hs-var">dg</span></a></span></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229262"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Context n, DotGraph n)
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
forall n. Ord n =&gt; n -&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
</span><a href="Data.GraphViz.Types.Graph.html#decompose"><span class="hs-identifier hs-var">decompose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n, NodeInfo n) -&gt; n
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((n, NodeInfo n) -&gt; n)
-&gt; (Map n (NodeInfo n) -&gt; (n, NodeInfo n))
-&gt; Map n (NodeInfo n)
-&gt; n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n) -&gt; (n, NodeInfo n)
forall k a. Map k a -&gt; (k, a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#findMin"><span class="hs-identifier hs-var">M.findMin</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; n) -&gt; Map n (NodeInfo n) -&gt; n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229262"><span class="hs-identifier hs-var">dg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229262"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-- | Recursively decompose the Dot graph into a list of contexts such</span><span>
</span><span id="line-406"></span><span class="hs-comment">--   that if @(c:cs) = decomposeList dg@, then @dg = c &amp; 'composeList' cs@.</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">--   Note that all global attributes are lost, so this is /not/</span><span>
</span><span id="line-409"></span><span class="hs-comment">--   suitable for representing a Dot graph on its own.</span><span>
</span><span id="line-410"></span><span id="local-6989586621679228201"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#decomposeList"><span class="hs-identifier hs-type">decomposeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228201"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228201"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228201"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-411"></span><span id="decomposeList"><span class="annot"><span class="annottext">decomposeList :: forall n. Ord n =&gt; DotGraph n -&gt; [Context n]
</span><a href="Data.GraphViz.Types.Graph.html#decomposeList"><span class="hs-identifier hs-var hs-var">decomposeList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; Maybe (Context n, DotGraph n))
-&gt; DotGraph n -&gt; [Context n]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#unfoldr"><span class="hs-identifier hs-var">unfoldr</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Maybe (Context n, DotGraph n)
forall n. Ord n =&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
</span><a href="Data.GraphViz.Types.Graph.html#decomposeAny"><span class="hs-identifier hs-var">decomposeAny</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span id="local-6989586621679228194"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#delSucc"><span class="hs-identifier hs-type">delSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228194"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228194"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228194"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228194"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228194"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-414"></span><span id="delSucc"><span class="annot"><span class="annottext">delSucc :: forall n. Ord n =&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delSucc"><span class="hs-identifier hs-var hs-var">delSucc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
forall n.
Ord n =&gt;
((EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delPS"><span class="hs-identifier hs-var">delPS</span></a></span><span> </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSucc"><span class="hs-identifier hs-var">niSucc</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span id="local-6989586621679229270"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#delPred"><span class="hs-identifier hs-type">delPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229270"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229270"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229270"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229270"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229270"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-417"></span><span id="delPred"><span class="annot"><span class="annottext">delPred :: forall n. Ord n =&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delPred"><span class="hs-identifier hs-var hs-var">delPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
forall n.
Ord n =&gt;
((EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delPS"><span class="hs-identifier hs-var">delPS</span></a></span><span> </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niPred"><span class="hs-identifier hs-var">niPred</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- Only takes in EdgeMap rather than [n] to make it easier to call</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- from decompose</span><span>
</span><span id="line-421"></span><span id="local-6989586621679228206"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#delPS"><span class="hs-identifier hs-type">delPS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228206"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-423"></span><span id="delPS"><span class="annot"><span class="annottext">delPS :: forall n.
Ord n =&gt;
((EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delPS"><span class="hs-identifier hs-var hs-var">delPS</span></a></span></span><span> </span><span id="local-6989586621679229277"><span class="annot"><span class="annottext">(EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229277"><span class="hs-identifier hs-var">fni</span></a></span></span><span> </span><span id="local-6989586621679229278"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229278"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679229279"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229279"><span class="hs-identifier hs-var">fm</span></a></span></span><span> </span><span id="local-6989586621679229280"><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229280"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; n -&gt; NodeMap n) -&gt; NodeMap n -&gt; [n] -&gt; NodeMap n
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; n -&gt; NodeMap n
forall {k}. Ord k =&gt; Map k (NodeInfo n) -&gt; k -&gt; Map k (NodeInfo n)
</span><a href="#local-6989586621679229281"><span class="hs-identifier hs-var">delE</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229280"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; NodeMap n) -&gt; [n] -&gt; NodeMap n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n -&gt; [n]
forall k a. Map k a -&gt; [k]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">M.keys</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229279"><span class="hs-identifier hs-var">fm</span></a></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621679229281"><span class="annot"><span class="annottext">delE :: Map k (NodeInfo n) -&gt; k -&gt; Map k (NodeInfo n)
</span><a href="#local-6989586621679229281"><span class="hs-identifier hs-var hs-var">delE</span></a></span></span><span> </span><span id="local-6989586621679229289"><span class="annot"><span class="annottext">Map k (NodeInfo n)
</span><a href="#local-6989586621679229289"><span class="hs-identifier hs-var">nm'</span></a></span></span><span> </span><span id="local-6989586621679229290"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679229290"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n)
-&gt; k -&gt; Map k (NodeInfo n) -&gt; Map k (NodeInfo n)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229277"><span class="hs-identifier hs-var">fni</span></a></span><span> </span><span class="annot"><span class="annottext">((EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n)
-&gt; (EdgeMap n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; NodeInfo n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">M.delete</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229278"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679229290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (NodeInfo n)
</span><a href="#local-6989586621679229289"><span class="hs-identifier hs-var">nm'</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Delete the specified node from the graph; returns the original</span><span>
</span><span id="line-428"></span><span class="hs-comment">--   graph if that node isn't present.</span><span>
</span><span id="line-429"></span><span id="local-6989586621679228212"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteNode"><span class="hs-identifier hs-type">deleteNode</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228212"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228212"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228212"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228212"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-430"></span><span id="deleteNode"><span class="annot"><span class="annottext">deleteNode :: forall n. Ord n =&gt; n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#deleteNode"><span class="hs-identifier hs-var hs-var">deleteNode</span></a></span></span><span> </span><span id="local-6989586621679229293"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229293"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229294"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229294"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
-&gt; ((Context n, DotGraph n) -&gt; DotGraph n)
-&gt; Maybe (Context n, DotGraph n)
-&gt; DotGraph n
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229294"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">(Context n, DotGraph n) -&gt; DotGraph n
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Context n, DotGraph n) -&gt; DotGraph n)
-&gt; Maybe (Context n, DotGraph n) -&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
forall n. Ord n =&gt; n -&gt; DotGraph n -&gt; Maybe (Context n, DotGraph n)
</span><a href="Data.GraphViz.Types.Graph.html#decompose"><span class="hs-identifier hs-var">decompose</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229293"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229294"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- | Delete all edges between the two nodes; returns the original</span><span>
</span><span id="line-433"></span><span class="hs-comment">--   graph if there are no edges.</span><span>
</span><span id="line-434"></span><span id="local-6989586621679228214"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteAllEdges"><span class="hs-identifier hs-type">deleteAllEdges</span></a></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228214"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228214"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228214"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228214"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228214"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-435"></span><span id="deleteAllEdges"><span class="annot"><span class="annottext">deleteAllEdges :: forall n. Ord n =&gt; n -&gt; n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#deleteAllEdges"><span class="hs-identifier hs-var hs-var">deleteAllEdges</span></a></span></span><span> </span><span id="local-6989586621679229298"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229298"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679229299"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229299"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
forall n. (NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-var">withValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
forall {n}. Ord n =&gt; n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229300"><span class="hs-identifier hs-var">delAE</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229298"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229299"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n)
-&gt; (NodeMap n -&gt; NodeMap n) -&gt; NodeMap n -&gt; NodeMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
forall {n}. Ord n =&gt; n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229300"><span class="hs-identifier hs-var">delAE</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229299"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229298"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679229300"><span class="annot"><span class="annottext">delAE :: n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229300"><span class="hs-identifier hs-var hs-var">delAE</span></a></span></span><span> </span><span id="local-6989586621679229306"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229306"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229307"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229307"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
forall n. Ord n =&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delSucc"><span class="hs-identifier hs-var">delSucc</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229306"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
forall {a}. Map n [a]
</span><a href="#local-6989586621679229308"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n)
-&gt; (NodeMap n -&gt; NodeMap n) -&gt; NodeMap n -&gt; NodeMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
forall n. Ord n =&gt; n -&gt; EdgeMap n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#delPred"><span class="hs-identifier hs-var">delPred</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229306"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
forall {a}. Map n [a]
</span><a href="#local-6989586621679229308"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679229308"><span class="annot"><span class="annottext">t' :: Map n [a]
</span><a href="#local-6989586621679229308"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; [a] -&gt; Map n [a]
forall k a. k -&gt; a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229307"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | Deletes the specified edge from the DotGraph (note: for unordered</span><span>
</span><span id="line-442"></span><span class="hs-comment">--   graphs both orientations are considered).</span><span>
</span><span id="line-443"></span><span id="local-6989586621679229310"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteEdge"><span class="hs-identifier hs-type">deleteEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229310"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229310"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229310"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229310"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229310"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-444"></span><span id="deleteEdge"><span class="annot"><span class="annottext">deleteEdge :: forall n. Ord n =&gt; n -&gt; n -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#deleteEdge"><span class="hs-identifier hs-var hs-var">deleteEdge</span></a></span></span><span> </span><span id="local-6989586621679229313"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229313"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679229314"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229314"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span id="local-6989586621679229315"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229315"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679229316"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229316"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
forall n. (NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-var">withValues</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229317"><span class="hs-identifier hs-var">delEs</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229316"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679229328"><span class="annot"><span class="annottext">delE :: n -&gt; n -&gt; Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
</span><a href="#local-6989586621679229328"><span class="hs-identifier hs-var hs-var">delE</span></a></span></span><span> </span><span id="local-6989586621679229329"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229329"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229330"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229330"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSucc"><span class="hs-identifier hs-var">niSucc</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n -&gt; UpdateEdgeMap n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Attributes] -&gt; [Attributes])
-&gt; n -&gt; Map n [Attributes] -&gt; Map n [Attributes]
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; [Attributes] -&gt; [Attributes]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229315"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229330"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229329"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-447"></span><span>               </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; Map n (NodeInfo n))
-&gt; (Map n (NodeInfo n) -&gt; Map n (NodeInfo n))
-&gt; Map n (NodeInfo n)
-&gt; Map n (NodeInfo n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n)
-&gt; n -&gt; Map n (NodeInfo n) -&gt; Map n (NodeInfo n)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdateEdgeMap n
forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niPred"><span class="hs-identifier hs-var">niPred</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateEdgeMap n -&gt; UpdateEdgeMap n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Attributes] -&gt; [Attributes])
-&gt; n -&gt; Map n [Attributes] -&gt; Map n [Attributes]
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; [Attributes] -&gt; [Attributes]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229315"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229329"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229330"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621679229317"><span class="annot"><span class="annottext">delEs :: NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229317"><span class="hs-identifier hs-var hs-var">delEs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229316"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
forall {n}. Ord n =&gt; n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229328"><span class="hs-identifier hs-var">delE</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229313"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229314"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-450"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
forall {n}. Ord n =&gt; n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229328"><span class="hs-identifier hs-var">delE</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229313"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229314"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n)
-&gt; (NodeMap n -&gt; NodeMap n) -&gt; NodeMap n -&gt; NodeMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
forall {n}. Ord n =&gt; n -&gt; n -&gt; NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229328"><span class="hs-identifier hs-var">delE</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229314"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229313"><span class="hs-identifier hs-var">n1</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- | As with 'deleteEdge' but takes a 'DotEdge' rather than individual</span><span>
</span><span id="line-453"></span><span class="hs-comment">--   values.</span><span>
</span><span id="line-454"></span><span id="local-6989586621679229335"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteDotEdge"><span class="hs-identifier hs-type">deleteDotEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229335"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229335"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229335"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229335"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-455"></span><span id="deleteDotEdge"><span class="annot"><span class="annottext">deleteDotEdge :: forall n. Ord n =&gt; DotEdge n -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#deleteDotEdge"><span class="hs-identifier hs-var hs-var">deleteDotEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span id="local-6989586621679229338"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229338"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679229339"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229339"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span id="local-6989586621679229340"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229340"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
forall n. Ord n =&gt; n -&gt; n -&gt; Attributes -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#deleteEdge"><span class="hs-identifier hs-var">deleteEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229338"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229339"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229340"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | Delete the specified cluster, and makes any clusters or nodes</span><span>
</span><span id="line-458"></span><span class="hs-comment">--   within it be in its root cluster (or the overall graph if</span><span>
</span><span id="line-459"></span><span class="hs-comment">--   required).</span><span>
</span><span id="line-460"></span><span id="local-6989586621679228224"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#deleteCluster"><span class="hs-identifier hs-type">deleteCluster</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228224"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228224"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-461"></span><span id="deleteCluster"><span class="annot"><span class="annottext">deleteCluster :: forall n. GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#deleteCluster"><span class="hs-identifier hs-var hs-var">deleteCluster</span></a></span></span><span> </span><span id="local-6989586621679229342"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229342"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229343"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229343"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
forall n. (NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-var">withValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n) -&gt; NodeMap n -&gt; NodeMap n
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; NodeInfo n
forall {n}. NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229345"><span class="hs-identifier hs-var">adjNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                     </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
forall n.
(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withClusters"><span class="hs-identifier hs-var">withClusters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ClusterInfo -&gt; ClusterInfo)
-&gt; Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; ClusterInfo
</span><a href="#local-6989586621679229346"><span class="hs-identifier hs-var">adjCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; (Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; Map GraphID ClusterInfo
-&gt; Map GraphID ClusterInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">M.delete</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                     </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229343"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679229349"><span class="annot"><span class="annottext">p :: Maybe GraphID
</span><a href="#local-6989586621679229349"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(ClusterInfo -&gt; Maybe GraphID)
-&gt; Maybe ClusterInfo -&gt; Maybe GraphID
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229342"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID ClusterInfo -&gt; Maybe ClusterInfo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229343"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621679229352"><span class="annot"><span class="annottext">adjParent :: Maybe GraphID -&gt; Maybe GraphID
</span><a href="#local-6989586621679229352"><span class="hs-identifier hs-var hs-var">adjParent</span></a></span></span><span> </span><span id="local-6989586621679229353"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229353"><span class="hs-identifier hs-var">p'</span></a></span></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229353"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; Maybe GraphID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Maybe GraphID
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229342"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229349"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229353"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679229345"><span class="annot"><span class="annottext">adjNode :: NodeInfo n -&gt; NodeInfo n
</span><a href="#local-6989586621679229345"><span class="hs-identifier hs-var hs-var">adjNode</span></a></span></span><span> </span><span id="local-6989586621679229354"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229354"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229354"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229352"><span class="hs-identifier hs-type">adjParent</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229354"><span class="hs-identifier hs-type">ni</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621679229346"><span class="annot"><span class="annottext">adjCluster :: ClusterInfo -&gt; ClusterInfo
</span><a href="#local-6989586621679229346"><span class="hs-identifier hs-var hs-var">adjCluster</span></a></span></span><span> </span><span id="local-6989586621679229355"><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229355"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229355"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229352"><span class="hs-identifier hs-type">adjParent</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229355"><span class="hs-identifier hs-type">ci</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><span class="hs-comment">-- | Remove clusters with no sub-clusters and no nodes within them.</span></span><span>
</span><span id="line-476"></span><span id="local-6989586621679229356"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#removeEmptyClusters"><span class="hs-identifier hs-type">removeEmptyClusters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229356"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229356"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-477"></span><span id="removeEmptyClusters"><span class="annot"><span class="annottext">removeEmptyClusters :: forall {n}. DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#removeEmptyClusters"><span class="hs-identifier hs-var hs-var">removeEmptyClusters</span></a></span></span><span> </span><span id="local-6989586621679229357"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229357"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229357"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229358"><span class="hs-identifier hs-type">cM'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621679229359"><span class="annot"><span class="annottext">cM :: Map GraphID ClusterInfo
</span><a href="#local-6989586621679229359"><span class="hs-identifier hs-var hs-var">cM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229357"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679229358"><span class="annot"><span class="annottext">cM' :: Map GraphID ClusterInfo
</span><a href="#local-6989586621679229358"><span class="hs-identifier hs-var hs-var">cM'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229359"><span class="hs-identifier hs-var">cM</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
-&gt; Map GraphID [GraphID] -&gt; Map GraphID ClusterInfo
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#difference"><span class="hs-operator hs-var">`M.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID [GraphID]
</span><a href="#local-6989586621679229363"><span class="hs-identifier hs-var">invCs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
-&gt; Map GraphID [n] -&gt; Map GraphID ClusterInfo
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#difference"><span class="hs-operator hs-var">`M.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID [n]
</span><a href="#local-6989586621679229364"><span class="hs-identifier hs-var">invNs</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621679229363"><span class="annot"><span class="annottext">invCs :: Map GraphID [GraphID]
</span><a href="#local-6989586621679229363"><span class="hs-identifier hs-var hs-var">invCs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map GraphID (Maybe GraphID) -&gt; Map GraphID [GraphID]
forall {b}. Map b (Maybe GraphID) -&gt; Map GraphID [b]
</span><a href="#local-6989586621679229365"><span class="hs-identifier hs-var">usedClustsIn</span></a></span><span> </span><span class="annot"><span class="annottext">(Map GraphID (Maybe GraphID) -&gt; Map GraphID [GraphID])
-&gt; Map GraphID (Maybe GraphID) -&gt; Map GraphID [GraphID]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ClusterInfo -&gt; Maybe GraphID)
-&gt; Map GraphID ClusterInfo -&gt; Map GraphID (Maybe GraphID)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229359"><span class="hs-identifier hs-var">cM</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621679229364"><span class="annot"><span class="annottext">invNs :: Map GraphID [n]
</span><a href="#local-6989586621679229364"><span class="hs-identifier hs-var hs-var">invNs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map n (Maybe GraphID) -&gt; Map GraphID [n]
forall {b}. Map b (Maybe GraphID) -&gt; Map GraphID [b]
</span><a href="#local-6989586621679229365"><span class="hs-identifier hs-var">usedClustsIn</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (Maybe GraphID) -&gt; Map GraphID [n])
-&gt; (Map n (NodeInfo n) -&gt; Map n (Maybe GraphID))
-&gt; Map n (NodeInfo n)
-&gt; Map GraphID [n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; Maybe GraphID)
-&gt; Map n (NodeInfo n) -&gt; Map n (Maybe GraphID)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Maybe GraphID
forall n. NodeInfo n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; Map GraphID [n])
-&gt; Map n (NodeInfo n) -&gt; Map GraphID [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229357"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621679229365"><span class="annot"><span class="annottext">usedClustsIn :: Map b (Maybe GraphID) -&gt; Map GraphID [b]
</span><a href="#local-6989586621679229365"><span class="hs-identifier hs-var hs-var">usedClustsIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GraphID, [b])] -&gt; Map GraphID [b]
forall k a. Eq k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromAscList"><span class="hs-identifier hs-var">M.fromAscList</span></a></span><span>
</span><span id="line-486"></span><span>                   </span><span class="annot"><span class="annottext">([(GraphID, [b])] -&gt; Map GraphID [b])
-&gt; (Map b (Maybe GraphID) -&gt; [(GraphID, [b])])
-&gt; Map b (Maybe GraphID)
-&gt; Map GraphID [b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(GraphID, b)] -&gt; (GraphID, [b]))
-&gt; [[(GraphID, b)]] -&gt; [(GraphID, [b])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; [b] -&gt; (GraphID, [b]))
-&gt; ([(GraphID, b)] -&gt; GraphID)
-&gt; [(GraphID, b)]
-&gt; [b]
-&gt; (GraphID, [b])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphID, b) -&gt; GraphID
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((GraphID, b) -&gt; GraphID)
-&gt; ([(GraphID, b)] -&gt; (GraphID, b)) -&gt; [(GraphID, b)] -&gt; GraphID
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(GraphID, b)] -&gt; (GraphID, b)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">([(GraphID, b)] -&gt; [b] -&gt; (GraphID, [b]))
-&gt; ([(GraphID, b)] -&gt; [b]) -&gt; [(GraphID, b)] -&gt; (GraphID, [b])
forall a b.
([(GraphID, b)] -&gt; a -&gt; b)
-&gt; ([(GraphID, b)] -&gt; a) -&gt; [(GraphID, b)] -&gt; b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((GraphID, b) -&gt; b) -&gt; [(GraphID, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphID, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>                   </span><span class="annot"><span class="annottext">([[(GraphID, b)]] -&gt; [(GraphID, [b])])
-&gt; (Map b (Maybe GraphID) -&gt; [[(GraphID, b)]])
-&gt; Map b (Maybe GraphID)
-&gt; [(GraphID, [b])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((GraphID, b) -&gt; GraphID) -&gt; [(GraphID, b)] -&gt; [[(GraphID, b)]]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [[a]]
</span><a href="Data.GraphViz.Internal.Util.html#groupSortBy"><span class="hs-identifier hs-var">groupSortBy</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphID, b) -&gt; GraphID
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-488"></span><span>                   </span><span class="annot"><span class="annottext">([(GraphID, b)] -&gt; [[(GraphID, b)]])
-&gt; (Map b (Maybe GraphID) -&gt; [(GraphID, b)])
-&gt; Map b (Maybe GraphID)
-&gt; [[(GraphID, b)]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((b, Maybe GraphID) -&gt; Maybe (GraphID, b))
-&gt; [(b, Maybe GraphID)] -&gt; [(GraphID, b)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; Maybe GraphID -&gt; Maybe (GraphID, b))
-&gt; (b, Maybe GraphID) -&gt; Maybe (GraphID, b)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GraphID -&gt; (GraphID, b)) -&gt; Maybe GraphID -&gt; Maybe (GraphID, b)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">((GraphID -&gt; (GraphID, b)) -&gt; Maybe GraphID -&gt; Maybe (GraphID, b))
-&gt; (b -&gt; GraphID -&gt; (GraphID, b))
-&gt; b
-&gt; Maybe GraphID
-&gt; Maybe (GraphID, b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; b -&gt; (GraphID, b)) -&gt; b -&gt; GraphID -&gt; (GraphID, b)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>                   </span><span class="annot"><span class="annottext">([(b, Maybe GraphID)] -&gt; [(GraphID, b)])
-&gt; (Map b (Maybe GraphID) -&gt; [(b, Maybe GraphID)])
-&gt; Map b (Maybe GraphID)
-&gt; [(GraphID, b)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Maybe GraphID) -&gt; [(b, Maybe GraphID)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#assocs"><span class="hs-identifier hs-var">M.assocs</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- Information</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="annot"><span class="hs-comment">-- | Does this graph have any nodes?</span></span><span>
</span><span id="line-495"></span><span id="local-6989586621679229380"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229380"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-496"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n) -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; Bool)
-&gt; (DotGraph n -&gt; Map n (NodeInfo n)) -&gt; DotGraph n -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="annot"><span class="hs-comment">-- | Does this graph have any clusters?</span></span><span>
</span><span id="line-499"></span><span id="local-6989586621679229382"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#hasClusters"><span class="hs-identifier hs-type">hasClusters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229382"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-500"></span><span id="hasClusters"><span class="annot"><span class="annottext">hasClusters :: forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#hasClusters"><span class="hs-identifier hs-var hs-var">hasClusters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="annot"><span class="annottext">(Map GraphID ClusterInfo -&gt; Bool)
-&gt; (DotGraph n -&gt; Map GraphID ClusterInfo) -&gt; DotGraph n -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="annot"><span class="hs-comment">-- | Determine if this graph has nodes or clusters.</span></span><span>
</span><span id="line-503"></span><span id="local-6989586621679229383"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#isEmptyGraph"><span class="hs-identifier hs-type">isEmptyGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229383"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-504"></span><span id="isEmptyGraph"><span class="annot"><span class="annottext">isEmptyGraph :: forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#isEmptyGraph"><span class="hs-identifier hs-var hs-var">isEmptyGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (DotGraph n -&gt; Bool)
-&gt; (DotGraph n -&gt; Bool)
-&gt; DotGraph n
-&gt; Bool
forall a b c.
(a -&gt; b -&gt; c)
-&gt; (DotGraph n -&gt; a) -&gt; (DotGraph n -&gt; b) -&gt; DotGraph n -&gt; c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">(&amp;&amp;)</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (DotGraph n -&gt; Bool) -&gt; DotGraph n -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#hasClusters"><span class="hs-identifier hs-var">hasClusters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span id="local-6989586621679228262"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#graphAttributes"><span class="hs-identifier hs-type">graphAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228262"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-507"></span><span id="graphAttributes"><span class="annot"><span class="annottext">graphAttributes :: forall n. DotGraph n -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#graphAttributes"><span class="hs-identifier hs-var hs-var">graphAttributes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#fromGlobAttrs"><span class="hs-identifier hs-var">fromGlobAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; [GlobalAttributes])
-&gt; (DotGraph n -&gt; GlobAttrs) -&gt; DotGraph n -&gt; [GlobalAttributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; GlobAttrs
forall n. DotGraph n -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var">graphAttrs</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="annot"><span class="hs-comment">-- | Return the ID for the cluster the node is in.</span></span><span>
</span><span id="line-510"></span><span id="local-6989586621679228264"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#foundInCluster"><span class="hs-identifier hs-type">foundInCluster</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228264"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228264"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228264"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span></span><span>
</span><span id="line-511"></span><span id="foundInCluster"><span class="annot"><span class="annottext">foundInCluster :: forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#foundInCluster"><span class="hs-identifier hs-var hs-var">foundInCluster</span></a></span></span><span> </span><span id="local-6989586621679229389"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229389"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229390"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229390"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Maybe GraphID
forall n. NodeInfo n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; Maybe GraphID) -&gt; NodeInfo n -&gt; Maybe GraphID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; NodeMap n
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229389"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; n -&gt; NodeInfo n
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229390"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="annot"><span class="hs-comment">-- | Return the attributes for the node.</span></span><span>
</span><span id="line-514"></span><span id="local-6989586621679228268"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#attributesOf"><span class="hs-identifier hs-type">attributesOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228268"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span></span><span>
</span><span id="line-515"></span><span id="attributesOf"><span class="annot"><span class="annottext">attributesOf :: forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Graph.html#attributesOf"><span class="hs-identifier hs-var hs-var">attributesOf</span></a></span></span><span> </span><span id="local-6989586621679229394"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229394"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229395"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229395"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Attributes
forall n. NodeInfo n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Graph.html#_attributes"><span class="hs-identifier hs-var">_attributes</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; Attributes) -&gt; NodeInfo n -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; NodeMap n
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229394"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; n -&gt; NodeInfo n
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229395"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">-- | Predecessor edges for the specified node.  For undirected graphs</span><span>
</span><span id="line-518"></span><span class="hs-comment">--   equivalent to 'adjacentTo'.</span><span>
</span><span id="line-519"></span><span id="local-6989586621679228270"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#predecessorsOf"><span class="hs-identifier hs-type">predecessorsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228270"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228270"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228270"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228270"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-520"></span><span id="predecessorsOf"><span class="annot"><span class="annottext">predecessorsOf :: forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#predecessorsOf"><span class="hs-identifier hs-var hs-var">predecessorsOf</span></a></span></span><span> </span><span id="local-6989586621679229399"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229399"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229400"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229400"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229399"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
forall n.
(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#emToDE"><span class="hs-identifier hs-var">emToDE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-operator hs-var">`DotEdge`</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229400"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>                       </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; [DotEdge n])
-&gt; (NodeInfo n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; [DotEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; EdgeMap n
forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var">_predecessors</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; [DotEdge n]) -&gt; NodeInfo n -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; NodeMap n
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229399"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; n -&gt; NodeInfo n
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229400"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; n -&gt; [DotEdge n]
forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#adjacentTo"><span class="hs-identifier hs-var">adjacentTo</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229399"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229400"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-comment">-- | Successor edges for the specified node.  For undirected graphs</span><span>
</span><span id="line-526"></span><span class="hs-comment">--   equivalent to 'adjacentTo'.</span><span>
</span><span id="line-527"></span><span id="local-6989586621679229402"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#successorsOf"><span class="hs-identifier hs-type">successorsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229402"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229402"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229402"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229402"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-528"></span><span id="successorsOf"><span class="annot"><span class="annottext">successorsOf :: forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#successorsOf"><span class="hs-identifier hs-var hs-var">successorsOf</span></a></span></span><span> </span><span id="local-6989586621679229406"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229406"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229407"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229407"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229406"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
forall n.
(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#emToDE"><span class="hs-identifier hs-var">emToDE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-var">DotEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229407"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>                       </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; [DotEdge n])
-&gt; (NodeInfo n -&gt; EdgeMap n) -&gt; NodeInfo n -&gt; [DotEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; EdgeMap n
forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; [DotEdge n]) -&gt; NodeInfo n -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; NodeMap n
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229406"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; n -&gt; NodeInfo n
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229407"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; n -&gt; [DotEdge n]
forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#adjacentTo"><span class="hs-identifier hs-var">adjacentTo</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229406"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229407"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><span class="hs-comment">-- | All edges involving this node.</span></span><span>
</span><span id="line-534"></span><span id="local-6989586621679229408"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#adjacentTo"><span class="hs-identifier hs-type">adjacentTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229408"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229408"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229408"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229408"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-535"></span><span id="adjacentTo"><span class="annot"><span class="annottext">adjacentTo :: forall n. Ord n =&gt; DotGraph n -&gt; n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#adjacentTo"><span class="hs-identifier hs-var hs-var">adjacentTo</span></a></span></span><span> </span><span id="local-6989586621679229411"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229411"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229412"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229412"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679229413"><span class="hs-identifier hs-var">sucs</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n] -&gt; [DotEdge n] -&gt; [DotEdge n]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679229414"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-537"></span><span>    </span><span id="local-6989586621679229417"><span class="annot"><span class="annottext">ni :: NodeInfo n
</span><a href="#local-6989586621679229417"><span class="hs-identifier hs-var hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; NodeMap n
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229411"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; n -&gt; NodeInfo n
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229412"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679229413"><span class="annot"><span class="annottext">sucs :: [DotEdge n]
</span><a href="#local-6989586621679229413"><span class="hs-identifier hs-var hs-var">sucs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
forall n.
(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#emToDE"><span class="hs-identifier hs-var">emToDE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-var">DotEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229412"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; [DotEdge n]) -&gt; EdgeMap n -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; EdgeMap n
forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229417"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span id="local-6989586621679229414"><span class="annot"><span class="annottext">preds :: [DotEdge n]
</span><a href="#local-6989586621679229414"><span class="hs-identifier hs-var hs-var">preds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
forall n.
(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#emToDE"><span class="hs-identifier hs-var">emToDE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-operator hs-var">`DotEdge`</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229412"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EdgeMap n -&gt; [DotEdge n]) -&gt; EdgeMap n -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229412"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; EdgeMap n -&gt; EdgeMap n
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-operator hs-var">`M.delete`</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; EdgeMap n
forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var">_predecessors</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229417"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span id="local-6989586621679228272"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#emToDE"><span class="hs-identifier hs-type">emToDE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228272"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228272"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228272"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228272"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-542"></span><span id="emToDE"><span class="annot"><span class="annottext">emToDE :: forall n.
(n -&gt; Attributes -&gt; DotEdge n) -&gt; EdgeMap n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#emToDE"><span class="hs-identifier hs-var hs-var">emToDE</span></a></span></span><span> </span><span id="local-6989586621679229420"><span class="annot"><span class="annottext">n -&gt; Attributes -&gt; DotEdge n
</span><a href="#local-6989586621679229420"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, Attributes) -&gt; DotEdge n) -&gt; [(n, Attributes)] -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; DotEdge n) -&gt; (n, Attributes) -&gt; DotEdge n
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; Attributes -&gt; DotEdge n
</span><a href="#local-6989586621679229420"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(n, Attributes)] -&gt; [DotEdge n])
-&gt; (EdgeMap n -&gt; [(n, Attributes)]) -&gt; EdgeMap n -&gt; [DotEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n -&gt; [(n, Attributes)]
forall n. EdgeMap n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-var">fromMap</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="annot"><span class="hs-comment">-- | Which cluster (or the root graph) is this cluster in?</span></span><span>
</span><span id="line-545"></span><span id="local-6989586621679228276"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#parentOf"><span class="hs-identifier hs-type">parentOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228276"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span></span><span>
</span><span id="line-546"></span><span id="parentOf"><span class="annot"><span class="annottext">parentOf :: forall n. DotGraph n -&gt; GraphID -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentOf"><span class="hs-identifier hs-var hs-var">parentOf</span></a></span></span><span> </span><span id="local-6989586621679229422"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229422"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229423"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229423"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(ClusterInfo -&gt; Maybe GraphID) -&gt; ClusterInfo -&gt; Maybe GraphID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229422"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo -&gt; GraphID -&gt; ClusterInfo
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229423"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span id="local-6989586621679228278"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusterAttributes"><span class="hs-identifier hs-type">clusterAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228278"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-549"></span><span id="clusterAttributes"><span class="annot"><span class="annottext">clusterAttributes :: forall n. DotGraph n -&gt; GraphID -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#clusterAttributes"><span class="hs-identifier hs-var hs-var">clusterAttributes</span></a></span></span><span> </span><span id="local-6989586621679229425"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229425"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span id="local-6989586621679229426"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229426"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#fromGlobAttrs"><span class="hs-identifier hs-var">fromGlobAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; [GlobalAttributes])
-&gt; (ClusterInfo -&gt; GlobAttrs) -&gt; ClusterInfo -&gt; [GlobalAttributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#clusterAttrs"><span class="hs-identifier hs-var">clusterAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(ClusterInfo -&gt; [GlobalAttributes])
-&gt; ClusterInfo -&gt; [GlobalAttributes]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229425"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo -&gt; GraphID -&gt; ClusterInfo
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229426"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- For DotRepr instance</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228012"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228012"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228012"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679229445"><span class="annot"><span class="annottext">fromCanonical :: DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.html#fromCanonical"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCanonical</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#fromDotRepr"><span class="hs-identifier hs-var">fromDotRepr</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679229446"><span class="annot"><span class="annottext">getID :: DotGraph n -&gt; Maybe GraphID
</span><a href="#local-6989586621679229446"><span class="hs-identifier hs-var hs-var hs-var hs-var">getID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Maybe GraphID
forall n. DotGraph n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span>  </span><span id="local-6989586621679229448"><span class="annot"><span class="annottext">setID :: GraphID -&gt; DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229448"><span class="hs-identifier hs-var hs-var hs-var hs-var">setID</span></a></span></span><span> </span><span id="local-6989586621679229450"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229450"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679229451"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229451"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229451"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229450"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621679229452"><span class="annot"><span class="annottext">graphIsDirected :: DotGraph n -&gt; Bool
</span><a href="#local-6989586621679229452"><span class="hs-identifier hs-var hs-var hs-var hs-var">graphIsDirected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621679229454"><span class="annot"><span class="annottext">setIsDirected :: Bool -&gt; DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229454"><span class="hs-identifier hs-var hs-var hs-var hs-var">setIsDirected</span></a></span></span><span> </span><span id="local-6989586621679229456"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229456"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679229457"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229457"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229457"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229456"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679229458"><span class="annot"><span class="annottext">graphIsStrict :: DotGraph n -&gt; Bool
</span><a href="#local-6989586621679229458"><span class="hs-identifier hs-var hs-var hs-var hs-var">graphIsStrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Graph.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>  </span><span id="local-6989586621679229460"><span class="annot"><span class="annottext">setStrictness :: Bool -&gt; DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229460"><span class="hs-identifier hs-var hs-var hs-var hs-var">setStrictness</span></a></span></span><span> </span><span id="local-6989586621679229462"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229462"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679229463"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229463"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229463"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229462"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679229468"><span class="annot"><span class="annottext">mapDotGraph :: forall n'.
DotRepr DotGraph n' =&gt;
(n -&gt; n') -&gt; DotGraph n -&gt; DotGraph n'
</span><a href="#local-6989586621679229468"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapDotGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; n') -&gt; DotGraph n -&gt; DotGraph n'
forall n' n. Ord n' =&gt; (n -&gt; n') -&gt; DotGraph n -&gt; DotGraph n'
</span><a href="Data.GraphViz.Types.Graph.html#mapNs"><span class="hs-identifier hs-var">mapNs</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679229471"><span class="annot"><span class="annottext">graphStructureInformation :: DotGraph n -&gt; (GlobalAttributes, ClusterLookup)
</span><a href="#local-6989586621679229471"><span class="hs-identifier hs-var hs-var hs-var hs-var">graphStructureInformation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; (GlobalAttributes, ClusterLookup)
forall n. DotGraph n -&gt; (GlobalAttributes, ClusterLookup)
</span><a href="Data.GraphViz.Types.Graph.html#getGraphInfo"><span class="hs-identifier hs-var">getGraphInfo</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679229474"><span class="annot"><span class="annottext">nodeInformation :: Bool -&gt; DotGraph n -&gt; NodeLookup n
</span><a href="#local-6989586621679229474"><span class="hs-identifier hs-var hs-var hs-var hs-var">nodeInformation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DotGraph n -&gt; NodeLookup n
forall n. Bool -&gt; DotGraph n -&gt; NodeLookup n
</span><a href="Data.GraphViz.Types.Graph.html#getNodeInfo"><span class="hs-identifier hs-var">getNodeInfo</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621679229477"><span class="annot"><span class="annottext">edgeInformation :: Bool -&gt; DotGraph n -&gt; [DotEdge n]
</span><a href="#local-6989586621679229477"><span class="hs-identifier hs-var hs-var hs-var hs-var">edgeInformation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DotGraph n -&gt; [DotEdge n]
forall n. Bool -&gt; DotGraph n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span>  </span><span id="local-6989586621679229479"><span class="annot"><span class="annottext">unAnonymise :: DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229479"><span class="hs-identifier hs-var hs-var hs-var hs-var">unAnonymise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-comment">-- No anonymous clusters!</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228297"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228297"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Generalised.html#FromGeneralisedDot"><span class="hs-identifier hs-type">G.FromGeneralisedDot</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228297"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-580"></span><span>  </span><span id="local-6989586621679229489"><span class="annot"><span class="annottext">fromGeneralised :: DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229489"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromGeneralised</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#fromDotRepr"><span class="hs-identifier hs-var">fromDotRepr</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228305"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228305"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Printing.html#PrintDot"><span class="hs-identifier hs-type">PrintDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228305"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#PrintDotRepr"><span class="hs-identifier hs-type">PrintDotRepr</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228305"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-583"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228311"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228311"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Parsing.html#ParseDot"><span class="hs-identifier hs-type">ParseDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228311"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#ParseDotRepr"><span class="hs-identifier hs-type">ParseDotRepr</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228311"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-584"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228316"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228316"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Printing.html#PrintDot"><span class="hs-identifier hs-type">PrintDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228316"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Parsing.html#ParseDot"><span class="hs-identifier hs-type">ParseDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228316"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#PPDotRepr"><span class="hs-identifier hs-type">PPDotRepr</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228316"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="annot"><span class="hs-comment">-- | Uses the PrintDot instance for canonical 'C.DotGraph's.</span></span><span>
</span><span id="line-587"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679228304"><span id="local-6989586621679229521"><span id="local-6989586621679229524"><span id="local-6989586621679229527"><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Printing.html#PrintDot"><span class="hs-identifier hs-type">PrintDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228304"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Printing.html#PrintDot"><span class="hs-identifier hs-type">PrintDot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228304"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-588"></span><span>  </span><span id="local-6989586621679229532"><span class="annot"><span class="annottext">unqtDot :: DotGraph n -&gt; DotCode
</span><a href="#local-6989586621679229532"><span class="hs-identifier hs-var hs-var hs-var hs-var">unqtDot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotCode
forall a. PrintDot a =&gt; a -&gt; DotCode
</span><a href="Data.GraphViz.Printing.html#unqtDot"><span class="hs-identifier hs-var">unqtDot</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotCode)
-&gt; (DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotCode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall n. DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#toCanonical"><span class="hs-identifier hs-var">toCanonical</span></a></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><span class="hs-comment">-- | Uses the ParseDot instance for generalised 'G.DotGraph's.</span></span><span>
</span><span id="line-591"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679229535"><span id="local-6989586621679229541"><span id="local-6989586621679229544"><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229535"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Parsing.html#ParseDot"><span class="hs-identifier hs-type">ParseDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229535"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Parsing.html#ParseDot"><span class="hs-identifier hs-type">ParseDot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229535"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-592"></span><span>  </span><span id="local-6989586621679229552"><span class="annot"><span class="annottext">parseUnqt :: Parse (DotGraph n)
</span><a href="#local-6989586621679229552"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseUnqt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229554"><span class="hs-identifier hs-var">fromGDot</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; Parser GraphvizState (DotGraph n) -&gt; Parse (DotGraph n)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser GraphvizState (DotGraph n)
forall a. ParseDot a =&gt; Parse a
</span><a href="Data.GraphViz.Parsing.html#parseUnqt"><span class="hs-identifier hs-var">parseUnqt</span></a></span><span>
</span><span id="line-593"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-594"></span><span>      </span><span class="hs-comment">-- fromGDot :: G.DotGraph n -&gt; DotGraph n</span><span>
</span><span id="line-595"></span><span>      </span><span id="local-6989586621679229554"><span class="annot"><span class="annottext">fromGDot :: DotGraph n -&gt; DotGraph n
</span><a href="#local-6989586621679229554"><span class="hs-identifier hs-var hs-var">fromGDot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#fromDotRepr"><span class="hs-identifier hs-var">fromDotRepr</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (DotGraph n -&gt; DotGraph n) -&gt; DotGraph n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n -&gt; DotGraph n
forall a. a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#asTypeOf"><span class="hs-operator hs-var">`asTypeOf`</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229559"><span class="annot"><span class="annottext">DotGraph n
forall {n}. DotGraph n
forall a. HasCallStack =&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Generalised.html#DotGraph"><span class="hs-identifier hs-type">G.DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229559"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>  </span><span id="local-6989586621679229564"><span class="annot"><span class="annottext">parse :: Parse (DotGraph n)
</span><a href="#local-6989586621679229564"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parse (DotGraph n)
forall a. ParseDot a =&gt; Parse a
</span><a href="Data.GraphViz.Parsing.html#parseUnqt"><span class="hs-identifier hs-var">parseUnqt</span></a></span><span> </span><span class="hs-comment">-- Don't want the option of quoting</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#cOptions"><span class="hs-identifier hs-type">cOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-600"></span><span id="cOptions"><span class="annot"><span class="annottext">cOptions :: CanonicaliseOptions
</span><a href="Data.GraphViz.Types.Graph.html#cOptions"><span class="hs-identifier hs-var hs-var">cOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#COpts"><span class="hs-identifier hs-type">COpts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">edgesInClusters :: Bool
</span><a href="Data.GraphViz.Algorithms.html#edgesInClusters"><span class="hs-identifier hs-var">edgesInClusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-601"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">groupAttributes :: Bool
</span><a href="Data.GraphViz.Algorithms.html#groupAttributes"><span class="hs-identifier hs-var">groupAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-602"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="annot"><span class="hs-comment">-- | Convert any existing DotRepr instance to a 'DotGraph'.</span></span><span>
</span><span id="line-605"></span><span id="local-6989586621679228285"><span id="local-6989586621679228286"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#fromDotRepr"><span class="hs-identifier hs-type">fromDotRepr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228285"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228286"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228285"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228286"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228286"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-606"></span><span id="fromDotRepr"><span class="annot"><span class="annottext">fromDotRepr :: forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#fromDotRepr"><span class="hs-identifier hs-var hs-var">fromDotRepr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotGraph n
forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#unsafeFromCanonical"><span class="hs-identifier hs-var">unsafeFromCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph n -&gt; DotGraph n)
-&gt; (dg n -&gt; DotGraph n) -&gt; dg n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#canonicaliseOptions"><span class="hs-identifier hs-var">canonicaliseOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="Data.GraphViz.Types.Graph.html#cOptions"><span class="hs-identifier hs-var">cOptions</span></a></span><span> </span><span class="annot"><span class="annottext">(dg n -&gt; DotGraph n) -&gt; (dg n -&gt; dg n) -&gt; dg n -&gt; DotGraph n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">dg n -&gt; dg n
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; dg n
</span><a href="Data.GraphViz.Types.html#unAnonymise"><span class="hs-identifier hs-var">unAnonymise</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-comment">-- | Convert a canonical Dot graph to a graph-based one.  This assumes</span><span>
</span><span id="line-609"></span><span class="hs-comment">--   that the canonical graph is the same format as returned by</span><span>
</span><span id="line-610"></span><span class="hs-comment">--   'toCanonical'.  The \&quot;unsafeness\&quot; is that:</span><span>
</span><span id="line-611"></span><span class="hs-comment">--</span><span>
</span><span id="line-612"></span><span class="hs-comment">--   * All clusters must have a unique identifier ('unAnonymise' can</span><span>
</span><span id="line-613"></span><span class="hs-comment">--     be used to make sure all clusters /have/ an identifier, but it</span><span>
</span><span id="line-614"></span><span class="hs-comment">--     doesn't ensure uniqueness).</span><span>
</span><span id="line-615"></span><span class="hs-comment">--</span><span>
</span><span id="line-616"></span><span class="hs-comment">--   * All nodes are assumed to be explicitly listed precisely once.</span><span>
</span><span id="line-617"></span><span class="hs-comment">--</span><span>
</span><span id="line-618"></span><span class="hs-comment">--   * Only edges found in the root graph are considered.</span><span>
</span><span id="line-619"></span><span class="hs-comment">--</span><span>
</span><span id="line-620"></span><span class="hs-comment">--   If this isn't the case, use 'fromCanonical' instead.</span><span>
</span><span id="line-621"></span><span class="hs-comment">--</span><span>
</span><span id="line-622"></span><span class="hs-comment">--   The 'graphToDot' function from &quot;Data.GraphViz&quot; produces output</span><span>
</span><span id="line-623"></span><span class="hs-comment">--   suitable for this function (assuming all clusters are provided</span><span>
</span><span id="line-624"></span><span class="hs-comment">--   with a unique identifier); 'graphElemsToDot' is suitable if all</span><span>
</span><span id="line-625"></span><span class="hs-comment">--   nodes are specified in the input list (rather than just the</span><span>
</span><span id="line-626"></span><span class="hs-comment">--   edges).</span><span>
</span><span id="line-627"></span><span id="local-6989586621679229575"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#unsafeFromCanonical"><span class="hs-identifier hs-type">unsafeFromCanonical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229575"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">C.DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229575"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229575"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-628"></span><span id="unsafeFromCanonical"><span class="annot"><span class="annottext">unsafeFromCanonical :: forall n. Ord n =&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#unsafeFromCanonical"><span class="hs-identifier hs-var hs-var">unsafeFromCanonical</span></a></span></span><span> </span><span id="local-6989586621679229578"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229578"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DG"><span class="hs-identifier hs-type">DG</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">strictGraph :: Bool
</span><a href="Data.GraphViz.Types.Graph.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Canonical.html#strictGraph"><span class="hs-identifier hs-var">C.strictGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229578"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-629"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">directedGraph :: Bool
</span><a href="Data.GraphViz.Types.Graph.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229579"><span class="hs-identifier hs-var">dirGraph</span></a></span><span>
</span><span id="line-630"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphAttrs :: GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var">graphAttrs</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229580"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-631"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphID :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229581"><span class="hs-identifier hs-var">mgid</span></a></span><span>
</span><span id="line-632"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusters :: Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229582"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-633"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">values :: NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229583"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-634"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-635"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679229584"><span class="annot"><span class="annottext">stmts :: DotStatements n
</span><a href="#local-6989586621679229584"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; DotStatements n
forall n. DotGraph n -&gt; DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#graphStatements"><span class="hs-identifier hs-var">C.graphStatements</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229578"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span id="local-6989586621679229581"><span class="annot"><span class="annottext">mgid :: Maybe GraphID
</span><a href="#local-6989586621679229581"><span class="hs-identifier hs-var hs-var">mgid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Maybe GraphID
forall n. DotGraph n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#graphID"><span class="hs-identifier hs-var">C.graphID</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229578"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621679229579"><span class="annot"><span class="annottext">dirGraph :: Bool
</span><a href="#local-6989586621679229579"><span class="hs-identifier hs-var hs-var">dirGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Bool
forall n. DotGraph n -&gt; Bool
</span><a href="Data.GraphViz.Types.Canonical.html#directedGraph"><span class="hs-identifier hs-var">C.directedGraph</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229578"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679229580"><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229580"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229582"><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229582"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229583"><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229583"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; DotStatements n
-&gt; (GlobAttrs, Map GraphID ClusterInfo, NodeMap n)
</span><a href="#local-6989586621679229585"><span class="hs-identifier hs-var">fCStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229584"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679229585"><span class="annot"><span class="annottext">fCStmt :: Maybe GraphID
-&gt; DotStatements n
-&gt; (GlobAttrs, Map GraphID ClusterInfo, NodeMap n)
</span><a href="#local-6989586621679229585"><span class="hs-identifier hs-var hs-var">fCStmt</span></a></span></span><span> </span><span id="local-6989586621679229587"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229587"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679229588"><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229588"><span class="hs-identifier hs-var">stmts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229589"><span class="hs-identifier hs-var">sgAs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229590"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229591"><span class="hs-identifier hs-var">ns'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-644"></span><span>        </span><span id="local-6989586621679229589"><span class="annot"><span class="annottext">sgAs :: GlobAttrs
</span><a href="#local-6989586621679229589"><span class="hs-identifier hs-var hs-var">sgAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes] -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#toGlobAttrs"><span class="hs-identifier hs-var">toGlobAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">([GlobalAttributes] -&gt; GlobAttrs)
-&gt; [GlobalAttributes] -&gt; GlobAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [GlobalAttributes]
forall n. DotStatements n -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">C.attrStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229588"><span class="hs-identifier hs-var">stmts'</span></a></span><span>
</span><span id="line-645"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679229590"><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229590"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229600"><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229600"><span class="hs-identifier hs-var">sgNs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Map GraphID ClusterInfo] -&gt; Map GraphID ClusterInfo
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#unions"><span class="hs-identifier hs-var">M.unions</span></a></span><span> </span><span class="annot"><span class="annottext">([Map GraphID ClusterInfo] -&gt; Map GraphID ClusterInfo)
-&gt; ([NodeMap n] -&gt; NodeMap n)
-&gt; ([Map GraphID ClusterInfo], [NodeMap n])
-&gt; (Map GraphID ClusterInfo, NodeMap n)
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Arrow.html#%2A%2A%2A"><span class="hs-operator hs-var">***</span></a></span><span> </span><span class="annot"><span class="annottext">[NodeMap n] -&gt; NodeMap n
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#unions"><span class="hs-identifier hs-var">M.unions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Map GraphID ClusterInfo], [NodeMap n])
 -&gt; (Map GraphID ClusterInfo, NodeMap n))
-&gt; ([DotSubGraph n] -&gt; ([Map GraphID ClusterInfo], [NodeMap n]))
-&gt; [DotSubGraph n]
-&gt; (Map GraphID ClusterInfo, NodeMap n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Map GraphID ClusterInfo, NodeMap n)]
-&gt; ([Map GraphID ClusterInfo], [NodeMap n])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span>
</span><span id="line-646"></span><span>                      </span><span class="annot"><span class="annottext">([(Map GraphID ClusterInfo, NodeMap n)]
 -&gt; ([Map GraphID ClusterInfo], [NodeMap n]))
-&gt; ([DotSubGraph n] -&gt; [(Map GraphID ClusterInfo, NodeMap n)])
-&gt; [DotSubGraph n]
-&gt; ([Map GraphID ClusterInfo], [NodeMap n])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DotSubGraph n -&gt; (Map GraphID ClusterInfo, NodeMap n))
-&gt; [DotSubGraph n] -&gt; [(Map GraphID ClusterInfo, NodeMap n)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; DotSubGraph n -&gt; (Map GraphID ClusterInfo, NodeMap n)
</span><a href="#local-6989586621679229603"><span class="hs-identifier hs-var">fCSG</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229587"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DotSubGraph n] -&gt; (Map GraphID ClusterInfo, NodeMap n))
-&gt; [DotSubGraph n] -&gt; (Map GraphID ClusterInfo, NodeMap n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotSubGraph n]
forall n. DotStatements n -&gt; [DotSubGraph n]
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">C.subGraphs</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229588"><span class="hs-identifier hs-var">stmts'</span></a></span><span>
</span><span id="line-647"></span><span>        </span><span id="local-6989586621679229606"><span class="annot"><span class="annottext">nNs :: NodeMap n
</span><a href="#local-6989586621679229606"><span class="hs-identifier hs-var hs-var">nNs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(n, NodeInfo n)] -&gt; NodeMap n
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(n, NodeInfo n)] -&gt; NodeMap n)
-&gt; ([DotNode n] -&gt; [(n, NodeInfo n)]) -&gt; [DotNode n] -&gt; NodeMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DotNode n -&gt; (n, NodeInfo n)) -&gt; [DotNode n] -&gt; [(n, NodeInfo n)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe GraphID -&gt; DotNode n -&gt; (n, NodeInfo n)
</span><a href="#local-6989586621679229608"><span class="hs-identifier hs-var">fDN</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229587"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DotNode n] -&gt; NodeMap n) -&gt; [DotNode n] -&gt; NodeMap n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotNode n]
forall n. DotStatements n -&gt; [DotNode n]
</span><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">C.nodeStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229588"><span class="hs-identifier hs-var">stmts'</span></a></span><span>
</span><span id="line-648"></span><span>        </span><span id="local-6989586621679229591"><span class="annot"><span class="annottext">ns' :: NodeMap n
</span><a href="#local-6989586621679229591"><span class="hs-identifier hs-var hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229600"><span class="hs-identifier hs-var">sgNs</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; NodeMap n -&gt; NodeMap n
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229606"><span class="hs-identifier hs-var">nNs</span></a></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621679229603"><span class="annot"><span class="annottext">fCSG :: Maybe GraphID
-&gt; DotSubGraph n -&gt; (Map GraphID ClusterInfo, NodeMap n)
</span><a href="#local-6989586621679229603"><span class="hs-identifier hs-var hs-var">fCSG</span></a></span></span><span> </span><span id="local-6989586621679229612"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229612"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679229613"><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679229613"><span class="hs-identifier hs-var">sg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID
-&gt; ClusterInfo
-&gt; Map GraphID ClusterInfo
-&gt; Map GraphID ClusterInfo
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229614"><span class="hs-identifier hs-var">sgid</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229615"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229616"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229617"><span class="hs-identifier hs-var">ns'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-652"></span><span>        </span><span id="local-6989586621679229618"><span class="annot"><span class="annottext">msgid :: Maybe GraphID
</span><a href="#local-6989586621679229618"><span class="hs-identifier hs-var">msgid</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679229614"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229614"><span class="hs-identifier hs-var">sgid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; Maybe GraphID
forall n. DotSubGraph n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphID"><span class="hs-identifier hs-var">C.subGraphID</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679229613"><span class="hs-identifier hs-var">sg</span></a></span><span>
</span><span id="line-653"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679229620"><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229620"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229616"><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229616"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229617"><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229617"><span class="hs-identifier hs-var">ns'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; DotStatements n
-&gt; (GlobAttrs, Map GraphID ClusterInfo, NodeMap n)
</span><a href="#local-6989586621679229585"><span class="hs-identifier hs-var">fCStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229618"><span class="hs-identifier hs-var">msgid</span></a></span><span> </span><span class="annot"><span class="annottext">(DotStatements n
 -&gt; (GlobAttrs, Map GraphID ClusterInfo, NodeMap n))
-&gt; DotStatements n
-&gt; (GlobAttrs, Map GraphID ClusterInfo, NodeMap n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; DotStatements n
forall n. DotSubGraph n -&gt; DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphStmts"><span class="hs-identifier hs-var">C.subGraphStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679229613"><span class="hs-identifier hs-var">sg</span></a></span><span>
</span><span id="line-654"></span><span>        </span><span id="local-6989586621679229615"><span class="annot"><span class="annottext">ci :: ClusterInfo
</span><a href="#local-6989586621679229615"><span class="hs-identifier hs-var hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; GlobAttrs -&gt; ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#CI"><span class="hs-identifier hs-var">CI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229612"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229620"><span class="hs-identifier hs-var">as'</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621679229608"><span class="annot"><span class="annottext">fDN :: Maybe GraphID -&gt; DotNode n -&gt; (n, NodeInfo n)
</span><a href="#local-6989586621679229608"><span class="hs-identifier hs-var hs-var">fDN</span></a></span></span><span> </span><span id="local-6989586621679229625"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229625"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span id="local-6989586621679229626"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229626"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229627"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229627"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229626"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-657"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-type">NI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_inCluster :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229625"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-658"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_attributes :: Attributes
</span><a href="Data.GraphViz.Types.Graph.html#_attributes"><span class="hs-identifier hs-var">_attributes</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229627"><span class="hs-identifier hs-var">as'</span></a></span><span>
</span><span id="line-659"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_predecessors :: EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var">_predecessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Map n (EdgeMap n) -&gt; EdgeMap n
forall {k} {k} {a}. Ord k =&gt; k -&gt; Map k (Map k a) -&gt; Map k a
</span><a href="#local-6989586621679229628"><span class="hs-identifier hs-var">eSel</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229626"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (EdgeMap n)
</span><a href="#local-6989586621679229629"><span class="hs-identifier hs-var">tEs</span></a></span><span>
</span><span id="line-660"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_successors :: EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Map n (EdgeMap n) -&gt; EdgeMap n
forall {k} {k} {a}. Ord k =&gt; k -&gt; Map k (Map k a) -&gt; Map k a
</span><a href="#local-6989586621679229628"><span class="hs-identifier hs-var">eSel</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229626"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (EdgeMap n)
</span><a href="#local-6989586621679229630"><span class="hs-identifier hs-var">fEs</span></a></span><span>
</span><span id="line-661"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-662"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679229631"><span class="annot"><span class="annottext">es :: [DotEdge n]
</span><a href="#local-6989586621679229631"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotEdge n]
forall n. DotStatements n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">C.edgeStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679229584"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621679229630"><span class="annot"><span class="annottext">fEs :: Map n (EdgeMap n)
</span><a href="#local-6989586621679229630"><span class="hs-identifier hs-var hs-var">fEs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; n) -&gt; [DotEdge n] -&gt; Map n (EdgeMap n)
forall n.
Ord n =&gt;
(DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; n) -&gt; [DotEdge n] -&gt; Map n (EdgeMap n)
</span><a href="Data.GraphViz.Types.Graph.html#toEdgeMap"><span class="hs-identifier hs-var">toEdgeMap</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#fromNode"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#toNode"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679229631"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-666"></span><span>    </span><span id="local-6989586621679229629"><span class="annot"><span class="annottext">tEs :: Map n (EdgeMap n)
</span><a href="#local-6989586621679229629"><span class="hs-identifier hs-var hs-var">tEs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map n (EdgeMap n) -&gt; Map n (EdgeMap n)
forall {a}. Map n (Map n a) -&gt; Map n (Map n a)
</span><a href="#local-6989586621679229639"><span class="hs-identifier hs-var">delLoops</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n (EdgeMap n) -&gt; Map n (EdgeMap n))
-&gt; Map n (EdgeMap n) -&gt; Map n (EdgeMap n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; n) -&gt; [DotEdge n] -&gt; Map n (EdgeMap n)
forall n.
Ord n =&gt;
(DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; n) -&gt; [DotEdge n] -&gt; Map n (EdgeMap n)
</span><a href="Data.GraphViz.Types.Graph.html#toEdgeMap"><span class="hs-identifier hs-var">toEdgeMap</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#toNode"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#fromNode"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679229631"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-667"></span><span>    </span><span id="local-6989586621679229628"><span class="annot"><span class="annottext">eSel :: k -&gt; Map k (Map k a) -&gt; Map k a
</span><a href="#local-6989586621679229628"><span class="hs-identifier hs-var hs-var">eSel</span></a></span></span><span> </span><span id="local-6989586621679229644"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679229644"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679229645"><span class="annot"><span class="annottext">Map k (Map k a)
</span><a href="#local-6989586621679229645"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Maybe (Map k a) -&gt; Map k a
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Map k a) -&gt; Map k a) -&gt; Maybe (Map k a) -&gt; Map k a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679229644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k (Map k a) -&gt; Maybe (Map k a)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (Map k a)
</span><a href="#local-6989586621679229645"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679229639"><span class="annot"><span class="annottext">delLoops :: Map n (Map n a) -&gt; Map n (Map n a)
</span><a href="#local-6989586621679229639"><span class="hs-identifier hs-var hs-var">delLoops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Map n a -&gt; Map n a) -&gt; Map n (Map n a) -&gt; Map n (Map n a)
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapWithKey"><span class="hs-identifier hs-var">M.mapWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; Map n a -&gt; Map n a
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">M.delete</span></a></span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span id="local-6989586621679228365"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#toEdgeMap"><span class="hs-identifier hs-type">toEdgeMap</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-671"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228365"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-672"></span><span id="toEdgeMap"><span class="annot"><span class="annottext">toEdgeMap :: forall n.
Ord n =&gt;
(DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; n) -&gt; [DotEdge n] -&gt; Map n (EdgeMap n)
</span><a href="Data.GraphViz.Types.Graph.html#toEdgeMap"><span class="hs-identifier hs-var hs-var">toEdgeMap</span></a></span></span><span> </span><span id="local-6989586621679229653"><span class="annot"><span class="annottext">DotEdge n -&gt; n
</span><a href="#local-6989586621679229653"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229654"><span class="annot"><span class="annottext">DotEdge n -&gt; n
</span><a href="#local-6989586621679229654"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(n, Attributes)] -&gt; EdgeMap n)
-&gt; Map n [(n, Attributes)] -&gt; Map n (EdgeMap n)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, Attributes)] -&gt; EdgeMap n
forall {c}. [(n, c)] -&gt; Map n [c]
</span><a href="#local-6989586621679229655"><span class="hs-identifier hs-var">eM</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n [(n, Attributes)] -&gt; Map n (EdgeMap n))
-&gt; ([DotEdge n] -&gt; Map n [(n, Attributes)])
-&gt; [DotEdge n]
-&gt; Map n (EdgeMap n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, [(n, Attributes)])] -&gt; Map n [(n, Attributes)]
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(n, [(n, Attributes)])] -&gt; Map n [(n, Attributes)])
-&gt; ([DotEdge n] -&gt; [(n, [(n, Attributes)])])
-&gt; [DotEdge n]
-&gt; Map n [(n, Attributes)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; (n, Attributes))
-&gt; [DotEdge n]
-&gt; [(n, [(n, Attributes)])]
forall b a c. Ord b =&gt; (a -&gt; b) -&gt; (a -&gt; c) -&gt; [a] -&gt; [(b, [c])]
</span><a href="Data.GraphViz.Internal.Util.html#groupSortCollectBy"><span class="hs-identifier hs-var">groupSortCollectBy</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
</span><a href="#local-6989586621679229653"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; (n, Attributes)
</span><a href="#local-6989586621679229656"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679229656"><span class="annot"><span class="annottext">t' :: DotEdge n -&gt; (n, Attributes)
</span><a href="#local-6989586621679229656"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Attributes -&gt; (n, Attributes))
-&gt; (DotEdge n -&gt; n)
-&gt; (DotEdge n -&gt; Attributes)
-&gt; DotEdge n
-&gt; (n, Attributes)
forall a b c.
(a -&gt; b -&gt; c)
-&gt; (DotEdge n -&gt; a) -&gt; (DotEdge n -&gt; b) -&gt; DotEdge n -&gt; c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
</span><a href="#local-6989586621679229654"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; Attributes
forall n. DotEdge n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#edgeAttributes"><span class="hs-identifier hs-var">edgeAttributes</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span id="local-6989586621679229655"><span class="annot"><span class="annottext">eM :: [(n, c)] -&gt; Map n [c]
</span><a href="#local-6989586621679229655"><span class="hs-identifier hs-var hs-var">eM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(n, [c])] -&gt; Map n [c]
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(n, [c])] -&gt; Map n [c])
-&gt; ([(n, c)] -&gt; [(n, [c])]) -&gt; [(n, c)] -&gt; Map n [c]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((n, c) -&gt; n) -&gt; ((n, c) -&gt; c) -&gt; [(n, c)] -&gt; [(n, [c])]
forall b a c. Ord b =&gt; (a -&gt; b) -&gt; (a -&gt; c) -&gt; [a] -&gt; [(b, [c])]
</span><a href="Data.GraphViz.Internal.Util.html#groupSortCollectBy"><span class="hs-identifier hs-var">groupSortCollectBy</span></a></span><span> </span><span class="annot"><span class="annottext">(n, c) -&gt; n
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(n, c) -&gt; c
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span id="local-6989586621679228288"><span id="local-6989586621679228289"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#mapNs"><span class="hs-identifier hs-type">mapNs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228288"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228289"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228288"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228289"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228288"><span class="hs-identifier hs-type">n'</span></a></span></span></span><span>
</span><span id="line-678"></span><span id="mapNs"><span class="annot"><span class="annottext">mapNs :: forall n' n. Ord n' =&gt; (n -&gt; n') -&gt; DotGraph n -&gt; DotGraph n'
</span><a href="Data.GraphViz.Types.Graph.html#mapNs"><span class="hs-identifier hs-var hs-var">mapNs</span></a></span></span><span> </span><span id="local-6989586621679229664"><span class="annot"><span class="annottext">n -&gt; n'
</span><a href="#local-6989586621679229664"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DG"><span class="hs-identifier hs-type">DG</span></a></span><span> </span><span id="local-6989586621679229665"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229665"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679229666"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229666"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679229667"><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229667"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679229668"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229668"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679229669"><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229669"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679229670"><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229670"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Bool
-&gt; GlobAttrs
-&gt; Maybe GraphID
-&gt; Map GraphID ClusterInfo
-&gt; NodeMap n'
-&gt; DotGraph n'
forall n.
Bool
-&gt; Bool
-&gt; GlobAttrs
-&gt; Maybe GraphID
-&gt; Map GraphID ClusterInfo
-&gt; NodeMap n
-&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#DG"><span class="hs-identifier hs-var">DG</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229665"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229666"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GlobAttrs
</span><a href="#local-6989586621679229667"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229668"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229669"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-679"></span><span>                                 </span><span class="annot"><span class="annottext">(NodeMap n' -&gt; DotGraph n') -&gt; NodeMap n' -&gt; DotGraph n'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; NodeMap n'
</span><a href="#local-6989586621679229671"><span class="hs-identifier hs-var">mapNM</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n
</span><a href="#local-6989586621679229670"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-680"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-681"></span><span>    </span><span id="local-6989586621679229671"><span class="annot"><span class="annottext">mapNM :: NodeMap n -&gt; NodeMap n'
</span><a href="#local-6989586621679229671"><span class="hs-identifier hs-var hs-var">mapNM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; NodeInfo n') -&gt; Map n' (NodeInfo n) -&gt; NodeMap n'
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; NodeInfo n'
</span><a href="#local-6989586621679229672"><span class="hs-identifier hs-var">mapNI</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n' (NodeInfo n) -&gt; NodeMap n')
-&gt; (NodeMap n -&gt; Map n' (NodeInfo n)) -&gt; NodeMap n -&gt; NodeMap n'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeMap n -&gt; Map n' (NodeInfo n)
forall {a}. Map n a -&gt; Map n' a
</span><a href="#local-6989586621679229673"><span class="hs-identifier hs-var">mpM</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621679229672"><span class="annot"><span class="annottext">mapNI :: NodeInfo n -&gt; NodeInfo n'
</span><a href="#local-6989586621679229672"><span class="hs-identifier hs-var hs-var">mapNI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-type">NI</span></a></span><span> </span><span id="local-6989586621679229674"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229674"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621679229675"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229675"><span class="hs-identifier hs-var">as'</span></a></span></span><span> </span><span id="local-6989586621679229676"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229676"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679229677"><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229677"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; Attributes -&gt; EdgeMap n' -&gt; EdgeMap n' -&gt; NodeInfo n'
forall n.
Maybe GraphID -&gt; Attributes -&gt; EdgeMap n -&gt; EdgeMap n -&gt; NodeInfo n
</span><a href="Data.GraphViz.Types.Graph.html#NI"><span class="hs-identifier hs-var">NI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229674"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229675"><span class="hs-identifier hs-var">as'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeMap n -&gt; EdgeMap n'
forall {a}. Map n a -&gt; Map n' a
</span><a href="#local-6989586621679229673"><span class="hs-identifier hs-var">mpM</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229676"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeMap n -&gt; EdgeMap n'
forall {a}. Map n a -&gt; Map n' a
</span><a href="#local-6989586621679229673"><span class="hs-identifier hs-var">mpM</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n
</span><a href="#local-6989586621679229677"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621679229673"><span class="annot"><span class="annottext">mpM :: Map n a -&gt; Map n' a
</span><a href="#local-6989586621679229673"><span class="hs-identifier hs-var hs-var">mpM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; n') -&gt; Map n a -&gt; Map n' a
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapKeys"><span class="hs-identifier hs-var">M.mapKeys</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n'
</span><a href="#local-6989586621679229664"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span id="local-6989586621679228290"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#getGraphInfo"><span class="hs-identifier hs-type">getGraphInfo</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228290"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html#ClusterLookup"><span class="hs-identifier hs-type">ClusterLookup</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-686"></span><span id="getGraphInfo"><span class="annot"><span class="annottext">getGraphInfo :: forall n. DotGraph n -&gt; (GlobalAttributes, ClusterLookup)
</span><a href="Data.GraphViz.Types.Graph.html#getGraphInfo"><span class="hs-identifier hs-var hs-var">getGraphInfo</span></a></span></span><span> </span><span id="local-6989586621679229681"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229681"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679229682"><span class="hs-identifier hs-var">gas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679229683"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621679229684"><span class="annot"><span class="annottext">toGA :: SAttrs -&gt; GlobalAttributes
</span><a href="#local-6989586621679229684"><span class="hs-identifier hs-var hs-var">toGA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#GraphAttrs"><span class="hs-identifier hs-var">GraphAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; GlobalAttributes)
-&gt; (SAttrs -&gt; Attributes) -&gt; SAttrs -&gt; GlobalAttributes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679229682"><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679229682"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229687"><span class="annot"><span class="annottext">Map GraphID GlobalAttributes
</span><a href="#local-6989586621679229687"><span class="hs-identifier hs-var">cgs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SAttrs -&gt; GlobalAttributes
</span><a href="#local-6989586621679229684"><span class="hs-identifier hs-var">toGA</span></a></span><span> </span><span class="annot"><span class="annottext">(SAttrs -&gt; GlobalAttributes)
-&gt; (Map GraphID SAttrs -&gt; Map GraphID GlobalAttributes)
-&gt; (SAttrs, Map GraphID SAttrs)
-&gt; (GlobalAttributes, Map GraphID GlobalAttributes)
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Arrow.html#%2A%2A%2A"><span class="hs-operator hs-var">***</span></a></span><span> </span><span class="annot"><span class="annottext">(SAttrs -&gt; GlobalAttributes)
-&gt; Map GraphID SAttrs -&gt; Map GraphID GlobalAttributes
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; GlobalAttributes
</span><a href="#local-6989586621679229684"><span class="hs-identifier hs-var">toGA</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((SAttrs, Map GraphID SAttrs)
 -&gt; (GlobalAttributes, Map GraphID GlobalAttributes))
-&gt; (SAttrs, Map GraphID SAttrs)
-&gt; (GlobalAttributes, Map GraphID GlobalAttributes)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; SAttrs) -&gt; DotGraph n -&gt; (SAttrs, Map GraphID SAttrs)
forall n.
(GlobAttrs -&gt; SAttrs) -&gt; DotGraph n -&gt; (SAttrs, Map GraphID SAttrs)
</span><a href="Data.GraphViz.Types.Graph.html#globAttrMap"><span class="hs-identifier hs-var">globAttrMap</span></a></span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAs"><span class="hs-identifier hs-var">graphAs</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229681"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679229689"><span class="annot"><span class="annottext">pM :: Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="#local-6989586621679229689"><span class="hs-identifier hs-var hs-var">pM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seq (Maybe GraphID) -&gt; Seq (Maybe GraphID))
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Maybe GraphID) -&gt; Seq (Maybe GraphID)
forall {a}. Seq a -&gt; Seq a
</span><a href="#local-6989586621679229690"><span class="hs-identifier hs-var">pInit</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Maybe GraphID) (Seq (Maybe GraphID))
 -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID)))
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
forall n. DotGraph n -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="Data.GraphViz.Types.Graph.html#clusterPath"><span class="hs-identifier hs-var">clusterPath</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229681"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>    </span><span id="local-6989586621679229683"><span class="annot"><span class="annottext">cl :: ClusterLookup
</span><a href="#local-6989586621679229683"><span class="hs-identifier hs-var hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe GraphID
 -&gt; GlobalAttributes -&gt; ([Seq (Maybe GraphID)], GlobalAttributes))
-&gt; Map (Maybe GraphID) GlobalAttributes -&gt; ClusterLookup
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapWithKey"><span class="hs-identifier hs-var">M.mapWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; GlobalAttributes -&gt; ([Seq (Maybe GraphID)], GlobalAttributes)
forall {b}. Maybe GraphID -&gt; b -&gt; ([Seq (Maybe GraphID)], b)
</span><a href="#local-6989586621679229692"><span class="hs-identifier hs-var">addPath</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Maybe GraphID) GlobalAttributes -&gt; ClusterLookup)
-&gt; Map (Maybe GraphID) GlobalAttributes -&gt; ClusterLookup
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe GraphID)
-&gt; Map GraphID GlobalAttributes
-&gt; Map (Maybe GraphID) GlobalAttributes
forall k1 k2 a. (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapKeysMonotonic"><span class="hs-identifier hs-var">M.mapKeysMonotonic</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Maybe GraphID
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID GlobalAttributes
</span><a href="#local-6989586621679229687"><span class="hs-identifier hs-var">cgs</span></a></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621679229692"><span class="annot"><span class="annottext">addPath :: Maybe GraphID -&gt; b -&gt; ([Seq (Maybe GraphID)], b)
</span><a href="#local-6989586621679229692"><span class="hs-identifier hs-var hs-var">addPath</span></a></span></span><span> </span><span id="local-6989586621679229696"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229696"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229697"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679229697"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Maybe (Seq (Maybe GraphID)) -&gt; [Seq (Maybe GraphID)]
forall a. Maybe a -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybeToList"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Seq (Maybe GraphID)) -&gt; [Seq (Maybe GraphID)])
-&gt; Maybe (Seq (Maybe GraphID)) -&gt; [Seq (Maybe GraphID)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229696"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
-&gt; Maybe (Seq (Maybe GraphID))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="#local-6989586621679229689"><span class="hs-identifier hs-var">pM</span></a></span><span>
</span><span id="line-695"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679229697"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-696"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>
</span><span id="line-698"></span><span>    </span><span id="local-6989586621679229690"><span class="annot"><span class="annottext">pInit :: Seq a -&gt; Seq a
</span><a href="#local-6989586621679229690"><span class="hs-identifier hs-var hs-var">pInit</span></a></span></span><span> </span><span id="local-6989586621679229698"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679229698"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; ViewR a
forall a. Seq a -&gt; ViewR a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#viewr"><span class="hs-identifier hs-var">Seq.viewr</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679229698"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-699"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679229700"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679229700"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-type">Seq.:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679229700"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-700"></span><span>                </span><span class="annot"><span class="annottext">ViewR a
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq a
forall a. Seq a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">Seq.empty</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span id="local-6989586621679228291"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#getNodeInfo"><span class="hs-identifier hs-type">getNodeInfo</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228291"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html#NodeLookup"><span class="hs-identifier hs-type">NodeLookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228291"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-703"></span><span id="getNodeInfo"><span class="annot"><span class="annottext">getNodeInfo :: forall n. Bool -&gt; DotGraph n -&gt; NodeLookup n
</span><a href="Data.GraphViz.Types.Graph.html#getNodeInfo"><span class="hs-identifier hs-var hs-var">getNodeInfo</span></a></span></span><span> </span><span id="local-6989586621679229702"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229702"><span class="hs-identifier hs-var">withGlob</span></a></span></span><span> </span><span id="local-6989586621679229703"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229703"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; (Seq (Maybe GraphID), Attributes))
-&gt; Map n (NodeInfo n) -&gt; Map n (Seq (Maybe GraphID), Attributes)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; (Seq (Maybe GraphID), Attributes)
forall {n}. NodeInfo n -&gt; (Seq (Maybe GraphID), Attributes)
</span><a href="#local-6989586621679229704"><span class="hs-identifier hs-var">toLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (NodeInfo n)
</span><a href="#local-6989586621679229705"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679229706"><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229706"><span class="hs-identifier hs-var">gGlob</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229707"><span class="annot"><span class="annottext">Map GraphID SAttrs
</span><a href="#local-6989586621679229707"><span class="hs-identifier hs-var">aM</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; SAttrs) -&gt; DotGraph n -&gt; (SAttrs, Map GraphID SAttrs)
forall n.
(GlobAttrs -&gt; SAttrs) -&gt; DotGraph n -&gt; (SAttrs, Map GraphID SAttrs)
</span><a href="Data.GraphViz.Types.Graph.html#globAttrMap"><span class="hs-identifier hs-var">globAttrMap</span></a></span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="Data.GraphViz.Types.Graph.html#nodeAs"><span class="hs-identifier hs-var">nodeAs</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229703"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621679229708"><span class="annot"><span class="annottext">pM :: Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="#local-6989586621679229708"><span class="hs-identifier hs-var hs-var">pM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
forall n. DotGraph n -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="Data.GraphViz.Types.Graph.html#clusterPath"><span class="hs-identifier hs-var">clusterPath</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229703"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679229705"><span class="annot"><span class="annottext">ns :: Map n (NodeInfo n)
</span><a href="#local-6989586621679229705"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229703"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span>    </span><span id="local-6989586621679229704"><span class="annot"><span class="annottext">toLookup :: NodeInfo n -&gt; (Seq (Maybe GraphID), Attributes)
</span><a href="#local-6989586621679229704"><span class="hs-identifier hs-var hs-var">toLookup</span></a></span></span><span> </span><span id="local-6989586621679229709"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229709"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Maybe GraphID)
</span><a href="#local-6989586621679229710"><span class="hs-identifier hs-var">pth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229711"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-712"></span><span>        </span><span id="local-6989586621679229712"><span class="annot"><span class="annottext">as :: Attributes
</span><a href="#local-6989586621679229712"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Attributes
forall n. NodeInfo n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Graph.html#_attributes"><span class="hs-identifier hs-var">_attributes</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229709"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-713"></span><span>        </span><span id="local-6989586621679229713"><span class="annot"><span class="annottext">mp :: Maybe GraphID
</span><a href="#local-6989586621679229713"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Maybe GraphID
forall n. NodeInfo n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#_inCluster"><span class="hs-identifier hs-var">_inCluster</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229709"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-714"></span><span>        </span><span id="local-6989586621679229710"><span class="annot"><span class="annottext">pth :: Seq (Maybe GraphID)
</span><a href="#local-6989586621679229710"><span class="hs-identifier hs-var hs-var">pth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Maybe GraphID)
-&gt; Maybe (Seq (Maybe GraphID)) -&gt; Seq (Maybe GraphID)
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Maybe GraphID)
forall a. Seq a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">Seq.empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Seq (Maybe GraphID)) -&gt; Seq (Maybe GraphID))
-&gt; Maybe (Seq (Maybe GraphID)) -&gt; Seq (Maybe GraphID)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229713"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
-&gt; Maybe (Seq (Maybe GraphID))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="#local-6989586621679229708"><span class="hs-identifier hs-var">pM</span></a></span><span>
</span><span id="line-715"></span><span>        </span><span id="local-6989586621679229718"><span class="annot"><span class="annottext">pAs :: SAttrs
</span><a href="#local-6989586621679229718"><span class="hs-identifier hs-var hs-var">pAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Maybe SAttrs -&gt; SAttrs
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229706"><span class="hs-identifier hs-var">gGlob</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe SAttrs -&gt; SAttrs) -&gt; Maybe SAttrs -&gt; SAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID SAttrs -&gt; Maybe SAttrs
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID SAttrs
</span><a href="#local-6989586621679229707"><span class="hs-identifier hs-var">aM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe SAttrs) -&gt; Maybe GraphID -&gt; Maybe SAttrs
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229713"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-716"></span><span>        </span><span id="local-6989586621679229711"><span class="annot"><span class="annottext">as' :: Attributes
</span><a href="#local-6989586621679229711"><span class="hs-identifier hs-var hs-var">as'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229702"><span class="hs-identifier hs-var">withGlob</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span> </span><span class="annot"><span class="annottext">(SAttrs -&gt; Attributes) -&gt; SAttrs -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229712"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229718"><span class="hs-identifier hs-var">pAs</span></a></span><span>
</span><span id="line-717"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229712"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span id="local-6989586621679228166"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#getEdgeInfo"><span class="hs-identifier hs-type">getEdgeInfo</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228166"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228166"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-720"></span><span id="getEdgeInfo"><span class="annot"><span class="annottext">getEdgeInfo :: forall n. Bool -&gt; DotGraph n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Graph.html#getEdgeInfo"><span class="hs-identifier hs-var hs-var">getEdgeInfo</span></a></span></span><span> </span><span id="local-6989586621679229721"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229721"><span class="hs-identifier hs-var">withGlob</span></a></span></span><span> </span><span id="local-6989586621679229722"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229722"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, (n, [Attributes])) -&gt; [DotEdge n])
-&gt; [(n, (n, [Attributes]))] -&gt; [DotEdge n]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; (n, [Attributes]) -&gt; [DotEdge n])
-&gt; (n, (n, [Attributes])) -&gt; [DotEdge n]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; (n, [Attributes]) -&gt; [DotEdge n]
forall {n}. n -&gt; (n, [Attributes]) -&gt; [DotEdge n]
</span><a href="#local-6989586621679229724"><span class="hs-identifier hs-var">mkDotEdges</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(n, (n, [Attributes]))]
</span><a href="#local-6989586621679229725"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-722"></span><span>    </span><span id="local-6989586621679229726"><span class="annot"><span class="annottext">gGlob :: SAttrs
</span><a href="#local-6989586621679229726"><span class="hs-identifier hs-var hs-var">gGlob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="Data.GraphViz.Types.Graph.html#edgeAs"><span class="hs-identifier hs-var">edgeAs</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; SAttrs) -&gt; GlobAttrs -&gt; SAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; GlobAttrs
forall n. DotGraph n -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var">graphAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229722"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span>    </span><span id="local-6989586621679229725"><span class="annot"><span class="annottext">es :: [(n, (n, [Attributes]))]
</span><a href="#local-6989586621679229725"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, [(n, [Attributes])]) -&gt; [(n, (n, [Attributes]))])
-&gt; [(n, [(n, [Attributes])])] -&gt; [(n, (n, [Attributes]))]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; [(n, [Attributes])] -&gt; [(n, (n, [Attributes]))])
-&gt; (n, [(n, [Attributes])]) -&gt; [(n, (n, [Attributes]))]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((n, [Attributes]) -&gt; (n, (n, [Attributes])))
-&gt; [(n, [Attributes])] -&gt; [(n, (n, [Attributes]))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(((n, [Attributes]) -&gt; (n, (n, [Attributes])))
 -&gt; [(n, [Attributes])] -&gt; [(n, (n, [Attributes]))])
-&gt; (n -&gt; (n, [Attributes]) -&gt; (n, (n, [Attributes])))
-&gt; n
-&gt; [(n, [Attributes])]
-&gt; [(n, (n, [Attributes]))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>         </span><span class="annot"><span class="annottext">([(n, [(n, [Attributes])])] -&gt; [(n, (n, [Attributes]))])
-&gt; (Map n (NodeInfo n) -&gt; [(n, [(n, [Attributes])])])
-&gt; Map n (NodeInfo n)
-&gt; [(n, (n, [Attributes]))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [(n, [Attributes])] -&gt; [(n, [(n, [Attributes])])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#assocs"><span class="hs-identifier hs-var">M.assocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n [(n, [Attributes])] -&gt; [(n, [(n, [Attributes])])])
-&gt; (Map n (NodeInfo n) -&gt; Map n [(n, [Attributes])])
-&gt; Map n (NodeInfo n)
-&gt; [(n, [(n, [Attributes])])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo n -&gt; [(n, [Attributes])])
-&gt; Map n (NodeInfo n) -&gt; Map n [(n, [Attributes])]
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map n [Attributes] -&gt; [(n, [Attributes])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#assocs"><span class="hs-identifier hs-var">M.assocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map n [Attributes] -&gt; [(n, [Attributes])])
-&gt; (NodeInfo n -&gt; Map n [Attributes])
-&gt; NodeInfo n
-&gt; [(n, [Attributes])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo n -&gt; Map n [Attributes]
forall n. NodeInfo n -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>         </span><span class="annot"><span class="annottext">(Map n (NodeInfo n) -&gt; [(n, (n, [Attributes]))])
-&gt; Map n (NodeInfo n) -&gt; [(n, (n, [Attributes]))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map n (NodeInfo n)
forall n. DotGraph n -&gt; NodeMap n
</span><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229722"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679229729"><span class="annot"><span class="annottext">addGlob :: Attributes -&gt; Attributes
</span><a href="#local-6989586621679229729"><span class="hs-identifier hs-var hs-var">addGlob</span></a></span></span><span> </span><span id="local-6989586621679229730"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229730"><span class="hs-keyword hs-var">as</span></a></span></span><span>
</span><span id="line-729"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679229721"><span class="hs-identifier hs-var">withGlob</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span> </span><span class="annot"><span class="annottext">(SAttrs -&gt; Attributes) -&gt; SAttrs -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229730"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229726"><span class="hs-identifier hs-var">gGlob</span></a></span><span>
</span><span id="line-730"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229730"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span>    </span><span id="local-6989586621679229724"><span class="annot"><span class="annottext">mkDotEdges :: n -&gt; (n, [Attributes]) -&gt; [DotEdge n]
</span><a href="#local-6989586621679229724"><span class="hs-identifier hs-var hs-var">mkDotEdges</span></a></span></span><span> </span><span id="local-6989586621679229731"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229731"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229732"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229732"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229733"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679229733"><span class="hs-identifier hs-var">ass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; DotEdge n) -&gt; [Attributes] -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Attributes -&gt; DotEdge n
forall n. n -&gt; n -&gt; Attributes -&gt; DotEdge n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-var">DotEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229731"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679229732"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; DotEdge n)
-&gt; (Attributes -&gt; Attributes) -&gt; Attributes -&gt; DotEdge n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Attributes
</span><a href="#local-6989586621679229729"><span class="hs-identifier hs-var">addGlob</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679229733"><span class="hs-identifier hs-var">ass</span></a></span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span id="local-6989586621679228384"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#globAttrMap"><span class="hs-identifier hs-type">globAttrMap</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-type">GlobAttrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html#SAttrs"><span class="hs-identifier hs-type">SAttrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228384"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-735"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html#SAttrs"><span class="hs-identifier hs-type">SAttrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html#SAttrs"><span class="hs-identifier hs-type">SAttrs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-736"></span><span id="globAttrMap"><span class="annot"><span class="annottext">globAttrMap :: forall n.
(GlobAttrs -&gt; SAttrs) -&gt; DotGraph n -&gt; (SAttrs, Map GraphID SAttrs)
</span><a href="Data.GraphViz.Types.Graph.html#globAttrMap"><span class="hs-identifier hs-var hs-var">globAttrMap</span></a></span></span><span> </span><span id="local-6989586621679229734"><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="#local-6989586621679229734"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621679229735"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229735"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229736"><span class="hs-identifier hs-var">gGlob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map GraphID SAttrs
</span><a href="#local-6989586621679229737"><span class="hs-identifier hs-var">aM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-738"></span><span>    </span><span id="local-6989586621679229736"><span class="annot"><span class="annottext">gGlob :: SAttrs
</span><a href="#local-6989586621679229736"><span class="hs-identifier hs-var hs-var">gGlob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="#local-6989586621679229734"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; SAttrs) -&gt; GlobAttrs -&gt; SAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; GlobAttrs
forall n. DotGraph n -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#graphAttrs"><span class="hs-identifier hs-var">graphAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229735"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>    </span><span id="local-6989586621679229738"><span class="annot"><span class="annottext">cs :: Map GraphID ClusterInfo
</span><a href="#local-6989586621679229738"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229735"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span>    </span><span id="local-6989586621679229737"><span class="annot"><span class="annottext">aM :: Map GraphID SAttrs
</span><a href="#local-6989586621679229737"><span class="hs-identifier hs-var hs-var">aM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ClusterInfo -&gt; SAttrs)
-&gt; Map GraphID ClusterInfo -&gt; Map GraphID SAttrs
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; SAttrs
</span><a href="#local-6989586621679229740"><span class="hs-identifier hs-var">attrsFor</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229738"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span>    </span><span id="local-6989586621679229740"><span class="annot"><span class="annottext">attrsFor :: ClusterInfo -&gt; SAttrs
</span><a href="#local-6989586621679229740"><span class="hs-identifier hs-var hs-var">attrsFor</span></a></span></span><span> </span><span id="local-6989586621679229741"><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229741"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229742"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229743"><span class="hs-identifier hs-var">pAs</span></a></span><span>
</span><span id="line-745"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-746"></span><span>        </span><span id="local-6989586621679229742"><span class="annot"><span class="annottext">as :: SAttrs
</span><a href="#local-6989586621679229742"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobAttrs -&gt; SAttrs
</span><a href="#local-6989586621679229734"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobAttrs -&gt; SAttrs) -&gt; GlobAttrs -&gt; SAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#clusterAttrs"><span class="hs-identifier hs-var">clusterAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229741"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-747"></span><span>        </span><span id="local-6989586621679229744"><span class="annot"><span class="annottext">p :: Maybe GraphID
</span><a href="#local-6989586621679229744"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229741"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-748"></span><span>        </span><span id="local-6989586621679229743"><span class="annot"><span class="annottext">pAs :: SAttrs
</span><a href="#local-6989586621679229743"><span class="hs-identifier hs-var hs-var">pAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Maybe SAttrs -&gt; SAttrs
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229736"><span class="hs-identifier hs-var">gGlob</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe SAttrs -&gt; SAttrs) -&gt; Maybe SAttrs -&gt; SAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID SAttrs -&gt; Maybe SAttrs
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID SAttrs
</span><a href="#local-6989586621679229737"><span class="hs-identifier hs-var">aM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe SAttrs) -&gt; Maybe GraphID -&gt; Maybe SAttrs
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229744"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span id="local-6989586621679228386"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusterPath"><span class="hs-identifier hs-type">clusterPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228386"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html#Path"><span class="hs-identifier hs-type">St.Path</span></a></span></span><span>
</span><span id="line-751"></span><span id="clusterPath"><span class="annot"><span class="annottext">clusterPath :: forall n. DotGraph n -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
</span><a href="Data.GraphViz.Types.Graph.html#clusterPath"><span class="hs-identifier hs-var hs-var">clusterPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe GraphID)
-&gt; Map GraphID (Seq (Maybe GraphID))
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
forall k1 k2 a. (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapKeysMonotonic"><span class="hs-identifier hs-var">M.mapKeysMonotonic</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Maybe GraphID
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Map GraphID (Seq (Maybe GraphID))
 -&gt; Map (Maybe GraphID) (Seq (Maybe GraphID)))
-&gt; (DotGraph n -&gt; Map GraphID (Seq (Maybe GraphID)))
-&gt; DotGraph n
-&gt; Map (Maybe GraphID) (Seq (Maybe GraphID))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq GraphID -&gt; Seq (Maybe GraphID))
-&gt; Map GraphID (Seq GraphID) -&gt; Map GraphID (Seq (Maybe GraphID))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe GraphID) -&gt; Seq GraphID -&gt; Seq (Maybe GraphID)
forall a b. (a -&gt; b) -&gt; Seq a -&gt; Seq b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; Maybe GraphID
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map GraphID (Seq GraphID) -&gt; Map GraphID (Seq (Maybe GraphID)))
-&gt; (DotGraph n -&gt; Map GraphID (Seq GraphID))
-&gt; DotGraph n
-&gt; Map GraphID (Seq (Maybe GraphID))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID (Seq GraphID)
forall n. DotGraph n -&gt; Map GraphID (Seq GraphID)
</span><a href="Data.GraphViz.Types.Graph.html#clusterPath%27"><span class="hs-identifier hs-var">clusterPath'</span></a></span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span id="local-6989586621679228168"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusterPath%27"><span class="hs-identifier hs-type">clusterPath'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228168"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq.Seq</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-754"></span><span id="clusterPath%27"><span class="annot"><span class="annottext">clusterPath' :: forall n. DotGraph n -&gt; Map GraphID (Seq GraphID)
</span><a href="Data.GraphViz.Types.Graph.html#clusterPath%27"><span class="hs-identifier hs-var hs-var">clusterPath'</span></a></span></span><span> </span><span id="local-6989586621679229750"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229750"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map GraphID (Seq GraphID)
</span><a href="#local-6989586621679229751"><span class="hs-identifier hs-var">pM</span></a></span><span>
</span><span id="line-755"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-756"></span><span>    </span><span id="local-6989586621679229752"><span class="annot"><span class="annottext">cs :: Map GraphID ClusterInfo
</span><a href="#local-6989586621679229752"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n -&gt; Map GraphID ClusterInfo
forall n. DotGraph n -&gt; Map GraphID ClusterInfo
</span><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229750"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621679229751"><span class="annot"><span class="annottext">pM :: Map GraphID (Seq GraphID)
</span><a href="#local-6989586621679229751"><span class="hs-identifier hs-var hs-var">pM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; ClusterInfo -&gt; Seq GraphID)
-&gt; Map GraphID ClusterInfo -&gt; Map GraphID (Seq GraphID)
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapWithKey"><span class="hs-identifier hs-var">M.mapWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; ClusterInfo -&gt; Seq GraphID
</span><a href="#local-6989586621679229753"><span class="hs-identifier hs-var">pathOf</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID ClusterInfo
</span><a href="#local-6989586621679229752"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span>    </span><span id="local-6989586621679229753"><span class="annot"><span class="annottext">pathOf :: GraphID -&gt; ClusterInfo -&gt; Seq GraphID
</span><a href="#local-6989586621679229753"><span class="hs-identifier hs-var hs-var">pathOf</span></a></span></span><span> </span><span id="local-6989586621679229754"><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229754"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679229755"><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229755"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq GraphID
</span><a href="#local-6989586621679229756"><span class="hs-identifier hs-var">pPth</span></a></span><span> </span><span class="annot"><span class="annottext">Seq GraphID -&gt; GraphID -&gt; Seq GraphID
forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">Seq.|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">GraphID
</span><a href="#local-6989586621679229754"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-761"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-762"></span><span>        </span><span id="local-6989586621679229758"><span class="annot"><span class="annottext">mp :: Maybe GraphID
</span><a href="#local-6989586621679229758"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterInfo -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Graph.html#parentCluster"><span class="hs-identifier hs-var">parentCluster</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterInfo
</span><a href="#local-6989586621679229755"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-763"></span><span>        </span><span id="local-6989586621679229756"><span class="annot"><span class="annottext">pPth :: Seq GraphID
</span><a href="#local-6989586621679229756"><span class="hs-identifier hs-var hs-var">pPth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq GraphID -&gt; Maybe (Seq GraphID) -&gt; Seq GraphID
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Seq GraphID
forall a. Seq a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">Seq.empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Seq GraphID) -&gt; Seq GraphID)
-&gt; Maybe (Seq GraphID) -&gt; Seq GraphID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphID -&gt; Map GraphID (Seq GraphID) -&gt; Maybe (Seq GraphID)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`M.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map GraphID (Seq GraphID)
</span><a href="#local-6989586621679229751"><span class="hs-identifier hs-var">pM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphID -&gt; Maybe (Seq GraphID))
-&gt; Maybe GraphID -&gt; Maybe (Seq GraphID)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679229758"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-764"></span><span>
</span><span id="line-765"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span id="local-6989586621679228095"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-type">withValues</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228095"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeMap"><span class="hs-identifier hs-type">NodeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228095"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228095"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228095"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-768"></span><span id="withValues"><span class="annot"><span class="annottext">withValues :: forall n. (NodeMap n -&gt; NodeMap n) -&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withValues"><span class="hs-identifier hs-var hs-var">withValues</span></a></span></span><span> </span><span id="local-6989586621679229761"><span class="annot"><span class="annottext">NodeMap n -&gt; NodeMap n
</span><a href="#local-6989586621679229761"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229762"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229762"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229762"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229761"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229762"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span id="local-6989586621679228149"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#withClusters"><span class="hs-identifier hs-type">withClusters</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#ClusterInfo"><span class="hs-identifier hs-type">ClusterInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#ClusterInfo"><span class="hs-identifier hs-type">ClusterInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228149"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228149"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-772"></span><span id="withClusters"><span class="annot"><span class="annottext">withClusters :: forall n.
(Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo)
-&gt; DotGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Types.Graph.html#withClusters"><span class="hs-identifier hs-var hs-var">withClusters</span></a></span></span><span> </span><span id="local-6989586621679229763"><span class="annot"><span class="annottext">Map GraphID ClusterInfo -&gt; Map GraphID ClusterInfo
</span><a href="#local-6989586621679229763"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229764"><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229764"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679229764"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229763"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229764"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#toGlobAttrs"><span class="hs-identifier hs-type">toGlobAttrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-type">GlobAttrs</span></a></span><span>
</span><span id="line-775"></span><span id="toGlobAttrs"><span class="annot"><span class="annottext">toGlobAttrs :: [GlobalAttributes] -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#toGlobAttrs"><span class="hs-identifier hs-var hs-var">toGlobAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attributes, Attributes, Attributes) -&gt; GlobAttrs
</span><a href="#local-6989586621679229765"><span class="hs-identifier hs-var">mkGA</span></a></span><span> </span><span class="annot"><span class="annottext">((Attributes, Attributes, Attributes) -&gt; GlobAttrs)
-&gt; ([GlobalAttributes] -&gt; (Attributes, Attributes, Attributes))
-&gt; [GlobalAttributes]
-&gt; GlobAttrs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes] -&gt; (Attributes, Attributes, Attributes)
</span><a href="Data.GraphViz.Types.Internal.Common.html#partitionGlobal"><span class="hs-identifier hs-var">partitionGlobal</span></a></span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679229765"><span class="annot"><span class="annottext">mkGA :: (Attributes, Attributes, Attributes) -&gt; GlobAttrs
</span><a href="#local-6989586621679229765"><span class="hs-identifier hs-var hs-var">mkGA</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679229766"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229766"><span class="hs-identifier hs-var">ga</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229767"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229767"><span class="hs-identifier hs-var">na</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679229768"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229768"><span class="hs-identifier hs-var">ea</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs -&gt; GlobAttrs
</span><a href="Data.GraphViz.Types.Graph.html#GA"><span class="hs-identifier hs-var">GA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229766"><span class="hs-identifier hs-var">ga</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229767"><span class="hs-identifier hs-var">na</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679229768"><span class="hs-identifier hs-var">ea</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>
</span><span id="line-779"></span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#fromGlobAttrs"><span class="hs-identifier hs-type">fromGlobAttrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GlobAttrs"><span class="hs-identifier hs-type">GlobAttrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-780"></span><span id="fromGlobAttrs"><span class="annot"><span class="annottext">fromGlobAttrs :: GlobAttrs -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Graph.html#fromGlobAttrs"><span class="hs-identifier hs-var hs-var">fromGlobAttrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#GA"><span class="hs-identifier hs-type">GA</span></a></span><span> </span><span id="local-6989586621679229769"><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229769"><span class="hs-identifier hs-var">ga</span></a></span></span><span> </span><span id="local-6989586621679229770"><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229770"><span class="hs-identifier hs-var">na</span></a></span></span><span> </span><span id="local-6989586621679229771"><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229771"><span class="hs-identifier hs-var">ea</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalAttributes -&gt; Bool)
-&gt; [GlobalAttributes] -&gt; [GlobalAttributes]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (GlobalAttributes -&gt; Bool) -&gt; GlobalAttributes -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; Bool)
-&gt; (GlobalAttributes -&gt; Attributes) -&gt; GlobalAttributes -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalAttributes -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#attrs"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>                              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#GraphAttrs"><span class="hs-identifier hs-var">GraphAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; GlobalAttributes) -&gt; Attributes -&gt; GlobalAttributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229769"><span class="hs-identifier hs-var">ga</span></a></span><span>
</span><span id="line-782"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#NodeAttrs"><span class="hs-identifier hs-var">NodeAttrs</span></a></span><span>  </span><span class="annot"><span class="annottext">(Attributes -&gt; GlobalAttributes) -&gt; Attributes -&gt; GlobalAttributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229770"><span class="hs-identifier hs-var">na</span></a></span><span>
</span><span id="line-783"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#EdgeAttrs"><span class="hs-identifier hs-var">EdgeAttrs</span></a></span><span>  </span><span class="annot"><span class="annottext">(Attributes -&gt; GlobalAttributes) -&gt; Attributes -&gt; GlobalAttributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Attributes
</span><a href="Data.GraphViz.Attributes.Same.html#unSame"><span class="hs-identifier hs-var">unSame</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679229771"><span class="hs-identifier hs-var">ea</span></a></span><span>
</span><span id="line-784"></span><span>                              </span><span class="hs-special">]</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-keyword">type</span><span> </span><span id="UpdateEdgeMap"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#UpdateEdgeMap"><span class="hs-identifier hs-var">UpdateEdgeMap</span></a></span></span><span> </span><span id="local-6989586621679229775"><span class="annot"><a href="#local-6989586621679229775"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229775"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229775"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229775"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229775"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span id="local-6989586621679229776"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#niSucc"><span class="hs-identifier hs-type">niSucc</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#UpdateEdgeMap"><span class="hs-identifier hs-type">UpdateEdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229776"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-789"></span><span id="niSucc"><span class="annot"><span class="annottext">niSucc :: forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSucc"><span class="hs-identifier hs-var hs-var">niSucc</span></a></span></span><span> </span><span id="local-6989586621679229777"><span class="annot"><span class="annottext">EdgeMap n -&gt; EdgeMap n
</span><a href="#local-6989586621679229777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229778"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229778"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229778"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229777"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_successors"><span class="hs-identifier hs-var">_successors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229778"><span class="hs-identifier hs-type">ni</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span id="local-6989586621679229779"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#niPred"><span class="hs-identifier hs-type">niPred</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#UpdateEdgeMap"><span class="hs-identifier hs-type">UpdateEdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229779"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-792"></span><span id="niPred"><span class="annot"><span class="annottext">niPred :: forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niPred"><span class="hs-identifier hs-var hs-var">niPred</span></a></span></span><span> </span><span id="local-6989586621679229780"><span class="annot"><span class="annottext">EdgeMap n -&gt; EdgeMap n
</span><a href="#local-6989586621679229780"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679229781"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229781"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229781"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var">_predecessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679229780"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#_predecessors"><span class="hs-identifier hs-var">_predecessors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229781"><span class="hs-identifier hs-type">ni</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span id="local-6989586621679228112"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#niSkip"><span class="hs-identifier hs-type">niSkip</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#UpdateEdgeMap"><span class="hs-identifier hs-type">UpdateEdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228112"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-795"></span><span id="niSkip"><span class="annot"><span class="annottext">niSkip :: forall n. UpdateEdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#niSkip"><span class="hs-identifier hs-var hs-var">niSkip</span></a></span></span><span> </span><span class="annot"><span class="annottext">EdgeMap n -&gt; EdgeMap n
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679229782"><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229782"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeInfo n
</span><a href="#local-6989586621679229782"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span id="local-6989586621679228096"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#toMap"><span class="hs-identifier hs-type">toMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228096"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228096"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228096"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-798"></span><span id="toMap"><span class="annot"><span class="annottext">toMap :: forall n. Ord n =&gt; [(n, Attributes)] -&gt; EdgeMap n
</span><a href="Data.GraphViz.Types.Graph.html#toMap"><span class="hs-identifier hs-var hs-var">toMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(n, [Attributes])] -&gt; Map n [Attributes]
forall k a. Eq k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromAscList"><span class="hs-identifier hs-var">M.fromAscList</span></a></span><span> </span><span class="annot"><span class="annottext">([(n, [Attributes])] -&gt; Map n [Attributes])
-&gt; ([(n, Attributes)] -&gt; [(n, [Attributes])])
-&gt; [(n, Attributes)]
-&gt; Map n [Attributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((n, Attributes) -&gt; n)
-&gt; ((n, Attributes) -&gt; Attributes)
-&gt; [(n, Attributes)]
-&gt; [(n, [Attributes])]
forall b a c. Ord b =&gt; (a -&gt; b) -&gt; (a -&gt; c) -&gt; [a] -&gt; [(b, [c])]
</span><a href="Data.GraphViz.Internal.Util.html#groupSortCollectBy"><span class="hs-identifier hs-var">groupSortCollectBy</span></a></span><span> </span><span class="annot"><span class="annottext">(n, Attributes) -&gt; n
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(n, Attributes) -&gt; Attributes
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span id="local-6989586621679228097"><span class="annot"><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-type">fromMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Graph.html#EdgeMap"><span class="hs-identifier hs-type">EdgeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228097"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228097"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-801"></span><span id="fromMap"><span class="annot"><span class="annottext">fromMap :: forall n. EdgeMap n -&gt; [(n, Attributes)]
</span><a href="Data.GraphViz.Types.Graph.html#fromMap"><span class="hs-identifier hs-var hs-var">fromMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, [Attributes]) -&gt; [(n, Attributes)])
-&gt; [(n, [Attributes])] -&gt; [(n, Attributes)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(n -&gt; [Attributes] -&gt; [(n, Attributes)])
-&gt; (n, [Attributes]) -&gt; [(n, Attributes)]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Attributes -&gt; (n, Attributes))
-&gt; [Attributes] -&gt; [(n, Attributes)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">((Attributes -&gt; (n, Attributes))
 -&gt; [Attributes] -&gt; [(n, Attributes)])
-&gt; (n -&gt; Attributes -&gt; (n, Attributes))
-&gt; n
-&gt; [Attributes]
-&gt; [(n, Attributes)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(n, [Attributes])] -&gt; [(n, Attributes)])
-&gt; (EdgeMap n -&gt; [(n, [Attributes])])
-&gt; EdgeMap n
-&gt; [(n, Attributes)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeMap n -&gt; [(n, [Attributes])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span>
</span><span id="line-802"></span></pre></body></html>