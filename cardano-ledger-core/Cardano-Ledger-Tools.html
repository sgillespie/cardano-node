<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cardano.Ledger.Tools</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cardano-ledger-core-1.10.0.0: Core components of Cardano ledgers from the Shelley release on.</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/Cardano.Ledger.Tools.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cardano.Ledger.Tools</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This is a module that contains functionality that is not necessary for ledger
 operation, but is useful for testing as well as for downstream users of ledger</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:setMinFeeTx">setMinFeeTx</a> :: <a href="Cardano-Ledger-Core.html#t:EraTx" title="Cardano.Ledger.Core">EraTx</a> era =&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</li><li class="src short"><a href="#v:calcMinFeeTx">calcMinFeeTx</a> :: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-UTxO.html#t:EraUTxO" title="Cardano.Ledger.UTxO">EraUTxO</a> era =&gt; <a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a> -&gt; <a href="Cardano-Ledger-Coin.html#t:Coin" title="Cardano.Ledger.Coin">Coin</a></li><li class="src short"><a href="#v:calcMinFeeTxNativeScriptWits">calcMinFeeTxNativeScriptWits</a> :: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-UTxO.html#t:EraUTxO" title="Cardano.Ledger.UTxO">EraUTxO</a> era =&gt; <a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Set" title="Distribution.Compat.Prelude">Set</a> (<a href="Cardano-Ledger-Keys.html#t:KeyHash" title="Cardano.Ledger.Keys">KeyHash</a> '<a href="Cardano-Ledger-Keys.html#v:Witness" title="Cardano.Ledger.Keys">Witness</a> (<a href="Cardano-Ledger-Core.html#t:EraCrypto" title="Cardano.Ledger.Core">EraCrypto</a> era)) -&gt; <a href="Cardano-Ledger-Coin.html#t:Coin" title="Cardano.Ledger.Coin">Coin</a></li><li class="src short"><a href="#v:estimateMinFeeTx">estimateMinFeeTx</a> :: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-Core.html#t:EraTx" title="Cardano.Ledger.Core">EraTx</a> era =&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a> -&gt; <a href="Cardano-Ledger-Coin.html#t:Coin" title="Cardano.Ledger.Coin">Coin</a></li><li class="src short"><a href="#v:addDummyWitsTx">addDummyWitsTx</a> :: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-Core.html#t:EraTx" title="Cardano.Ledger.Core">EraTx</a> era =&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a> -&gt; [Attributes AddrAttributes] -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</li><li class="src short"><a href="#v:integralToByteStringN">integralToByteStringN</a> :: (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Integral" title="Distribution.Compat.Prelude">Integral</a> i, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> i) =&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a> -&gt; i -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:setMinFeeTx" class="def">setMinFeeTx</a> :: <a href="Cardano-Ledger-Core.html#t:EraTx" title="Cardano.Ledger.Core">EraTx</a> era =&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era -&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era <a href="src/Cardano.Ledger.Tools.html#setMinFeeTx" class="link">Source</a> <a href="#v:setMinFeeTx" class="selflink">#</a></p><div class="doc"><p>Calculate and update the fee in the transaction until it has the smallest possible
 value according to the settings in the protocol parameters.</p><p>This function potentially changes the <code><a href="Cardano-Ledger-Core.html#v:feeTxBodyL" title="Cardano.Ledger.Core">feeTxBodyL</a></code> field of the <code><a href="Cardano-Ledger-Core.html#t:TxBody" title="Cardano.Ledger.Core">TxBody</a></code>, as such it
 affects the hash of the body, which consequently invalidates all of the signature in
 the attached witnesses.</p></div></div><div class="top"><p class="src"><a id="v:calcMinFeeTx" class="def">calcMinFeeTx</a> <a href="src/Cardano.Ledger.Tools.html#calcMinFeeTx" class="link">Source</a> <a href="#v:calcMinFeeTx" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-UTxO.html#t:EraUTxO" title="Cardano.Ledger.UTxO">EraUTxO</a> era</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a> era</td><td class="doc"><p>All TxOuts available for this transaction. In other words <code>TxIn</code>s produced by
 <code><a href="Cardano-Ledger-Core.html#v:allInputsTxBodyF" title="Cardano.Ledger.Core">allInputsTxBodyF</a></code> should be present in this <code><a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a></code> map, however this is not checked.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era</td><td class="doc"><p>The current protocol parameters.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</td><td class="doc"><p>The transaction.</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a></td><td class="doc"><p>Number of extra KeyHash witnesses that will be supplied for satisfying native
 scripts. It is impossible to know how many of these is required without knowing the
 actual witnesses supplied and the time when the transaction will be
 submitted. Therefore we put this burden on the user.</p><p>This number can also be used to specify all of the redundant extra key witnesses that
 will be supplied.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Coin.html#t:Coin" title="Cardano.Ledger.Coin">Coin</a></td><td class="doc"><p>The required minimum fee.</p></td></tr></table></div><div class="doc"><p>This is a more accurate version <code><a href="Cardano-Ledger-Tools.html#v:estimateMinFeeTx" title="Cardano.Ledger.Tools">estimateMinFeeTx</a></code> that looks into transaction and
 figures out how many and what kind of key witnesses this transaction needs. It requires
 access to the portion of the <code><a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a></code> that is relevant for this transaction. The only
 type of witnesses that it cannot figure out reliably is the witnesses needed for
 satisfying native scripts included in the transaction. For this reason number of
 witnesses needed for native scripts must be supplied as an extra argument.</p><h4 class="subheading details-toggle-control details-toggle" data-details-id="ch:calcMinFeeTx0">Example</h4><details id="ch:calcMinFeeTx0"><summary class="hide-when-js-enabled">Expand</summary><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let relevantUtxo = txInsFilter utxo (tx ^. bodyTxL . allInputsTxBodyF)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>calcMinFeeTx relevantUtxo pp tx 5
</code></strong></pre></details></div></div><div class="top"><p class="src"><a id="v:calcMinFeeTxNativeScriptWits" class="def">calcMinFeeTxNativeScriptWits</a> <a href="src/Cardano.Ledger.Tools.html#calcMinFeeTxNativeScriptWits" class="link">Source</a> <a href="#v:calcMinFeeTxNativeScriptWits" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-UTxO.html#t:EraUTxO" title="Cardano.Ledger.UTxO">EraUTxO</a> era</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a> era</td><td class="doc"><p>All TxOuts available for this transaction. In other words <code>TxIn</code>s produced by
 <code><a href="Cardano-Ledger-Core.html#v:allInputsTxBodyF" title="Cardano.Ledger.Core">allInputsTxBodyF</a></code> should be present in this <code><a href="Cardano-Ledger-UTxO.html#t:UTxO" title="Cardano.Ledger.UTxO">UTxO</a></code> map, however this is not checked.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era</td><td class="doc"><p>The current protocol parameters.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</td><td class="doc"><p>The transaction.</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Set" title="Distribution.Compat.Prelude">Set</a> (<a href="Cardano-Ledger-Keys.html#t:KeyHash" title="Cardano.Ledger.Keys">KeyHash</a> '<a href="Cardano-Ledger-Keys.html#v:Witness" title="Cardano.Ledger.Keys">Witness</a> (<a href="Cardano-Ledger-Core.html#t:EraCrypto" title="Cardano.Ledger.Core">EraCrypto</a> era))</td><td class="doc"><p>KeyHash witnesses that will be supplied for satisfying native scripts. It is
 impossible to know how many of these is required without knowing the actual witnesses
 supplied and the time when the transaction will be submitted. Therefore we put this
 burden on the user.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Coin.html#t:Coin" title="Cardano.Ledger.Coin">Coin</a></td><td class="doc"><p>The required minimum fee.</p></td></tr></table></div><div class="doc"><p>Same as <code><a href="Cardano-Ledger-Tools.html#v:calcMinFeeTx" title="Cardano.Ledger.Tools">calcMinFeeTx</a></code>, except this function allows to specify hashes of key witnesses
 that will be supplied, instead of their count. That is only useful whenever there is a
 chance of some of the required witnesses being the same as the witnesses that will be
 supplied for native scripts.</p></div></div><div class="top"><p class="src"><a id="v:estimateMinFeeTx" class="def">estimateMinFeeTx</a> <a href="src/Cardano.Ledger.Tools.html#estimateMinFeeTx" class="link">Source</a> <a href="#v:estimateMinFeeTx" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-Core.html#t:EraTx" title="Cardano.Ledger.Core">EraTx</a> era</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era</td><td class="doc"><p>The current protocol parameters.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</td><td class="doc"><p>The transaction.</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a></td><td class="doc"><p>The number of key witnesses still to be added to the transaction.</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a></td><td class="doc"><p>The number of Byron key witnesses still to be added to the transaction.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Coin.html#t:Coin" title="Cardano.Ledger.Coin">Coin</a></td><td class="doc"><p>The required minimum fee.</p></td></tr></table></div><div class="doc"><p>Estimate a minimum transaction fee for a transaction that does not yet have all of
 the <code><a href="Cardano-Ledger-Keys.html#t:VKey" title="Cardano.Ledger.Keys">VKey</a></code> witnesses. This calculation is not very accurate in estimating Byron
 witnesses, but it should work for the most part. If you have access to UTxO necessary
 for the transaction that it is better and easier to use <code><a href="Cardano-Ledger-Tools.html#v:calcMinFeeTx" title="Cardano.Ledger.Tools">calcMinFeeTx</a></code> instead.</p><p><em>Since: 1.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:addDummyWitsTx" class="def">addDummyWitsTx</a> <a href="src/Cardano.Ledger.Tools.html#addDummyWitsTx" class="link">Source</a> <a href="#v:addDummyWitsTx" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> era. <a href="Cardano-Ledger-Core.html#t:EraTx" title="Cardano.Ledger.Core">EraTx</a> era</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Ledger-Core.html#t:PParams" title="Cardano.Ledger.Core">PParams</a> era</td><td class="doc"><p>The current protocol parameters.</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</td><td class="doc"><p>The transaction.</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a></td><td class="doc"><p>The number of key witnesses still to be added to the transaction.</p></td></tr><tr><td class="src">-&gt; [Attributes AddrAttributes]</td><td class="doc"><p>List of attributes from TxOuts with Byron addresses that are being spent</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Ledger-Core.html#t:Tx" title="Cardano.Ledger.Core">Tx</a> era</td><td class="doc"><p>The required minimum fee.</p></td></tr></table></div><div class="doc"><p>Create dummy witnesses and add them to the transaction</p></div></div><div class="top"><p class="src"><a id="v:integralToByteStringN" class="def">integralToByteStringN</a> :: (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Integral" title="Distribution.Compat.Prelude">Integral</a> i, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> i) =&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/Cabal-syntax-3.10.1.0/Distribution-Compat-Prelude.html#t:Int" title="Distribution.Compat.Prelude">Int</a> -&gt; i -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Cardano.Ledger.Tools.html#integralToByteStringN" class="link">Source</a> <a href="#v:integralToByteStringN" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>