<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Consensus.NodeKernel</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-consensus-diffusion-0.10.0.0: Integration for the Ouroboros Network layer</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/Ouroboros.Consensus.NodeKernel.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.NodeKernel</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Node kernel</a></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:MempoolCapacityBytesOverride">MempoolCapacityBytesOverride</a><ul class="subs"><li>= <a href="#v:NoMempoolCapacityBytesOverride">NoMempoolCapacityBytesOverride</a></li><li>| <a href="#v:MempoolCapacityBytesOverride">MempoolCapacityBytesOverride</a> !MempoolCapacityBytes</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:NodeKernel">NodeKernel</a> m addrNTN addrNTC blk = <a href="#v:NodeKernel">NodeKernel</a> {<ul class="subs"><li><a href="#v:getChainDB">getChainDB</a> :: ChainDB m blk</li><li><a href="#v:getMempool">getMempool</a> :: Mempool m blk</li><li><a href="#v:getTopLevelConfig">getTopLevelConfig</a> :: TopLevelConfig blk</li><li><a href="#v:getFetchClientRegistry">getFetchClientRegistry</a> :: FetchClientRegistry (ConnectionId addrNTN) (Header blk) blk m</li><li><a href="#v:getFetchMode">getFetchMode</a> :: STM m FetchMode</li><li><a href="#v:getNodeCandidates">getNodeCandidates</a> :: StrictTVar m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> (ConnectionId addrNTN) (StrictTVar m (AnchoredFragment (Header blk))))</li><li><a href="#v:getPeerSharingRegistry">getPeerSharingRegistry</a> :: PeerSharingRegistry addrNTN m</li><li><a href="#v:getTracers">getTracers</a> :: <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m (ConnectionId addrNTN) addrNTC blk</li><li><a href="#v:setBlockForging">setBlockForging</a> :: [BlockForging m blk] -&gt; m ()</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:NodeKernelArgs">NodeKernelArgs</a> m addrNTN addrNTC blk = <a href="#v:NodeKernelArgs">NodeKernelArgs</a> {<ul class="subs"><li><a href="#v:tracers">tracers</a> :: <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m (ConnectionId addrNTN) addrNTC blk</li><li><a href="#v:registry">registry</a> :: ResourceRegistry m</li><li><a href="#v:cfg">cfg</a> :: TopLevelConfig blk</li><li><a href="#v:btime">btime</a> :: BlockchainTime m</li><li><a href="#v:chainDB">chainDB</a> :: ChainDB m blk</li><li><a href="#v:initChainDB">initChainDB</a> :: StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()</li><li><a href="#v:chainSyncFutureCheck">chainSyncFutureCheck</a> :: SomeHeaderInFutureCheck m blk</li><li><a href="#v:blockFetchSize">blockFetchSize</a> :: Header blk -&gt; SizeInBytes</li><li><a href="#v:mempoolCapacityOverride">mempoolCapacityOverride</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a></li><li><a href="#v:miniProtocolParameters">miniProtocolParameters</a> :: MiniProtocolParameters</li><li><a href="#v:blockFetchConfiguration">blockFetchConfiguration</a> :: BlockFetchConfiguration</li><li><a href="#v:keepAliveRng">keepAliveRng</a> :: StdGen</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:TraceForgeEvent">TraceForgeEvent</a> blk<ul class="subs"><li>= <a href="#v:TraceStartLeadershipCheck">TraceStartLeadershipCheck</a> SlotNo</li><li>| <a href="#v:TraceSlotIsImmutable">TraceSlotIsImmutable</a> SlotNo (Point blk) BlockNo</li><li>| <a href="#v:TraceBlockFromFuture">TraceBlockFromFuture</a> SlotNo SlotNo</li><li>| <a href="#v:TraceBlockContext">TraceBlockContext</a> SlotNo BlockNo (Point blk)</li><li>| <a href="#v:TraceNoLedgerState">TraceNoLedgerState</a> SlotNo (Point blk)</li><li>| <a href="#v:TraceLedgerState">TraceLedgerState</a> SlotNo (Point blk)</li><li>| <a href="#v:TraceNoLedgerView">TraceNoLedgerView</a> SlotNo OutsideForecastRange</li><li>| <a href="#v:TraceLedgerView">TraceLedgerView</a> SlotNo</li><li>| <a href="#v:TraceForgeStateUpdateError">TraceForgeStateUpdateError</a> SlotNo (ForgeStateUpdateError blk)</li><li>| <a href="#v:TraceNodeCannotForge">TraceNodeCannotForge</a> SlotNo (CannotForge blk)</li><li>| <a href="#v:TraceNodeNotLeader">TraceNodeNotLeader</a> SlotNo</li><li>| <a href="#v:TraceNodeIsLeader">TraceNodeIsLeader</a> SlotNo</li><li>| <a href="#v:TraceForgeTickedLedgerState">TraceForgeTickedLedgerState</a> SlotNo (Point blk)</li><li>| <a href="#v:TraceForgingMempoolSnapshot">TraceForgingMempoolSnapshot</a> SlotNo (Point blk) (ChainHash blk) SlotNo</li><li>| <a href="#v:TraceForgedBlock">TraceForgedBlock</a> SlotNo (Point blk) blk MempoolSize</li><li>| <a href="#v:TraceDidntAdoptBlock">TraceDidntAdoptBlock</a> SlotNo blk</li><li>| <a href="#v:TraceAdoptionThreadDied">TraceAdoptionThreadDied</a> SlotNo blk</li><li>| <a href="#v:TraceForgedInvalidBlock">TraceForgedInvalidBlock</a> SlotNo blk (InvalidBlockReason blk)</li><li>| <a href="#v:TraceAdoptedBlock">TraceAdoptedBlock</a> SlotNo blk [Validated (GenTx blk)]</li></ul></li><li class="src short"><a href="#v:getMempoolReader">getMempoolReader</a> :: <span class="keyword">forall</span> m blk. (LedgerSupportsMempool blk, IOLike m, HasTxId (GenTx blk)) =&gt; Mempool m blk -&gt; TxSubmissionMempoolReader (GenTxId blk) (Validated (GenTx blk)) TicketNo m</li><li class="src short"><a href="#v:getMempoolWriter">getMempoolWriter</a> :: (LedgerSupportsMempool blk, IOLike m, HasTxId (GenTx blk)) =&gt; Mempool m blk -&gt; TxSubmissionMempoolWriter (GenTxId blk) (GenTx blk) TicketNo m</li><li class="src short"><a href="#v:getPeersFromCurrentLedger">getPeersFromCurrentLedger</a> :: (IOLike m, LedgerSupportsPeerSelection blk) =&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m addrNTN addrNTC blk -&gt; (LedgerState blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; STM m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> [(PoolStake, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> RelayAccessPoint)])</li><li class="src short"><a href="#v:getPeersFromCurrentLedgerAfterSlot">getPeersFromCurrentLedgerAfterSlot</a> :: <span class="keyword">forall</span> m blk addrNTN addrNTC. (IOLike m, LedgerSupportsPeerSelection blk, UpdateLedger blk) =&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m addrNTN addrNTC blk -&gt; SlotNo -&gt; STM m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> [(PoolStake, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> RelayAccessPoint)])</li><li class="src short"><a href="#v:initNodeKernel">initNodeKernel</a> :: <span class="keyword">forall</span> m addrNTN addrNTC blk. (IOLike m, <a href="Ouroboros-Consensus-Node.html#t:RunNode" title="Ouroboros.Consensus.Node">RunNode</a> blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> addrNTN, Hashable addrNTN, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> addrNTN) =&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernelArgs" title="Ouroboros.Consensus.NodeKernel">NodeKernelArgs</a> m addrNTN addrNTC blk -&gt; m (<a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m addrNTN addrNTC blk)</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Node kernel</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MempoolCapacityBytesOverride" class="def">MempoolCapacityBytesOverride</a> <a href="#t:MempoolCapacityBytesOverride" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NoMempoolCapacityBytesOverride" class="def">NoMempoolCapacityBytesOverride</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:MempoolCapacityBytesOverride" class="def">MempoolCapacityBytesOverride</a> !MempoolCapacityBytes</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:MempoolCapacityBytesOverride">Instances</h4><details id="i:MempoolCapacityBytesOverride" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MempoolCapacityBytesOverride:Show:1"></span> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MempoolCapacityBytesOverride:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Mempool-Capacity.html">Ouroboros.Consensus.Mempool.Capacity</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a>] -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MempoolCapacityBytesOverride:Eq:2"></span> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MempoolCapacityBytesOverride:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Mempool-Capacity.html">Ouroboros.Consensus.Mempool.Capacity</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a> -&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a> -&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:NodeKernel" class="def">NodeKernel</a> m addrNTN addrNTC blk <a href="src/Ouroboros.Consensus.NodeKernel.html#NodeKernel" class="link">Source</a> <a href="#t:NodeKernel" class="selflink">#</a></p><div class="doc"><p>Interface against running relay node</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NodeKernel" class="def">NodeKernel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getChainDB" class="def">getChainDB</a> :: ChainDB m blk</dfn><div class="doc"><p>The <code>ChainDB</code> of the node</p></div></li><li><dfn class="src"><a id="v:getMempool" class="def">getMempool</a> :: Mempool m blk</dfn><div class="doc"><p>The node's mempool</p></div></li><li><dfn class="src"><a id="v:getTopLevelConfig" class="def">getTopLevelConfig</a> :: TopLevelConfig blk</dfn><div class="doc"><p>The node's top-level static configuration</p></div></li><li><dfn class="src"><a id="v:getFetchClientRegistry" class="def">getFetchClientRegistry</a> :: FetchClientRegistry (ConnectionId addrNTN) (Header blk) blk m</dfn><div class="doc"><p>The fetch client registry, used for the block fetch clients.</p></div></li><li><dfn class="src"><a id="v:getFetchMode" class="def">getFetchMode</a> :: STM m FetchMode</dfn><div class="doc"><p>The fetch mode, used by diffusion.</p></div></li><li><dfn class="src"><a id="v:getNodeCandidates" class="def">getNodeCandidates</a> :: StrictTVar m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> (ConnectionId addrNTN) (StrictTVar m (AnchoredFragment (Header blk))))</dfn><div class="doc"><p>Read the current candidates</p></div></li><li><dfn class="src"><a id="v:getPeerSharingRegistry" class="def">getPeerSharingRegistry</a> :: PeerSharingRegistry addrNTN m</dfn><div class="doc"><p>Read the current peer sharing registry, used for interacting with
 the PeerSharing protocol</p></div></li><li><dfn class="src"><a id="v:getTracers" class="def">getTracers</a> :: <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m (ConnectionId addrNTN) addrNTC blk</dfn><div class="doc"><p>The node's tracers</p></div></li><li><dfn class="src"><a id="v:setBlockForging" class="def">setBlockForging</a> :: [BlockForging m blk] -&gt; m ()</dfn><div class="doc"><p>Set block forging</p><p>When set with the empty list '[]' block forging will be disabled.</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:NodeKernelArgs" class="def">NodeKernelArgs</a> m addrNTN addrNTC blk <a href="src/Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs" class="link">Source</a> <a href="#t:NodeKernelArgs" class="selflink">#</a></p><div class="doc"><p>Arguments required when initializing a node</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NodeKernelArgs" class="def">NodeKernelArgs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:tracers" class="def">tracers</a> :: <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m (ConnectionId addrNTN) addrNTC blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:registry" class="def">registry</a> :: ResourceRegistry m</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:cfg" class="def">cfg</a> :: TopLevelConfig blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:btime" class="def">btime</a> :: BlockchainTime m</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:chainDB" class="def">chainDB</a> :: ChainDB m blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:initChainDB" class="def">initChainDB</a> :: StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:chainSyncFutureCheck" class="def">chainSyncFutureCheck</a> :: SomeHeaderInFutureCheck m blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:blockFetchSize" class="def">blockFetchSize</a> :: Header blk -&gt; SizeInBytes</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:mempoolCapacityOverride" class="def">mempoolCapacityOverride</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:miniProtocolParameters" class="def">miniProtocolParameters</a> :: MiniProtocolParameters</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:blockFetchConfiguration" class="def">blockFetchConfiguration</a> :: BlockFetchConfiguration</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:keepAliveRng" class="def">keepAliveRng</a> :: StdGen</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TraceForgeEvent" class="def">TraceForgeEvent</a> blk <a href="src/Ouroboros.Consensus.Node.Tracers.html#TraceForgeEvent" class="link">Source</a> <a href="#t:TraceForgeEvent" class="selflink">#</a></p><div class="doc"><p>Trace the forging of a block as a slot leader.</p><p>The flow of trace events here can be visualized as follows:</p><pre>TraceStartLeadershipCheck
         |
         +--- TraceSlotIsImmutable (leadership check failed)
         |
         +--- TraceBlockFromFuture (leadership check failed)
         |
 TraceBlockContext
         |
         +--- TraceNoLedgerState (leadership check failed)
         |
  TraceLedgerState
         |
         +--- TraceNoLedgerView (leadership check failed)
         |
  TraceLedgerView
         |
         +--- TraceForgeStateUpdateError (leadership check failed)
         |
         +--- TraceNodeCannotForge (leadership check failed)
         |
         +--- TraceNodeNotLeader
         |
  TraceNodeIsLeader
         |
   TraceForgedBlock
         |
         +--- TraceDidntAdoptBlock
         |
         +--- TraceForgedInvalidBlock
         |
 TraceAdoptedBlock</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TraceStartLeadershipCheck" class="def">TraceStartLeadershipCheck</a> SlotNo</td><td class="doc"><p>Start of the leadership check</p><p>We record the current slot number.</p></td></tr><tr><td class="src"><a id="v:TraceSlotIsImmutable" class="def">TraceSlotIsImmutable</a> SlotNo (Point blk) BlockNo</td><td class="doc"><p>Leadership check failed: the tip of the ImmutableDB inhabits the
 current slot</p><p>This might happen in two cases.</p><ol><li value="1">the clock moved backwards, on restart we ignored everything from the
     VolatileDB since it's all in the future, and now the tip of the
     ImmutableDB points to a block produced in the same slot we're trying
     to produce a block in</li><li value="2">k = 0 and we already adopted a block from another leader of the same
     slot.</li></ol><p>We record both the current slot number as well as the tip of the
 ImmutableDB.</p><p>See also <a href="https://github.com/IntersectMBO/ouroboros-network/issues/1462">https://github.com/IntersectMBO/ouroboros-network/issues/1462</a></p></td></tr><tr><td class="src"><a id="v:TraceBlockFromFuture" class="def">TraceBlockFromFuture</a> SlotNo SlotNo</td><td class="doc"><p>Leadership check failed: the current chain contains a block from a slot
 <em>after</em> the current slot</p><p>This can only happen if the system is under heavy load.</p><p>We record both the current slot number as well as the slot number of the
 block at the tip of the chain.</p><p>See also <a href="https://github.com/IntersectMBO/ouroboros-network/issues/1462">https://github.com/IntersectMBO/ouroboros-network/issues/1462</a></p></td></tr><tr><td class="src"><a id="v:TraceBlockContext" class="def">TraceBlockContext</a> SlotNo BlockNo (Point blk)</td><td class="doc"><p>We found out to which block we are going to connect the block we are about
 to forge.</p><p>We record the current slot number, the block number of the block to
 connect to and its point.</p><p>Note that block number of the block we will try to forge is one more than
 the recorded block number.</p></td></tr><tr><td class="src"><a id="v:TraceNoLedgerState" class="def">TraceNoLedgerState</a> SlotNo (Point blk)</td><td class="doc"><p>Leadership check failed: we were unable to get the ledger state for the
 point of the block we want to connect to</p><p>This can happen if after choosing which block to connect to the node
 switched to a different fork. We expect this to happen only rather
 rarely, so this certainly merits a warning; if it happens a lot, that
 merits an investigation.</p><p>We record both the current slot number as well as the point of the block
 we attempt to connect the new block to (that we requested the ledger
 state for).</p></td></tr><tr><td class="src"><a id="v:TraceLedgerState" class="def">TraceLedgerState</a> SlotNo (Point blk)</td><td class="doc"><p>We obtained a ledger state for the point of the block we want to
 connect to</p><p>We record both the current slot number as well as the point of the block
 we attempt to connect the new block to (that we requested the ledger
 state for).</p></td></tr><tr><td class="src"><a id="v:TraceNoLedgerView" class="def">TraceNoLedgerView</a> SlotNo OutsideForecastRange</td><td class="doc"><p>Leadership check failed: we were unable to get the ledger view for the
 current slot number</p><p>This will only happen if there are many missing blocks between the tip of
 our chain and the current slot.</p><p>We record also the failure returned by <code>forecastFor</code>.</p></td></tr><tr><td class="src"><a id="v:TraceLedgerView" class="def">TraceLedgerView</a> SlotNo</td><td class="doc"><p>We obtained a ledger view for the current slot number</p><p>We record the current slot number.</p></td></tr><tr><td class="src"><a id="v:TraceForgeStateUpdateError" class="def">TraceForgeStateUpdateError</a> SlotNo (ForgeStateUpdateError blk)</td><td class="doc"><p>Updating the forge state failed.</p><p>For example, the KES key could not be evolved anymore.</p><p>We record the error returned by <code>updateForgeState</code>.</p></td></tr><tr><td class="src"><a id="v:TraceNodeCannotForge" class="def">TraceNodeCannotForge</a> SlotNo (CannotForge blk)</td><td class="doc"><p>We did the leadership check and concluded that we should lead and forge
 a block, but cannot.</p><p>This should only happen rarely and should be logged with warning severity.</p><p>Records why we cannot forge a block.</p></td></tr><tr><td class="src"><a id="v:TraceNodeNotLeader" class="def">TraceNodeNotLeader</a> SlotNo</td><td class="doc"><p>We did the leadership check and concluded we are not the leader</p><p>We record the current slot number</p></td></tr><tr><td class="src"><a id="v:TraceNodeIsLeader" class="def">TraceNodeIsLeader</a> SlotNo</td><td class="doc"><p>We did the leadership check and concluded we <em>are</em> the leader</p><p>The node will soon forge; it is about to read its transactions from the
 Mempool. This will be followed by TraceForgedBlock.</p></td></tr><tr><td class="src"><a id="v:TraceForgeTickedLedgerState" class="def">TraceForgeTickedLedgerState</a> SlotNo (Point blk)</td><td class="doc"><p>We ticked the ledger state for the slot of the to-be-forged block.</p><p>We record the current slot number and the point of the block we attempt
 to connect the new block to.</p></td></tr><tr><td class="src"><a id="v:TraceForgingMempoolSnapshot" class="def">TraceForgingMempoolSnapshot</a> SlotNo (Point blk) (ChainHash blk) SlotNo</td><td class="doc"><p>We acquired a mempool snapshot.</p><p>We record the the point of the state we are starting from (ie the point
 from <code><a href="Ouroboros-Consensus-NodeKernel.html#v:TraceLedgerState" title="Ouroboros.Consensus.NodeKernel">TraceLedgerState</a></code>) and point the mempool had most last synced wrt.</p></td></tr><tr><td class="src"><a id="v:TraceForgedBlock" class="def">TraceForgedBlock</a> SlotNo (Point blk) blk MempoolSize</td><td class="doc"><p>We forged a block</p><p>We record the current slot number, the point of the predecessor, the block
 itself, and the total size of the mempool snapshot at the time we produced
 the block (which may be significantly larger than the block, due to
 maximum block size)</p><p>This will be followed by one of three messages:</p><ul><li>TraceAdoptedBlock (normally)</li><li>TraceDidntAdoptBlock (rarely)</li><li>TraceForgedInvalidBlock (hopefully never -- this would indicate a bug)</li></ul></td></tr><tr><td class="src"><a id="v:TraceDidntAdoptBlock" class="def">TraceDidntAdoptBlock</a> SlotNo blk</td><td class="doc"><p>We did not adopt the block we produced, but the block was valid. We
 must have adopted a block that another leader of the same slot produced
 before we got the chance of adopting our own block. This is very rare,
 this warrants a warning.</p></td></tr><tr><td class="src"><a id="v:TraceAdoptionThreadDied" class="def">TraceAdoptionThreadDied</a> SlotNo blk</td><td class="doc"><p>We did not adopt the block we produced, because the adoption thread
 died.  Most likely because of an async exception.</p></td></tr><tr><td class="src"><a id="v:TraceForgedInvalidBlock" class="def">TraceForgedInvalidBlock</a> SlotNo blk (InvalidBlockReason blk)</td><td class="doc"><p>We forged a block that is invalid according to the ledger in the
 ChainDB. This means there is an inconsistency between the mempool
 validation and the ledger validation. This is a serious error!</p></td></tr><tr><td class="src"><a id="v:TraceAdoptedBlock" class="def">TraceAdoptedBlock</a> SlotNo blk [Validated (GenTx blk)]</td><td class="doc"><p>We adopted the block we produced, we also trace the transactions
 that were adopted.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TraceForgeEvent">Instances</h4><details id="i:TraceForgeEvent" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TraceForgeEvent:Show:1"></span> (LedgerSupportsProtocol blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (Validated (GenTx blk)), <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (ForgeStateUpdateError blk), <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (CannotForge blk)) =&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk)</span> <a href="src/Ouroboros.Consensus.Node.Tracers.html#line-343" class="link">Source</a> <a href="#t:TraceForgeEvent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TraceForgeEvent:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Node-Tracers.html">Ouroboros.Consensus.Node.Tracers</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk] -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TraceForgeEvent:Eq:2"></span> (LedgerSupportsProtocol blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (Validated (GenTx blk)), <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (ForgeStateUpdateError blk), <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (CannotForge blk)) =&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk)</span> <a href="src/Ouroboros.Consensus.Node.Tracers.html#line-337" class="link">Source</a> <a href="#t:TraceForgeEvent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TraceForgeEvent:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Node-Tracers.html">Ouroboros.Consensus.Node.Tracers</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk -&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk -&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:getMempoolReader" class="def">getMempoolReader</a> :: <span class="keyword">forall</span> m blk. (LedgerSupportsMempool blk, IOLike m, HasTxId (GenTx blk)) =&gt; Mempool m blk -&gt; TxSubmissionMempoolReader (GenTxId blk) (Validated (GenTx blk)) TicketNo m <a href="src/Ouroboros.Consensus.NodeKernel.html#getMempoolReader" class="link">Source</a> <a href="#v:getMempoolReader" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getMempoolWriter" class="def">getMempoolWriter</a> :: (LedgerSupportsMempool blk, IOLike m, HasTxId (GenTx blk)) =&gt; Mempool m blk -&gt; TxSubmissionMempoolWriter (GenTxId blk) (GenTx blk) TicketNo m <a href="src/Ouroboros.Consensus.NodeKernel.html#getMempoolWriter" class="link">Source</a> <a href="#v:getMempoolWriter" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getPeersFromCurrentLedger" class="def">getPeersFromCurrentLedger</a> :: (IOLike m, LedgerSupportsPeerSelection blk) =&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m addrNTN addrNTC blk -&gt; (LedgerState blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; STM m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> [(PoolStake, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> RelayAccessPoint)]) <a href="src/Ouroboros.Consensus.NodeKernel.html#getPeersFromCurrentLedger" class="link">Source</a> <a href="#v:getPeersFromCurrentLedger" class="selflink">#</a></p><div class="doc"><p>Retrieve the peers registered in the current chain/ledger state by
 descending stake.</p><p>For example, for Shelley, this will return the stake pool relays ordered by
 descending stake.</p><p>Only returns a <code><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a></code> when the given predicate returns <code><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code>. This predicate
 can for example check whether the slot of the ledger state is older or newer
 than some slot number.</p><p>We don't use the ledger state at the tip of the chain, but the ledger state
 <code>k</code> blocks back, i.e., at the tip of the immutable chain, because any stake
 pools registered in that ledger state are guaranteed to be stable. This
 justifies merging the future and current stake pools.</p></div></div><div class="top"><p class="src"><a id="v:getPeersFromCurrentLedgerAfterSlot" class="def">getPeersFromCurrentLedgerAfterSlot</a> :: <span class="keyword">forall</span> m blk addrNTN addrNTC. (IOLike m, LedgerSupportsPeerSelection blk, UpdateLedger blk) =&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m addrNTN addrNTC blk -&gt; SlotNo -&gt; STM m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> [(PoolStake, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> RelayAccessPoint)]) <a href="src/Ouroboros.Consensus.NodeKernel.html#getPeersFromCurrentLedgerAfterSlot" class="link">Source</a> <a href="#v:getPeersFromCurrentLedgerAfterSlot" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Ouroboros-Consensus-NodeKernel.html#v:getPeersFromCurrentLedger" title="Ouroboros.Consensus.NodeKernel">getPeersFromCurrentLedger</a></code> but with a &quot;after slot number X&quot;
 condition.</p></div></div><div class="top"><p class="src"><a id="v:initNodeKernel" class="def">initNodeKernel</a> :: <span class="keyword">forall</span> m addrNTN addrNTC blk. (IOLike m, <a href="Ouroboros-Consensus-Node.html#t:RunNode" title="Ouroboros.Consensus.Node">RunNode</a> blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> addrNTN, Hashable addrNTN, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> addrNTN) =&gt; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernelArgs" title="Ouroboros.Consensus.NodeKernel">NodeKernelArgs</a> m addrNTN addrNTC blk -&gt; m (<a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m addrNTN addrNTC blk) <a href="src/Ouroboros.Consensus.NodeKernel.html#initNodeKernel" class="link">Source</a> <a href="#v:initNodeKernel" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>