<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass            #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances         #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses     #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns            #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards           #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables       #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving        #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications          #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies              #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators             #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Protocol.BFT</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier">Bft</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier">BftFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftParams"><span class="hs-identifier">BftParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidationErr"><span class="hs-identifier">BftValidationErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#forgeBftFields"><span class="hs-identifier">forgeBftFields</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Classes</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier">BftCrypto</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftMockCrypto"><span class="hs-identifier">BftMockCrypto</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftStandardCrypto"><span class="hs-identifier">BftStandardCrypto</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier">BftValidateView</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#bftValidateView"><span class="hs-identifier">bftValidateView</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Type instances</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ConsensusConfig"><span class="hs-identifier">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.DSIGN</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Kind.html"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.html"><span class="hs-identifier">Data.Typeable</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html"><span class="hs-identifier">Ouroboros.Consensus.Block.Abstract</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html"><span class="hs-identifier">Ouroboros.Consensus.Node.ProtocolInfo</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.NodeId.html"><span class="hs-identifier">Ouroboros.Consensus.NodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.NodeId.html#CoreNodeId"><span class="hs-identifier">CoreNodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeId.html#NodeId"><span class="hs-identifier">NodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Abstract</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Signed.html"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Signed</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Ticked.html"><span class="hs-identifier">Ouroboros.Consensus.Ticked</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html"><span class="hs-identifier">Ouroboros.Consensus.Util.Condense</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Fields BFT requires in a block
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">data</span><span> </span><span id="BftFields"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-var">BftFields</span></a></span></span><span> </span><span id="local-6989586621679851225"><span class="annot"><a href="#local-6989586621679851225"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679851226"><span class="annot"><a href="#local-6989586621679851226"><span class="hs-identifier hs-type">toSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BftFields"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-var">BftFields</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-53"></span><span>      </span><span id="bftSignature"><span class="annot"><span class="annottext">forall c toSign.
BftFields c toSign -&gt; SignedDSIGN (BftDSIGN c) toSign
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSignature"><span class="hs-identifier hs-var hs-var">bftSignature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SignedDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851225"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679851226"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679851417"><span id="local-6989586621679851419"><span class="annot"><span class="annottext">(forall x. BftFields c toSign -&gt; Rep (BftFields c toSign) x)
-&gt; (forall x. Rep (BftFields c toSign) x -&gt; BftFields c toSign)
-&gt; Generic (BftFields c toSign)
forall x. Rep (BftFields c toSign) x -&gt; BftFields c toSign
forall x. BftFields c toSign -&gt; Rep (BftFields c toSign) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c toSign x. Rep (BftFields c toSign) x -&gt; BftFields c toSign
forall c toSign x. BftFields c toSign -&gt; Rep (BftFields c toSign) x
$cfrom :: forall c toSign x. BftFields c toSign -&gt; Rep (BftFields c toSign) x
from :: forall x. BftFields c toSign -&gt; Rep (BftFields c toSign) x
$cto :: forall c toSign x. Rep (BftFields c toSign) x -&gt; BftFields c toSign
to :: forall x. Rep (BftFields c toSign) x -&gt; BftFields c toSign
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span id="local-6989586621679851248"><span id="local-6989586621679851249"><span id="local-6989586621679851424"><span id="local-6989586621679851431"><span id="local-6989586621679851435"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851248"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851248"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851249"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-58"></span><span id="local-6989586621679851255"><span id="local-6989586621679851256"><span id="local-6989586621679851441"><span id="local-6989586621679851446"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851255"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851255"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851256"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- We use the generic implementation, but override 'showTypeOf' to show @c@</span><span>
</span><span id="line-61"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679851289"><span id="local-6989586621679851290"><span id="local-6989586621679851453"><span id="local-6989586621679851457"><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851289"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851290"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851289"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851290"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679851484"><span class="annot"><span class="annottext">showTypeOf :: Proxy (BftFields c toSign) -&gt; String
</span><a href="#local-6989586621679851484"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy (BftFields c toSign)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep -&gt; String) -&gt; TypeRep -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (BftFields c) -&gt; TypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.html#typeRep"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
forall (t :: * -&gt; *). Proxy t
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851289"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="BftValidateView"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier hs-var">BftValidateView</span></a></span></span><span> </span><span id="local-6989586621679851308"><span class="annot"><a href="#local-6989586621679851308"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679851489"><span class="annot"><a href="#local-6989586621679851489"><span class="hs-identifier hs-type">signed</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851308"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679851489"><span class="hs-identifier hs-type">signed</span></a></span><span>
</span><span id="line-66"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span id="BftValidateView"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier hs-var">BftValidateView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851308"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851489"><span class="hs-identifier hs-type">signed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679851489"><span class="hs-identifier hs-type">signed</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><span class="hs-comment">-- | Convenience constructor for 'BftValidateView'</span></span><span>
</span><span id="line-69"></span><span id="local-6989586621679851300"><span id="local-6989586621679851302"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#bftValidateView"><span class="hs-identifier hs-type">bftValidateView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Signed.html#SignedHeader"><span class="hs-identifier hs-type">SignedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851300"><span class="hs-identifier hs-type">hdr</span></a></span><span>
</span><span id="line-70"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851302"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Signed.html#Signed"><span class="hs-identifier hs-type">Signed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851300"><span class="hs-identifier hs-type">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679851300"><span class="hs-identifier hs-type">hdr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851302"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Signed.html#Signed"><span class="hs-identifier hs-type">Signed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851300"><span class="hs-identifier hs-type">hdr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679851300"><span class="hs-identifier hs-type">hdr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier hs-type">BftValidateView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851302"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-74"></span><span id="bftValidateView"><span class="annot"><span class="annottext">bftValidateView :: forall hdr c.
(SignedHeader hdr, Signable (BftDSIGN c) (Signed hdr)) =&gt;
(hdr -&gt; BftFields c (Signed hdr)) -&gt; hdr -&gt; BftValidateView c
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftValidateView"><span class="hs-identifier hs-var hs-var">bftValidateView</span></a></span></span><span> </span><span id="local-6989586621679851495"><span class="annot"><span class="annottext">hdr -&gt; BftFields c (Signed hdr)
</span><a href="#local-6989586621679851495"><span class="hs-identifier hs-var">getFields</span></a></span></span><span> </span><span id="local-6989586621679851496"><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679851496"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">BftFields c (Signed hdr) -&gt; Signed hdr -&gt; BftValidateView c
forall c signed.
Signable (BftDSIGN c) signed =&gt;
BftFields c signed -&gt; signed -&gt; BftValidateView c
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier hs-var">BftValidateView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">hdr -&gt; BftFields c (Signed hdr)
</span><a href="#local-6989586621679851495"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679851496"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">hdr -&gt; Signed hdr
forall hdr. SignedHeader hdr =&gt; hdr -&gt; Signed hdr
</span><a href="Ouroboros.Consensus.Protocol.Signed.html#headerSigned"><span class="hs-identifier hs-var">headerSigned</span></a></span><span> </span><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679851496"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679851311"><span id="local-6989586621679851312"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#forgeBftFields"><span class="hs-identifier hs-type">forgeBftFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851311"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-78"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851311"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679851312"><span class="hs-identifier hs-type">toSign</span></a></span><span>
</span><span id="line-79"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ConsensusConfig"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851311"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679851312"><span class="hs-identifier hs-type">toSign</span></a></span><span>
</span><span id="line-82"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851311"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851312"><span class="hs-identifier hs-type">toSign</span></a></span></span></span><span>
</span><span id="line-83"></span><span id="forgeBftFields"><span class="annot"><span class="annottext">forgeBftFields :: forall c toSign.
(BftCrypto c, Signable (BftDSIGN c) toSign) =&gt;
ConsensusConfig (Bft c) -&gt; toSign -&gt; BftFields c toSign
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#forgeBftFields"><span class="hs-identifier hs-var hs-var">forgeBftFields</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftConfig"><span class="hs-identifier hs-type">BftConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851507"><span id="local-6989586621679851508"><span id="local-6989586621679851509"><span class="annot"><span class="annottext">Map NodeId (VerKeyDSIGN (BftDSIGN c))
SignKeyDSIGN (BftDSIGN c)
BftParams
bftParams :: BftParams
bftSignKey :: SignKeyDSIGN (BftDSIGN c)
bftVerKeys :: Map NodeId (VerKeyDSIGN (BftDSIGN c))
bftParams :: forall c. ConsensusConfig (Bft c) -&gt; BftParams
bftSignKey :: forall c. ConsensusConfig (Bft c) -&gt; SignKeyDSIGN (BftDSIGN c)
bftVerKeys :: forall c.
ConsensusConfig (Bft c) -&gt; Map NodeId (VerKeyDSIGN (BftDSIGN c))
</span><a href="#local-6989586621679851507"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679851513"><span class="annot"><span class="annottext">toSign
</span><a href="#local-6989586621679851513"><span class="hs-identifier hs-var">toSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-84"></span><span>      </span><span id="local-6989586621679851514"><span class="annot"><span class="annottext">signature :: SignedDSIGN (BftDSIGN c) toSign
</span><a href="#local-6989586621679851514"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextDSIGN (BftDSIGN c)
-&gt; toSign
-&gt; SignKeyDSIGN (BftDSIGN c)
-&gt; SignedDSIGN (BftDSIGN c) toSign
forall v a.
(DSIGNAlgorithm v, Signable v a) =&gt;
ContextDSIGN v -&gt; a -&gt; SignKeyDSIGN v -&gt; SignedDSIGN v a
</span><span class="hs-identifier hs-var">signedDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">toSign
</span><a href="#local-6989586621679851513"><span class="hs-identifier hs-var">toSign</span></a></span><span> </span><span class="annot"><span class="annottext">SignKeyDSIGN (BftDSIGN c)
</span><a href="#local-6989586621679851508"><span class="hs-identifier hs-var">bftSignKey</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-86"></span><span>          </span><span class="annot"><span class="annottext">bftSignature :: SignedDSIGN (BftDSIGN c) toSign
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSignature"><span class="hs-identifier hs-var">bftSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignedDSIGN (BftDSIGN c) toSign
</span><a href="#local-6989586621679851514"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Protocol proper
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Basic BFT</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Basic BFT is very simple:</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- * No support for delegation (and hence has no need for a ledger view)</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- * Requires round-robin block signing throughout (and so has no</span><span>
</span><span id="line-99"></span><span class="hs-comment">--   need for any chain state or cryptographic leader proofs).</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- * Does not use any stateful crypto (and so has no need for node state)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="Bft"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-var">Bft</span></a></span></span><span> </span><span id="local-6989586621679851516"><span class="annot"><a href="#local-6989586621679851516"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><span class="hs-comment">-- | Protocol parameters</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">data</span><span> </span><span id="BftParams"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftParams"><span class="hs-identifier hs-var">BftParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BftParams"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftParams"><span class="hs-identifier hs-var">BftParams</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-comment">-- | Security parameter</span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-comment">-- Although the protocol proper does not have such a security parameter,</span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-comment">-- we insist on it.</span><span>
</span><span id="line-109"></span><span>      </span><span id="bftSecurityParam"><span class="annot"><span class="annottext">BftParams -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSecurityParam"><span class="hs-identifier hs-var hs-var">bftSecurityParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Config.SecurityParam.html#SecurityParam"><span class="hs-identifier hs-type">SecurityParam</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Number of core nodes</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="bftNumNodes"><span class="annot"><span class="annottext">BftParams -&gt; NumCoreNodes
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftNumNodes"><span class="hs-identifier hs-var hs-var">bftNumNodes</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#NumCoreNodes"><span class="hs-identifier hs-type">NumCoreNodes</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679851521"><span id="local-6989586621679851523"><span class="annot"><span class="annottext">(forall x. BftParams -&gt; Rep BftParams x)
-&gt; (forall x. Rep BftParams x -&gt; BftParams) -&gt; Generic BftParams
forall x. Rep BftParams x -&gt; BftParams
forall x. BftParams -&gt; Rep BftParams x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. BftParams -&gt; Rep BftParams x
from :: forall x. BftParams -&gt; Rep BftParams x
$cto :: forall x. Rep BftParams x -&gt; BftParams
to :: forall x. Rep BftParams x -&gt; BftParams
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679851526"><span id="local-6989586621679851530"><span id="local-6989586621679851536"><span class="annot"><span class="annottext">Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo)
Proxy BftParams -&gt; String
(Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy BftParams -&gt; String)
-&gt; NoThunks BftParams
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; BftParams -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: Proxy BftParams -&gt; String
showTypeOf :: Proxy BftParams -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- | (Static) node configuration</span></span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ConsensusConfig"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ConsensusConfig"><span class="hs-identifier hs-var">ConsensusConfig</span></a></span></span><span> </span><span id="local-6989586621679851327"><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851327"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BftConfig"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftConfig"><span class="hs-identifier hs-var">BftConfig</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-118"></span><span>      </span><span id="bftParams"><span class="annot"><span class="annottext">forall c. ConsensusConfig (Bft c) -&gt; BftParams
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftParams"><span class="hs-identifier hs-var hs-var">bftParams</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftParams"><span class="hs-identifier hs-type">BftParams</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="bftSignKey"><span class="annot"><span class="annottext">forall c. ConsensusConfig (Bft c) -&gt; SignKeyDSIGN (BftDSIGN c)
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSignKey"><span class="hs-identifier hs-var hs-var">bftSignKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SignKeyDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851327"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="bftVerKeys"><span class="annot"><span class="annottext">forall c.
ConsensusConfig (Bft c) -&gt; Map NodeId (VerKeyDSIGN (BftDSIGN c))
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftVerKeys"><span class="hs-identifier hs-var hs-var">bftVerKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeId.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VerKeyDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851327"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679851567"><span id="local-6989586621679851569"><span class="annot"><span class="annottext">(forall x.
 ConsensusConfig (Bft c) -&gt; Rep (ConsensusConfig (Bft c)) x)
-&gt; (forall x.
    Rep (ConsensusConfig (Bft c)) x -&gt; ConsensusConfig (Bft c))
-&gt; Generic (ConsensusConfig (Bft c))
forall x.
Rep (ConsensusConfig (Bft c)) x -&gt; ConsensusConfig (Bft c)
forall x.
ConsensusConfig (Bft c) -&gt; Rep (ConsensusConfig (Bft c)) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x.
Rep (ConsensusConfig (Bft c)) x -&gt; ConsensusConfig (Bft c)
forall c x.
ConsensusConfig (Bft c) -&gt; Rep (ConsensusConfig (Bft c)) x
$cfrom :: forall c x.
ConsensusConfig (Bft c) -&gt; Rep (ConsensusConfig (Bft c)) x
from :: forall x.
ConsensusConfig (Bft c) -&gt; Rep (ConsensusConfig (Bft c)) x
$cto :: forall c x.
Rep (ConsensusConfig (Bft c)) x -&gt; ConsensusConfig (Bft c)
to :: forall x.
Rep (ConsensusConfig (Bft c)) x -&gt; ConsensusConfig (Bft c)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679851364"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ConsensusProtocol"><span class="hs-identifier hs-type">ConsensusProtocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValidationErr"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ValidationErr"><span class="hs-identifier hs-var">ValidationErr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidationErr"><span class="hs-identifier hs-type">BftValidationErr</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValidateView"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ValidateView"><span class="hs-identifier hs-var">ValidateView</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier hs-type">BftValidateView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="LedgerView"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#LedgerView"><span class="hs-identifier hs-var">LedgerView</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="IsLeader"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#IsLeader"><span class="hs-identifier hs-var">IsLeader</span></a></span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ChainDepState"><span class="hs-identifier hs-var">ChainDepState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="CanBeLeader"><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#CanBeLeader"><span class="hs-identifier hs-var">CanBeLeader</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851364"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeId.html#CoreNodeId"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679851628"><span class="annot"><span class="annottext">protocolSecurityParam :: ConsensusConfig (Bft c) -&gt; SecurityParam
</span><a href="#local-6989586621679851628"><span class="hs-identifier hs-var hs-var hs-var hs-var">protocolSecurityParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BftParams -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSecurityParam"><span class="hs-identifier hs-var">bftSecurityParam</span></a></span><span> </span><span class="annot"><span class="annottext">(BftParams -&gt; SecurityParam)
-&gt; (ConsensusConfig (Bft c) -&gt; BftParams)
-&gt; ConsensusConfig (Bft c)
-&gt; SecurityParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Bft c) -&gt; BftParams
forall c. ConsensusConfig (Bft c) -&gt; BftParams
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftParams"><span class="hs-identifier hs-var">bftParams</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679851636"><span class="annot"><span class="annottext">checkIsLeader :: HasCallStack =&gt;
ConsensusConfig (Bft c)
-&gt; CanBeLeader (Bft c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Bft c))
-&gt; Maybe (IsLeader (Bft c))
</span><a href="#local-6989586621679851636"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIsLeader</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftConfig"><span class="hs-identifier hs-type">BftConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851638"><span id="local-6989586621679851639"><span id="local-6989586621679851640"><span class="annot"><span class="annottext">Map NodeId (VerKeyDSIGN (BftDSIGN c))
SignKeyDSIGN (BftDSIGN c)
BftParams
bftParams :: forall c. ConsensusConfig (Bft c) -&gt; BftParams
bftSignKey :: forall c. ConsensusConfig (Bft c) -&gt; SignKeyDSIGN (BftDSIGN c)
bftVerKeys :: forall c.
ConsensusConfig (Bft c) -&gt; Map NodeId (VerKeyDSIGN (BftDSIGN c))
bftParams :: BftParams
bftSignKey :: SignKeyDSIGN (BftDSIGN c)
bftVerKeys :: Map NodeId (VerKeyDSIGN (BftDSIGN c))
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftParams"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.NodeId.html#CoreNodeId"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span> </span><span id="local-6989586621679851642"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851642"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span id="local-6989586621679851644"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851644"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ticked (ChainDepState (Bft c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851646"><span class="hs-identifier hs-var">numCoreNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851642"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe ()
Maybe (IsLeader (Bft c))
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftParams"><span class="hs-identifier hs-type">BftParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851647"><span id="local-6989586621679851648"><span class="annot"><span class="annottext">SecurityParam
NumCoreNodes
bftSecurityParam :: BftParams -&gt; SecurityParam
bftNumNodes :: BftParams -&gt; NumCoreNodes
bftSecurityParam :: SecurityParam
bftNumNodes :: NumCoreNodes
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSecurityParam"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BftParams
</span><a href="#local-6989586621679851638"><span class="hs-identifier hs-var">bftParams</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#NumCoreNodes"><span class="hs-identifier hs-type">NumCoreNodes</span></a></span><span> </span><span id="local-6989586621679851646"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851646"><span class="hs-identifier hs-var">numCoreNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumCoreNodes
</span><a href="#local-6989586621679851648"><span class="hs-identifier hs-var">bftNumNodes</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679851651"><span class="annot"><span class="annottext">updateChainDepState :: HasCallStack =&gt;
ConsensusConfig (Bft c)
-&gt; ValidateView (Bft c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Bft c))
-&gt; Except (ValidationErr (Bft c)) (ChainDepState (Bft c))
</span><a href="#local-6989586621679851651"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateChainDepState</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftConfig"><span class="hs-identifier hs-type">BftConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851653"><span id="local-6989586621679851654"><span id="local-6989586621679851655"><span class="annot"><span class="annottext">Map NodeId (VerKeyDSIGN (BftDSIGN c))
SignKeyDSIGN (BftDSIGN c)
BftParams
bftParams :: forall c. ConsensusConfig (Bft c) -&gt; BftParams
bftSignKey :: forall c. ConsensusConfig (Bft c) -&gt; SignKeyDSIGN (BftDSIGN c)
bftVerKeys :: forall c.
ConsensusConfig (Bft c) -&gt; Map NodeId (VerKeyDSIGN (BftDSIGN c))
bftParams :: BftParams
bftSignKey :: SignKeyDSIGN (BftDSIGN c)
bftVerKeys :: Map NodeId (VerKeyDSIGN (BftDSIGN c))
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftParams"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidateView"><span class="hs-identifier hs-type">BftValidateView</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851671"><span class="annot"><span class="annottext">SignedDSIGN (BftDSIGN c) signed
bftSignature :: forall c toSign.
BftFields c toSign -&gt; SignedDSIGN (BftDSIGN c) toSign
bftSignature :: SignedDSIGN (BftDSIGN c) signed
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSignature"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679851672"><span class="annot"><span class="annottext">signed
</span><a href="#local-6989586621679851672"><span class="hs-identifier hs-var">signed</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span id="local-6989586621679851673"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851673"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                      </span><span class="annot"><span class="annottext">Ticked (ChainDepState (Bft c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-comment">-- TODO: Should deal with unknown node IDs</span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContextDSIGN (BftDSIGN c)
-&gt; VerKeyDSIGN (BftDSIGN c)
-&gt; signed
-&gt; SignedDSIGN (BftDSIGN c) signed
-&gt; Either String ()
forall v a.
(DSIGNAlgorithm v, Signable v a, HasCallStack) =&gt;
ContextDSIGN v
-&gt; VerKeyDSIGN v -&gt; a -&gt; SignedDSIGN v a -&gt; Either String ()
</span><span class="hs-identifier hs-var">verifySignedDSIGN</span></span><span>
</span><span id="line-148"></span><span>             </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map NodeId (VerKeyDSIGN (BftDSIGN c))
</span><a href="#local-6989586621679851655"><span class="hs-identifier hs-var">bftVerKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId (VerKeyDSIGN (BftDSIGN c))
-&gt; NodeId -&gt; VerKeyDSIGN (BftDSIGN c)
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679851676"><span class="hs-identifier hs-var">expectedLeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>             </span><span class="annot"><span class="annottext">signed
</span><a href="#local-6989586621679851672"><span class="hs-identifier hs-var">signed</span></a></span><span>
</span><span id="line-151"></span><span>             </span><span class="annot"><span class="annottext">SignedDSIGN (BftDSIGN c) signed
</span><a href="#local-6989586621679851671"><span class="hs-identifier hs-var">bftSignature</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT BftValidationErr Identity ()
forall a. a -&gt; ExceptT BftValidationErr Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679851677"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679851677"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BftValidationErr
-&gt; Except (ValidationErr (Bft c)) (ChainDepState (Bft c))
forall a.
BftValidationErr -&gt; ExceptT (ValidationErr (Bft c)) Identity a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#throwError"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(BftValidationErr
 -&gt; Except (ValidationErr (Bft c)) (ChainDepState (Bft c)))
-&gt; BftValidationErr
-&gt; Except (ValidationErr (Bft c)) (ChainDepState (Bft c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; BftValidationErr
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#BftInvalidSignature"><span class="hs-identifier hs-var">BftInvalidSignature</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679851677"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftParams"><span class="hs-identifier hs-type">BftParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851680"><span id="local-6989586621679851681"><span class="annot"><span class="annottext">SecurityParam
NumCoreNodes
bftSecurityParam :: BftParams -&gt; SecurityParam
bftNumNodes :: BftParams -&gt; NumCoreNodes
bftSecurityParam :: SecurityParam
bftNumNodes :: NumCoreNodes
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSecurityParam"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BftParams
</span><a href="#local-6989586621679851653"><span class="hs-identifier hs-var">bftParams</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span id="local-6989586621679851676"><span class="annot"><span class="annottext">expectedLeader :: NodeId
</span><a href="#local-6989586621679851676"><span class="hs-identifier hs-var hs-var">expectedLeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreNodeId -&gt; NodeId
</span><a href="Ouroboros.Consensus.NodeId.html#CoreId"><span class="hs-identifier hs-var">CoreId</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreNodeId -&gt; NodeId) -&gt; CoreNodeId -&gt; NodeId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; CoreNodeId
</span><a href="Ouroboros.Consensus.NodeId.html#CoreNodeId"><span class="hs-identifier hs-var">CoreNodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851673"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851683"><span class="hs-identifier hs-var">numCoreNodes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#NumCoreNodes"><span class="hs-identifier hs-type">NumCoreNodes</span></a></span><span> </span><span id="local-6989586621679851683"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679851683"><span class="hs-identifier hs-var">numCoreNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumCoreNodes
</span><a href="#local-6989586621679851681"><span class="hs-identifier hs-var">bftNumNodes</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679851685"><span class="annot"><span class="annottext">reupdateChainDepState :: HasCallStack =&gt;
ConsensusConfig (Bft c)
-&gt; ValidateView (Bft c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Bft c))
-&gt; ChainDepState (Bft c)
</span><a href="#local-6989586621679851685"><span class="hs-identifier hs-var hs-var hs-var hs-var">reupdateChainDepState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Bft c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ValidateView (Bft c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Ticked (ChainDepState (Bft c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679851687"><span class="annot"><span class="annottext">tickChainDepState :: ConsensusConfig (Bft c)
-&gt; LedgerView (Bft c)
-&gt; SlotNo
-&gt; ChainDepState (Bft c)
-&gt; Ticked (ChainDepState (Bft c))
</span><a href="#local-6989586621679851687"><span class="hs-identifier hs-var hs-var hs-var hs-var">tickChainDepState</span></a></span></span><span>     </span><span class="annot"><span class="annottext">ConsensusConfig (Bft c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LedgerView (Bft c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ChainDepState (Bft c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ticked ()
Ticked (ChainDepState (Bft c))
</span><a href="Ouroboros.Consensus.Ticked.html#TickedTrivial"><span class="hs-identifier hs-var">TickedTrivial</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679851690"><span id="local-6989586621679851693"><span id="local-6989586621679851696"><span id="local-6989586621679851702"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851690"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.Abstract.html#ConsensusConfig"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#Bft"><span class="hs-identifier hs-type">Bft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851690"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- use generic instance</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  BFT specific types
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">data</span><span> </span><span id="BftValidationErr"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftValidationErr"><span class="hs-identifier hs-var">BftValidationErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BftInvalidSignature"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftInvalidSignature"><span class="hs-identifier hs-var">BftInvalidSignature</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679851741"><span id="local-6989586621679851747"><span id="local-6989586621679851750"><span class="annot"><span class="annottext">Int -&gt; BftValidationErr -&gt; ShowS
[BftValidationErr] -&gt; ShowS
BftValidationErr -&gt; String
(Int -&gt; BftValidationErr -&gt; ShowS)
-&gt; (BftValidationErr -&gt; String)
-&gt; ([BftValidationErr] -&gt; ShowS)
-&gt; Show BftValidationErr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; BftValidationErr -&gt; ShowS
showsPrec :: Int -&gt; BftValidationErr -&gt; ShowS
$cshow :: BftValidationErr -&gt; String
show :: BftValidationErr -&gt; String
$cshowList :: [BftValidationErr] -&gt; ShowS
showList :: [BftValidationErr] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679851754"><span id="local-6989586621679851759"><span class="annot"><span class="annottext">BftValidationErr -&gt; BftValidationErr -&gt; Bool
(BftValidationErr -&gt; BftValidationErr -&gt; Bool)
-&gt; (BftValidationErr -&gt; BftValidationErr -&gt; Bool)
-&gt; Eq BftValidationErr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: BftValidationErr -&gt; BftValidationErr -&gt; Bool
== :: BftValidationErr -&gt; BftValidationErr -&gt; Bool
$c/= :: BftValidationErr -&gt; BftValidationErr -&gt; Bool
/= :: BftValidationErr -&gt; BftValidationErr -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679851763"><span id="local-6989586621679851765"><span class="annot"><span class="annottext">(forall x. BftValidationErr -&gt; Rep BftValidationErr x)
-&gt; (forall x. Rep BftValidationErr x -&gt; BftValidationErr)
-&gt; Generic BftValidationErr
forall x. Rep BftValidationErr x -&gt; BftValidationErr
forall x. BftValidationErr -&gt; Rep BftValidationErr x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. BftValidationErr -&gt; Rep BftValidationErr x
from :: forall x. BftValidationErr -&gt; Rep BftValidationErr x
$cto :: forall x. Rep BftValidationErr x -&gt; BftValidationErr
to :: forall x. Rep BftValidationErr x -&gt; BftValidationErr
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679851768"><span id="local-6989586621679851771"><span id="local-6989586621679851777"><span class="annot"><span class="annottext">Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo)
Proxy BftValidationErr -&gt; String
(Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy BftValidationErr -&gt; String)
-&gt; NoThunks BftValidationErr
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; BftValidationErr -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: Proxy BftValidationErr -&gt; String
showTypeOf :: Proxy BftValidationErr -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Crypto models
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><span class="hs-comment">-- | Crypto primitives required by BFT</span></span><span>
</span><span id="line-177"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSIGNAlgorithm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContextDSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-type">BftDSIGN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="BftCrypto"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-var">BftCrypto</span></a></span></span><span> </span><span id="local-6989586621679851247"><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="BftDSIGN"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-var">BftDSIGN</span></a></span></span><span> </span><span id="local-6989586621679851247"><span class="annot"><a href="#local-6989586621679851247"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">data</span><span> </span><span id="BftStandardCrypto"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftStandardCrypto"><span class="hs-identifier hs-var">BftStandardCrypto</span></a></span></span><span>
</span><span id="line-186"></span><span class="hs-keyword">data</span><span> </span><span id="BftMockCrypto"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftMockCrypto"><span class="hs-identifier hs-var">BftMockCrypto</span></a></span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftStandardCrypto"><span class="hs-identifier hs-type">BftStandardCrypto</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BftDSIGN"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-var">BftDSIGN</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftStandardCrypto"><span class="hs-identifier hs-type">BftStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed448DSIGN</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftMockCrypto"><span class="hs-identifier hs-type">BftMockCrypto</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BftDSIGN"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftDSIGN"><span class="hs-identifier hs-var">BftDSIGN</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftMockCrypto"><span class="hs-identifier hs-type">BftMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MockDSIGN</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Condense
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679851408"><span id="local-6989586621679851409"><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftCrypto"><span class="hs-identifier hs-type">BftCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851408"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851408"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679851409"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621679851841"><span class="annot"><span class="annottext">condense :: BftFields c toSign -&gt; String
</span><a href="#local-6989586621679851841"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Protocol.BFT.html#BftFields"><span class="hs-identifier hs-type">BftFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679851843"><span class="annot"><span class="annottext">SignedDSIGN (BftDSIGN c) toSign
bftSignature :: forall c toSign.
BftFields c toSign -&gt; SignedDSIGN (BftDSIGN c) toSign
bftSignature :: SignedDSIGN (BftDSIGN c) toSign
</span><a href="Ouroboros.Consensus.Protocol.BFT.html#bftSignature"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignedDSIGN (BftDSIGN c) toSign -&gt; String
forall a. Condense a =&gt; a -&gt; String
</span><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">SignedDSIGN (BftDSIGN c) toSign
</span><a href="#local-6989586621679851843"><span class="hs-identifier hs-var">bftSignature</span></a></span><span>
</span><span id="line-200"></span></pre></body></html>