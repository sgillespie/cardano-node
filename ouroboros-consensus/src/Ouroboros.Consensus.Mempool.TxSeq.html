<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies         #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase                 #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses      #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns             #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms            #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns               #-}</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Intended for qualified import.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- &gt; import           Ouroboros.Consensus.Mempool.TxSeq (TxSeq (..))</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &gt; import qualified Ouroboros.Consensus.Mempool.TxSeq as TxSeq</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Mempool.TxSeq</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier">TicketNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier">TxSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-identifier">Empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3E"><span class="hs-operator">(:&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3C"><span class="hs-operator">(:&lt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier">TxTicket</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#fromList"><span class="hs-identifier">fromList</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#lookupByTicketNo"><span class="hs-identifier">lookupByTicketNo</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTicketNo"><span class="hs-identifier">splitAfterTicketNo</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTxSize"><span class="hs-identifier">splitAfterTxSize</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toList"><span class="hs-identifier">toList</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toMempoolSize"><span class="hs-identifier">toMempoolSize</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toTuples"><span class="hs-identifier">toTuples</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#zeroTicketNo"><span class="hs-identifier">zeroTicketNo</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Reference implementations for testing</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTxSizeSpec"><span class="hs-identifier">splitAfterTxSizeSpec</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.FingerTree.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StrictFingerTree</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.FingerTree.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FingerTree</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Foldable</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.Capacity.html"><span class="hs-identifier">Ouroboros.Consensus.Mempool.Capacity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.Capacity.html#MempoolSize"><span class="hs-identifier">MempoolSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.TxSubmission2.Type</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxSizeInBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Mempool transaction sequence as a finger tree
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | We allocate each transaction a (monotonically increasing) ticket number</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- as it enters the mempool.</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-keyword">newtype</span><span> </span><span id="TicketNo"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-var">TicketNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TicketNo"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-var">TicketNo</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679837883"><span id="local-6989586621679837887"><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; Bool
(TicketNo -&gt; TicketNo -&gt; Bool)
-&gt; (TicketNo -&gt; TicketNo -&gt; Bool) -&gt; Eq TicketNo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: TicketNo -&gt; TicketNo -&gt; Bool
== :: TicketNo -&gt; TicketNo -&gt; Bool
$c/= :: TicketNo -&gt; TicketNo -&gt; Bool
/= :: TicketNo -&gt; TicketNo -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679837894"><span id="local-6989586621679837898"><span id="local-6989586621679837901"><span id="local-6989586621679837905"><span id="local-6989586621679837908"><span id="local-6989586621679837911"><span id="local-6989586621679837914"><span class="annot"><span class="annottext">Eq TicketNo
Eq TicketNo =&gt;
(TicketNo -&gt; TicketNo -&gt; Ordering)
-&gt; (TicketNo -&gt; TicketNo -&gt; Bool)
-&gt; (TicketNo -&gt; TicketNo -&gt; Bool)
-&gt; (TicketNo -&gt; TicketNo -&gt; Bool)
-&gt; (TicketNo -&gt; TicketNo -&gt; Bool)
-&gt; (TicketNo -&gt; TicketNo -&gt; TicketNo)
-&gt; (TicketNo -&gt; TicketNo -&gt; TicketNo)
-&gt; Ord TicketNo
TicketNo -&gt; TicketNo -&gt; Bool
TicketNo -&gt; TicketNo -&gt; Ordering
TicketNo -&gt; TicketNo -&gt; TicketNo
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: TicketNo -&gt; TicketNo -&gt; Ordering
compare :: TicketNo -&gt; TicketNo -&gt; Ordering
$c&lt; :: TicketNo -&gt; TicketNo -&gt; Bool
&lt; :: TicketNo -&gt; TicketNo -&gt; Bool
$c&lt;= :: TicketNo -&gt; TicketNo -&gt; Bool
&lt;= :: TicketNo -&gt; TicketNo -&gt; Bool
$c&gt; :: TicketNo -&gt; TicketNo -&gt; Bool
&gt; :: TicketNo -&gt; TicketNo -&gt; Bool
$c&gt;= :: TicketNo -&gt; TicketNo -&gt; Bool
&gt;= :: TicketNo -&gt; TicketNo -&gt; Bool
$cmax :: TicketNo -&gt; TicketNo -&gt; TicketNo
max :: TicketNo -&gt; TicketNo -&gt; TicketNo
$cmin :: TicketNo -&gt; TicketNo -&gt; TicketNo
min :: TicketNo -&gt; TicketNo -&gt; TicketNo
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679837918"><span id="local-6989586621679837924"><span id="local-6989586621679837928"><span class="annot"><span class="annottext">Int -&gt; TicketNo -&gt; ShowS
[TicketNo] -&gt; ShowS
TicketNo -&gt; String
(Int -&gt; TicketNo -&gt; ShowS)
-&gt; (TicketNo -&gt; String) -&gt; ([TicketNo] -&gt; ShowS) -&gt; Show TicketNo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; TicketNo -&gt; ShowS
showsPrec :: Int -&gt; TicketNo -&gt; ShowS
$cshow :: TicketNo -&gt; String
show :: TicketNo -&gt; String
$cshowList :: [TicketNo] -&gt; ShowS
showList :: [TicketNo] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679837932"><span id="local-6989586621679837937"><span id="local-6989586621679837941"><span id="local-6989586621679837945"><span id="local-6989586621679837949"><span id="local-6989586621679837953"><span id="local-6989586621679837957"><span id="local-6989586621679837961"><span class="annot"><span class="annottext">Int -&gt; TicketNo
TicketNo -&gt; Int
TicketNo -&gt; [TicketNo]
TicketNo -&gt; TicketNo
TicketNo -&gt; TicketNo -&gt; [TicketNo]
TicketNo -&gt; TicketNo -&gt; TicketNo -&gt; [TicketNo]
(TicketNo -&gt; TicketNo)
-&gt; (TicketNo -&gt; TicketNo)
-&gt; (Int -&gt; TicketNo)
-&gt; (TicketNo -&gt; Int)
-&gt; (TicketNo -&gt; [TicketNo])
-&gt; (TicketNo -&gt; TicketNo -&gt; [TicketNo])
-&gt; (TicketNo -&gt; TicketNo -&gt; [TicketNo])
-&gt; (TicketNo -&gt; TicketNo -&gt; TicketNo -&gt; [TicketNo])
-&gt; Enum TicketNo
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: TicketNo -&gt; TicketNo
succ :: TicketNo -&gt; TicketNo
$cpred :: TicketNo -&gt; TicketNo
pred :: TicketNo -&gt; TicketNo
$ctoEnum :: Int -&gt; TicketNo
toEnum :: Int -&gt; TicketNo
$cfromEnum :: TicketNo -&gt; Int
fromEnum :: TicketNo -&gt; Int
$cenumFrom :: TicketNo -&gt; [TicketNo]
enumFrom :: TicketNo -&gt; [TicketNo]
$cenumFromThen :: TicketNo -&gt; TicketNo -&gt; [TicketNo]
enumFromThen :: TicketNo -&gt; TicketNo -&gt; [TicketNo]
$cenumFromTo :: TicketNo -&gt; TicketNo -&gt; [TicketNo]
enumFromTo :: TicketNo -&gt; TicketNo -&gt; [TicketNo]
$cenumFromThenTo :: TicketNo -&gt; TicketNo -&gt; TicketNo -&gt; [TicketNo]
enumFromThenTo :: TicketNo -&gt; TicketNo -&gt; TicketNo -&gt; [TicketNo]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679837967"><span id="local-6989586621679837972"><span class="annot"><span class="annottext">TicketNo
TicketNo -&gt; TicketNo -&gt; Bounded TicketNo
forall a. a -&gt; a -&gt; Bounded a
$cminBound :: TicketNo
minBound :: TicketNo
$cmaxBound :: TicketNo
maxBound :: TicketNo
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Enum.html#Bounded"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679837978"><span id="local-6989586621679837983"><span id="local-6989586621679837987"><span class="annot"><span class="annottext">Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo)
Proxy TicketNo -&gt; String
(Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy TicketNo -&gt; String)
-&gt; NoThunks TicketNo
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; TicketNo -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: Proxy TicketNo -&gt; String
showTypeOf :: Proxy TicketNo -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- | The transaction ticket number from which our counter starts.</span></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#zeroTicketNo"><span class="hs-identifier hs-type">zeroTicketNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span>
</span><span id="line-52"></span><span id="zeroTicketNo"><span class="annot"><span class="annottext">zeroTicketNo :: TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#zeroTicketNo"><span class="hs-identifier hs-var hs-var">zeroTicketNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-var">TicketNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | We associate transactions in the mempool with their ticket number and</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- size in bytes.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-keyword">data</span><span> </span><span id="TxTicket"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-var">TxTicket</span></a></span></span><span> </span><span id="local-6989586621679837701"><span class="annot"><a href="#local-6989586621679837701"><span class="hs-identifier hs-type">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxTicket"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-var">TxTicket</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="txTicketTx"><span class="annot"><span class="annottext">forall tx. TxTicket tx -&gt; tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketTx"><span class="hs-identifier hs-var hs-var">txTicketTx</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679837701"><span class="hs-identifier hs-type">tx</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The transaction associated with this ticket.</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="txTicketNo"><span class="annot"><span class="annottext">forall tx. TxTicket tx -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketNo"><span class="hs-identifier hs-var hs-var">txTicketNo</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The ticket number.</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="txTicketTxSizeInBytes"><span class="annot"><span class="annottext">forall tx. TxTicket tx -&gt; TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketTxSizeInBytes"><span class="hs-identifier hs-var hs-var">txTicketTxSizeInBytes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">TxSizeInBytes</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- ^ The byte size of the transaction ('txTicketTx') associated with this</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- ticket.</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679837998"><span id="local-6989586621679838004"><span class="annot"><span class="annottext">TxTicket tx -&gt; TxTicket tx -&gt; Bool
(TxTicket tx -&gt; TxTicket tx -&gt; Bool)
-&gt; (TxTicket tx -&gt; TxTicket tx -&gt; Bool) -&gt; Eq (TxTicket tx)
forall tx. Eq tx =&gt; TxTicket tx -&gt; TxTicket tx -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall tx. Eq tx =&gt; TxTicket tx -&gt; TxTicket tx -&gt; Bool
== :: TxTicket tx -&gt; TxTicket tx -&gt; Bool
$c/= :: forall tx. Eq tx =&gt; TxTicket tx -&gt; TxTicket tx -&gt; Bool
/= :: TxTicket tx -&gt; TxTicket tx -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838009"><span id="local-6989586621679838016"><span id="local-6989586621679838020"><span class="annot"><span class="annottext">Int -&gt; TxTicket tx -&gt; ShowS
[TxTicket tx] -&gt; ShowS
TxTicket tx -&gt; String
(Int -&gt; TxTicket tx -&gt; ShowS)
-&gt; (TxTicket tx -&gt; String)
-&gt; ([TxTicket tx] -&gt; ShowS)
-&gt; Show (TxTicket tx)
forall tx. Show tx =&gt; Int -&gt; TxTicket tx -&gt; ShowS
forall tx. Show tx =&gt; [TxTicket tx] -&gt; ShowS
forall tx. Show tx =&gt; TxTicket tx -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall tx. Show tx =&gt; Int -&gt; TxTicket tx -&gt; ShowS
showsPrec :: Int -&gt; TxTicket tx -&gt; ShowS
$cshow :: forall tx. Show tx =&gt; TxTicket tx -&gt; String
show :: TxTicket tx -&gt; String
$cshowList :: forall tx. Show tx =&gt; [TxTicket tx] -&gt; ShowS
showList :: [TxTicket tx] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838023"><span id="local-6989586621679838025"><span class="annot"><span class="annottext">(forall x. TxTicket tx -&gt; Rep (TxTicket tx) x)
-&gt; (forall x. Rep (TxTicket tx) x -&gt; TxTicket tx)
-&gt; Generic (TxTicket tx)
forall x. Rep (TxTicket tx) x -&gt; TxTicket tx
forall x. TxTicket tx -&gt; Rep (TxTicket tx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall tx x. Rep (TxTicket tx) x -&gt; TxTicket tx
forall tx x. TxTicket tx -&gt; Rep (TxTicket tx) x
$cfrom :: forall tx x. TxTicket tx -&gt; Rep (TxTicket tx) x
from :: forall x. TxTicket tx -&gt; Rep (TxTicket tx) x
$cto :: forall tx x. Rep (TxTicket tx) x -&gt; TxTicket tx
to :: forall x. Rep (TxTicket tx) x -&gt; TxTicket tx
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838030"><span id="local-6989586621679838034"><span id="local-6989586621679838040"><span class="annot"><span class="annottext">Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo)
Proxy (TxTicket tx) -&gt; String
(Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (TxTicket tx) -&gt; String)
-&gt; NoThunks (TxTicket tx)
forall tx.
NoThunks tx =&gt;
Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo)
forall tx. NoThunks tx =&gt; Proxy (TxTicket tx) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: forall tx.
NoThunks tx =&gt;
Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall tx.
NoThunks tx =&gt;
Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; TxTicket tx -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: forall tx. NoThunks tx =&gt; Proxy (TxTicket tx) -&gt; String
showTypeOf :: Proxy (TxTicket tx) -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | The mempool is a sequence of transactions with their ticket numbers and</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- size in bytes.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Transactions are allocated monotonically increasing ticket numbers as they</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- are appended to the mempool sequence. Transactions can be removed from any</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- position, not just the front.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- The sequence is thus ordered by the ticket numbers. We can use the ticket</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- numbers as a compact representation for a \&quot;reader\&quot; location in the</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- sequence. If a reader knows it has seen all txs with a lower ticket number</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- then it is only interested in transactions with higher ticket numbers.</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- The mempool sequence is represented by a fingertree. We use a fingertree</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- measure to allow not just normal sequence operations but also efficient</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- splitting and indexing by the ticket number.</span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-keyword">newtype</span><span> </span><span id="TxSeq"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span></span><span> </span><span id="local-6989586621679837810"><span class="annot"><a href="#local-6989586621679837810"><span class="hs-identifier hs-type">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxSeq"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictFingerTree</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-type">TxSeqMeasure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837810"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679838083"><span id="local-6989586621679838089"><span id="local-6989586621679838093"><span class="annot"><span class="annottext">Int -&gt; TxSeq tx -&gt; ShowS
[TxSeq tx] -&gt; ShowS
TxSeq tx -&gt; String
(Int -&gt; TxSeq tx -&gt; ShowS)
-&gt; (TxSeq tx -&gt; String) -&gt; ([TxSeq tx] -&gt; ShowS) -&gt; Show (TxSeq tx)
forall tx. Show tx =&gt; Int -&gt; TxSeq tx -&gt; ShowS
forall tx. Show tx =&gt; [TxSeq tx] -&gt; ShowS
forall tx. Show tx =&gt; TxSeq tx -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall tx. Show tx =&gt; Int -&gt; TxSeq tx -&gt; ShowS
showsPrec :: Int -&gt; TxSeq tx -&gt; ShowS
$cshow :: forall tx. Show tx =&gt; TxSeq tx -&gt; String
show :: TxSeq tx -&gt; String
$cshowList :: forall tx. Show tx =&gt; [TxSeq tx] -&gt; ShowS
showList :: [TxSeq tx] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679838097"><span id="local-6989586621679838103"><span id="local-6989586621679838108"><span class="annot"><span class="annottext">Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo)
Proxy (TxSeq tx) -&gt; String
(Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (TxSeq tx) -&gt; String)
-&gt; NoThunks (TxSeq tx)
forall tx.
NoThunks tx =&gt;
Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo)
forall tx. NoThunks tx =&gt; Proxy (TxSeq tx) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: forall tx.
NoThunks tx =&gt;
Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall tx.
NoThunks tx =&gt;
Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; TxSeq tx -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: forall tx. NoThunks tx =&gt; Proxy (TxSeq tx) -&gt; String
showTypeOf :: Proxy (TxSeq tx) -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679838114"><span id="local-6989586621679838121"><span id="local-6989586621679838126"><span id="local-6989586621679838129"><span id="local-6989586621679838132"><span id="local-6989586621679838135"><span id="local-6989586621679838138"><span id="local-6989586621679838141"><span id="local-6989586621679838144"><span id="local-6989586621679838149"><span id="local-6989586621679838154"><span id="local-6989586621679838159"><span id="local-6989586621679838164"><span id="local-6989586621679838169"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679838178"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; TxSeq a -&gt; m
</span><a href="#local-6989586621679838178"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span id="local-6989586621679838180"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679838180"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838181"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a)
</span><a href="#local-6989586621679838181"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxTicket a -&gt; m)
-&gt; StrictFingerTree TxSeqMeasure (TxTicket a) -&gt; m
forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; StrictFingerTree TxSeqMeasure a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">Foldable.foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679838180"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; (TxTicket a -&gt; a) -&gt; TxTicket a -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxTicket a -&gt; a
forall tx. TxTicket tx -&gt; tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketTx"><span class="hs-identifier hs-var">txTicketTx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a)
</span><a href="#local-6989586621679838181"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679838184"><span class="annot"><span class="annottext">null :: forall a. TxSeq a -&gt; Bool
</span><a href="#local-6989586621679838184"><span class="hs-identifier hs-var hs-var hs-var hs-var">null</span></a></span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838186"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a)
</span><a href="#local-6989586621679838186"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a) -&gt; Bool
forall a. StrictFingerTree TxSeqMeasure a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">Foldable.null</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a)
</span><a href="#local-6989586621679838186"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679838190"><span class="annot"><span class="annottext">length :: forall a. TxSeq a -&gt; Int
</span><a href="#local-6989586621679838190"><span class="hs-identifier hs-var hs-var hs-var hs-var">length</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838192"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a)
</span><a href="#local-6989586621679838192"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; Int
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSize"><span class="hs-identifier hs-var">mSize</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSeqMeasure -&gt; Int) -&gt; TxSeqMeasure -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a) -&gt; TxSeqMeasure
forall v a. Measured v a =&gt; a -&gt; v
</span><span class="hs-identifier hs-var">FingerTree.measure</span></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket a)
</span><a href="#local-6989586621679838192"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | The 'StrictFingerTree' relies on a \&quot;measure\&quot; for subsequences in the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- tree. A measure of the size of the subsequence allows for efficient</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- sequence operations. Also measuring the min and max ticket number allows</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- for efficient operations based on the ticket number (assuming the sequence</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- is ordered by ticket number).</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- To use a 'StrictFingerTree' with a 'TxSeqMeasure' we have to provide a way</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- to measure individual elements of the sequence (i.e. 'TxTicket's), via a</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- 'Measured' instance, and also a way to combine the measures, via a 'Monoid'</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- instance.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-keyword">data</span><span> </span><span id="TxSeqMeasure"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-var">TxSeqMeasure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxSeqMeasure"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-var">TxSeqMeasure</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-104"></span><span>       </span><span id="mMinTicket"><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMinTicket"><span class="hs-identifier hs-var hs-var">mMinTicket</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>       </span><span id="mMaxTicket"><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMaxTicket"><span class="hs-identifier hs-var hs-var">mMaxTicket</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>       </span><span id="mSizeBytes"><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSizeBytes"><span class="hs-identifier hs-var hs-var">mSizeBytes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">TxSizeInBytes</span></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>       </span><span id="mSize"><span class="annot"><span class="annottext">TxSeqMeasure -&gt; Int
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSize"><span class="hs-identifier hs-var hs-var">mSize</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-108"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679838200"><span id="local-6989586621679838208"><span id="local-6989586621679838212"><span class="annot"><span class="annottext">Int -&gt; TxSeqMeasure -&gt; ShowS
[TxSeqMeasure] -&gt; ShowS
TxSeqMeasure -&gt; String
(Int -&gt; TxSeqMeasure -&gt; ShowS)
-&gt; (TxSeqMeasure -&gt; String)
-&gt; ([TxSeqMeasure] -&gt; ShowS)
-&gt; Show TxSeqMeasure
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; TxSeqMeasure -&gt; ShowS
showsPrec :: Int -&gt; TxSeqMeasure -&gt; ShowS
$cshow :: TxSeqMeasure -&gt; String
show :: TxSeqMeasure -&gt; String
$cshowList :: [TxSeqMeasure] -&gt; ShowS
showList :: [TxSeqMeasure] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679837793"><span class="annot"><span class="hs-identifier hs-type">FingerTree.Measured</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-type">TxSeqMeasure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837793"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679838219"><span class="annot"><span class="annottext">measure :: TxTicket tx -&gt; TxSeqMeasure
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">measure</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><span class="annottext">tx
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838220"><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838220"><span class="hs-identifier hs-var">tno</span></a></span></span><span> </span><span id="local-6989586621679838221"><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838221"><span class="hs-identifier hs-var">tsz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; TxSizeInBytes -&gt; Int -&gt; TxSeqMeasure
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-var">TxSeqMeasure</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838220"><span class="hs-identifier hs-var">tno</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838220"><span class="hs-identifier hs-var">tno</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838221"><span class="hs-identifier hs-var">tsz</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679838224"><span id="local-6989586621679838228"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-type">TxSeqMeasure</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679838239"><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838239"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span id="local-6989586621679838240"><span class="annot"><span class="annottext">&lt;&gt; :: TxSeqMeasure -&gt; TxSeqMeasure -&gt; TxSeqMeasure
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span id="local-6989586621679838241"><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838241"><span class="hs-identifier hs-var">vr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; TxSizeInBytes -&gt; Int -&gt; TxSeqMeasure
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-var">TxSeqMeasure</span></a></span><span>
</span><span id="line-116"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMinTicket"><span class="hs-identifier hs-var">mMinTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838239"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; TicketNo
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#min"><span class="hs-operator hs-var">`min`</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMinTicket"><span class="hs-identifier hs-var">mMinTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838241"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMaxTicket"><span class="hs-identifier hs-var">mMaxTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838239"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; TicketNo
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#max"><span class="hs-operator hs-var">`max`</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMaxTicket"><span class="hs-identifier hs-var">mMaxTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838241"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSizeBytes"><span class="hs-identifier hs-var">mSizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838239"><span class="hs-identifier hs-var">vl</span></a></span><span>   </span><span class="annot"><span class="annottext">TxSizeInBytes -&gt; TxSizeInBytes -&gt; TxSizeInBytes
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span>   </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSizeBytes"><span class="hs-identifier hs-var">mSizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838241"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; Int
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSize"><span class="hs-identifier hs-var">mSize</span></a></span><span>      </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838239"><span class="hs-identifier hs-var">vl</span></a></span><span>   </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span>   </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; Int
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSize"><span class="hs-identifier hs-var">mSize</span></a></span><span>      </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838241"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679838250"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-type">TxSeqMeasure</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679838256"><span class="annot"><span class="annottext">mempty :: TxSeqMeasure
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; TxSizeInBytes -&gt; Int -&gt; TxSeqMeasure
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-var">TxSeqMeasure</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
forall a. Bounded a =&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
forall a. Bounded a =&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Enum.html#minBound"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679838260"><span class="annot"><span class="annottext">mappend :: TxSeqMeasure -&gt; TxSeqMeasure -&gt; TxSeqMeasure
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TxSeqMeasure -&gt; TxSeqMeasure
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | A helper function for the ':&gt;' pattern.</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span id="local-6989586621679837805"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewBack"><span class="hs-identifier hs-type">viewBack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837805"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837805"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837805"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span id="viewBack"><span class="annot"><span class="annottext">viewBack :: forall tx. TxSeq tx -&gt; Maybe (TxSeq tx, TxTicket tx)
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewBack"><span class="hs-identifier hs-var hs-var">viewBack</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838263"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838263"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
-&gt; ViewR (StrictFingerTree TxSeqMeasure) (TxTicket tx)
forall v a.
Measured v a =&gt;
StrictFingerTree v a -&gt; ViewR (StrictFingerTree v) a
</span><span class="hs-identifier hs-var">FingerTree.viewr</span></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838263"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>                         </span><span class="annot"><span class="annottext">ViewR (StrictFingerTree TxSeqMeasure) (TxTicket tx)
</span><span class="hs-identifier hs-var">FingerTree.EmptyR</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TxSeq tx, TxTicket tx)
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-130"></span><span>                         </span><span id="local-6989586621679838266"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838266"><span class="hs-identifier hs-var">txs'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">FingerTree.:&gt;</span></span><span> </span><span id="local-6989586621679838268"><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838268"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxSeq tx, TxTicket tx) -&gt; Maybe (TxSeq tx, TxTicket tx)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838266"><span class="hs-identifier hs-var">txs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838268"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | A helper function for the ':&lt;' pattern.</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span id="local-6989586621679837811"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewFront"><span class="hs-identifier hs-type">viewFront</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837811"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837811"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837811"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-135"></span><span id="viewFront"><span class="annot"><span class="annottext">viewFront :: forall tx. TxSeq tx -&gt; Maybe (TxTicket tx, TxSeq tx)
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewFront"><span class="hs-identifier hs-var hs-var">viewFront</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838271"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838271"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
-&gt; ViewL (StrictFingerTree TxSeqMeasure) (TxTicket tx)
forall v a.
Measured v a =&gt;
StrictFingerTree v a -&gt; ViewL (StrictFingerTree v) a
</span><span class="hs-identifier hs-var">FingerTree.viewl</span></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838271"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>                          </span><span class="annot"><span class="annottext">ViewL (StrictFingerTree TxSeqMeasure) (TxTicket tx)
</span><span class="hs-identifier hs-var">FingerTree.EmptyL</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TxTicket tx, TxSeq tx)
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-137"></span><span>                          </span><span id="local-6989586621679838274"><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838274"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">FingerTree.:&lt;</span></span><span> </span><span id="local-6989586621679838276"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838276"><span class="hs-identifier hs-var">txs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxTicket tx, TxSeq tx) -&gt; Maybe (TxTicket tx, TxSeq tx)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838274"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838276"><span class="hs-identifier hs-var">txs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | An empty mempool sequence.</span><span>
</span><span id="line-140"></span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679837817"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837817"><span class="hs-identifier hs-type">tx</span></a></span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">pattern</span><span> </span><span id="Empty"><span id="%24mEmpty"><span id="%24bEmpty"><span class="annot"><span class="annottext">$mEmpty :: forall {r} {tx}. TxSeq tx -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bEmpty :: forall tx. TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">Empty</span></a></span></span></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewFront"><span class="hs-identifier hs-type">viewFront</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-type">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
forall v a. Measured v a =&gt; StrictFingerTree v a
</span><span class="hs-identifier hs-var">FingerTree.empty</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | \( O(1) \). Access or add a tx at the back of the mempool sequence.</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- New txs are always added at the back.</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3E"><span class="hs-operator hs-type">(:&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679837822"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837822"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837822"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837822"><span class="hs-identifier hs-type">tx</span></a></span></span><span>
</span><span id="line-150"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="#local-6989586621679838280"><span class="hs-identifier hs-type">txs</span></a></span><span> </span><span id="%3A%3E"><span id="%24m%3A%3E"><span id="%24b%3A%3E"><span class="annot"><span class="annottext">$m:&gt; :: forall {r} {tx}.
TxSeq tx -&gt; (TxSeq tx -&gt; TxTicket tx -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$b:&gt; :: forall tx. TxSeq tx -&gt; TxTicket tx -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">:&gt;</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679838283"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewBack"><span class="hs-identifier hs-type">viewBack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679838280"><span class="annot"><a href="#local-6989586621679838280"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838283"><span class="annot"><a href="#local-6989586621679838283"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838284"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838284"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span id="local-6989586621679838285"><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838285"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838284"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
-&gt; TxTicket tx -&gt; StrictFingerTree TxSeqMeasure (TxTicket tx)
forall v a.
Measured v a =&gt;
StrictFingerTree v a -&gt; a -&gt; StrictFingerTree v a
</span><span class="hs-operator hs-var">FingerTree.|&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838285"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">--TODO: assert ordered by ticket no</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | \( O(1) \). Access a tx at the front of the mempool sequence.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- Note that we never add txs at the front. We access txs from front to back</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- when forwarding txs to other peers, or when adding txs to blocks.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3C"><span class="hs-operator hs-type">(:&lt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679837827"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837827"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837827"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837827"><span class="hs-identifier hs-type">tx</span></a></span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="#local-6989586621679838287"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span id="%3A%3C"><span id="%24m%3A%3C"><span class="annot"><span class="annottext">$m:&lt; :: forall {r} {tx}.
TxSeq tx -&gt; (TxTicket tx -&gt; TxSeq tx -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3C"><span class="hs-operator hs-var hs-var">:&lt;</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679838289"><span class="hs-identifier hs-type">txs</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#viewFront"><span class="hs-identifier hs-type">viewFront</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679838287"><span class="annot"><a href="#local-6989586621679838287"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838289"><span class="annot"><a href="#local-6989586621679838289"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-pragma hs-type">Empty</span></a></span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-164"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-pragma hs-type">Empty</span></a></span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:&lt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | \( O(\log(n)) \). Look up a transaction in the sequence by its 'TicketNo'.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span id="local-6989586621679837829"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#lookupByTicketNo"><span class="hs-identifier hs-type">lookupByTicketNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837829"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837829"><span class="hs-identifier hs-type">tx</span></a></span></span><span>
</span><span id="line-170"></span><span id="lookupByTicketNo"><span class="annot"><span class="annottext">lookupByTicketNo :: forall tx. TxSeq tx -&gt; TicketNo -&gt; Maybe tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#lookupByTicketNo"><span class="hs-identifier hs-var hs-var">lookupByTicketNo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838294"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838294"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679838295"><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838295"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxSeqMeasure -&gt; TxSeqMeasure -&gt; Bool)
-&gt; StrictFingerTree TxSeqMeasure (TxTicket tx)
-&gt; SearchResult TxSeqMeasure (TxTicket tx)
forall v a.
Measured v a =&gt;
(v -&gt; v -&gt; Bool) -&gt; StrictFingerTree v a -&gt; SearchResult v a
</span><span class="hs-identifier hs-var">FingerTree.search</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679838297"><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838297"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679838298"><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838298"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMaxTicket"><span class="hs-identifier hs-var">mMaxTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838297"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838295"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-172"></span><span>                                   </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMinTicket"><span class="hs-identifier hs-var">mMinTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838298"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span>  </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838295"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838294"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">FingerTree.Position</span></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span id="local-6989586621679838302"><span class="annot"><span class="annottext">tx
</span><a href="#local-6989586621679838302"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679838303"><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838303"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838303"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838295"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tx -&gt; Maybe tx
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">tx
</span><a href="#local-6989586621679838302"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">SearchResult TxSeqMeasure (TxTicket tx)
</span><span class="hs-identifier">_</span></span><span>                                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe tx
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | \( O(\log(n)) \). Split the sequence of transactions into two parts</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- based on the given 'TicketNo'. The first part has transactions with tickets</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- less than or equal to the given ticket, and the second part has transactions</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- with tickets strictly greater than the given ticket.</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span id="local-6989586621679837834"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTicketNo"><span class="hs-identifier hs-type">splitAfterTicketNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837834"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837834"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837834"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-182"></span><span id="splitAfterTicketNo"><span class="annot"><span class="annottext">splitAfterTicketNo :: forall tx. TxSeq tx -&gt; TicketNo -&gt; (TxSeq tx, TxSeq tx)
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTicketNo"><span class="hs-identifier hs-var hs-var">splitAfterTicketNo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838306"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838306"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679838307"><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838307"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxSeqMeasure -&gt; Bool)
-&gt; StrictFingerTree TxSeqMeasure (TxTicket tx)
-&gt; (StrictFingerTree TxSeqMeasure (TxTicket tx),
    StrictFingerTree TxSeqMeasure (TxTicket tx))
forall v a.
Measured v a =&gt;
(v -&gt; Bool)
-&gt; StrictFingerTree v a
-&gt; (StrictFingerTree v a, StrictFingerTree v a)
</span><span class="hs-identifier hs-var">FingerTree.split</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679838309"><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838309"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mMaxTicket"><span class="hs-identifier hs-var">mMaxTicket</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838309"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo -&gt; TicketNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TicketNo
</span><a href="#local-6989586621679838307"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838306"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679838310"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838310"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838311"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838311"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838310"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838311"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | \( O(\log(n)) \). Split the sequence of transactions into two parts</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- based on the given 'TxSizeInBytes'. The first part has transactions whose</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- summed 'TxSizeInBytes' is less than or equal to the given 'TxSizeInBytes',</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- and the second part has the remaining transactions in the sequence.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span id="local-6989586621679837838"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTxSize"><span class="hs-identifier hs-type">splitAfterTxSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837838"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxSizeInBytes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837838"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837838"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-192"></span><span id="splitAfterTxSize"><span class="annot"><span class="annottext">splitAfterTxSize :: forall tx. TxSeq tx -&gt; TxSizeInBytes -&gt; (TxSeq tx, TxSeq tx)
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTxSize"><span class="hs-identifier hs-var hs-var">splitAfterTxSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838315"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838315"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679838316"><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838316"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxSeqMeasure -&gt; Bool)
-&gt; StrictFingerTree TxSeqMeasure (TxTicket tx)
-&gt; (StrictFingerTree TxSeqMeasure (TxTicket tx),
    StrictFingerTree TxSeqMeasure (TxTicket tx))
forall v a.
Measured v a =&gt;
(v -&gt; Bool)
-&gt; StrictFingerTree v a
-&gt; (StrictFingerTree v a, StrictFingerTree v a)
</span><span class="hs-identifier hs-var">FingerTree.split</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679838317"><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838317"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure -&gt; TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSizeBytes"><span class="hs-identifier hs-var">mSizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeqMeasure
</span><a href="#local-6989586621679838317"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes -&gt; TxSizeInBytes -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838316"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838315"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679838318"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838318"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838319"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838319"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838318"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
forall tx. StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838319"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | \( O(n) \). Specification of 'splitAfterTxSize'.</span><span>
</span><span id="line-197"></span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- Use 'splitAfterTxSize' as it should be faster.</span><span>
</span><span id="line-199"></span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- This function is used to verify whether 'splitAfterTxSize' behaves as</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- expected.</span><span>
</span><span id="line-202"></span><span id="local-6989586621679838320"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTxSizeSpec"><span class="hs-identifier hs-type">splitAfterTxSizeSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838320"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxSizeInBytes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838320"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838320"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-203"></span><span id="splitAfterTxSizeSpec"><span class="annot"><span class="annottext">splitAfterTxSizeSpec :: forall tx. TxSeq tx -&gt; TxSizeInBytes -&gt; (TxSeq tx, TxSeq tx)
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#splitAfterTxSizeSpec"><span class="hs-identifier hs-var hs-var">splitAfterTxSizeSpec</span></a></span></span><span> </span><span id="local-6989586621679838322"><span class="annot"><span class="annottext">TxSeq tx
</span><a href="#local-6989586621679838322"><span class="hs-identifier hs-var">txseq</span></a></span></span><span> </span><span id="local-6989586621679838323"><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838323"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">([TxTicket tx] -&gt; TxSeq tx)
-&gt; ([TxTicket tx], [TxTicket tx]) -&gt; (TxSeq tx, TxSeq tx)
forall a b. (a -&gt; b) -&gt; (a, a) -&gt; (b, b)
</span><a href="#local-6989586621679838324"><span class="hs-identifier hs-var">mapTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[TxTicket tx] -&gt; TxSeq tx
forall tx. [TxTicket tx] -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">(([TxTicket tx], [TxTicket tx]) -&gt; (TxSeq tx, TxSeq tx))
-&gt; ([TxTicket tx], [TxTicket tx]) -&gt; (TxSeq tx, TxSeq tx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
-&gt; [TxTicket tx] -&gt; [TxTicket tx] -&gt; ([TxTicket tx], [TxTicket tx])
forall tx.
TxSizeInBytes
-&gt; [TxTicket tx] -&gt; [TxTicket tx] -&gt; ([TxTicket tx], [TxTicket tx])
</span><a href="#local-6989586621679838325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSeq tx -&gt; [TxTicket tx]
forall tx. TxSeq tx -&gt; [TxTicket tx]
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeq tx
</span><a href="#local-6989586621679838322"><span class="hs-identifier hs-var">txseq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679837841"><span id="local-6989586621679837842"><span class="annot"><a href="#local-6989586621679838324"><span class="hs-identifier hs-type">mapTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679837841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679837842"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679837841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679837841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679837842"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679837842"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679838324"><span class="annot"><span class="annottext">mapTuple :: forall a b. (a -&gt; b) -&gt; (a, a) -&gt; (b, b)
</span><a href="#local-6989586621679838324"><span class="hs-identifier hs-var hs-var">mapTuple</span></a></span></span><span> </span><span id="local-6989586621679838326"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679838326"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679838327"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838327"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838328"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838328"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679838326"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838327"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679838326"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838328"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679837844"><span class="annot"><a href="#local-6989586621679838325"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxSizeInBytes</span></span><span>
</span><span id="line-210"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837844"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837844"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837844"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837844"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679838325"><span class="annot"><span class="annottext">go :: forall tx.
TxSizeInBytes
-&gt; [TxTicket tx] -&gt; [TxTicket tx] -&gt; ([TxTicket tx], [TxTicket tx])
</span><a href="#local-6989586621679838325"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679838330"><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838330"><span class="hs-identifier hs-var">accByteSize</span></a></span></span><span> </span><span id="local-6989586621679838331"><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838331"><span class="hs-identifier hs-var">accTickets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxTicket tx] -&gt; [TxTicket tx]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838331"><span class="hs-identifier hs-var">accTickets</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>      </span><span id="local-6989586621679838333"><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838333"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679838334"><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838334"><span class="hs-identifier hs-var">ts</span></a></span></span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679838336"><span class="annot"><span class="annottext">accByteSize' :: TxSizeInBytes
</span><a href="#local-6989586621679838336"><span class="hs-identifier hs-var hs-var">accByteSize'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838330"><span class="hs-identifier hs-var">accByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes -&gt; TxSizeInBytes -&gt; TxSizeInBytes
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">TxTicket tx -&gt; TxSizeInBytes
forall tx. TxTicket tx -&gt; TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketTxSizeInBytes"><span class="hs-identifier hs-var">txTicketTxSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838333"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838336"><span class="hs-identifier hs-var">accByteSize'</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes -&gt; TxSizeInBytes -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838323"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
-&gt; [TxTicket tx] -&gt; [TxTicket tx] -&gt; ([TxTicket tx], [TxTicket tx])
forall tx.
TxSizeInBytes
-&gt; [TxTicket tx] -&gt; [TxTicket tx] -&gt; ([TxTicket tx], [TxTicket tx])
</span><a href="#local-6989586621679838325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838336"><span class="hs-identifier hs-var">accByteSize'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838333"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">TxTicket tx -&gt; [TxTicket tx] -&gt; [TxTicket tx]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838331"><span class="hs-identifier hs-var">accTickets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838334"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxTicket tx] -&gt; [TxTicket tx]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838331"><span class="hs-identifier hs-var">accTickets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838333"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">TxTicket tx -&gt; [TxTicket tx] -&gt; [TxTicket tx]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[TxTicket tx]
</span><a href="#local-6989586621679838334"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><span class="hs-comment">-- | Given a list of 'TxTicket's, construct a 'TxSeq'.</span></span><span>
</span><span id="line-224"></span><span id="local-6989586621679837843"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837843"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837843"><span class="hs-identifier hs-type">tx</span></a></span></span><span>
</span><span id="line-225"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: forall tx. [TxTicket tx] -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxSeq tx -&gt; TxTicket tx -&gt; TxSeq tx)
-&gt; TxSeq tx -&gt; [TxTicket tx] -&gt; TxSeq tx
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">Foldable.foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeq tx -&gt; TxTicket tx -&gt; TxSeq tx
forall tx. TxSeq tx -&gt; TxTicket tx -&gt; TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#%3A%3E"><span class="hs-operator hs-var">(:&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeq tx
forall tx. TxSeq tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><span class="hs-comment">-- | Convert a 'TxSeq' to a list of 'TxTicket's.</span></span><span>
</span><span id="line-228"></span><span id="local-6989586621679837845"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toList"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837845"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxTicket"><span class="hs-identifier hs-type">TxTicket</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837845"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-229"></span><span id="toList"><span class="annot"><span class="annottext">toList :: forall tx. TxSeq tx -&gt; [TxTicket tx]
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toList"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838342"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838342"><span class="hs-identifier hs-var">ftree</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; [TxTicket tx]
forall a. StrictFingerTree TxSeqMeasure a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">Foldable.toList</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838342"><span class="hs-identifier hs-var">ftree</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Convert a 'TxSeq' to a list of pairs of transactions and their</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- associated 'TicketNo's.</span><span>
</span><span id="line-233"></span><span id="local-6989586621679837854"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toTuples"><span class="hs-identifier hs-type">toTuples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837854"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679837854"><span class="hs-identifier hs-type">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TicketNo"><span class="hs-identifier hs-type">TicketNo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-234"></span><span id="toTuples"><span class="annot"><span class="annottext">toTuples :: forall tx. TxSeq tx -&gt; [(tx, TicketNo)]
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toTuples"><span class="hs-identifier hs-var hs-var">toTuples</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838347"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838347"><span class="hs-identifier hs-var">ftree</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxTicket tx -&gt; (tx, TicketNo))
-&gt; [TxTicket tx] -&gt; [(tx, TicketNo)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679838348"><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838348"><span class="hs-identifier hs-var">ticket</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxTicket tx -&gt; tx
forall tx. TxTicket tx -&gt; tx
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketTx"><span class="hs-identifier hs-var">txTicketTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838348"><span class="hs-identifier hs-var">ticket</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxTicket tx -&gt; TicketNo
forall tx. TxTicket tx -&gt; TicketNo
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#txTicketNo"><span class="hs-identifier hs-var">txTicketNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxTicket tx
</span><a href="#local-6989586621679838348"><span class="hs-identifier hs-var">ticket</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; [TxTicket tx]
forall a. StrictFingerTree TxSeqMeasure a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">Foldable.toList</span></a></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838347"><span class="hs-identifier hs-var">ftree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | \( O(1) \). Return the 'MempoolSize' of the given 'TxSeq'.</span></span><span>
</span><span id="line-239"></span><span id="local-6989586621679837859"><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toMempoolSize"><span class="hs-identifier hs-type">toMempoolSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679837859"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.Capacity.html#MempoolSize"><span class="hs-identifier hs-type">MempoolSize</span></a></span></span><span>
</span><span id="line-240"></span><span id="toMempoolSize"><span class="annot"><span class="annottext">toMempoolSize :: forall tx. TxSeq tx -&gt; MempoolSize
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#toMempoolSize"><span class="hs-identifier hs-var hs-var">toMempoolSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span id="local-6989586621679838353"><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838353"><span class="hs-identifier hs-var">ftree</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.Capacity.html#MempoolSize"><span class="hs-identifier hs-type">MempoolSize</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">msNumTxs :: TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.Capacity.html#msNumTxs"><span class="hs-identifier hs-var">msNumTxs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TxSizeInBytes
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679838355"><span class="hs-identifier hs-var">mSize</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">msNumBytes :: TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.Capacity.html#msNumBytes"><span class="hs-identifier hs-var">msNumBytes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSizeInBytes
</span><a href="#local-6989586621679838357"><span class="hs-identifier hs-var">mSizeBytes</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.TxSeq.html#TxSeqMeasure"><span class="hs-identifier hs-type">TxSeqMeasure</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679838357"><span class="annot"><span class="annottext">TxSizeInBytes
mSizeBytes :: TxSeqMeasure -&gt; TxSizeInBytes
mSizeBytes :: TxSizeInBytes
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSizeBytes"><span class="hs-identifier hs-var hs-var">mSizeBytes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838355"><span class="annot"><span class="annottext">Int
mSize :: TxSeqMeasure -&gt; Int
mSize :: Int
</span><a href="Ouroboros.Consensus.Mempool.TxSeq.html#mSize"><span class="hs-identifier hs-var hs-var">mSize</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx) -&gt; TxSeqMeasure
forall v a. Measured v a =&gt; a -&gt; v
</span><span class="hs-identifier hs-var">FingerTree.measure</span></span><span> </span><span class="annot"><span class="annottext">StrictFingerTree TxSeqMeasure (TxTicket tx)
</span><a href="#local-6989586621679838353"><span class="hs-identifier hs-var">ftree</span></a></span><span>
</span><span id="line-246"></span></pre></body></html>