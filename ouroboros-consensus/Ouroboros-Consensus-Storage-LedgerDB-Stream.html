<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Consensus.Storage.LedgerDB.Stream</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-consensus-0.15.0.0: Consensus layer for the Ouroboros blockchain protocol</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/Ouroboros.Consensus.Storage.LedgerDB.Stream.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Storage.LedgerDB.Stream</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:NextBlock">NextBlock</a> blk<ul class="subs"><li>= <a href="#v:NoMoreBlocks">NoMoreBlocks</a></li><li>| <a href="#v:NextBlock">NextBlock</a> blk</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:StreamAPI">StreamAPI</a> m blk = <a href="#v:StreamAPI">StreamAPI</a> {<ul class="subs"><li><a href="#v:streamAfter">streamAfter</a> :: <span class="keyword">forall</span> a. <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> =&gt; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk -&gt; (<a href="Ouroboros-Consensus-HardFork-Combinator-Degenerate.html#t:Either" title="Ouroboros.Consensus.HardFork.Combinator.Degenerate">Either</a> (<a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk) (m (<a href="Ouroboros-Consensus-Storage-LedgerDB-Stream.html#t:NextBlock" title="Ouroboros.Consensus.Storage.LedgerDB.Stream">NextBlock</a> blk)) -&gt; m a) -&gt; m a</li></ul>}</li><li class="src short"><a href="#v:streamAll">streamAll</a> :: <span class="keyword">forall</span> m blk e a. (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a>) =&gt; <a href="Ouroboros-Consensus-Storage-LedgerDB-Stream.html#t:StreamAPI" title="Ouroboros.Consensus.Storage.LedgerDB.Stream">StreamAPI</a> m blk -&gt; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk -&gt; (<a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk -&gt; e) -&gt; a -&gt; (blk -&gt; a -&gt; m a) -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/Control-Monad-Except.html#t:ExceptT" title="Control.Monad.Except">ExceptT</a> e m a</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:NextBlock" class="def">NextBlock</a> blk <a href="src/Ouroboros.Consensus.Storage.LedgerDB.Stream.html#NextBlock" class="link">Source</a> <a href="#t:NextBlock" class="selflink">#</a></p><div class="doc"><p>Next block returned during streaming</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NoMoreBlocks" class="def">NoMoreBlocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:NextBlock" class="def">NextBlock</a> blk</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:StreamAPI" class="def">StreamAPI</a> m blk <a href="src/Ouroboros.Consensus.Storage.LedgerDB.Stream.html#StreamAPI" class="link">Source</a> <a href="#t:StreamAPI" class="selflink">#</a></p><div class="doc"><p>Stream blocks from the immutable DB</p><p>When we initialize the ledger DB, we try to find a snapshot close to the
 tip of the immutable DB, and then stream blocks from the immutable DB to its
 tip to bring the ledger up to date with the tip of the immutable DB.</p><p>In CPS form to enable the use of <code>withXYZ</code> style iterator init functions.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:StreamAPI" class="def">StreamAPI</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:streamAfter" class="def">streamAfter</a> :: <span class="keyword">forall</span> a. <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> =&gt; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk -&gt; (<a href="Ouroboros-Consensus-HardFork-Combinator-Degenerate.html#t:Either" title="Ouroboros.Consensus.HardFork.Combinator.Degenerate">Either</a> (<a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk) (m (<a href="Ouroboros-Consensus-Storage-LedgerDB-Stream.html#t:NextBlock" title="Ouroboros.Consensus.Storage.LedgerDB.Stream">NextBlock</a> blk)) -&gt; m a) -&gt; m a</dfn><div class="doc"><p>Start streaming after the specified block</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:streamAll" class="def">streamAll</a> <a href="src/Ouroboros.Consensus.Storage.LedgerDB.Stream.html#streamAll" class="link">Source</a> <a href="#v:streamAll" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> m blk e a. (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Ouroboros-Consensus-Storage-LedgerDB-Stream.html#t:StreamAPI" title="Ouroboros.Consensus.Storage.LedgerDB.Stream">StreamAPI</a> m blk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk</td><td class="doc"><p>Starting point for streaming</p></td></tr><tr><td class="src">-&gt; (<a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk -&gt; e)</td><td class="doc"><p>Error when tip not found</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Starting point when tip <em>is</em> found</p></td></tr><tr><td class="src">-&gt; (blk -&gt; a -&gt; m a)</td><td class="doc"><p>Update function for each block</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/Control-Monad-Except.html#t:ExceptT" title="Control.Monad.Except">ExceptT</a> e m a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Stream all blocks</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>