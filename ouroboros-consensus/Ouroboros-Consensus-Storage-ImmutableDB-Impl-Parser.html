<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-consensus-0.15.0.0: Consensus layer for the Ouroboros blockchain protocol</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:BlockSummary">BlockSummary</a> blk = <a href="#v:BlockSummary">BlockSummary</a> {<ul class="subs"><li><a href="#v:summaryEntry">summaryEntry</a> :: !(<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Index-Secondary.html#t:Entry" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Index.Secondary">Entry</a> blk)</li><li><a href="#v:summaryBlockNo">summaryBlockNo</a> :: !<a href="Ouroboros-Consensus-Block-Abstract.html#t:BlockNo" title="Ouroboros.Consensus.Block.Abstract">BlockNo</a></li><li><a href="#v:summarySlotNo">summarySlotNo</a> :: !<a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:ChunkFileError">ChunkFileError</a> blk<ul class="subs"><li>= <a href="#v:ChunkErrRead">ChunkErrRead</a> <a href="Ouroboros-Consensus-Util-CBOR.html#t:ReadIncrementalErr" title="Ouroboros.Consensus.Util.CBOR">ReadIncrementalErr</a></li><li>| <a href="#v:ChunkErrHashMismatch">ChunkErrHashMismatch</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:HeaderHash" title="Ouroboros.Consensus.Block.Abstract">HeaderHash</a> blk) (<a href="Ouroboros-Consensus-Block-Abstract.html#t:ChainHash" title="Ouroboros.Consensus.Block.Abstract">ChainHash</a> blk)</li><li>| <a href="#v:ChunkErrCorrupt">ChunkErrCorrupt</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk)</li></ul></li><li class="src short"><a href="#v:parseChunkFile">parseChunkFile</a> :: <span class="keyword">forall</span> m blk h r. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:GetPrevHash" title="Ouroboros.Consensus.Block.Abstract">GetPrevHash</a> blk, <a href="Ouroboros-Consensus-Storage-Serialisation.html#t:HasBinaryBlockInfo" title="Ouroboros.Consensus.Storage.Serialisation">HasBinaryBlockInfo</a> blk, <a href="Ouroboros-Consensus-Storage-Serialisation.html#t:DecodeDisk" title="Ouroboros.Consensus.Storage.Serialisation">DecodeDisk</a> blk (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> -&gt; blk)) =&gt; <a href="Ouroboros-Consensus-Block-Abstract.html#t:CodecConfig" title="Ouroboros.Consensus.Block.Abstract">CodecConfig</a> blk -&gt; HasFS m h -&gt; (blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; FsPath -&gt; [CRC] -&gt; (Stream (Of (<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:BlockSummary" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">BlockSummary</a> blk, <a href="Ouroboros-Consensus-Block-Abstract.html#t:ChainHash" title="Ouroboros.Consensus.Block.Abstract">ChainHash</a> blk)) m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a>)) -&gt; m r) -&gt; m r</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BlockSummary" class="def">BlockSummary</a> blk <a href="src/Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser.html#BlockSummary" class="link">Source</a> <a href="#t:BlockSummary" class="selflink">#</a></p><div class="doc"><p>Information about a block returned by the parser.</p><p>The fields of this record are strict to make sure that by evaluating this
 record to WHNF, we no longer hold on to the entire block. Otherwise, we might
 accidentally keep all blocks in a single file in memory during parsing.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:BlockSummary" class="def">BlockSummary</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:summaryEntry" class="def">summaryEntry</a> :: !(<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Index-Secondary.html#t:Entry" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Index.Secondary">Entry</a> blk)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:summaryBlockNo" class="def">summaryBlockNo</a> :: !<a href="Ouroboros-Consensus-Block-Abstract.html#t:BlockNo" title="Ouroboros.Consensus.Block.Abstract">BlockNo</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:summarySlotNo" class="def">summarySlotNo</a> :: !<a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ChunkFileError" class="def">ChunkFileError</a> blk <a href="src/Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types.html#ChunkFileError" class="link">Source</a> <a href="#t:ChunkFileError" class="selflink">#</a></p><div class="doc"><p>Defined here instead of in the <code>Parser</code> module because <code><a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Types.html#t:TraceEvent" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types">TraceEvent</a></code>
 depends on it.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ChunkErrRead" class="def">ChunkErrRead</a> <a href="Ouroboros-Consensus-Util-CBOR.html#t:ReadIncrementalErr" title="Ouroboros.Consensus.Util.CBOR">ReadIncrementalErr</a></td><td class="doc"><p>A block could not be decoded</p></td></tr><tr><td class="src"><a id="v:ChunkErrHashMismatch" class="def">ChunkErrHashMismatch</a></td><td class="doc"><p>The previous hash of a block did not match the hash of the previous
 block.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">(<a href="Ouroboros-Consensus-Block-Abstract.html#t:HeaderHash" title="Ouroboros.Consensus.Block.Abstract">HeaderHash</a> blk)</dfn><div class="doc"><p>The hash of the previous block</p></div></li><li><dfn class="src">(<a href="Ouroboros-Consensus-Block-Abstract.html#t:ChainHash" title="Ouroboros.Consensus.Block.Abstract">ChainHash</a> blk)</dfn><div class="doc"><p>The previous hash of the block</p></div></li></ul></div></td></tr><tr><td class="src"><a id="v:ChunkErrCorrupt" class="def">ChunkErrCorrupt</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk)</td><td class="doc"><p>The integrity verification of the block with the given point returned
 <code><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#v:False" title="Data.Bool">False</a></code>, indicating that the block got corrupted.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ChunkFileError">Instances</h4><details id="i:ChunkFileError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ChunkFileError:Show:1"></span> <a href="Ouroboros-Consensus-Block-Abstract.html#t:StandardHash" title="Ouroboros.Consensus.Block.Abstract">StandardHash</a> blk =&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk)</span> <a href="src/Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types.html#line-101" class="link">Source</a> <a href="#t:ChunkFileError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ChunkFileError:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Types.html">Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk] -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ChunkFileError:Eq:2"></span> <a href="Ouroboros-Consensus-Block-Abstract.html#t:StandardHash" title="Ouroboros.Consensus.Block.Abstract">StandardHash</a> blk =&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk)</span> <a href="src/Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types.html#line-101" class="link">Source</a> <a href="#t:ChunkFileError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ChunkFileError:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Types.html">Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk -&gt; <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk -&gt; <a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:parseChunkFile" class="def">parseChunkFile</a> <a href="src/Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser.html#parseChunkFile" class="link">Source</a> <a href="#v:parseChunkFile" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> m blk h r. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:GetPrevHash" title="Ouroboros.Consensus.Block.Abstract">GetPrevHash</a> blk, <a href="Ouroboros-Consensus-Storage-Serialisation.html#t:HasBinaryBlockInfo" title="Ouroboros.Consensus.Storage.Serialisation">HasBinaryBlockInfo</a> blk, <a href="Ouroboros-Consensus-Storage-Serialisation.html#t:DecodeDisk" title="Ouroboros.Consensus.Storage.Serialisation">DecodeDisk</a> blk (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> -&gt; blk))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Ouroboros-Consensus-Block-Abstract.html#t:CodecConfig" title="Ouroboros.Consensus.Block.Abstract">CodecConfig</a> blk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; HasFS m h</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (blk -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>)</td><td class="doc"><p>Check integrity of the block. <code><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Bool.html#v:False" title="Data.Bool">False</a></code> = corrupt.</p></td></tr><tr><td class="src">-&gt; FsPath</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [CRC]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (Stream (Of (<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:BlockSummary" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">BlockSummary</a> blk, <a href="Ouroboros-Consensus-Block-Abstract.html#t:ChainHash" title="Ouroboros.Consensus.Block.Abstract">ChainHash</a> blk)) m (<a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#t:ChunkFileError" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkFileError</a> blk, <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a>)) -&gt; m r)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; m r</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Parse the contents of a chunk file.</p><ul><li>The parser decodes each block in the chunk. When one of them fails to
   decode, a <code><a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#v:ChunkErrRead" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkErrRead</a></code> error is returned.</li><li>Each block's checksum is checked against its given expected checksum
   (coming from the secondary index). When a checksum doesn't match, a
   <code><a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#v:ChunkErrCorrupt" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkErrCorrupt</a></code> error is returned. When the secondary index is missing or
   corrupt, and there are no or fewer expected checksums, we use the given
   (more expensive) integrity checking function instead of checksum
   comparison.</li><li>We check that each block fits onto the previous one by checking the hashes.
   If not, we return a <code><a href="Ouroboros-Consensus-Storage-ImmutableDB-Impl-Parser.html#v:ChunkErrHashMismatch" title="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Parser">ChunkErrHashMismatch</a></code> error.</li><li>An error is returned in the form of:</li></ul><pre>'Maybe' ('ChunkFileError' blk, 'Word64')</pre><p>The <code><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a></code> corresponds to the offset in the file where the last valid
   entry ends. Truncating to this offset will remove all invalid data from the
   file and just leave the valid entries before it. Note that we are not using
   <code><a href="Ouroboros-Consensus-HardFork-Combinator-Degenerate.html#t:Either" title="Ouroboros.Consensus.HardFork.Combinator.Degenerate">Either</a></code> because the error might occur after some valid entries have been
   parsed successfully, in which case we still want these valid entries, but
   also want to know about the error so we can truncate the file to get rid of
   the unparseable data.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>