<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Foreign.JavaScript</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Synopsis</span></span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-comment">-- | A JavaScript foreign function interface (FFI).</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-comment">-- This module implements a web server that communicates with</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-comment">-- a web browser and allows you to execute arbitrary JavaScript code on it.</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-comment">-- NOTE: This module is used internally by the &quot;Graphics.UI.Threepenny&quot;</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-comment">-- library, but the types are /not/ compatible directly</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-comment">-- (although some escape hatches are provided).</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-comment">-- Use &quot;Foreign.JavaScript&quot; only if you want to roll your own</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-comment">-- interface to the web browser.</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Server</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.html#serve"><span class="hs-identifier">serve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#defaultConfig"><span class="hs-identifier">defaultConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Config"><span class="hs-identifier">Config</span></a></span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>          </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsPort"><span class="hs-identifier">jsPort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsAddr"><span class="hs-identifier">jsAddr</span></a></span><span>
</span><span id="line-18"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsCustomHTML"><span class="hs-identifier">jsCustomHTML</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsStatic"><span class="hs-identifier">jsStatic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsLog"><span class="hs-identifier">jsLog</span></a></span><span>
</span><span id="line-19"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsWindowReloadOnDisconnect"><span class="hs-identifier">jsWindowReloadOnDisconnect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsCallBufferMode"><span class="hs-identifier">jsCallBufferMode</span></a></span><span>
</span><span id="line-20"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#jsUseSSL"><span class="hs-identifier">jsUseSSL</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Types.html#ConfigSSL"><span class="hs-identifier">ConfigSSL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Server"><span class="hs-identifier">Server</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#MimeType"><span class="hs-identifier">MimeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#URI"><span class="hs-identifier">URI</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Server.html#loadFile"><span class="hs-identifier">loadFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Server.html#loadDirectory"><span class="hs-identifier">loadDirectory</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Window"><span class="hs-identifier">Window</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#getServer"><span class="hs-identifier">getServer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#getCookies"><span class="hs-identifier">getCookies</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#root"><span class="hs-identifier">root</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * JavaScript FFI</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#ToJS"><span class="hs-identifier">ToJS</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#FromJS"><span class="hs-identifier">FromJS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#JSFunction"><span class="hs-identifier">JSFunction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#JSObject"><span class="hs-identifier">JSObject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#JavaScriptException"><span class="hs-identifier">JavaScriptException</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#FFI"><span class="hs-identifier">FFI</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#ffi"><span class="hs-identifier">ffi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.html#runFunction"><span class="hs-identifier">runFunction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.html#callFunction"><span class="hs-identifier">callFunction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Types.html#NewJSObject"><span class="hs-identifier">NewJSObject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.html#unsafeCreateJSObject"><span class="hs-identifier">unsafeCreateJSObject</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Types.html#CallBufferMode"><span class="hs-identifier">CallBufferMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.CallBuffer.html#setCallBufferMode"><span class="hs-identifier">setCallBufferMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.CallBuffer.html#getCallBufferMode"><span class="hs-identifier">getCallBufferMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.CallBuffer.html#flushCallBuffer"><span class="hs-identifier">flushCallBuffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#IsHandler"><span class="hs-identifier">IsHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.html#exportHandler"><span class="hs-identifier">exportHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#onDisconnect"><span class="hs-identifier">onDisconnect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Foreign.JavaScript.Types.html#debug"><span class="hs-identifier">debug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#timestamp"><span class="hs-identifier">timestamp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/stm-2.5.1.0/src/Control.Concurrent.STM.html"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STM</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>                           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foreign.JavaScript.CallBuffer.html"><span class="hs-identifier">Foreign.JavaScript.CallBuffer</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foreign.JavaScript.EventLoop.html"><span class="hs-identifier">Foreign.JavaScript.EventLoop</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html"><span class="hs-identifier">Foreign.JavaScript.Marshal</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foreign.JavaScript.Server.html"><span class="hs-identifier">Foreign.JavaScript.Server</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foreign.JavaScript.Types.html"><span class="hs-identifier">Foreign.JavaScript.Types</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foreign.RemotePtr.html"><span class="hs-identifier">Foreign.RemotePtr</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.html"><span class="hs-identifier">Foreign</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Server
------------------------------------------------------------------------------}</span><span>
</span><span id="line-47"></span><span class="annot"><span class="hs-comment">-- | Run a &quot;Foreign.JavaScript&quot; server.</span></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Foreign.JavaScript.html#serve"><span class="hs-identifier hs-type">serve</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ Configuration options.</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foreign.JavaScript.Types.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Initialization whenever a client connects.</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span id="serve"><span class="annot"><span class="annottext">serve :: Config -&gt; (Window -&gt; IO ()) -&gt; IO ()
</span><a href="Foreign.JavaScript.html#serve"><span class="hs-identifier hs-var hs-var">serve</span></a></span></span><span> </span><span id="local-6989586621679114499"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679114499"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679114500"><span class="annot"><span class="annottext">Window -&gt; IO ()
</span><a href="#local-6989586621679114500"><span class="hs-identifier hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; EventLoop -&gt; IO ()
</span><a href="Foreign.JavaScript.Server.html#httpComm"><span class="hs-identifier hs-var">httpComm</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679114499"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">(EventLoop -&gt; IO ()) -&gt; EventLoop -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; IO ()) -&gt; EventLoop
forall void. (Window -&gt; IO void) -&gt; EventLoop
</span><a href="Foreign.JavaScript.EventLoop.html#eventLoop"><span class="hs-identifier hs-var">eventLoop</span></a></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; IO ()) -&gt; EventLoop) -&gt; (Window -&gt; IO ()) -&gt; EventLoop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679114503"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; CallBufferMode -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#setCallBufferMode"><span class="hs-identifier hs-var">setCallBufferMode</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; CallBufferMode
</span><a href="Foreign.JavaScript.Types.html#jsCallBufferMode"><span class="hs-identifier hs-var">jsCallBufferMode</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679114499"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; JSFunction () -&gt; IO ()
</span><a href="Foreign.JavaScript.html#runFunction"><span class="hs-identifier hs-var">runFunction</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(JSFunction () -&gt; IO ()) -&gt; JSFunction () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-55"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; JSFunction ()
forall a. FFI a =&gt; String -&gt; a
</span><a href="Foreign.JavaScript.Marshal.html#ffi"><span class="hs-identifier hs-var">ffi</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;connection.setReloadOnDisconnect(%1)&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; JSFunction ()) -&gt; Bool -&gt; JSFunction ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Bool
</span><a href="Foreign.JavaScript.Types.html#jsWindowReloadOnDisconnect"><span class="hs-identifier hs-var">jsWindowReloadOnDisconnect</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679114499"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#flushCallBuffer"><span class="hs-identifier hs-var">flushCallBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">w</span></a></span><span>   </span><span class="hs-comment">-- make sure that all `runEval` commands are executed</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; IO ()
</span><a href="#local-6989586621679114500"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#flushCallBuffer"><span class="hs-identifier hs-var">flushCallBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">w</span></a></span><span>   </span><span class="hs-comment">-- make sure that all `runEval` commands are executed</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    JavaScript
------------------------------------------------------------------------------}</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Run a JavaScript function, but do not wait for a result.</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- NOTE: The JavaScript function need not be executed immediately,</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- it can be buffered and sent to the browser window at a later time.</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- See 'setCallBufferMode' and 'flushCallBuffer' for more.</span><span>
</span><span id="line-68"></span><span class="annot"><a href="Foreign.JavaScript.html#runFunction"><span class="hs-identifier hs-type">runFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#JSFunction"><span class="hs-identifier hs-type">JSFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span id="runFunction"><span class="annot"><span class="annottext">runFunction :: Window -&gt; JSFunction () -&gt; IO ()
</span><a href="Foreign.JavaScript.html#runFunction"><span class="hs-identifier hs-var hs-var">runFunction</span></a></span></span><span> </span><span id="local-6989586621679114504"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114504"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679114505"><span class="annot"><span class="annottext">JSFunction ()
</span><a href="#local-6989586621679114505"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window -&gt; String -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#bufferRunEval"><span class="hs-identifier hs-var">bufferRunEval</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114504"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; IO String -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction () -&gt; IO String
forall a. JSFunction a -&gt; IO String
</span><a href="Foreign.JavaScript.Marshal.html#toCode"><span class="hs-identifier hs-var">toCode</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction ()
</span><a href="#local-6989586621679114505"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Run a JavaScript function that creates a new object.</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Return a corresponding 'JSObject' without waiting for the browser</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- to send a result.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- WARNING: This function assumes that the supplied JavaScript code does,</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- in fact, create an object that is new.</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Foreign.JavaScript.html#unsafeCreateJSObject"><span class="hs-identifier hs-type">unsafeCreateJSObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#JSFunction"><span class="hs-identifier hs-type">JSFunction</span></a></span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#NewJSObject"><span class="hs-identifier hs-type">NewJSObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#JSObject"><span class="hs-identifier hs-type">JSObject</span></a></span><span>
</span><span id="line-78"></span><span id="unsafeCreateJSObject"><span class="annot"><span class="annottext">unsafeCreateJSObject :: Window -&gt; JSFunction NewJSObject -&gt; IO JSObject
</span><a href="Foreign.JavaScript.html#unsafeCreateJSObject"><span class="hs-identifier hs-var hs-var">unsafeCreateJSObject</span></a></span></span><span> </span><span id="local-6989586621679114509"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114509"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679114510"><span class="annot"><span class="annottext">JSFunction NewJSObject
</span><a href="#local-6989586621679114510"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679114511"><span class="annot"><span class="annottext">JSFunction JSObject
</span><a href="#local-6989586621679114511"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; JSFunction NewJSObject -&gt; IO (JSFunction JSObject)
</span><a href="Foreign.JavaScript.Marshal.html#wrapImposeStablePtr"><span class="hs-identifier hs-var">wrapImposeStablePtr</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114509"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction NewJSObject
</span><a href="#local-6989586621679114510"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; String -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#bufferRunEval"><span class="hs-identifier hs-var">bufferRunEval</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114509"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; IO String -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction JSObject -&gt; IO String
forall a. JSFunction a -&gt; IO String
</span><a href="Foreign.JavaScript.Marshal.html#toCode"><span class="hs-identifier hs-var">toCode</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction JSObject
</span><a href="#local-6989586621679114511"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">JSFunction JSObject -&gt; Window -&gt; Value -&gt; IO JSObject
forall a. JSFunction a -&gt; Window -&gt; Value -&gt; IO a
</span><a href="Foreign.JavaScript.Marshal.html#marshalResult"><span class="hs-identifier hs-var">marshalResult</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction JSObject
</span><a href="#local-6989586621679114511"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114509"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall {a}. a
</span><a href="#local-6989586621679114514"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679114514"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679114514"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsafeCreateJSObject: marshal does not take arguments&quot;</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><span class="hs-comment">-- | Call a JavaScript function and wait for the result.</span></span><span>
</span><span id="line-86"></span><span id="local-6989586621679114434"><span class="annot"><a href="Foreign.JavaScript.html#callFunction"><span class="hs-identifier hs-type">callFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#JSFunction"><span class="hs-identifier hs-type">JSFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679114434"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679114434"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-87"></span><span id="callFunction"><span class="annot"><span class="annottext">callFunction :: forall a. Window -&gt; JSFunction a -&gt; IO a
</span><a href="Foreign.JavaScript.html#callFunction"><span class="hs-identifier hs-var hs-var">callFunction</span></a></span></span><span> </span><span id="local-6989586621679114521"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114521"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679114522"><span class="annot"><span class="annottext">JSFunction a
</span><a href="#local-6989586621679114522"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- FIXME: Add the code of f to the buffer as well!</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- However, we have to pay attention to the semantics of exceptions in this case.</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#flushCallBuffer"><span class="hs-identifier hs-var">flushCallBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114521"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679114523"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679114523"><span class="hs-identifier hs-var">resultJS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; String -&gt; IO Value
</span><a href="Foreign.JavaScript.Types.html#callEval"><span class="hs-identifier hs-var">callEval</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114521"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO Value) -&gt; IO String -&gt; IO Value
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction a -&gt; IO String
forall a. JSFunction a -&gt; IO String
</span><a href="Foreign.JavaScript.Marshal.html#toCode"><span class="hs-identifier hs-var">toCode</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction a
</span><a href="#local-6989586621679114522"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">JSFunction a -&gt; Window -&gt; Value -&gt; IO a
forall a. JSFunction a -&gt; Window -&gt; Value -&gt; IO a
</span><a href="Foreign.JavaScript.Marshal.html#marshalResult"><span class="hs-identifier hs-var">marshalResult</span></a></span><span> </span><span class="annot"><span class="annottext">JSFunction a
</span><a href="#local-6989586621679114522"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114521"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679114523"><span class="hs-identifier hs-var">resultJS</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Export a Haskell function as an event handler.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- The result is a JavaScript @Function@ object that can be called</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- from JavaScript like a regular function. However,</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- the corresponding Haskell function will /not/ be run immediately,</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- rather it will be added to the event queue and processed</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- like an event. In other words, this the Haskell code is only called</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- asynchronously.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- WARNING: The event handler will be garbage collected unless you</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- keep a reference to it /on the Haskell side/!</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Registering it with a JavaScript function will generally /not/</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- keep it alive.</span><span>
</span><span id="line-108"></span><span id="local-6989586621679114436"><span class="annot"><a href="Foreign.JavaScript.html#exportHandler"><span class="hs-identifier hs-type">exportHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Marshal.html#IsHandler"><span class="hs-identifier hs-type">IsHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679114436"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679114436"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Foreign.JavaScript.Types.html#JSObject"><span class="hs-identifier hs-type">JSObject</span></a></span></span><span>
</span><span id="line-109"></span><span id="exportHandler"><span class="annot"><span class="annottext">exportHandler :: forall a. IsHandler a =&gt; Window -&gt; a -&gt; IO JSObject
</span><a href="Foreign.JavaScript.html#exportHandler"><span class="hs-identifier hs-var hs-var">exportHandler</span></a></span></span><span> </span><span id="local-6989586621679114544"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114544"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679114545"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679114545"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679114546"><span class="annot"><span class="annottext">HsEvent
</span><a href="#local-6989586621679114546"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; ([Value] -&gt; IO ()) -&gt; IO HsEvent
</span><a href="Foreign.JavaScript.EventLoop.html#newHandler"><span class="hs-identifier hs-var">newHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114544"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679114548"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679114548"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Window -&gt; [Value] -&gt; IO ()
forall a. IsHandler a =&gt; a -&gt; Window -&gt; [Value] -&gt; IO ()
</span><a href="Foreign.JavaScript.Marshal.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679114545"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114544"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679114548"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; IO ()
</span><a href="Foreign.JavaScript.CallBuffer.html#flushCallBuffer"><span class="hs-identifier hs-var">flushCallBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114544"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679114550"><span class="annot"><span class="annottext">JSObject
</span><a href="#local-6989586621679114550"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; JSFunction NewJSObject -&gt; IO JSObject
</span><a href="Foreign.JavaScript.html#unsafeCreateJSObject"><span class="hs-identifier hs-var">unsafeCreateJSObject</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679114544"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(JSFunction NewJSObject -&gt; IO JSObject)
-&gt; JSFunction NewJSObject -&gt; IO JSObject
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; HsEvent -&gt; String -&gt; JSFunction NewJSObject
forall a. FFI a =&gt; String -&gt; a
</span><a href="Foreign.JavaScript.Marshal.html#ffi"><span class="hs-identifier hs-var">ffi</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Haskell.newEvent(%1,%2)&quot;</span></span><span> </span><span class="annot"><span class="annottext">HsEvent
</span><a href="#local-6989586621679114546"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. IsHandler a =&gt; a -&gt; String
</span><a href="Foreign.JavaScript.Marshal.html#convertArguments"><span class="hs-identifier hs-var">convertArguments</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679114545"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">JSObject -&gt; HsEvent -&gt; IO ()
forall a b. RemotePtr a -&gt; RemotePtr b -&gt; IO ()
</span><a href="Foreign.RemotePtr.html#addReachable"><span class="hs-identifier hs-var">Foreign.addReachable</span></a></span><span> </span><span class="annot"><span class="annottext">JSObject
</span><a href="#local-6989586621679114550"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">HsEvent
</span><a href="#local-6989586621679114546"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">JSObject -&gt; IO JSObject
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">JSObject
</span><a href="#local-6989586621679114550"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-115"></span></pre></body></html>