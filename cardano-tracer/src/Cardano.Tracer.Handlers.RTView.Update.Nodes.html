<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.Update.Nodes</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addColumnsForConnected"><span class="hs-identifier">addColumnsForConnected</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addDatasetsForConnected"><span class="hs-identifier">addDatasetsForConnected</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#doAddLiveViewNodesForConnected"><span class="hs-identifier">doAddLiveViewNodesForConnected</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#checkNoNodesState"><span class="hs-identifier">checkNoNodesState</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#updateNodesUI"><span class="hs-identifier">updateNodesUI</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#updateNodesUptime"><span class="hs-identifier">updateNodesUptime</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/stm-2.5.1.0/src/Control.Concurrent.STM.html"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#atomically"><span class="hs-identifier">atomically</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/stm-2.5.1.0/src/Control.Concurrent.STM.TVar.html"><span class="hs-identifier">Control.Concurrent.STM.TVar</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier">forM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier">void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html"><span class="hs-identifier">Control.Monad.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier">whenJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJustM"><span class="hs-identifier">whenJustM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenM"><span class="hs-identifier">whenM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#find"><span class="hs-identifier">find</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#NonEmpty"><span class="hs-identifier">NonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier">Set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Read.html"><span class="hs-identifier">Data.Text.Read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Read.html#decimal"><span class="hs-identifier">decimal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Read.html#double"><span class="hs-identifier">double</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Calendar.html"><span class="hs-identifier">Data.Time.Calendar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Calendar.Days.html#diffDays"><span class="hs-identifier">diffDays</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.html"><span class="hs-identifier">Data.Time.Clock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier">UTCTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCDiff.html#addUTCTime"><span class="hs-identifier">addUTCTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCDiff.html#diffUTCTime"><span class="hs-identifier">diffUTCTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier">utctDay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.System.html"><span class="hs-identifier">Data.Time.Clock.System</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.SystemTime.html#getSystemTime"><span class="hs-identifier">getSystemTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.System.html#systemToUTCTime"><span class="hs-identifier">systemToUTCTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.html"><span class="hs-identifier">Data.Time.Format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier">defaultTimeLocale</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier">formatTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.html"><span class="hs-identifier">Graphics.UI.Threepenny</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UI</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html"><span class="hs-identifier">Graphics.UI.Threepenny.Core</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Printf.html"><span class="hs-identifier">Text.Printf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Printf.html#printf"><span class="hs-identifier">printf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.html"><span class="hs-identifier">Text.Read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.html#readMaybe"><span class="hs-identifier">readMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/cardano-node/cardano-node/dist-newstyle/build/x86_64-linux/ghc-9.6.3/trace-dispatcher-2.5.2/doc/html/trace-dispatcher/src/Cardano.Logging.html"><span class="hs-identifier">Cardano.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-node/cardano-node/dist-newstyle/build/x86_64-linux/ghc-9.6.3/trace-dispatcher-2.5.2/doc/html/trace-dispatcher/src/Cardano.Logging.Utils.html#showT"><span class="hs-identifier">showT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Configuration.html"><span class="hs-identifier">Cardano.Tracer.Configuration</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Environment.html"><span class="hs-identifier">Cardano.Tracer.Environment</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.Metrics.Utils.html"><span class="hs-identifier">Cardano.Tracer.Handlers.Metrics.Utils</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.State.Displayed</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.State.EraSettings</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Charts.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.UI.Charts</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.HTML.Node.Column.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.UI.HTML.Node.Column</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.HTML.NoNodes.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.UI.HTML.NoNodes</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Types.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.UI.Types</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.UI.Utils</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.NodeInfo.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.Update.NodeInfo</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.Update.Utils</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Utils.html"><span class="hs-identifier">Cardano.Tracer.Handlers.RTView.Utils</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Types.html"><span class="hs-identifier">Cardano.Tracer.Types</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Tracer.Utils.html"><span class="hs-identifier">Cardano.Tracer.Utils</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#updateNodesUI"><span class="hs-identifier hs-type">updateNodesUI</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html#DisplayedElements"><span class="hs-identifier hs-type">DisplayedElements</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#ErasSettings"><span class="hs-identifier hs-type">ErasSettings</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Configuration.html#LoggingParams"><span class="hs-identifier hs-type">LoggingParams</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Types.html#Colors"><span class="hs-identifier hs-type">Colors</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Types.html#DatasetsIndices"><span class="hs-identifier hs-type">DatasetsIndices</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Timer.html#Timer"><span class="hs-identifier hs-type">UI.Timer</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span id="updateNodesUI"><span class="annot"><span class="annottext">updateNodesUI :: TracerEnv
-&gt; DisplayedElements
-&gt; ErasSettings
-&gt; NonEmpty LoggingParams
-&gt; Colors
-&gt; DatasetsIndices
-&gt; Timer
-&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#updateNodesUI"><span class="hs-identifier hs-var hs-var">updateNodesUI</span></a></span></span><span> </span><span id="local-6989586621679629616"><span class="annot"><span class="annottext">tracerEnv :: TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621679629618"><span class="annot"><span class="annottext">ConnectedNodes
teConnectedNodes :: ConnectedNodes
teConnectedNodes :: TracerEnv -&gt; ConnectedNodes
</span><a href="#local-6989586621679629618"><span class="hs-identifier hs-var hs-var">teConnectedNodes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629620"><span class="annot"><span class="annottext">AcceptedMetrics
teAcceptedMetrics :: AcceptedMetrics
teAcceptedMetrics :: TracerEnv -&gt; AcceptedMetrics
</span><a href="#local-6989586621679629620"><span class="hs-identifier hs-var hs-var">teAcceptedMetrics</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-66"></span><span>              </span><span id="local-6989586621679629622"><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629622"><span class="hs-identifier hs-var">displayedElements</span></a></span></span><span> </span><span id="local-6989586621679629623"><span class="annot"><span class="annottext">ErasSettings
</span><a href="#local-6989586621679629623"><span class="hs-identifier hs-var">nodesEraSettings</span></a></span></span><span> </span><span id="local-6989586621679629624"><span class="annot"><span class="annottext">NonEmpty LoggingParams
</span><a href="#local-6989586621679629624"><span class="hs-identifier hs-var">loggingConfig</span></a></span></span><span> </span><span id="local-6989586621679629625"><span class="annot"><span class="annottext">Colors
</span><a href="#local-6989586621679629625"><span class="hs-identifier hs-var">colors</span></a></span></span><span>
</span><span id="line-67"></span><span>              </span><span id="local-6989586621679629626"><span class="annot"><span class="annottext">DatasetsIndices
</span><a href="#local-6989586621679629626"><span class="hs-identifier hs-var">datasetIndices</span></a></span></span><span> </span><span id="local-6989586621679629627"><span class="annot"><span class="annottext">Timer
</span><a href="#local-6989586621679629627"><span class="hs-identifier hs-var">noNodesProgressTimer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679629628"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629629"><span class="annot"><span class="annottext">Map NodeId DisplayedForNode
</span><a href="#local-6989586621679629629"><span class="hs-identifier hs-var">displayedEls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Set NodeId, Map NodeId DisplayedForNode)
-&gt; UI (Set NodeId, Map NodeId DisplayedForNode)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Set NodeId, Map NodeId DisplayedForNode)
 -&gt; UI (Set NodeId, Map NodeId DisplayedForNode))
-&gt; (STM (Set NodeId, Map NodeId DisplayedForNode)
    -&gt; IO (Set NodeId, Map NodeId DisplayedForNode))
-&gt; STM (Set NodeId, Map NodeId DisplayedForNode)
-&gt; UI (Set NodeId, Map NodeId DisplayedForNode)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Set NodeId, Map NodeId DisplayedForNode)
-&gt; IO (Set NodeId, Map NodeId DisplayedForNode)
forall a. STM a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#atomically"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (Set NodeId, Map NodeId DisplayedForNode)
 -&gt; UI (Set NodeId, Map NodeId DisplayedForNode))
-&gt; STM (Set NodeId, Map NodeId DisplayedForNode)
-&gt; UI (Set NodeId, Map NodeId DisplayedForNode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">(Set NodeId
 -&gt; Map NodeId DisplayedForNode
 -&gt; (Set NodeId, Map NodeId DisplayedForNode))
-&gt; STM (Set NodeId)
-&gt; STM
     (Map NodeId DisplayedForNode
      -&gt; (Set NodeId, Map NodeId DisplayedForNode))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectedNodes -&gt; STM (Set NodeId)
forall a. TVar a -&gt; STM a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectedNodes
</span><a href="#local-6989586621679629618"><span class="hs-identifier hs-var">teConnectedNodes</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">STM
  (Map NodeId DisplayedForNode
   -&gt; (Set NodeId, Map NodeId DisplayedForNode))
-&gt; STM (Map NodeId DisplayedForNode)
-&gt; STM (Set NodeId, Map NodeId DisplayedForNode)
forall a b. STM (a -&gt; b) -&gt; STM a -&gt; STM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements -&gt; STM (Map NodeId DisplayedForNode)
forall a. TVar a -&gt; STM a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629622"><span class="hs-identifier hs-var">displayedElements</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">-- Check connected/disconnected nodes since previous UI's update.</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629635"><span class="annot"><span class="annottext">displayed :: Set NodeId
</span><a href="#local-6989586621679629635"><span class="hs-identifier hs-var hs-var">displayed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NodeId] -&gt; Set NodeId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([NodeId] -&gt; Set NodeId) -&gt; [NodeId] -&gt; Set NodeId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId DisplayedForNode -&gt; [NodeId]
forall k a. Map k a -&gt; [k]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">M.keys</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId DisplayedForNode
</span><a href="#local-6989586621679629629"><span class="hs-identifier hs-var">displayedEls</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; UI () -&gt; UI ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId -&gt; Set NodeId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629635"><span class="hs-identifier hs-var">displayed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629640"><span class="annot"><span class="annottext">disconnected :: Set NodeId
</span><a href="#local-6989586621679629640"><span class="hs-identifier hs-var hs-var">disconnected</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629635"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId -&gt; Set NodeId -&gt; Set NodeId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="hs-comment">-- In 'displayed' but not in 'connected'.</span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621679629642"><span class="annot"><span class="annottext">newlyConnected :: Set NodeId
</span><a href="#local-6989586621679629642"><span class="hs-identifier hs-var hs-var">newlyConnected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId -&gt; Set NodeId -&gt; Set NodeId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629635"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-comment">-- In 'connected' but not in 'displayed'.</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">Set NodeId -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#deleteColumnsForDisconnected"><span class="hs-identifier hs-var">deleteColumnsForDisconnected</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629640"><span class="hs-identifier hs-var">disconnected</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#deleteLiveViewNodesForDisconnected"><span class="hs-identifier hs-var">deleteLiveViewNodesForDisconnected</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629640"><span class="hs-identifier hs-var">disconnected</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Set NodeId -&gt; NonEmpty LoggingParams -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addColumnsForConnected"><span class="hs-identifier hs-var">addColumnsForConnected</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629642"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty LoggingParams
</span><a href="#local-6989586621679629624"><span class="hs-identifier hs-var">loggingConfig</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addLiveViewNodesForConnected"><span class="hs-identifier hs-var">addLiveViewNodesForConnected</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629642"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">Set NodeId -&gt; Timer -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#checkNoNodesState"><span class="hs-identifier hs-var">checkNoNodesState</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">Timer
</span><a href="#local-6989586621679629627"><span class="hs-identifier hs-var">noNodesProgressTimer</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Set NodeId -&gt; DisplayedElements -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.NodeInfo.html#askNSetNodeInfo"><span class="hs-identifier hs-var">askNSetNodeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629642"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629622"><span class="hs-identifier hs-var">displayedElements</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Set NodeId -&gt; Colors -&gt; DatasetsIndices -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addDatasetsForConnected"><span class="hs-identifier hs-var">addDatasetsForConnected</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629642"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span> </span><span class="annot"><span class="annottext">Colors
</span><a href="#local-6989586621679629625"><span class="hs-identifier hs-var">colors</span></a></span><span> </span><span class="annot"><span class="annottext">DatasetsIndices
</span><a href="#local-6989586621679629626"><span class="hs-identifier hs-var">datasetIndices</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; DatasetsIndices -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Charts.html#restoreLastHistoryOnCharts"><span class="hs-identifier hs-var">restoreLastHistoryOnCharts</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629616"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">DatasetsIndices
</span><a href="#local-6989586621679629626"><span class="hs-identifier hs-var">datasetIndices</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629642"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; UI ()
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; UI ()) -&gt; IO () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><span class="annottext">DisplayedElements -&gt; Set NodeId -&gt; IO ()
</span><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html#updateDisplayedElements"><span class="hs-identifier hs-var">updateDisplayedElements</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629622"><span class="hs-identifier hs-var">displayedElements</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; AcceptedMetrics -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setBlockReplayProgress"><span class="hs-identifier hs-var">setBlockReplayProgress</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629620"><span class="hs-identifier hs-var">teAcceptedMetrics</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; AcceptedMetrics -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setProducerMode"><span class="hs-identifier hs-var">setProducerMode</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629620"><span class="hs-identifier hs-var">teAcceptedMetrics</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; DisplayedElements -&gt; AcceptedMetrics -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setLeadershipStats"><span class="hs-identifier hs-var">setLeadershipStats</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629622"><span class="hs-identifier hs-var">displayedElements</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629620"><span class="hs-identifier hs-var">teAcceptedMetrics</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId
-&gt; DisplayedElements -&gt; AcceptedMetrics -&gt; ErasSettings -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setEraEpochInfo"><span class="hs-identifier hs-var">setEraEpochInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629628"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629622"><span class="hs-identifier hs-var">displayedElements</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629620"><span class="hs-identifier hs-var">teAcceptedMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">ErasSettings
</span><a href="#local-6989586621679629623"><span class="hs-identifier hs-var">nodesEraSettings</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addColumnsForConnected"><span class="hs-identifier hs-type">addColumnsForConnected</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Configuration.html#LoggingParams"><span class="hs-identifier hs-type">LoggingParams</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span id="addColumnsForConnected"><span class="annot"><span class="annottext">addColumnsForConnected :: TracerEnv -&gt; Set NodeId -&gt; NonEmpty LoggingParams -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addColumnsForConnected"><span class="hs-identifier hs-var hs-var">addColumnsForConnected</span></a></span></span><span> </span><span id="local-6989586621679629653"><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629653"><span class="hs-identifier hs-var">tracerEnv</span></a></span></span><span> </span><span id="local-6989586621679629654"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629654"><span class="hs-identifier hs-var">newlyConnected</span></a></span></span><span> </span><span id="local-6989586621679629655"><span class="annot"><span class="annottext">NonEmpty LoggingParams
</span><a href="#local-6989586621679629655"><span class="hs-identifier hs-var">loggingConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; UI () -&gt; UI ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set NodeId -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629654"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679629657"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629657"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndShow"><span class="hs-identifier hs-var">findAndShow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629657"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;main-table-container&quot;</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndShow"><span class="hs-identifier hs-var">findAndShow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629657"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;logs-live-view-button&quot;</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629654"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; NonEmpty LoggingParams -&gt; NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.HTML.Node.Column.html#addNodeColumn"><span class="hs-identifier hs-var">addNodeColumn</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629653"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty LoggingParams
</span><a href="#local-6989586621679629655"><span class="hs-identifier hs-var">loggingConfig</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addDatasetsForConnected"><span class="hs-identifier hs-type">addDatasetsForConnected</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Types.html#Colors"><span class="hs-identifier hs-type">Colors</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Types.html#DatasetsIndices"><span class="hs-identifier hs-type">DatasetsIndices</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span id="addDatasetsForConnected"><span class="annot"><span class="annottext">addDatasetsForConnected :: TracerEnv -&gt; Set NodeId -&gt; Colors -&gt; DatasetsIndices -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addDatasetsForConnected"><span class="hs-identifier hs-var hs-var">addDatasetsForConnected</span></a></span></span><span> </span><span id="local-6989586621679629661"><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629661"><span class="hs-identifier hs-var">tracerEnv</span></a></span></span><span> </span><span id="local-6989586621679629662"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629662"><span class="hs-identifier hs-var">newlyConnected</span></a></span></span><span> </span><span id="local-6989586621679629663"><span class="annot"><span class="annottext">Colors
</span><a href="#local-6989586621679629663"><span class="hs-identifier hs-var">colors</span></a></span></span><span> </span><span id="local-6989586621679629664"><span class="annot"><span class="annottext">DatasetsIndices
</span><a href="#local-6989586621679629664"><span class="hs-identifier hs-var">datasetIndices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; UI () -&gt; UI ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set NodeId -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629662"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679629665"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629665"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndShow"><span class="hs-identifier hs-var">findAndShow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629665"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;main-charts-container&quot;</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndShow"><span class="hs-identifier hs-var">findAndShow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629665"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;logs-live-view-button&quot;</span></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629662"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Colors -&gt; DatasetsIndices -&gt; NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Charts.html#addNodeDatasetsToCharts"><span class="hs-identifier hs-var">addNodeDatasetsToCharts</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629661"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Colors
</span><a href="#local-6989586621679629663"><span class="hs-identifier hs-var">colors</span></a></span><span> </span><span class="annot"><span class="annottext">DatasetsIndices
</span><a href="#local-6989586621679629664"><span class="hs-identifier hs-var">datasetIndices</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#deleteColumnsForDisconnected"><span class="hs-identifier hs-type">deleteColumnsForDisconnected</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="deleteColumnsForDisconnected"><span class="annot"><span class="annottext">deleteColumnsForDisconnected :: Set NodeId -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#deleteColumnsForDisconnected"><span class="hs-identifier hs-var hs-var">deleteColumnsForDisconnected</span></a></span></span><span> </span><span id="local-6989586621679629667"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629667"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span id="local-6989586621679629668"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629668"><span class="hs-identifier hs-var">disconnected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679629669"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629669"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629668"><span class="hs-identifier hs-var">disconnected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.HTML.Node.Column.html#deleteNodeColumn"><span class="hs-identifier hs-var">deleteNodeColumn</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629669"><span class="hs-identifier hs-var">window</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; UI () -&gt; UI ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set NodeId -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629667"><span class="hs-identifier hs-var">connected</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndHide"><span class="hs-identifier hs-var">findAndHide</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629669"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;main-table-container&quot;</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndHide"><span class="hs-identifier hs-var">findAndHide</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629669"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;main-charts-container&quot;</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndHide"><span class="hs-identifier hs-var">findAndHide</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629669"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;logs-live-view-button&quot;</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- Please note that we don't remove historical data from charts</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">-- for disconnected node. Because the user may want to see the</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- historical data even for the node that already disconnected.</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#checkNoNodesState"><span class="hs-identifier hs-type">checkNoNodesState</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Timer.html#Timer"><span class="hs-identifier hs-type">UI.Timer</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="checkNoNodesState"><span class="annot"><span class="annottext">checkNoNodesState :: Set NodeId -&gt; Timer -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#checkNoNodesState"><span class="hs-identifier hs-var hs-var">checkNoNodesState</span></a></span></span><span> </span><span id="local-6989586621679629672"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629672"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span id="local-6989586621679629673"><span class="annot"><span class="annottext">Timer
</span><a href="#local-6989586621679629673"><span class="hs-identifier hs-var">noNodesProgressTimer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679629674"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629674"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set NodeId -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629672"><span class="hs-identifier hs-var">connected</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">Window -&gt; Timer -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.HTML.NoNodes.html#showNoNodes"><span class="hs-identifier hs-var">showNoNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629674"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">Timer
</span><a href="#local-6989586621679629673"><span class="hs-identifier hs-var">noNodesProgressTimer</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="annottext">UI Bool -&gt; UI () -&gt; UI ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenM"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="annot"><span class="annottext">UI Bool
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#logsLiveViewIsOpened"><span class="hs-identifier hs-var">logsLiveViewIsOpened</span></a></span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">(UI Element -&gt; UI Element) -&gt; Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndSet"><span class="hs-identifier hs-var">findAndSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadWriteAttr Element String ()
-&gt; String -&gt; UI Element -&gt; UI Element
forall x i o. ReadWriteAttr x i o -&gt; i -&gt; UI x -&gt; UI x
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">ReadWriteAttr Element String ()
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Attributes.html#class_"><span class="hs-identifier hs-var">UI.class_</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;modal&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629674"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;logs-live-view-modal-window&quot;</span></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">(UI Element -&gt; UI Element) -&gt; Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndSet"><span class="hs-identifier hs-var">findAndSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadWriteAttr Element String String
-&gt; String -&gt; UI Element -&gt; UI Element
forall x i o. ReadWriteAttr x i o -&gt; i -&gt; UI x -&gt; UI x
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">ReadWriteAttr Element String String
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#dataState"><span class="hs-identifier hs-var">dataState</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;closed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629674"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;logs-live-view-modal-window&quot;</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><span class="annottext">Window -&gt; Timer -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.HTML.NoNodes.html#hideNoNodes"><span class="hs-identifier hs-var">hideNoNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629674"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">Timer
</span><a href="#local-6989586621679629673"><span class="hs-identifier hs-var">noNodesProgressTimer</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#updateNodesUptime"><span class="hs-identifier hs-type">updateNodesUptime</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html#DisplayedElements"><span class="hs-identifier hs-type">DisplayedElements</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="updateNodesUptime"><span class="annot"><span class="annottext">updateNodesUptime :: TracerEnv -&gt; DisplayedElements -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#updateNodesUptime"><span class="hs-identifier hs-var hs-var">updateNodesUptime</span></a></span></span><span> </span><span id="local-6989586621679629682"><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629682"><span class="hs-identifier hs-var">tracerEnv</span></a></span></span><span> </span><span id="local-6989586621679629683"><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629683"><span class="hs-identifier hs-var">displayedElements</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679629684"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629684"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SystemTime -&gt; UTCTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.System.html#systemToUTCTime"><span class="hs-identifier hs-var">systemToUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">(SystemTime -&gt; UTCTime) -&gt; UI SystemTime -&gt; UI UTCTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemTime -&gt; UI SystemTime
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.SystemTime.html#getSystemTime"><span class="hs-identifier hs-var">getSystemTime</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679629685"><span class="annot"><span class="annottext">Map NodeId DisplayedForNode
</span><a href="#local-6989586621679629685"><span class="hs-identifier hs-var">displayed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Map NodeId DisplayedForNode)
-&gt; UI (Map NodeId DisplayedForNode)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map NodeId DisplayedForNode)
 -&gt; UI (Map NodeId DisplayedForNode))
-&gt; IO (Map NodeId DisplayedForNode)
-&gt; UI (Map NodeId DisplayedForNode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements -&gt; IO (Map NodeId DisplayedForNode)
forall a. TVar a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVarIO"><span class="hs-identifier hs-var">readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629683"><span class="hs-identifier hs-var">displayedElements</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="annottext">TracerEnv -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Utils.html#forConnectedUI_"><span class="hs-identifier hs-var">forConnectedUI_</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629682"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Map NodeId DisplayedForNode -&gt; NodeId -&gt; UI ()
</span><a href="#local-6989586621679629688"><span class="hs-identifier hs-var">getUptimeForNode</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629684"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId DisplayedForNode
</span><a href="#local-6989586621679629685"><span class="hs-identifier hs-var">displayed</span></a></span><span>
</span><span id="line-156"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679629688"><span class="annot"><span class="annottext">getUptimeForNode :: UTCTime -&gt; Map NodeId DisplayedForNode -&gt; NodeId -&gt; UI ()
</span><a href="#local-6989586621679629688"><span class="hs-identifier hs-var hs-var">getUptimeForNode</span></a></span></span><span> </span><span id="local-6989586621679629703"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629703"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span id="local-6989586621679629704"><span class="annot"><span class="annottext">Map NodeId DisplayedForNode
</span><a href="#local-6989586621679629704"><span class="hs-identifier hs-var">displayed</span></a></span></span><span> </span><span id="local-6989586621679629705"><span class="annot"><span class="annottext">nodeId :: NodeId
</span><a href="#local-6989586621679629705"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629707"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629707"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629710"><span class="annot"><span class="annottext">nodeStartElId :: EraName
</span><a href="#local-6989586621679629710"><span class="hs-identifier hs-var hs-var">nodeStartElId</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629707"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-start-time&quot;</span></span><span>
</span><span id="line-159"></span><span>        </span><span id="local-6989586621679629713"><span class="annot"><span class="annottext">nodeUptimeDElId :: EraName
</span><a href="#local-6989586621679629713"><span class="hs-identifier hs-var hs-var">nodeUptimeDElId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629707"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-uptime-days&quot;</span></span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679629716"><span class="annot"><span class="annottext">nodeUptimeHElId :: EraName
</span><a href="#local-6989586621679629716"><span class="hs-identifier hs-var hs-var">nodeUptimeHElId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629707"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-uptime-hours&quot;</span></span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679629719"><span class="annot"><span class="annottext">nodeUptimeMElId :: EraName
</span><a href="#local-6989586621679629719"><span class="hs-identifier hs-var hs-var">nodeUptimeMElId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629707"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-uptime-mins&quot;</span></span><span>
</span><span id="line-162"></span><span>        </span><span id="local-6989586621679629722"><span class="annot"><span class="annottext">nodeUptimeSElId :: EraName
</span><a href="#local-6989586621679629722"><span class="hs-identifier hs-var hs-var">nodeUptimeSElId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629707"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-uptime-secs&quot;</span></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map NodeId DisplayedForNode -&gt; NodeId -&gt; EraName -&gt; Maybe EraName
</span><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html#getDisplayedValuePure"><span class="hs-identifier hs-var">getDisplayedValuePure</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId DisplayedForNode
</span><a href="#local-6989586621679629704"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629705"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629710"><span class="hs-identifier hs-var">nodeStartElId</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">Maybe EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; UI ()
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679629724"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629724"><span class="hs-identifier hs-var">tsRaw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe UTCTime
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Read.html#readMaybe"><span class="hs-identifier hs-var">readMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629724"><span class="hs-identifier hs-var">tsRaw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; UI ()
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>          </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679629726"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629726"><span class="hs-identifier hs-var">startTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629727"><span class="annot"><span class="annottext">uptimeDiff :: NominalDiffTime
</span><a href="#local-6989586621679629727"><span class="hs-identifier hs-var hs-var">uptimeDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629703"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCDiff.html#diffUTCTime"><span class="hs-operator hs-var">`diffUTCTime`</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629726"><span class="hs-identifier hs-var">startTime</span></a></span><span>
</span><span id="line-170"></span><span>                </span><span id="local-6989586621679629728"><span class="annot"><span class="annottext">uptime :: UTCTime
</span><a href="#local-6989586621679629728"><span class="hs-identifier hs-var hs-var">uptime</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679629727"><span class="hs-identifier hs-var">uptimeDiff</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCDiff.html#addUTCTime"><span class="hs-operator hs-var">`addUTCTime`</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#nullTime"><span class="hs-identifier hs-var">nullTime</span></a></span><span>
</span><span id="line-171"></span><span>                </span><span id="local-6989586621679629732"><span class="annot"><span class="annottext">hoursNum :: String
</span><a href="#local-6989586621679629732"><span class="hs-identifier hs-var hs-var">hoursNum</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%H&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629728"><span class="hs-identifier hs-var">uptime</span></a></span><span>
</span><span id="line-172"></span><span>                </span><span id="local-6989586621679629734"><span class="annot"><span class="annottext">minsNum :: String
</span><a href="#local-6989586621679629734"><span class="hs-identifier hs-var hs-var">minsNum</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%M&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629728"><span class="hs-identifier hs-var">uptime</span></a></span><span>
</span><span id="line-173"></span><span>                </span><span id="local-6989586621679629736"><span class="annot"><span class="annottext">secsNum :: String
</span><a href="#local-6989586621679629736"><span class="hs-identifier hs-var hs-var">secsNum</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%S&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629728"><span class="hs-identifier hs-var">uptime</span></a></span><span>
</span><span id="line-174"></span><span>                </span><span id="local-6989586621679629737"><span class="annot"><span class="annottext">daysNum :: Integer
</span><a href="#local-6989586621679629737"><span class="hs-identifier hs-var hs-var">daysNum</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629728"><span class="hs-identifier hs-var">uptime</span></a></span><span> </span><span class="annot"><span class="annottext">Day -&gt; Day -&gt; Integer
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Calendar.Days.html#diffDays"><span class="hs-operator hs-var">`diffDays`</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#nullTime"><span class="hs-identifier hs-var">nullTime</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="annottext">[(EraName, EraName)] -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setTextValues"><span class="hs-identifier hs-var">setTextValues</span></a></span><span>
</span><span id="line-176"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629713"><span class="hs-identifier hs-var">nodeUptimeDElId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; EraName
forall a. Show a =&gt; a -&gt; EraName
</span><a href="file:///home/runner/work/cardano-node/cardano-node/dist-newstyle/build/x86_64-linux/ghc-9.6.3/trace-dispatcher-2.5.2/doc/html/trace-dispatcher/src/Cardano.Logging.Utils.html#showT"><span class="hs-identifier hs-var">showT</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679629737"><span class="hs-identifier hs-var">daysNum</span></a></span><span>   </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;d&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629716"><span class="hs-identifier hs-var">nodeUptimeHElId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629732"><span class="hs-identifier hs-var">hoursNum</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;h&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629719"><span class="hs-identifier hs-var">nodeUptimeMElId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629734"><span class="hs-identifier hs-var">minsNum</span></a></span><span>  </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;m&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629722"><span class="hs-identifier hs-var">nodeUptimeSElId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629736"><span class="hs-identifier hs-var">secsNum</span></a></span><span>  </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;s&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addLiveViewNodesForConnected"><span class="hs-identifier hs-type">addLiveViewNodesForConnected</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span id="addLiveViewNodesForConnected"><span class="annot"><span class="annottext">addLiveViewNodesForConnected :: TracerEnv -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#addLiveViewNodesForConnected"><span class="hs-identifier hs-var hs-var">addLiveViewNodesForConnected</span></a></span></span><span> </span><span id="local-6989586621679629740"><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629740"><span class="hs-identifier hs-var">tracerEnv</span></a></span></span><span> </span><span id="local-6989586621679629741"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629741"><span class="hs-identifier hs-var">newlyConnected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">UI Bool -&gt; UI () -&gt; UI ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenM"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="annot"><span class="annottext">UI Bool
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#logsLiveViewIsOpened"><span class="hs-identifier hs-var">logsLiveViewIsOpened</span></a></span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">TracerEnv -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#doAddLiveViewNodesForConnected"><span class="hs-identifier hs-var">doAddLiveViewNodesForConnected</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629740"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629741"><span class="hs-identifier hs-var">newlyConnected</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#doAddLiveViewNodesForConnected"><span class="hs-identifier hs-type">doAddLiveViewNodesForConnected</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span id="doAddLiveViewNodesForConnected"><span class="annot"><span class="annottext">doAddLiveViewNodesForConnected :: TracerEnv -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#doAddLiveViewNodesForConnected"><span class="hs-identifier hs-var hs-var">doAddLiveViewNodesForConnected</span></a></span></span><span> </span><span id="local-6989586621679629742"><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629742"><span class="hs-identifier hs-var">tracerEnv</span></a></span></span><span> </span><span id="local-6989586621679629743"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629743"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679629744"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629744"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">UI (Maybe Element) -&gt; (Element -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (Maybe a) -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJustM"><span class="hs-identifier hs-var">whenJustM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; String -&gt; UI (Maybe Element)
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#getElementById"><span class="hs-identifier hs-var">UI.getElementById</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629744"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;logs-live-view-nodes-checkboxes&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Element -&gt; UI ()) -&gt; UI ()) -&gt; (Element -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629746"><span class="annot"><span class="annottext">Element
</span><a href="#local-6989586621679629746"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629743"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629747"><span class="annot"><span class="annottext">nodeId :: NodeId
</span><a href="#local-6989586621679629747"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629748"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629748"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>      </span><span id="local-6989586621679629749"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629749"><span class="hs-identifier hs-var">nodeName</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO EraName -&gt; UI EraName
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO EraName -&gt; UI EraName) -&gt; IO EraName -&gt; UI EraName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv -&gt; NodeId -&gt; IO EraName
</span><a href="Cardano.Tracer.Utils.html#askNodeName"><span class="hs-identifier hs-var">askNodeName</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629742"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629747"><span class="hs-identifier hs-var">nodeId</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span id="local-6989586621679629751"><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679629751"><span class="hs-identifier hs-var">nodeColor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Color) -&gt; UI (Maybe Color)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Color) -&gt; UI (Maybe Color))
-&gt; IO (Maybe Color) -&gt; UI (Maybe Color)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv -&gt; EraName -&gt; IO (Maybe Color)
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Charts.html#getSavedColorForNode"><span class="hs-identifier hs-var">getSavedColorForNode</span></a></span><span> </span><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629742"><span class="hs-identifier hs-var">tracerEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629749"><span class="hs-identifier hs-var">nodeName</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629759"><span class="annot"><span class="annottext">nodeNamePrepared :: String
</span><a href="#local-6989586621679629759"><span class="hs-identifier hs-var hs-var">nodeNamePrepared</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(EraName -&gt; String) -&gt; EraName -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-202"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; Int
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html#length"><span class="hs-identifier hs-var">T.length</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629749"><span class="hs-identifier hs-var">nodeName</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">13</span></span><span>
</span><span id="line-203"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; EraName -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html#take"><span class="hs-identifier hs-var">T.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629749"><span class="hs-identifier hs-var">nodeName</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;...&quot;</span></span><span>
</span><span id="line-204"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629749"><span class="hs-identifier hs-var">nodeName</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span id="local-6989586621679629767"><span class="annot"><span class="annottext">checkId :: String
</span><a href="#local-6989586621679629767"><span class="hs-identifier hs-var hs-var">checkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629748"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__node-live-view-checkbox&quot;</span></span><span>
</span><span id="line-206"></span><span>          </span><span id="local-6989586621679629771"><span class="annot"><span class="annottext">checkLabelId :: String
</span><a href="#local-6989586621679629771"><span class="hs-identifier hs-var hs-var">checkLabelId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629748"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__node-live-view-checkbox-label&quot;</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><span class="annottext">UI Element -&gt; UI ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(UI Element -&gt; UI ()) -&gt; UI Element -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Element -&gt; UI Element
forall (m :: * -&gt; *) w. (MonadIO m, Widget w) =&gt; w -&gt; m Element
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#element"><span class="hs-identifier hs-var">element</span></a></span><span> </span><span class="annot"><span class="annottext">Element
</span><a href="#local-6989586621679629746"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">UI Element -&gt; [UI Element] -&gt; UI Element
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#%23%2B"><span class="hs-operator hs-var">#+</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">UI Element
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Elements.html#input"><span class="hs-identifier hs-var">UI.input</span></a></span><span> </span><span class="annot"><span class="annottext">UI Element -&gt; String -&gt; UI Element
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#%23%23"><span class="hs-operator hs-var">##</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629767"><span class="hs-identifier hs-var">checkId</span></a></span><span class="hs-cpp">
                   #. &quot;is-checkradio is-medium rt-view-ncb&quot;
</span><span class="hs-cpp">                   # set UI.type_ &quot;checkbox&quot;
</span><span class="hs-cpp">                   # set UI.name checkId
</span><span class="hs-cpp">                   # set UI.checked True
</span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="#local-6989586621679629751"><span class="hs-identifier hs-var">nodeColor</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>            </span><span class="annot"><span class="annottext">Maybe Color
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>              </span><span class="annot"><span class="annottext">UI Element
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Elements.html#label"><span class="hs-identifier hs-var">UI.label</span></a></span><span> </span><span class="annot"><span class="annottext">UI Element -&gt; String -&gt; UI Element
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#%23%23"><span class="hs-operator hs-var">##</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629771"><span class="hs-identifier hs-var">checkLabelId</span></a></span><span class="hs-cpp">
                       #. &quot;rt-view-ncbl&quot;
</span><span class="hs-cpp">                       # set UI.for checkId
</span><span class="hs-cpp">                       # set text nodeNamePrepared
</span><span>            </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.UI.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span id="local-6989586621679629785"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629785"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>              </span><span class="annot"><span class="annottext">UI Element
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Elements.html#label"><span class="hs-identifier hs-var">UI.label</span></a></span><span> </span><span class="annot"><span class="annottext">UI Element -&gt; String -&gt; UI Element
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#%23%23"><span class="hs-operator hs-var">##</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629771"><span class="hs-identifier hs-var">checkLabelId</span></a></span><span class="hs-cpp">
                       #. &quot;rt-view-ncbl&quot;
</span><span class="hs-cpp">                       # set UI.for checkId
</span><span class="hs-cpp">                       # set style [(&quot;color&quot;, code)]
</span><span class="hs-cpp">                       # set text nodeNamePrepared
</span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#deleteLiveViewNodesForDisconnected"><span class="hs-identifier hs-type">deleteLiveViewNodesForDisconnected</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Tracer.Environment.html#TracerEnv"><span class="hs-identifier hs-type">TracerEnv</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span id="deleteLiveViewNodesForDisconnected"><span class="annot"><span class="annottext">deleteLiveViewNodesForDisconnected :: TracerEnv -&gt; Set NodeId -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#deleteLiveViewNodesForDisconnected"><span class="hs-identifier hs-var hs-var">deleteLiveViewNodesForDisconnected</span></a></span></span><span> </span><span id="local-6989586621679629787"><span class="annot"><span class="annottext">TracerEnv
</span><a href="#local-6989586621679629787"><span class="hs-identifier hs-var">_tracerEnv</span></a></span></span><span> </span><span id="local-6989586621679629788"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629788"><span class="hs-identifier hs-var">disconnected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">UI Bool -&gt; UI () -&gt; UI ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenM"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="annot"><span class="annottext">UI Bool
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#logsLiveViewIsOpened"><span class="hs-identifier hs-var">logsLiveViewIsOpened</span></a></span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679629789"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629789"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629788"><span class="hs-identifier hs-var">disconnected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629790"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629793"><span class="annot"><span class="annottext">checkId :: EraName
</span><a href="#local-6989586621679629793"><span class="hs-identifier hs-var hs-var">checkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-live-view-checkbox&quot;</span></span><span>
</span><span id="line-237"></span><span>          </span><span id="local-6989586621679629796"><span class="annot"><span class="annottext">checkLabelId :: EraName
</span><a href="#local-6989586621679629796"><span class="hs-identifier hs-var hs-var">checkLabelId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629790"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-live-view-checkbox-label&quot;</span></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; (Element -&gt; UI ()) -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndDo"><span class="hs-identifier hs-var">findAndDo</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629789"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629793"><span class="hs-identifier hs-var">checkId</span></a></span><span> </span><span class="annot"><span class="annottext">Element -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#delete%27"><span class="hs-identifier hs-var">delete'</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><span class="annottext">Window -&gt; EraName -&gt; (Element -&gt; UI ()) -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndDo"><span class="hs-identifier hs-var">findAndDo</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629789"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629796"><span class="hs-identifier hs-var">checkLabelId</span></a></span><span> </span><span class="annot"><span class="annottext">Element -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#delete%27"><span class="hs-identifier hs-var">delete'</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#logsLiveViewIsOpened"><span class="hs-identifier hs-type">logsLiveViewIsOpened</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-242"></span><span id="logsLiveViewIsOpened"><span class="annot"><span class="annottext">logsLiveViewIsOpened :: UI Bool
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#logsLiveViewIsOpened"><span class="hs-identifier hs-var hs-var">logsLiveViewIsOpened</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679629799"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629799"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">Window -&gt; String -&gt; UI (Maybe Element)
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#getElementById"><span class="hs-identifier hs-var">UI.getElementById</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629799"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;logs-live-view-modal-window&quot;</span></span><span> </span><span class="annot"><span class="annottext">UI (Maybe Element) -&gt; (Maybe Element -&gt; UI Bool) -&gt; UI Bool
forall a b. UI a -&gt; (a -&gt; UI b) -&gt; UI b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Maybe Element
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UI Bool
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679629800"><span class="annot"><span class="annottext">Element
</span><a href="#local-6989586621679629800"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;opened&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; UI String -&gt; UI Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ReadWriteAttr Element String String -&gt; Element -&gt; UI String
forall x i o. ReadWriteAttr x i o -&gt; x -&gt; UI o
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadWriteAttr Element String String
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#dataState"><span class="hs-identifier hs-var">dataState</span></a></span><span> </span><span class="annot"><span class="annottext">Element
</span><a href="#local-6989586621679629800"><span class="hs-identifier hs-var">el</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setBlockReplayProgress"><span class="hs-identifier hs-type">setBlockReplayProgress</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#AcceptedMetrics"><span class="hs-identifier hs-type">AcceptedMetrics</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span id="setBlockReplayProgress"><span class="annot"><span class="annottext">setBlockReplayProgress :: Set NodeId -&gt; AcceptedMetrics -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setBlockReplayProgress"><span class="hs-identifier hs-var hs-var">setBlockReplayProgress</span></a></span></span><span> </span><span id="local-6989586621679629802"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629802"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span id="local-6989586621679629803"><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629803"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679629804"><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629804"><span class="hs-identifier hs-var">allMetrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores))
-&gt; IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics -&gt; IO (Map NodeId MetricsStores)
forall a. TVar a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVarIO"><span class="hs-identifier hs-var">readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629803"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629802"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629805"><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629805"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">Maybe MetricsStores -&gt; (MetricsStores -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeId -&gt; Map NodeId MetricsStores -&gt; Maybe MetricsStores
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629805"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629804"><span class="hs-identifier hs-var">allMetrics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((MetricsStores -&gt; UI ()) -&gt; UI ())
-&gt; (MetricsStores -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629807"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629807"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TVar MetricsLocalStore
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>      </span><span id="local-6989586621679629808"><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629808"><span class="hs-identifier hs-var">metrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)])
-&gt; IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Store -&gt; IO [(EraName, EraName)]
</span><a href="Cardano.Tracer.Handlers.Metrics.Utils.html#getListOfMetrics"><span class="hs-identifier hs-var">getListOfMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629807"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><span class="annottext">Maybe EraName -&gt; (EraName -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName -&gt; [(EraName, EraName)] -&gt; Maybe EraName
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;ChainDB.BlockReplayProgress&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629808"><span class="hs-identifier hs-var">metrics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((EraName -&gt; UI ()) -&gt; UI ()) -&gt; (EraName -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629811"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629811"><span class="hs-identifier hs-var">metricValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">NodeId -&gt; EraName -&gt; UI ()
</span><a href="#local-6989586621679629812"><span class="hs-identifier hs-var">updateBlockReplayProgress</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629805"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629811"><span class="hs-identifier hs-var">metricValue</span></a></span><span>
</span><span id="line-259"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679629812"><span class="annot"><span class="annottext">updateBlockReplayProgress :: NodeId -&gt; EraName -&gt; UI ()
</span><a href="#local-6989586621679629812"><span class="hs-identifier hs-var hs-var">updateBlockReplayProgress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629819"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629819"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679629820"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629820"><span class="hs-identifier hs-var">mValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Reader Double
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Read.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629820"><span class="hs-identifier hs-var">mValue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; UI ()
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679629821"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679629821"><span class="hs-identifier hs-var">progressPct</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629824"><span class="annot"><span class="annottext">nodeBlockReplayElId :: EraName
</span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var hs-var">nodeBlockReplayElId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629819"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-block-replay&quot;</span></span><span>
</span><span id="line-265"></span><span>            </span><span id="local-6989586621679629827"><span class="annot"><span class="annottext">progressPctS :: EraName
</span><a href="#local-6989586621679629827"><span class="hs-identifier hs-var hs-var">progressPctS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EraName) -&gt; String -&gt; EraName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679629821"><span class="hs-identifier hs-var">progressPct</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;100&quot;</span></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html#isInfixOf"><span class="hs-operator hs-var">`T.isInfixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629827"><span class="hs-identifier hs-var">progressPctS</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setTextAndClasses"><span class="hs-identifier hs-var">setTextAndClasses</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">nodeBlockReplayElId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;100&amp;nbsp;%&quot;</span></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;rt-view-percent-done&quot;</span></span><span>
</span><span id="line-268"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setTextValue"><span class="hs-identifier hs-var">setTextValue</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629824"><span class="hs-identifier hs-var">nodeBlockReplayElId</span></a></span><span> </span><span class="annot"><span class="annottext">(EraName -&gt; UI ()) -&gt; EraName -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629827"><span class="hs-identifier hs-var">progressPctS</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;&amp;nbsp;%&quot;</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setProducerMode"><span class="hs-identifier hs-type">setProducerMode</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#AcceptedMetrics"><span class="hs-identifier hs-type">AcceptedMetrics</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span id="setProducerMode"><span class="annot"><span class="annottext">setProducerMode :: Set NodeId -&gt; AcceptedMetrics -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setProducerMode"><span class="hs-identifier hs-var hs-var">setProducerMode</span></a></span></span><span> </span><span id="local-6989586621679629832"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629832"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span id="local-6989586621679629833"><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629833"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679629834"><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629834"><span class="hs-identifier hs-var">allMetrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores))
-&gt; IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics -&gt; IO (Map NodeId MetricsStores)
forall a. TVar a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVarIO"><span class="hs-identifier hs-var">readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629833"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629832"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629835"><span class="annot"><span class="annottext">nodeId :: NodeId
</span><a href="#local-6989586621679629835"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629836"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629836"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">Maybe MetricsStores -&gt; (MetricsStores -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeId -&gt; Map NodeId MetricsStores -&gt; Maybe MetricsStores
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629835"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629834"><span class="hs-identifier hs-var">allMetrics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((MetricsStores -&gt; UI ()) -&gt; UI ())
-&gt; (MetricsStores -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629837"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629837"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TVar MetricsLocalStore
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="annottext">UI [(EraName, EraName)] -&gt; ((EraName, EraName) -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
m (t a) -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Cardano.Tracer.Utils.html#forMM_"><span class="hs-identifier hs-var">forMM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)])
-&gt; IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Store -&gt; IO [(EraName, EraName)]
</span><a href="Cardano.Tracer.Handlers.Metrics.Utils.html#getListOfMetrics"><span class="hs-identifier hs-var">getListOfMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629837"><span class="hs-identifier hs-var">ekgStore</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((EraName, EraName) -&gt; UI ()) -&gt; UI ())
-&gt; ((EraName, EraName) -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629839"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629839"><span class="hs-identifier hs-var">mName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629839"><span class="hs-identifier hs-var">mName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Forge.NodeIsLeader&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; UI ()
</span><a href="#local-6989586621679629840"><span class="hs-identifier hs-var">showProducerMode</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629836"><span class="hs-identifier hs-var">anId</span></a></span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Forge.NodeIsLeaderNum&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; UI ()
</span><a href="#local-6989586621679629840"><span class="hs-identifier hs-var">showProducerMode</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629836"><span class="hs-identifier hs-var">anId</span></a></span><span>
</span><span id="line-282"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; UI ()
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-comment">-- The presence of these metrics is a proof that this node is</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- configured as a producer, so display corresponding icon.</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679629840"><span class="annot"><span class="annottext">showProducerMode :: EraName -&gt; UI ()
</span><a href="#local-6989586621679629840"><span class="hs-identifier hs-var hs-var">showProducerMode</span></a></span></span><span> </span><span id="local-6989586621679629844"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629844"><span class="hs-identifier hs-var">anId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679629845"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629845"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">(UI Element -&gt; UI Element) -&gt; Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndSet"><span class="hs-identifier hs-var">findAndSet</span></a></span><span> </span><span class="annot"><span class="annottext">UI Element -&gt; UI Element
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#showInline"><span class="hs-identifier hs-var">showInline</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679629845"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629844"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-producer-label&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setLeadershipStats"><span class="hs-identifier hs-type">setLeadershipStats</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html#DisplayedElements"><span class="hs-identifier hs-type">DisplayedElements</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#AcceptedMetrics"><span class="hs-identifier hs-type">AcceptedMetrics</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span id="setLeadershipStats"><span class="annot"><span class="annottext">setLeadershipStats :: Set NodeId -&gt; DisplayedElements -&gt; AcceptedMetrics -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setLeadershipStats"><span class="hs-identifier hs-var hs-var">setLeadershipStats</span></a></span></span><span> </span><span id="local-6989586621679629847"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629847"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span id="local-6989586621679629848"><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629848"><span class="hs-identifier hs-var">displayed</span></a></span></span><span> </span><span id="local-6989586621679629849"><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629849"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679629850"><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629850"><span class="hs-identifier hs-var">allMetrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores))
-&gt; IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics -&gt; IO (Map NodeId MetricsStores)
forall a. TVar a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVarIO"><span class="hs-identifier hs-var">readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629849"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629847"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629851"><span class="annot"><span class="annottext">nodeId :: NodeId
</span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629852"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629852"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">Maybe MetricsStores -&gt; (MetricsStores -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeId -&gt; Map NodeId MetricsStores -&gt; Maybe MetricsStores
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629850"><span class="hs-identifier hs-var">allMetrics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((MetricsStores -&gt; UI ()) -&gt; UI ())
-&gt; (MetricsStores -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629853"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629853"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TVar MetricsLocalStore
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>      </span><span id="local-6989586621679629854"><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629854"><span class="hs-identifier hs-var">metrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)])
-&gt; IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Store -&gt; IO [(EraName, EraName)]
</span><a href="Cardano.Tracer.Handlers.Metrics.Utils.html#getListOfMetrics"><span class="hs-identifier hs-var">getListOfMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629853"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><span class="annottext">[(EraName, EraName)] -&gt; ((EraName, EraName) -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629854"><span class="hs-identifier hs-var">metrics</span></a></span><span> </span><span class="annot"><span class="annottext">(((EraName, EraName) -&gt; UI ()) -&gt; UI ())
-&gt; ((EraName, EraName) -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629855"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629855"><span class="hs-identifier hs-var">mName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629856"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629856"><span class="hs-identifier hs-var">mValue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629855"><span class="hs-identifier hs-var">mName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-302"></span><span>          </span><span class="hs-comment">-- How many times this node was a leader.</span><span>
</span><span id="line-303"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Forge.NodeIsLeaderNum&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeId -&gt; DisplayedElements -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setDisplayedValue"><span class="hs-identifier hs-var">setDisplayedValue</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629848"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629852"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-leadership&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629856"><span class="hs-identifier hs-var">mValue</span></a></span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-comment">-- How many blocks were forged by this node.</span><span>
</span><span id="line-305"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Forge.BlocksForgedNum&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeId -&gt; DisplayedElements -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setDisplayedValue"><span class="hs-identifier hs-var">setDisplayedValue</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629848"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629852"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-forged-blocks&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629856"><span class="hs-identifier hs-var">mValue</span></a></span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-comment">-- How many times this node could not forge.</span><span>
</span><span id="line-307"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Forge.NodeCannotForgeNum&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeId -&gt; DisplayedElements -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setDisplayedValue"><span class="hs-identifier hs-var">setDisplayedValue</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629848"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629852"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-cannot-forge&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629856"><span class="hs-identifier hs-var">mValue</span></a></span><span>
</span><span id="line-308"></span><span>          </span><span class="hs-comment">-- How many slots were missed in this node.</span><span>
</span><span id="line-309"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Forge.SlotsMissed&quot;</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeId -&gt; DisplayedElements -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setDisplayedValue"><span class="hs-identifier hs-var">setDisplayedValue</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629851"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629848"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629852"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-missed-slots&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629856"><span class="hs-identifier hs-var">mValue</span></a></span><span>
</span><span id="line-310"></span><span>          </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; UI ()
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setEraEpochInfo"><span class="hs-identifier hs-type">setEraEpochInfo</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.Displayed.html#DisplayedElements"><span class="hs-identifier hs-type">DisplayedElements</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Types.html#AcceptedMetrics"><span class="hs-identifier hs-type">AcceptedMetrics</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#ErasSettings"><span class="hs-identifier hs-type">ErasSettings</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#UI"><span class="hs-identifier hs-type">UI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span id="setEraEpochInfo"><span class="annot"><span class="annottext">setEraEpochInfo :: Set NodeId
-&gt; DisplayedElements -&gt; AcceptedMetrics -&gt; ErasSettings -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#setEraEpochInfo"><span class="hs-identifier hs-var hs-var">setEraEpochInfo</span></a></span></span><span> </span><span id="local-6989586621679629858"><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629858"><span class="hs-identifier hs-var">connected</span></a></span></span><span> </span><span id="local-6989586621679629859"><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629859"><span class="hs-identifier hs-var">displayed</span></a></span></span><span> </span><span id="local-6989586621679629860"><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629860"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span></span><span> </span><span id="local-6989586621679629861"><span class="annot"><span class="annottext">ErasSettings
</span><a href="#local-6989586621679629861"><span class="hs-identifier hs-var">nodesEraSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679629862"><span class="annot"><span class="annottext">Map NodeId EraSettings
</span><a href="#local-6989586621679629862"><span class="hs-identifier hs-var">allSettings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Map NodeId EraSettings) -&gt; UI (Map NodeId EraSettings)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map NodeId EraSettings) -&gt; UI (Map NodeId EraSettings))
-&gt; IO (Map NodeId EraSettings) -&gt; UI (Map NodeId EraSettings)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ErasSettings -&gt; IO (Map NodeId EraSettings)
forall a. TVar a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVarIO"><span class="hs-identifier hs-var">readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">ErasSettings
</span><a href="#local-6989586621679629861"><span class="hs-identifier hs-var">nodesEraSettings</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679629863"><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629863"><span class="hs-identifier hs-var">allMetrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores))
-&gt; IO (Map NodeId MetricsStores) -&gt; UI (Map NodeId MetricsStores)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics -&gt; IO (Map NodeId MetricsStores)
forall a. TVar a -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Conc.Sync.html#readTVarIO"><span class="hs-identifier hs-var">readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">AcceptedMetrics
</span><a href="#local-6989586621679629860"><span class="hs-identifier hs-var">acceptedMetrics</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">Set NodeId -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Set NodeId
</span><a href="#local-6989586621679629858"><span class="hs-identifier hs-var">connected</span></a></span><span> </span><span class="annot"><span class="annottext">((NodeId -&gt; UI ()) -&gt; UI ()) -&gt; (NodeId -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629864"><span class="annot"><span class="annottext">nodeId :: NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629865"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629865"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679629866"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">epochS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NodeId -&gt; Map NodeId MetricsStores -&gt; Maybe MetricsStores
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629863"><span class="hs-identifier hs-var">allMetrics</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679629867"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629867"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TVar MetricsLocalStore
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-325"></span><span>          </span><span id="local-6989586621679629868"><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629868"><span class="hs-identifier hs-var">metrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)])
-&gt; IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Store -&gt; IO [(EraName, EraName)]
</span><a href="Cardano.Tracer.Handlers.Metrics.Utils.html#getListOfMetrics"><span class="hs-identifier hs-var">getListOfMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629867"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-326"></span><span>          </span><span class="annot"><span class="annottext">EraName -&gt; UI EraName
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(EraName -&gt; UI EraName) -&gt; EraName -&gt; UI EraName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; Maybe EraName -&gt; EraName
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe EraName -&gt; EraName) -&gt; Maybe EraName -&gt; EraName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; [(EraName, EraName)] -&gt; Maybe EraName
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;ChainDB.Epoch&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629868"><span class="hs-identifier hs-var">metrics</span></a></span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">Maybe MetricsStores
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; UI EraName
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; UI () -&gt; UI ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html#null"><span class="hs-identifier hs-var">T.null</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">epochS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">NodeId -&gt; DisplayedElements -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setDisplayedValue"><span class="hs-identifier hs-var">setDisplayedValue</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629859"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629865"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-epoch-num&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">epochS</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">Maybe EraSettings -&gt; (EraSettings -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeId -&gt; Map NodeId EraSettings -&gt; Maybe EraSettings
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId EraSettings
</span><a href="#local-6989586621679629862"><span class="hs-identifier hs-var">allSettings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((EraSettings -&gt; UI ()) -&gt; UI ())
-&gt; (EraSettings -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629870"><span class="annot"><span class="annottext">EraSettings
</span><a href="#local-6989586621679629870"><span class="hs-identifier hs-var">settings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>      </span><span class="annot"><span class="annottext">NodeId -&gt; DisplayedElements -&gt; EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setDisplayedValue"><span class="hs-identifier hs-var">setDisplayedValue</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayedElements
</span><a href="#local-6989586621679629859"><span class="hs-identifier hs-var">displayed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629865"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-era&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EraName -&gt; UI ()) -&gt; EraName -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EraSettings -&gt; EraName
</span><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#esEra"><span class="hs-identifier hs-var">esEra</span></a></span><span> </span><span class="annot"><span class="annottext">EraSettings
</span><a href="#local-6989586621679629870"><span class="hs-identifier hs-var">settings</span></a></span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><span class="annottext">EraSettings -&gt; NodeId -&gt; EraName -&gt; UI ()
</span><a href="#local-6989586621679629872"><span class="hs-identifier hs-var">updateEpochInfo</span></a></span><span> </span><span class="annot"><span class="annottext">EraSettings
</span><a href="#local-6989586621679629870"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629866"><span class="hs-identifier hs-var">epochS</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">EraSettings -&gt; NodeId -&gt; Map NodeId MetricsStores -&gt; UI ()
forall {b}. EraSettings -&gt; NodeId -&gt; Map NodeId (Store, b) -&gt; UI ()
</span><a href="#local-6989586621679629873"><span class="hs-identifier hs-var">updateEpochSlotProgress</span></a></span><span> </span><span class="annot"><span class="annottext">EraSettings
</span><a href="#local-6989586621679629870"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629864"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId MetricsStores
</span><a href="#local-6989586621679629863"><span class="hs-identifier hs-var">allMetrics</span></a></span><span>
</span><span id="line-335"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679629872"><span class="annot"><span class="annottext">updateEpochInfo :: EraSettings -&gt; NodeId -&gt; EraName -&gt; UI ()
</span><a href="#local-6989586621679629872"><span class="hs-identifier hs-var hs-var">updateEpochInfo</span></a></span></span><span> </span><span id="local-6989586621679629886"><span class="annot"><span class="annottext">EraSettings
</span><a href="#local-6989586621679629886"><span class="hs-identifier hs-var">settings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629887"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629887"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679629888"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629888"><span class="hs-identifier hs-var">epochS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; UI () -&gt; UI ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html#null"><span class="hs-identifier hs-var">T.null</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629888"><span class="hs-identifier hs-var">epochS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UI () -&gt; UI ()) -&gt; UI () -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629889"><span class="annot"><span class="annottext">epochNum :: Int
</span><a href="#local-6989586621679629889"><span class="hs-identifier hs-var hs-var">epochNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraName -&gt; Int -&gt; Int
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#readInt"><span class="hs-identifier hs-var">readInt</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629888"><span class="hs-identifier hs-var">epochS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">Maybe (UTCTime, UTCTime) -&gt; ((UTCTime, UTCTime) -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraSettings -&gt; Int -&gt; Maybe (UTCTime, UTCTime)
</span><a href="#local-6989586621679629891"><span class="hs-identifier hs-var">getEndOfCurrentEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">EraSettings
</span><a href="#local-6989586621679629886"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629889"><span class="hs-identifier hs-var">epochNum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((UTCTime, UTCTime) -&gt; UI ()) -&gt; UI ())
-&gt; ((UTCTime, UTCTime) -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629892"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629892"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629893"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629893"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>        </span><span id="local-6989586621679629894"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629894"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SystemTime -&gt; UTCTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.System.html#systemToUTCTime"><span class="hs-identifier hs-var">systemToUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">(SystemTime -&gt; UTCTime) -&gt; UI SystemTime -&gt; UI UTCTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemTime -&gt; UI SystemTime
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.SystemTime.html#getSystemTime"><span class="hs-identifier hs-var">getSystemTime</span></a></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629892"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629894"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629894"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629893"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-342"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>            </span><span class="hs-comment">-- We're synced and on the current epoch.</span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629897"><span class="annot"><span class="annottext">diffFromNowToEnd :: NominalDiffTime
</span><a href="#local-6989586621679629897"><span class="hs-identifier hs-var hs-var">diffFromNowToEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629893"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCDiff.html#diffUTCTime"><span class="hs-operator hs-var">`diffUTCTime`</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629894"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-345"></span><span>                </span><span id="local-6989586621679629898"><span class="annot"><span class="annottext">timeLeft :: UTCTime
</span><a href="#local-6989586621679629898"><span class="hs-identifier hs-var hs-var">timeLeft</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679629897"><span class="hs-identifier hs-var">diffFromNowToEnd</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCDiff.html#addUTCTime"><span class="hs-operator hs-var">`addUTCTime`</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#nullTime"><span class="hs-identifier hs-var">nullTime</span></a></span><span>
</span><span id="line-346"></span><span>                </span><span id="local-6989586621679629899"><span class="annot"><span class="annottext">daysNum :: Integer
</span><a href="#local-6989586621679629899"><span class="hs-identifier hs-var hs-var">daysNum</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629898"><span class="hs-identifier hs-var">timeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Day -&gt; Day -&gt; Integer
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Calendar.Days.html#diffDays"><span class="hs-operator hs-var">`diffDays`</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#nullTime"><span class="hs-identifier hs-var">nullTime</span></a></span><span>
</span><span id="line-347"></span><span>                </span><span id="local-6989586621679629901"><span class="annot"><span class="annottext">hoursNum :: String
</span><a href="#local-6989586621679629901"><span class="hs-identifier hs-var hs-var">hoursNum</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%H&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629898"><span class="hs-identifier hs-var">timeLeft</span></a></span><span>
</span><span id="line-348"></span><span>                </span><span id="local-6989586621679629903"><span class="annot"><span class="annottext">minsNum :: String
</span><a href="#local-6989586621679629903"><span class="hs-identifier hs-var hs-var">minsNum</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%M&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629898"><span class="hs-identifier hs-var">timeLeft</span></a></span><span>
</span><span id="line-349"></span><span>                </span><span id="local-6989586621679629905"><span class="annot"><span class="annottext">secsNum :: String
</span><a href="#local-6989586621679629905"><span class="hs-identifier hs-var hs-var">secsNum</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%S&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629898"><span class="hs-identifier hs-var">timeLeft</span></a></span><span>
</span><span id="line-350"></span><span>                </span><span id="local-6989586621679629918"><span class="annot"><span class="annottext">timeLeftF :: EraName
</span><a href="#local-6989586621679629918"><span class="hs-identifier hs-var hs-var">timeLeftF</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="annot"><span class="annottext">Integer -&gt; EraName
forall a. Show a =&gt; a -&gt; EraName
</span><a href="file:///home/runner/work/cardano-node/cardano-node/dist-newstyle/build/x86_64-linux/ghc-9.6.3/trace-dispatcher-2.5.2/doc/html/trace-dispatcher/src/Cardano.Logging.Utils.html#showT"><span class="hs-identifier hs-var">showT</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679629899"><span class="hs-identifier hs-var">daysNum</span></a></span><span>  </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;d &quot;</span></span><span>
</span><span id="line-351"></span><span>                             </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629901"><span class="hs-identifier hs-var">hoursNum</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;h &quot;</span></span><span>
</span><span id="line-352"></span><span>                             </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629903"><span class="hs-identifier hs-var">minsNum</span></a></span><span>  </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;m &quot;</span></span><span>
</span><span id="line-353"></span><span>                             </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679629905"><span class="hs-identifier hs-var">secsNum</span></a></span><span>  </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;s&quot;</span></span><span>
</span><span id="line-354"></span><span>            </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setTextValue"><span class="hs-identifier hs-var">setTextValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629887"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-epoch-end&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629918"><span class="hs-identifier hs-var">timeLeftF</span></a></span><span>
</span><span id="line-355"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-356"></span><span>            </span><span class="hs-comment">-- We're out of date (sync in progress), so just display the end date.</span><span>
</span><span id="line-357"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629920"><span class="annot"><span class="annottext">endDateF :: EraName
</span><a href="#local-6989586621679629920"><span class="hs-identifier hs-var hs-var">endDateF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EraName) -&gt; String -&gt; EraName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Format.Class.html#formatTime"><span class="hs-identifier hs-var">formatTime</span></a></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.Locale.html#defaultTimeLocale"><span class="hs-identifier hs-var">defaultTimeLocale</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%D %T&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679629893"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-358"></span><span>            </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setTextValue"><span class="hs-identifier hs-var">setTextValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629887"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-epoch-end&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629920"><span class="hs-identifier hs-var">endDateF</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679629891"><span class="annot"><span class="annottext">getEndOfCurrentEpoch :: EraSettings -&gt; Int -&gt; Maybe (UTCTime, UTCTime)
</span><a href="#local-6989586621679629891"><span class="hs-identifier hs-var hs-var">getEndOfCurrentEpoch</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#EraSettings"><span class="hs-identifier hs-type">EraSettings</span></a></span><span class="hs-special">{</span><span id="local-6989586621679629925"><span class="annot"><span class="annottext">EraName
esEra :: EraSettings -&gt; EraName
esEra :: EraName
</span><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#esEra"><span class="hs-identifier hs-var hs-var">esEra</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629926"><span class="annot"><span class="annottext">Int
esSlotLengthInS :: Int
esSlotLengthInS :: EraSettings -&gt; Int
</span><a href="#local-6989586621679629926"><span class="hs-identifier hs-var hs-var">esSlotLengthInS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629928"><span class="annot"><span class="annottext">Int
esEpochLength :: Int
esEpochLength :: EraSettings -&gt; Int
</span><a href="#local-6989586621679629928"><span class="hs-identifier hs-var hs-var">esEpochLength</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679629930"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629930"><span class="hs-identifier hs-var">currentEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EraName
-&gt; [(EraName, (EraStartPOSIX, Int))] -&gt; Maybe (EraStartPOSIX, Int)
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629925"><span class="hs-identifier hs-var">esEra</span></a></span><span> </span><span class="annot"><span class="annottext">[(EraName, (EraStartPOSIX, Int))]
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#epochsInfo"><span class="hs-identifier hs-var">epochsInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><span class="annottext">Maybe (EraStartPOSIX, Int)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-comment">-- So, there is no such an era. The possible reason: this is &quot;too new&quot; era</span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-comment">-- (not officially forked yet). Try to find corresponding epoch directly.</span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((EraName, (EraStartPOSIX, Int)) -&gt; Bool)
-&gt; [(EraName, (EraStartPOSIX, Int))]
-&gt; Maybe (EraName, (EraStartPOSIX, Int))
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraStartPOSIX
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629932"><span class="hs-identifier hs-var">firstEpoch</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629930"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629932"><span class="hs-identifier hs-var">firstEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(EraName, (EraStartPOSIX, Int))]
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#epochsInfo"><span class="hs-identifier hs-var">epochsInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>          </span><span class="annot"><span class="annottext">Maybe (EraName, (EraStartPOSIX, Int))
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (UTCTime, UTCTime)
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-367"></span><span>          </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679629933"><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629933"><span class="hs-identifier hs-var">epochStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629934"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629934"><span class="hs-identifier hs-var">firstEpoch</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX -&gt; Int -&gt; Maybe (UTCTime, UTCTime)
</span><a href="#local-6989586621679629935"><span class="hs-identifier hs-var">getEpochDates</span></a></span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629933"><span class="hs-identifier hs-var">epochStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629934"><span class="hs-identifier hs-var">firstEpoch</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679629936"><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629936"><span class="hs-identifier hs-var">epochStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679629937"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629937"><span class="hs-identifier hs-var">firstEpoch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX -&gt; Int -&gt; Maybe (UTCTime, UTCTime)
</span><a href="#local-6989586621679629935"><span class="hs-identifier hs-var">getEpochDates</span></a></span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629936"><span class="hs-identifier hs-var">epochStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629937"><span class="hs-identifier hs-var">firstEpoch</span></a></span><span>
</span><span id="line-369"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>    </span><span id="local-6989586621679629935"><span class="annot"><span class="annottext">getEpochDates :: EraStartPOSIX -&gt; Int -&gt; Maybe (UTCTime, UTCTime)
</span><a href="#local-6989586621679629935"><span class="hs-identifier hs-var hs-var">getEpochDates</span></a></span></span><span> </span><span id="local-6989586621679629938"><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629938"><span class="hs-identifier hs-var">startDate</span></a></span></span><span> </span><span id="local-6989586621679629939"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629939"><span class="hs-identifier hs-var">firstEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679629941"><span class="annot"><span class="annottext">elapsedEpochsInEra :: Int
</span><a href="#local-6989586621679629941"><span class="hs-identifier hs-var hs-var">elapsedEpochsInEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629930"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629939"><span class="hs-identifier hs-var">firstEpoch</span></a></span><span>
</span><span id="line-372"></span><span>          </span><span id="local-6989586621679629943"><span class="annot"><span class="annottext">epochLengthInS :: Int
</span><a href="#local-6989586621679629943"><span class="hs-identifier hs-var hs-var">epochLengthInS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629926"><span class="hs-identifier hs-var">esSlotLengthInS</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629928"><span class="hs-identifier hs-var">esEpochLength</span></a></span><span>
</span><span id="line-373"></span><span>          </span><span id="local-6989586621679629946"><span class="annot"><span class="annottext">secondsFromEpochStartToEpoch :: Int
</span><a href="#local-6989586621679629946"><span class="hs-identifier hs-var hs-var">secondsFromEpochStartToEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629943"><span class="hs-identifier hs-var">epochLengthInS</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629941"><span class="hs-identifier hs-var">elapsedEpochsInEra</span></a></span><span>
</span><span id="line-374"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679629951"><span class="annot"><span class="annottext">dateOfEpochStart :: EraStartPOSIX
</span><a href="#local-6989586621679629951"><span class="hs-identifier hs-var hs-var">dateOfEpochStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629938"><span class="hs-identifier hs-var">startDate</span></a></span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX -&gt; EraStartPOSIX -&gt; EraStartPOSIX
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; EraStartPOSIX
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629946"><span class="hs-identifier hs-var">secondsFromEpochStartToEpoch</span></a></span><span>
</span><span id="line-375"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679629956"><span class="annot"><span class="annottext">dateOfEpochEnd :: EraStartPOSIX
</span><a href="#local-6989586621679629956"><span class="hs-identifier hs-var hs-var">dateOfEpochEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629951"><span class="hs-identifier hs-var">dateOfEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX -&gt; EraStartPOSIX -&gt; EraStartPOSIX
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; EraStartPOSIX
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629943"><span class="hs-identifier hs-var">epochLengthInS</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(UTCTime, UTCTime) -&gt; Maybe (UTCTime, UTCTime)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraStartPOSIX -&gt; UTCTime
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#s2utc"><span class="hs-identifier hs-var">s2utc</span></a></span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629951"><span class="hs-identifier hs-var">dateOfEpochStart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX -&gt; UTCTime
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Utils.html#s2utc"><span class="hs-identifier hs-var">s2utc</span></a></span><span> </span><span class="annot"><span class="annottext">EraStartPOSIX
</span><a href="#local-6989586621679629956"><span class="hs-identifier hs-var">dateOfEpochEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621679629873"><span class="annot"><span class="annottext">updateEpochSlotProgress :: EraSettings -&gt; NodeId -&gt; Map NodeId (Store, b) -&gt; UI ()
</span><a href="#local-6989586621679629873"><span class="hs-identifier hs-var hs-var">updateEpochSlotProgress</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#EraSettings"><span class="hs-identifier hs-type">EraSettings</span></a></span><span class="hs-special">{</span><span id="local-6989586621679629982"><span class="annot"><span class="annottext">Int
esEpochLength :: EraSettings -&gt; Int
esEpochLength :: Int
</span><a href="Cardano.Tracer.Handlers.RTView.State.EraSettings.html#esEpochLength"><span class="hs-identifier hs-var hs-var">esEpochLength</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679629983"><span class="annot"><span class="annottext">nodeId :: NodeId
</span><a href="#local-6989586621679629983"><span class="hs-identifier hs-var">nodeId</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Types.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a></span><span> </span><span id="local-6989586621679629984"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629984"><span class="hs-identifier hs-var">anId</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679629985"><span class="annot"><span class="annottext">Map NodeId (Store, b)
</span><a href="#local-6989586621679629985"><span class="hs-identifier hs-var">allMetrics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Store, b) -&gt; ((Store, b) -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeId -&gt; Map NodeId (Store, b) -&gt; Maybe (Store, b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">NodeId
</span><a href="#local-6989586621679629983"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeId (Store, b)
</span><a href="#local-6989586621679629985"><span class="hs-identifier hs-var">allMetrics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Store, b) -&gt; UI ()) -&gt; UI ()) -&gt; ((Store, b) -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679629986"><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629986"><span class="hs-identifier hs-var">ekgStore</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>      </span><span id="local-6989586621679629987"><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629987"><span class="hs-identifier hs-var">metrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a. IO a -&gt; UI a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)])
-&gt; IO [(EraName, EraName)] -&gt; UI [(EraName, EraName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Store -&gt; IO [(EraName, EraName)]
</span><a href="Cardano.Tracer.Handlers.Metrics.Utils.html#getListOfMetrics"><span class="hs-identifier hs-var">getListOfMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="#local-6989586621679629986"><span class="hs-identifier hs-var">ekgStore</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><span class="annottext">Maybe EraName -&gt; (EraName -&gt; UI ()) -&gt; UI ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="file:///nix/store/1df7522106rl60xr1qprhwlmf1baz104-extra-lib-extra-1.7.14-haddock-doc/share/doc/extra/html/src/Control.Monad.Extra.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName -&gt; [(EraName, EraName)] -&gt; Maybe EraName
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;ChainDB.SlotInEpoch&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(EraName, EraName)]
</span><a href="#local-6989586621679629987"><span class="hs-identifier hs-var">metrics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((EraName -&gt; UI ()) -&gt; UI ()) -&gt; (EraName -&gt; UI ()) -&gt; UI ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679629988"><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629988"><span class="hs-identifier hs-var">slotInEpochS</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Reader Int
forall a. Integral a =&gt; Reader a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Read.html#decimal"><span class="hs-identifier hs-var">decimal</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629988"><span class="hs-identifier hs-var">slotInEpochS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-383"></span><span>          </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; UI ()
forall a. a -&gt; UI a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>          </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679629989"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629989"><span class="hs-identifier hs-var">slotInEpoch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679629990"><span class="hs-identifier hs-type">slotsPct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-386"></span><span>                </span><span id="local-6989586621679629990"><span class="annot"><span class="annottext">slotsPct :: Double
</span><a href="#local-6989586621679629990"><span class="hs-identifier hs-var hs-var">slotsPct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629989"><span class="hs-identifier hs-var">slotInEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679629982"><span class="hs-identifier hs-var">esEpochLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>                </span><span id="local-6989586621679630004"><span class="annot"><span class="annottext">slotsPctF :: String
</span><a href="#local-6989586621679630004"><span class="hs-identifier hs-var hs-var">slotsPctF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%.1f&quot;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679629990"><span class="hs-identifier hs-var">slotsPct</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%&quot;</span></span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#setTextValue"><span class="hs-identifier hs-var">setTextValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629984"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-epoch-progress-label&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EraName
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679630004"><span class="hs-identifier hs-var">slotsPctF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>            </span><span id="local-6989586621679630005"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679630005"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UI Window
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Internal.html#askWindow"><span class="hs-identifier hs-var">askWindow</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="annottext">(UI Element -&gt; UI Element) -&gt; Window -&gt; EraName -&gt; UI ()
</span><a href="Cardano.Tracer.Handlers.RTView.UI.Utils.html#findAndSet"><span class="hs-identifier hs-var">findAndSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadWriteAttr Element [(String, String)] ()
-&gt; [(String, String)] -&gt; UI Element -&gt; UI Element
forall x i o. ReadWriteAttr x i o -&gt; i -&gt; UI x -&gt; UI x
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">ReadWriteAttr Element [(String, String)] ()
</span><a href="file:///nix/store/w941r35abisxky957xgd85kmdfw5bdrv-threepenny-gui-lib-threepenny-gui-0.9.4.0-haddock-doc/share/doc/threepenny-gui/html/src/Graphics.UI.Threepenny.Core.html#style"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;width&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679630004"><span class="hs-identifier hs-var">slotsPctF</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679630005"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><a href="#local-6989586621679629984"><span class="hs-identifier hs-var">anId</span></a></span><span> </span><span class="annot"><span class="annottext">EraName -&gt; EraName -&gt; EraName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;__node-epoch-progress&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-keyword">type</span><span> </span><span id="EraName"><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#EraName"><span class="hs-identifier hs-var">EraName</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-393"></span><span class="hs-keyword">type</span><span> </span><span id="FirstEpochInEra"><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#FirstEpochInEra"><span class="hs-identifier hs-var">FirstEpochInEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-394"></span><span class="hs-keyword">type</span><span> </span><span id="EraStartPOSIX"><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#EraStartPOSIX"><span class="hs-identifier hs-var">EraStartPOSIX</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">-- It is taken from 'cardano-ledger' wiki topic &quot;First-Block-of-Each-Era&quot;.</span><span>
</span><span id="line-397"></span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#epochsInfo"><span class="hs-identifier hs-type">epochsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#EraName"><span class="hs-identifier hs-type">EraName</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#EraStartPOSIX"><span class="hs-identifier hs-type">EraStartPOSIX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#FirstEpochInEra"><span class="hs-identifier hs-type">FirstEpochInEra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span id="epochsInfo"><span class="annot"><span class="annottext">epochsInfo :: [(EraName, (EraStartPOSIX, Int))]
</span><a href="Cardano.Tracer.Handlers.RTView.Update.Nodes.html#epochsInfo"><span class="hs-identifier hs-var hs-var">epochsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Shelley&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraStartPOSIX
</span><span class="hs-number">1596073491</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">208</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 07/30/2020 1:44:51 AM GMT</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Allegra&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraStartPOSIX
</span><span class="hs-number">1608169491</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">236</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 12/17/2020 1:44:51 AM GMT</span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Mary&quot;</span></span><span class="hs-special">,</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraStartPOSIX
</span><span class="hs-number">1614649491</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">251</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 03/02/2021 1:44:51 AM GMT</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraName
</span><span class="hs-string">&quot;Alonzo&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraStartPOSIX
</span><span class="hs-number">1634953491</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">298</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 10/23/2021 1:44:51 AM GMT, start of new protocol.</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-404"></span></pre></body></html>