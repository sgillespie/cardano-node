<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Shelley.Protocol.TPraos</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.KES</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.VRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">certifiedOutput</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Chain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainPredicateFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.API</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.API</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PraosCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.API</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.BHeader</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.OCert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ocertKESPeriod</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ocertVkHot</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.OCert</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Slotting.Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unSlotNo</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html"><span class="hs-identifier">Data.Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#isRight"><span class="hs-identifier">isRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier">Word32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Numeric.Natural.html"><span class="hs-identifier">Numeric.Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-bignum-1.3/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Signed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Signed</span></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                     </span><span class="annot"><span class="hs-identifier">SignedHeader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">headerSigned</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.TPraos</span></span><span>
</span><span id="line-25"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaxMajorProtVer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaxMajorProtVer</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TPraos</span></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                     </span><span class="annot"><span class="hs-identifier">TPraosCannotForge</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TPraosFields</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TPraosToSign</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                     </span><span class="annot"><span class="hs-identifier">forgeTPraosFields</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tpraosMaxMajorPV</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tpraosParams</span></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                     </span><span class="annot"><span class="hs-identifier">tpraosSlotsPerKESPeriod</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Protocol.Abstract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtoCrypto"><span class="hs-identifier">ProtoCrypto</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsEnvelope"><span class="hs-identifier">ProtocolHeaderSupportsEnvelope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsKES"><span class="hs-identifier">ProtocolHeaderSupportsKES</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsLedger"><span class="hs-identifier">ProtocolHeaderSupportsLedger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsProtocol"><span class="hs-identifier">ProtocolHeaderSupportsProtocol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ShelleyHash"><span class="hs-identifier">ShelleyHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ShelleyProtocol"><span class="hs-identifier">ShelleyProtocol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ShelleyProtocolHeader"><span class="hs-identifier">ShelleyProtocolHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#protocolHeaderView"><span class="hs-identifier">protocolHeaderView</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ProtoCrypto"><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtoCrypto"><span class="hs-identifier hs-var">ProtoCrypto</span></a></span></span><span> </span><span id="local-6989586621680278060"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680278060"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680278060"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ShelleyProtocolHeader"><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ShelleyProtocolHeader"><span class="hs-identifier hs-var">ShelleyProtocolHeader</span></a></span></span><span> </span><span id="local-6989586621680278061"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680278061"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.BHeader</span></span><span> </span><span class="annot"><a href="#local-6989586621680278061"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680277916"><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680277916"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsEnvelope"><span class="hs-identifier hs-type">ProtocolHeaderSupportsEnvelope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680277916"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621680278088"><span class="annot"><span class="annottext">pHeaderHash :: ShelleyProtocolHeader (TPraos c)
-&gt; ShelleyHash (ProtoCrypto (TPraos c))
</span><a href="#local-6989586621680278088"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash c EraIndependentBlockHeader -&gt; ShelleyHash c
forall crypto.
Hash crypto EraIndependentBlockHeader -&gt; ShelleyHash crypto
</span><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ShelleyHash"><span class="hs-identifier hs-var">ShelleyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Hash c EraIndependentBlockHeader -&gt; ShelleyHash c)
-&gt; (BHeader c -&gt; Hash c EraIndependentBlockHeader)
-&gt; BHeader c
-&gt; ShelleyHash c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HashHeader c -&gt; Hash c EraIndependentBlockHeader
forall c. HashHeader c -&gt; Hash c EraIndependentBlockHeader
</span><span class="hs-identifier hs-var">SL.unHashHeader</span></span><span> </span><span class="annot"><span class="annottext">(HashHeader c -&gt; Hash c EraIndependentBlockHeader)
-&gt; (BHeader c -&gt; HashHeader c)
-&gt; BHeader c
-&gt; Hash c EraIndependentBlockHeader
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; HashHeader c
forall c. Crypto c =&gt; BHeader c -&gt; HashHeader c
</span><span class="hs-identifier hs-var">SL.bhHash</span></span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621680278095"><span class="annot"><span class="annottext">pHeaderPrevHash :: ShelleyProtocolHeader (TPraos c)
-&gt; PrevHash (ProtoCrypto (TPraos c))
</span><a href="#local-6989586621680278095"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderPrevHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; PrevHash c
forall c. BHBody c -&gt; PrevHash c
</span><span class="hs-identifier hs-var">SL.bheaderPrev</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; PrevHash c)
-&gt; (BHeader c -&gt; BHBody c) -&gt; BHeader c -&gt; PrevHash c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621680278100"><span class="annot"><span class="annottext">pHeaderBodyHash :: ShelleyProtocolHeader (TPraos c)
-&gt; Hash (ProtoCrypto (TPraos c)) EraIndependentBlockBody
</span><a href="#local-6989586621680278100"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderBodyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; Hash c EraIndependentBlockBody
forall c. BHBody c -&gt; Hash c EraIndependentBlockBody
</span><span class="hs-identifier hs-var">SL.bhash</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; Hash c EraIndependentBlockBody)
-&gt; (BHeader c -&gt; BHBody c)
-&gt; BHeader c
-&gt; Hash c EraIndependentBlockBody
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621680278104"><span class="annot"><span class="annottext">pHeaderSlot :: ShelleyProtocolHeader (TPraos c) -&gt; SlotNo
</span><a href="#local-6989586621680278104"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; SlotNo
forall c. BHBody c -&gt; SlotNo
</span><span class="hs-identifier hs-var">SL.bheaderSlotNo</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; SlotNo)
-&gt; (BHeader c -&gt; BHBody c) -&gt; BHeader c -&gt; SlotNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621680278108"><span class="annot"><span class="annottext">pHeaderBlock :: ShelleyProtocolHeader (TPraos c) -&gt; BlockNo
</span><a href="#local-6989586621680278108"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; BlockNo
forall c. BHBody c -&gt; BlockNo
</span><span class="hs-identifier hs-var">SL.bheaderBlockNo</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; BlockNo)
-&gt; (BHeader c -&gt; BHBody c) -&gt; BHeader c -&gt; BlockNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621680278115"><span class="annot"><span class="annottext">pHeaderSize :: ShelleyProtocolHeader (TPraos c) -&gt; Natural
</span><a href="#local-6989586621680278115"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; (BHeader c -&gt; Int) -&gt; BHeader c -&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; Int
forall c. BHeader c -&gt; Int
</span><span class="hs-identifier hs-var">SL.bHeaderSize</span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621680278122"><span class="annot"><span class="annottext">pHeaderBlockSize :: ShelleyProtocolHeader (TPraos c) -&gt; Natural
</span><a href="#local-6989586621680278122"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderBlockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-bignum-1.3/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Natural)
-&gt; (BHeader c -&gt; Word32) -&gt; BHeader c -&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; Word32
forall c. BHBody c -&gt; Word32
</span><span class="hs-identifier hs-var">SL.bsize</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; Word32)
-&gt; (BHeader c -&gt; BHBody c) -&gt; BHeader c -&gt; Word32
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="EnvelopeCheckError"><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#EnvelopeCheckError"><span class="hs-identifier hs-var">EnvelopeCheckError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainPredicateFailure</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621680278132"><span class="annot"><span class="annottext">envelopeChecks :: ConsensusConfig (TPraos c)
-&gt; LedgerView (TPraos c)
-&gt; ShelleyProtocolHeader (TPraos c)
-&gt; Except (EnvelopeCheckError (TPraos c)) ()
</span><a href="#local-6989586621680278132"><span class="hs-identifier hs-var hs-var hs-var hs-var">envelopeChecks</span></a></span></span><span> </span><span id="local-6989586621680278134"><span class="annot"><span class="annottext">ConsensusConfig (TPraos c)
</span><a href="#local-6989586621680278134"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680278135"><span class="annot"><span class="annottext">LedgerView (TPraos c)
</span><a href="#local-6989586621680278135"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680278136"><span class="annot"><span class="annottext">ShelleyProtocolHeader (TPraos c)
</span><a href="#local-6989586621680278136"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="annottext">Version
-&gt; ChainChecksPParams
-&gt; BHeaderView c
-&gt; ExceptT ChainPredicateFailure Identity ()
forall c (m :: * -&gt; *).
MonadError ChainPredicateFailure m =&gt;
Version -&gt; ChainChecksPParams -&gt; BHeaderView c -&gt; m ()
</span><span class="hs-identifier hs-var">SL.chainChecks</span></span><span>
</span><span id="line-53"></span><span>      </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621680278138"><span class="hs-identifier hs-var">maxPV</span></a></span><span>
</span><span id="line-54"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerView c -&gt; ChainChecksPParams
forall c. LedgerView c -&gt; ChainChecksPParams
</span><span class="hs-identifier hs-var">SL.lvChainChecks</span></span><span> </span><span class="annot"><span class="annottext">LedgerView (TPraos c)
LedgerView c
</span><a href="#local-6989586621680278135"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BHeader c -&gt; BHeaderView c
forall c. Crypto c =&gt; BHeader c -&gt; BHeaderView c
</span><span class="hs-identifier hs-var">SL.makeHeaderView</span></span><span> </span><span class="annot"><span class="annottext">(BHeader c -&gt; BHeaderView c) -&gt; BHeader c -&gt; BHeaderView c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall proto.
ProtocolHeaderSupportsProtocol proto =&gt;
ShelleyProtocolHeader proto -&gt; ValidateView proto
</span><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#protocolHeaderView"><span class="hs-identifier hs-var">protocolHeaderView</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680277916"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShelleyProtocolHeader (TPraos c)
</span><a href="#local-6989586621680278136"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">MaxMajorProtVer</span></span><span> </span><span id="local-6989586621680278138"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621680278138"><span class="hs-identifier hs-var">maxPV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPraosParams -&gt; MaxMajorProtVer
</span><span class="hs-identifier hs-var">tpraosMaxMajorPV</span></span><span> </span><span class="annot"><span class="annottext">(TPraosParams -&gt; MaxMajorProtVer)
-&gt; TPraosParams -&gt; MaxMajorProtVer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (TPraos c) -&gt; TPraosParams
forall c. ConsensusConfig (TPraos c) -&gt; TPraosParams
</span><span class="hs-identifier hs-var">tpraosParams</span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (TPraos c)
</span><a href="#local-6989586621680278134"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680277968"><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680277968"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsKES"><span class="hs-identifier hs-type">ProtocolHeaderSupportsKES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680277968"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>  </span><span id="local-6989586621680278155"><span class="annot"><span class="annottext">configSlotsPerKESPeriod :: ConsensusConfig (TPraos c) -&gt; Word64
</span><a href="#local-6989586621680278155"><span class="hs-identifier hs-var hs-var hs-var hs-var">configSlotsPerKESPeriod</span></a></span></span><span> </span><span id="local-6989586621680278157"><span class="annot"><span class="annottext">ConsensusConfig (TPraos c)
</span><a href="#local-6989586621680278157"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPraosParams -&gt; Word64
</span><span class="hs-identifier hs-var">tpraosSlotsPerKESPeriod</span></span><span> </span><span class="annot"><span class="annottext">(TPraosParams -&gt; Word64) -&gt; TPraosParams -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (TPraos c) -&gt; TPraosParams
forall c. ConsensusConfig (TPraos c) -&gt; TPraosParams
</span><span class="hs-identifier hs-var">tpraosParams</span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (TPraos c)
</span><a href="#local-6989586621680278157"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621680278171"><span class="annot"><span class="annottext">verifyHeaderIntegrity :: Word64 -&gt; ShelleyProtocolHeader (TPraos c) -&gt; Bool
</span><a href="#local-6989586621680278171"><span class="hs-identifier hs-var hs-var hs-var hs-var">verifyHeaderIntegrity</span></a></span></span><span> </span><span id="local-6989586621680278173"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680278173"><span class="hs-identifier hs-var">slotsPerKESPeriod</span></a></span></span><span> </span><span id="local-6989586621680278174"><span class="annot"><span class="annottext">ShelleyProtocolHeader (TPraos c)
</span><a href="#local-6989586621680278174"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Either String () -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#isRight"><span class="hs-identifier hs-var">isRight</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String () -&gt; Bool) -&gt; Either String () -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContextKES (KES c)
-&gt; VerKeyKES (KES c)
-&gt; Word
-&gt; BHBody c
-&gt; SignedKES (KES c) (BHBody c)
-&gt; Either String ()
forall v a.
(KESAlgorithm v, Signable v a) =&gt;
ContextKES v
-&gt; VerKeyKES v -&gt; Word -&gt; a -&gt; SignedKES v a -&gt; Either String ()
</span><span class="hs-identifier hs-var">SL.verifySignedKES</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerKeyKES (KES c)
</span><a href="#local-6989586621680278176"><span class="hs-identifier hs-var">ocertVkHot</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680278177"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BHBody c
</span><a href="#local-6989586621680278178"><span class="hs-identifier hs-var">hdrBody</span></a></span><span> </span><span class="annot"><span class="annottext">SignedKES (KES c) (BHBody c)
</span><a href="#local-6989586621680278179"><span class="hs-identifier hs-var">hdrSignature</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">SL.BHeader</span></span><span> </span><span id="local-6989586621680278178"><span class="annot"><span class="annottext">BHBody c
</span><a href="#local-6989586621680278178"><span class="hs-identifier hs-var">hdrBody</span></a></span></span><span> </span><span id="local-6989586621680278179"><span class="annot"><span class="annottext">SignedKES (KES c) (BHBody c)
</span><a href="#local-6989586621680278179"><span class="hs-identifier hs-var">hdrSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyProtocolHeader (TPraos c)
</span><a href="#local-6989586621680278174"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">SL.OCert</span></span><span>
</span><span id="line-66"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680278176"><span class="annot"><span class="annottext">VerKeyKES (KES c)
ocertVkHot :: forall c. OCert c -&gt; VerKeyKES c
ocertVkHot :: VerKeyKES (KES c)
</span><span class="hs-identifier hs-var hs-var">ocertVkHot</span></span></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>          </span><span class="annot"><span class="annottext">ocertKESPeriod :: forall c. OCert c -&gt; KESPeriod
</span><span class="hs-identifier hs-var">ocertKESPeriod</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.KESPeriod</span></span><span> </span><span id="local-6989586621680278183"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680278183"><span class="hs-identifier hs-var">startOfKesPeriod</span></a></span></span><span>
</span><span id="line-68"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; OCert c
forall c. BHBody c -&gt; OCert c
</span><span class="hs-identifier hs-var">SL.bheaderOCert</span></span><span> </span><span class="annot"><span class="annottext">BHBody c
</span><a href="#local-6989586621680278178"><span class="hs-identifier hs-var">hdrBody</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>      </span><span id="local-6989586621680278185"><span class="annot"><span class="annottext">currentKesPeriod :: Word
</span><a href="#local-6989586621680278185"><span class="hs-identifier hs-var hs-var">currentKesPeriod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">Word64 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Word) -&gt; Word64 -&gt; Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-72"></span><span>          </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><span class="hs-identifier hs-var">unSlotNo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BHBody c -&gt; SlotNo
forall c. BHBody c -&gt; SlotNo
</span><span class="hs-identifier hs-var">SL.bheaderSlotNo</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; SlotNo) -&gt; BHBody c -&gt; SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span> </span><span class="annot"><span class="annottext">BHeader c
ShelleyProtocolHeader (TPraos c)
</span><a href="#local-6989586621680278174"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680278173"><span class="hs-identifier hs-var">slotsPerKESPeriod</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>      </span><span id="local-6989586621680278177"><span class="annot"><span class="annottext">t :: Word
</span><a href="#local-6989586621680278177"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680278185"><span class="hs-identifier hs-var">currentKesPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680278183"><span class="hs-identifier hs-var">startOfKesPeriod</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>          </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680278185"><span class="hs-identifier hs-var">currentKesPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680278183"><span class="hs-identifier hs-var">startOfKesPeriod</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>          </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621680278204"><span class="annot"><span class="annottext">mkHeader :: forall crypto (m :: * -&gt; *).
(Crypto crypto, Monad m, crypto ~ ProtoCrypto (TPraos c)) =&gt;
HotKey crypto m
-&gt; CanBeLeader (TPraos c)
-&gt; IsLeader (TPraos c)
-&gt; SlotNo
-&gt; BlockNo
-&gt; PrevHash crypto
-&gt; Hash crypto EraIndependentBlockBody
-&gt; Int
-&gt; ProtVer
-&gt; m (ShelleyProtocolHeader (TPraos c))
</span><a href="#local-6989586621680278204"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkHeader</span></a></span></span><span> </span><span id="local-6989586621680278206"><span class="annot"><span class="annottext">HotKey crypto m
</span><a href="#local-6989586621680278206"><span class="hs-identifier hs-var">hotKey</span></a></span></span><span> </span><span id="local-6989586621680278207"><span class="annot"><span class="annottext">CanBeLeader (TPraos c)
</span><a href="#local-6989586621680278207"><span class="hs-identifier hs-var">canBeLeader</span></a></span></span><span> </span><span id="local-6989586621680278208"><span class="annot"><span class="annottext">IsLeader (TPraos c)
</span><a href="#local-6989586621680278208"><span class="hs-identifier hs-var">isLeader</span></a></span></span><span> </span><span id="local-6989586621680278209"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680278209"><span class="hs-identifier hs-var">curSlot</span></a></span></span><span> </span><span id="local-6989586621680278210"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621680278210"><span class="hs-identifier hs-var">curNo</span></a></span></span><span> </span><span id="local-6989586621680278211"><span class="annot"><span class="annottext">PrevHash crypto
</span><a href="#local-6989586621680278211"><span class="hs-identifier hs-var">prevHash</span></a></span></span><span> </span><span id="local-6989586621680278212"><span class="annot"><span class="annottext">Hash crypto EraIndependentBlockBody
</span><a href="#local-6989586621680278212"><span class="hs-identifier hs-var">bbHash</span></a></span></span><span> </span><span id="local-6989586621680278213"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680278213"><span class="hs-identifier hs-var">actualBodySize</span></a></span></span><span> </span><span id="local-6989586621680278214"><span class="annot"><span class="annottext">ProtVer
</span><a href="#local-6989586621680278214"><span class="hs-identifier hs-var">protVer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TPraosFields</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680278216"><span class="annot"><span class="annottext">SignedKES crypto (BHBody crypto)
tpraosSignature :: SignedKES crypto (BHBody crypto)
tpraosSignature :: forall c toSign. TPraosFields c toSign -&gt; SignedKES c toSign
</span><a href="#local-6989586621680278216"><span class="hs-identifier hs-var hs-var">tpraosSignature</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680278218"><span class="annot"><span class="annottext">BHBody crypto
tpraosToSign :: BHBody crypto
tpraosToSign :: forall c toSign. TPraosFields c toSign -&gt; toSign
</span><a href="#local-6989586621680278218"><span class="hs-identifier hs-var hs-var">tpraosToSign</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><span class="annottext">HotKey crypto m
-&gt; CanBeLeader (TPraos crypto)
-&gt; IsLeader (TPraos crypto)
-&gt; (TPraosToSign crypto -&gt; BHBody crypto)
-&gt; m (TPraosFields crypto (BHBody crypto))
forall c toSign (m :: * -&gt; *).
(PraosCrypto c, KESignable c toSign, Monad m) =&gt;
HotKey c m
-&gt; CanBeLeader (TPraos c)
-&gt; IsLeader (TPraos c)
-&gt; (TPraosToSign c -&gt; toSign)
-&gt; m (TPraosFields c toSign)
</span><span class="hs-identifier hs-var">forgeTPraosFields</span></span><span> </span><span class="annot"><span class="annottext">HotKey crypto m
</span><a href="#local-6989586621680278206"><span class="hs-identifier hs-var">hotKey</span></a></span><span> </span><span class="annot"><span class="annottext">CanBeLeader (TPraos c)
CanBeLeader (TPraos crypto)
</span><a href="#local-6989586621680278207"><span class="hs-identifier hs-var">canBeLeader</span></a></span><span> </span><span class="annot"><span class="annottext">IsLeader (TPraos c)
IsLeader (TPraos crypto)
</span><a href="#local-6989586621680278208"><span class="hs-identifier hs-var">isLeader</span></a></span><span> </span><span class="annot"><span class="annottext">TPraosToSign crypto -&gt; BHBody crypto
</span><a href="#local-6989586621680278220"><span class="hs-identifier hs-var">mkBhBody</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">BHeader crypto -&gt; m (BHeader crypto)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(BHeader crypto -&gt; m (BHeader crypto))
-&gt; BHeader crypto -&gt; m (BHeader crypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BHBody crypto -&gt; SignedKES crypto (BHBody crypto) -&gt; BHeader crypto
forall c.
Crypto c =&gt;
BHBody c -&gt; SignedKES c (BHBody c) -&gt; BHeader c
</span><span class="hs-identifier hs-var">SL.BHeader</span></span><span> </span><span class="annot"><span class="annottext">BHBody crypto
</span><a href="#local-6989586621680278218"><span class="hs-identifier hs-var">tpraosToSign</span></a></span><span> </span><span class="annot"><span class="annottext">SignedKES crypto (BHBody crypto)
</span><a href="#local-6989586621680278216"><span class="hs-identifier hs-var">tpraosSignature</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>      </span><span id="local-6989586621680278220"><span class="annot"><span class="annottext">mkBhBody :: TPraosToSign crypto -&gt; BHBody crypto
</span><a href="#local-6989586621680278220"><span class="hs-identifier hs-var hs-var">mkBhBody</span></a></span></span><span> </span><span id="local-6989586621680278221"><span class="annot"><span class="annottext">TPraosToSign crypto
</span><a href="#local-6989586621680278221"><span class="hs-identifier hs-var">toSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">SL.BHBody</span></span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bheaderPrev :: PrevHash crypto
</span><span class="hs-identifier hs-var">SL.bheaderPrev</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrevHash crypto
</span><a href="#local-6989586621680278211"><span class="hs-identifier hs-var">prevHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><span class="annottext">bheaderVk :: VKey 'BlockIssuer crypto
</span><span class="hs-identifier hs-var">SL.bheaderVk</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VKey 'BlockIssuer crypto
</span><a href="#local-6989586621680278224"><span class="hs-identifier hs-var">tpraosToSignIssuerVK</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>            </span><span class="annot"><span class="annottext">bheaderVrfVk :: VerKeyVRF crypto
</span><a href="#local-6989586621680278225"><span class="hs-identifier hs-var">SL.bheaderVrfVk</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerKeyVRF crypto
</span><a href="#local-6989586621680278226"><span class="hs-identifier hs-var">tpraosToSignVrfVK</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>            </span><span class="annot"><span class="annottext">bheaderSlotNo :: SlotNo
</span><span class="hs-identifier hs-var">SL.bheaderSlotNo</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680278209"><span class="hs-identifier hs-var">curSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>            </span><span class="annot"><span class="annottext">bheaderBlockNo :: BlockNo
</span><span class="hs-identifier hs-var">SL.bheaderBlockNo</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621680278210"><span class="hs-identifier hs-var">curNo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>            </span><span class="annot"><span class="annottext">bheaderEta :: CertifiedVRF crypto Nonce
</span><a href="#local-6989586621680278227"><span class="hs-identifier hs-var">SL.bheaderEta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF crypto Nonce
</span><a href="#local-6989586621680278228"><span class="hs-identifier hs-var">tpraosToSignEta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>            </span><span class="annot"><span class="annottext">bheaderL :: CertifiedVRF crypto Natural
</span><span class="hs-identifier hs-var">SL.bheaderL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF crypto Natural
</span><a href="#local-6989586621680278230"><span class="hs-identifier hs-var">tpraosToSignLeader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>            </span><span class="annot"><span class="annottext">bsize :: Word32
</span><span class="hs-identifier hs-var">SL.bsize</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680278213"><span class="hs-identifier hs-var">actualBodySize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>            </span><span class="annot"><span class="annottext">bhash :: Hash crypto EraIndependentBlockBody
</span><span class="hs-identifier hs-var">SL.bhash</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash crypto EraIndependentBlockBody
</span><a href="#local-6989586621680278212"><span class="hs-identifier hs-var">bbHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>            </span><span class="annot"><span class="annottext">bheaderOCert :: OCert crypto
</span><span class="hs-identifier hs-var">SL.bheaderOCert</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OCert crypto
</span><a href="#local-6989586621680278231"><span class="hs-identifier hs-var">tpraosToSignOCert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>            </span><span class="annot"><span class="annottext">bprotver :: ProtVer
</span><a href="#local-6989586621680278232"><span class="hs-identifier hs-var">SL.bprotver</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtVer
</span><a href="#local-6989586621680278214"><span class="hs-identifier hs-var">protVer</span></a></span><span>
</span><span id="line-97"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">TPraosToSign</span></span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680278224"><span class="annot"><span class="annottext">VKey 'BlockIssuer crypto
tpraosToSignIssuerVK :: VKey 'BlockIssuer crypto
tpraosToSignIssuerVK :: forall c. TPraosToSign c -&gt; VKey 'BlockIssuer c
</span><a href="#local-6989586621680278224"><span class="hs-identifier hs-var hs-var">tpraosToSignIssuerVK</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>              </span><span id="local-6989586621680278226"><span class="annot"><span class="annottext">VerKeyVRF crypto
tpraosToSignVrfVK :: VerKeyVRF crypto
tpraosToSignVrfVK :: forall c. TPraosToSign c -&gt; VerKeyVRF c
</span><a href="#local-6989586621680278226"><span class="hs-identifier hs-var hs-var">tpraosToSignVrfVK</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>              </span><span id="local-6989586621680278228"><span class="annot"><span class="annottext">CertifiedVRF crypto Nonce
tpraosToSignEta :: CertifiedVRF crypto Nonce
tpraosToSignEta :: forall c. TPraosToSign c -&gt; CertifiedVRF c Nonce
</span><a href="#local-6989586621680278228"><span class="hs-identifier hs-var hs-var">tpraosToSignEta</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>              </span><span id="local-6989586621680278230"><span class="annot"><span class="annottext">CertifiedVRF crypto Natural
tpraosToSignLeader :: CertifiedVRF crypto Natural
tpraosToSignLeader :: forall c. TPraosToSign c -&gt; CertifiedVRF c Natural
</span><a href="#local-6989586621680278230"><span class="hs-identifier hs-var hs-var">tpraosToSignLeader</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>              </span><span id="local-6989586621680278231"><span class="annot"><span class="annottext">OCert crypto
tpraosToSignOCert :: OCert crypto
tpraosToSignOCert :: forall c. TPraosToSign c -&gt; OCert c
</span><a href="#local-6989586621680278231"><span class="hs-identifier hs-var hs-var">tpraosToSignOCert</span></a></span></span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPraosToSign crypto
</span><a href="#local-6989586621680278221"><span class="hs-identifier hs-var">toSign</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680277942"><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680277942"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsProtocol"><span class="hs-identifier hs-type">ProtocolHeaderSupportsProtocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680277942"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="CannotForgeError"><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#CannotForgeError"><span class="hs-identifier hs-var">CannotForgeError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680277942"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TPraosCannotForge</span></span><span> </span><span class="annot"><a href="#local-6989586621680277942"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621680278247"><span class="annot"><span class="annottext">protocolHeaderView :: ShelleyProtocolHeader (TPraos c) -&gt; ValidateView (TPraos c)
</span><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#protocolHeaderView"><span class="hs-identifier hs-var hs-var hs-var hs-var">protocolHeaderView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHeader c
ShelleyProtocolHeader (TPraos c) -&gt; ValidateView (TPraos c)
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621680278250"><span class="annot"><span class="annottext">pHeaderIssuer :: ShelleyProtocolHeader (TPraos c)
-&gt; VKey 'BlockIssuer (ProtoCrypto (TPraos c))
</span><a href="#local-6989586621680278250"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderIssuer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; VKey 'BlockIssuer c
forall c. BHBody c -&gt; VKey 'BlockIssuer c
</span><span class="hs-identifier hs-var">SL.bheaderVk</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; VKey 'BlockIssuer c)
-&gt; (BHeader c -&gt; BHBody c) -&gt; BHeader c -&gt; VKey 'BlockIssuer c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621680278253"><span class="annot"><span class="annottext">pHeaderIssueNo :: ShelleyProtocolHeader (TPraos c) -&gt; Word64
</span><a href="#local-6989586621680278253"><span class="hs-identifier hs-var hs-var hs-var hs-var">pHeaderIssueNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OCert c -&gt; Word64
forall c. OCert c -&gt; Word64
</span><span class="hs-identifier hs-var">SL.ocertN</span></span><span> </span><span class="annot"><span class="annottext">(OCert c -&gt; Word64)
-&gt; (BHeader c -&gt; OCert c) -&gt; BHeader c -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; OCert c
forall c. BHBody c -&gt; OCert c
</span><span class="hs-identifier hs-var">SL.bheaderOCert</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; OCert c)
-&gt; (BHeader c -&gt; BHBody c) -&gt; BHeader c -&gt; OCert c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">-- As this is the leader VRF value, which is used for slot election in the</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- first place, it gives an advantage to smaller pools in a multi-leader slot.</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- This was not an intentional decision, see</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">-- https://github.com/IntersectMBO/ouroboros-network/issues/4051 for a more</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- detailed discussion.</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621680278257"><span class="annot"><span class="annottext">pTieBreakVRFValue :: ShelleyProtocolHeader (TPraos c)
-&gt; OutputVRF (VRF (ProtoCrypto (TPraos c)))
</span><a href="#local-6989586621680278257"><span class="hs-identifier hs-var hs-var hs-var hs-var">pTieBreakVRFValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (VRF c) Natural -&gt; OutputVRF (VRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><span class="hs-identifier hs-var">certifiedOutput</span></span><span> </span><span class="annot"><span class="annottext">(CertifiedVRF (VRF c) Natural -&gt; OutputVRF (VRF c))
-&gt; (BHeader c -&gt; CertifiedVRF (VRF c) Natural)
-&gt; BHeader c
-&gt; OutputVRF (VRF c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHBody c -&gt; CertifiedVRF (VRF c) Natural
forall c. BHBody c -&gt; CertifiedVRF c Natural
</span><span class="hs-identifier hs-var">SL.bheaderL</span></span><span> </span><span class="annot"><span class="annottext">(BHBody c -&gt; CertifiedVRF (VRF c) Natural)
-&gt; (BHeader c -&gt; BHBody c)
-&gt; BHeader c
-&gt; CertifiedVRF (VRF c) Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680278032"><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680278032"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ProtocolHeaderSupportsLedger"><span class="hs-identifier hs-type">ProtocolHeaderSupportsLedger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680278032"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621680278265"><span class="annot"><span class="annottext">mkHeaderView :: ShelleyProtocolHeader (TPraos c)
-&gt; BHeaderView (ProtoCrypto (TPraos c))
</span><a href="#local-6989586621680278265"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkHeaderView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; BHeaderView c
ShelleyProtocolHeader (TPraos c)
-&gt; BHeaderView (ProtoCrypto (TPraos c))
forall c. Crypto c =&gt; BHeader c -&gt; BHeaderView c
</span><span class="hs-identifier hs-var">SL.makeHeaderView</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Signed"><span class="annot"><span class="hs-identifier hs-var">Signed</span></span></span><span> </span><span id="local-6989586621680278267"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SL.BHeader</span></span><span> </span><span class="annot"><a href="#local-6989586621680278267"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.BHBody</span></span><span> </span><span class="annot"><a href="#local-6989586621680278267"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680278037"><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680278037"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignedHeader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SL.BHeader</span></span><span> </span><span class="annot"><a href="#local-6989586621680278037"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621680278274"><span class="annot"><span class="annottext">headerSigned :: BHeader c -&gt; Signed (BHeader c)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">headerSigned</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BHeader c -&gt; Signed (BHeader c)
BHeader c -&gt; BHBody c
forall c. Crypto c =&gt; BHeader c -&gt; BHBody c
</span><span class="hs-identifier hs-var">SL.bhbody</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680278046"><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680278046"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Abstract.html#ShelleyProtocol"><span class="hs-identifier hs-type">ShelleyProtocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680278046"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-130"></span></pre></body></html>