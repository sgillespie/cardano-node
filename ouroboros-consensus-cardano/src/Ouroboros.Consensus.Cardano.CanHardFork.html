<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards       #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Cardano.CanHardFork</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier">ByronPartialLedgerConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#CardanoHardForkConstraints"><span class="hs-identifier">CardanoHardForkConstraints</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TriggerHardFork</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports of Shelley code</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#ShelleyPartialLedgerConfig"><span class="hs-identifier">ShelleyPartialLedgerConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#forecastAcrossShelley"><span class="hs-identifier">forecastAcrossShelley</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#translateChainDepStateAcrossShelley"><span class="hs-identifier">translateChainDepStateAcrossShelley</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Common</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CC</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Genesis</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CC.Genesis</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Update</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CC.Update</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.DSIGN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ed25519DSIGN</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.Hash.Blake2b</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Blake2b_224</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Blake2b_256</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Core</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Crypto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ADDRHASH</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Crypto</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DSIGN</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HASH</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Era</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Hashes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EraIndependentTxBody</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DSignable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Hash</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.API</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.Translation</span></span><span>
</span><span id="line-41"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toFromByronTranslationContext</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.API</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.Rules.Prtcl</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Protocol.TPraos.Rules.Tickn</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Slotting.EpochInfo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">epochInfoFirst</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier">runExcept</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#throwError"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.State.Transition</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STS</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Coerce.html"><span class="hs-identifier">Data.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#coerce"><span class="hs-identifier">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Function.html"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Function.html#%26"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.Identity.html"><span class="hs-identifier">Data.Functor.Identity</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier">listToMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.BasicFunctors</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.InPairs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RequiringBoth</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ignoringBoth</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hpure</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.Tails</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tails</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.SOP.Tails</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tails</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Void.html"><span class="hs-identifier">Data.Void</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Lens.Micro.Extras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Block</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.html"><span class="hs-identifier">Ouroboros.Consensus.Byron.Ledger</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html"><span class="hs-identifier">Ouroboros.Consensus.Byron.Ledger.Inspect</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Byron.Inspect</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Node.html"><span class="hs-identifier">Ouroboros.Consensus.Byron.Node</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Cardano.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Forecast</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.State.Types</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.History</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bound</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">boundSlot</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>                     </span><span class="annot"><span class="hs-identifier">addSlots</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Simple</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Abstract</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Ledger.SupportsProtocol</span></span><span>
</span><span id="line-79"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LedgerSupportsProtocol</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Abstract</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PBft</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PBftCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PBftState</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT.State</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PBftState</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Praos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Praos</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Praos</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Praos</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.TPraos</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.TPraos</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TPraos</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Translate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TranslateProto</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Ledger</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Node.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Node</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Protocol.Praos.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Protocol.Praos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html"><span class="hs-identifier">Ouroboros.Consensus.Shelley.ShelleyHFC</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.TypeFamilyWrappers</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Util</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">eitherToMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Util.RedundantConstraints</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Figure out the transition point for Byron

  The Byron ledger defines the update 'State' in
  &quot;Cardano.Chain.Update.Validation.Interface&quot;. The critical piece of state we
  need is

  &gt; candidateProtocolUpdates :: ![CandidateProtocolUpdate]

  which are the update proposals that have been voted on, accepted, and
  endorsed, and now need to become stable. In `tryBumpVersion`
  (&quot;Cardano.Chain.Update.Validation.Interface.ProtocolVersionBump&quot;) we
  find the candidates that are at least 'kUpdateStabilityParam' (@== 4k@) deep,
  and then construct

  &gt; State
  &gt; { nextProtocolVersion    = cpuProtocolVersion
  &gt; , nextProtocolParameters = cpuProtocolParameters
  &gt; }

  (with 'State' from &quot;Cardano.Chain.Update.Validation.Interface.ProtocolVersionBump&quot;)
  where 'cpuProtocolVersion'/'cpuProtocolParameters' are the version and
  parameters from the update. This then ends up in the following callstack

  &gt; applyChainTick
  &gt; |
  &gt; \-- epochTransition
  &gt;     |
  &gt;     \-- registerEpoch
  &gt;         |
  &gt;         \-- tryBumpVersion

  Now, if this is changing the major version of the protocol, then this actually
  indicates the transition to Shelley, and the Byron 'applyChainTick' won't
  actually happen. Instead, in 'singleEraTransition' we will report the
  'EpochNo' of the transition as soon as it's @2k@ (not @4k@!) deep: in other
  words, as soon as it is stable; at this point, the HFC will do the rest.

  A slightly subtle point is that the Byron ledger does not record any
  information about /past/ updates to the protocol parameters, and so if we
  /were/ to ask the Byron ledger /after/ the update when the transition is
  going to take place (did take place), it will say 'Nothing': transition not
  yet known. In practice this won't matter, as it will have been translated to
  a Shelley ledger at that point.
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTransition"><span class="hs-identifier hs-type">byronTransition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PartialLedgerConfig</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-144"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Shelley major protocol version</span></span><span>
</span><span id="line-145"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-146"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span>
</span><span id="line-147"></span><span id="byronTransition"><span class="annot"><span class="annottext">byronTransition :: PartialLedgerConfig ByronBlock
-&gt; Word16 -&gt; LedgerState ByronBlock -&gt; Maybe EpochNo
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTransition"><span class="hs-identifier hs-var hs-var">byronTransition</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-type">ByronPartialLedgerConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621680281901"><span id="local-6989586621680281902"><span class="annot"><span class="annottext">LedgerConfig ByronBlock
TriggerHardFork
byronLedgerConfig :: LedgerConfig ByronBlock
byronTriggerHardFork :: TriggerHardFork
byronLedgerConfig :: ByronPartialLedgerConfig -&gt; LedgerConfig ByronBlock
byronTriggerHardFork :: ByronPartialLedgerConfig -&gt; TriggerHardFork
</span><a href="#local-6989586621680281901"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680281905"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680281905"><span class="hs-identifier hs-var">shelleyMajorVersion</span></a></span></span><span> </span><span id="local-6989586621680281906"><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680281906"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="annottext">[EpochNo] -&gt; Maybe EpochNo
forall a. [a] -&gt; Maybe a
</span><a href="#local-6989586621680281907"><span class="hs-identifier hs-var">takeAny</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">([EpochNo] -&gt; Maybe EpochNo)
-&gt; (LedgerState ByronBlock -&gt; [EpochNo])
-&gt; LedgerState ByronBlock
-&gt; Maybe EpochNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ProtocolUpdate -&gt; Maybe EpochNo) -&gt; [ProtocolUpdate] -&gt; [EpochNo]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolUpdate -&gt; Maybe EpochNo
</span><a href="#local-6989586621680281909"><span class="hs-identifier hs-var">isTransitionToShelley</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">([ProtocolUpdate] -&gt; [EpochNo])
-&gt; (LedgerState ByronBlock -&gt; [ProtocolUpdate])
-&gt; LedgerState ByronBlock
-&gt; [EpochNo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerConfig ByronBlock
-&gt; LedgerState ByronBlock -&gt; [ProtocolUpdate]
</span><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html#protocolUpdates"><span class="hs-identifier hs-var">Byron.Inspect.protocolUpdates</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerConfig ByronBlock
</span><a href="#local-6989586621680281901"><span class="hs-identifier hs-var">byronLedgerConfig</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">(LedgerState ByronBlock -&gt; Maybe EpochNo)
-&gt; LedgerState ByronBlock -&gt; Maybe EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680281906"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Ledger.html#ByronTransitionInfo"><span class="hs-identifier hs-type">ByronTransitionInfo</span></a></span><span> </span><span id="local-6989586621680281912"><span class="annot"><span class="annottext">Map ProtocolVersion BlockNo
</span><a href="#local-6989586621680281912"><span class="hs-identifier hs-var">transitionInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; ByronTransition
</span><a href="Ouroboros.Consensus.Byron.Ledger.Ledger.html#byronLedgerTransition"><span class="hs-identifier hs-var">byronLedgerTransition</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680281906"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621680281914"><span class="annot"><span class="annottext">genesis :: LedgerConfig ByronBlock
</span><a href="#local-6989586621680281914"><span class="hs-identifier hs-var hs-var">genesis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerConfig ByronBlock
</span><a href="#local-6989586621680281901"><span class="hs-identifier hs-var">byronLedgerConfig</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621680281915"><span class="annot"><span class="annottext">k :: BlockCount
</span><a href="#local-6989586621680281915"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenesisData -&gt; BlockCount
</span><span class="hs-identifier hs-var">CC.Genesis.gdK</span></span><span> </span><span class="annot"><span class="annottext">(GenesisData -&gt; BlockCount) -&gt; GenesisData -&gt; BlockCount
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; GenesisData
</span><span class="hs-identifier hs-var">CC.Genesis.configGenesisData</span></span><span> </span><span class="annot"><span class="annottext">Config
LedgerConfig ByronBlock
</span><a href="#local-6989586621680281914"><span class="hs-identifier hs-var">genesis</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="#local-6989586621680281909"><span class="hs-identifier hs-type">isTransitionToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html#ProtocolUpdate"><span class="hs-identifier hs-type">Byron.Inspect.ProtocolUpdate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621680281909"><span class="annot"><span class="annottext">isTransitionToShelley :: ProtocolUpdate -&gt; Maybe EpochNo
</span><a href="#local-6989586621680281909"><span class="hs-identifier hs-var hs-var">isTransitionToShelley</span></a></span></span><span> </span><span id="local-6989586621680281918"><span class="annot"><span class="annottext">ProtocolUpdate
</span><a href="#local-6989586621680281918"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion -&gt; Word16
</span><span class="hs-identifier hs-var">CC.Update.pvMajor</span></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621680281920"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680281905"><span class="hs-identifier hs-var">shelleyMajorVersion</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProtocolUpdate -&gt; UpdateState
</span><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html#protocolUpdateState"><span class="hs-identifier hs-var">Byron.Inspect.protocolUpdateState</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolUpdate
</span><a href="#local-6989586621680281918"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>          </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html#UpdateCandidate"><span class="hs-identifier hs-type">Byron.Inspect.UpdateCandidate</span></a></span><span> </span><span id="local-6989586621680281923"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680281923"><span class="hs-identifier hs-var">_becameCandidateSlotNo</span></a></span></span><span> </span><span id="local-6989586621680281924"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680281924"><span class="hs-identifier hs-var">adoptedIn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-163"></span><span>            </span><span id="local-6989586621680281925"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621680281925"><span class="hs-identifier hs-var">becameCandidateBlockNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProtocolVersion -&gt; Map ProtocolVersion BlockNo -&gt; Maybe BlockNo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621680281920"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">Map ProtocolVersion BlockNo
</span><a href="#local-6989586621680281912"><span class="hs-identifier hs-var">transitionInfo</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNo -&gt; Bool
</span><a href="#local-6989586621680281927"><span class="hs-identifier hs-var">isReallyStable</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621680281925"><span class="hs-identifier hs-var">becameCandidateBlockNo</span></a></span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="annottext">EpochNo -&gt; Maybe EpochNo
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680281924"><span class="hs-identifier hs-var">adoptedIn</span></a></span><span>
</span><span id="line-166"></span><span>          </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html#UpdateStableCandidate"><span class="hs-identifier hs-type">Byron.Inspect.UpdateStableCandidate</span></a></span><span> </span><span id="local-6989586621680281929"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680281929"><span class="hs-identifier hs-var">adoptedIn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>            </span><span class="hs-comment">-- If the Byron ledger thinks it's stable, it's _definitely_ stable</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="annottext">EpochNo -&gt; Maybe EpochNo
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680281929"><span class="hs-identifier hs-var">adoptedIn</span></a></span><span>
</span><span id="line-169"></span><span>          </span><span id="local-6989586621680281930"><span class="annot"><span class="annottext">UpdateState
</span><a href="#local-6989586621680281930"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>            </span><span class="hs-comment">-- The proposal isn't yet a candidate, never mind a stable one</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><span class="annottext">Maybe EpochNo
forall a. Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mzero"><span class="hs-identifier hs-var">mzero</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="#local-6989586621680281920"><span class="hs-identifier hs-type">version</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CC.Update.ProtocolVersion</span></span><span>
</span><span id="line-174"></span><span>        </span><span id="local-6989586621680281920"><span class="annot"><span class="annottext">version :: ProtocolVersion
</span><a href="#local-6989586621680281920"><span class="hs-identifier hs-var hs-var">version</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtocolUpdate -&gt; ProtocolVersion
</span><a href="Ouroboros.Consensus.Byron.Ledger.Inspect.html#protocolUpdateVersion"><span class="hs-identifier hs-var">Byron.Inspect.protocolUpdateVersion</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolUpdate
</span><a href="#local-6989586621680281918"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-comment">-- Normally, stability in the ledger is defined in terms of slots, not</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- blocks. Byron considers the proposal to be stable after the slot is more</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- than @2k@ old. That is not wrong: after @2k@, the block indeed is stable.</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- Unfortunately, this means that the /conclusion about stability itself/</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- is /not/ stable: if we were to switch to a denser fork, we might change</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- our mind (on the sparse chain we thought the block was already stable,</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">-- but on the dense chain we conclude it is it not yet stable).</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-comment">-- It is unclear at the moment if this presents a problem; the HFC assumes</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- monotonicity of timing info, in the sense that that any slot/time</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- conversions are either unknown or else not subject to rollback.</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- The problem sketched above might mean that we can go from &quot;conversion</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- known&quot; to &quot;conversion unknown&quot;, but then when we go back again to</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- &quot;conversion known&quot;, we /are/ guaranteed that we'd get the same answer.</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- Rather than trying to analyse this subtle problem, we instead base</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- stability on block numbers; after the block is `k` deep, we know for sure</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-comment">-- that it is stable, and moreover, no matter which chain we switch to, that</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- will remain to be the case.</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">-- The Byron 'UpdateState' records the 'SlotNo' of the block in which the</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- proposal became a candidate (i.e., when the last required endorsement</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- came in). That doesn't tell us very much, we need to know the block</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- number; that's precisely what the 'ByronTransition' part of the Byron</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- state tells us.</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="#local-6989586621680281927"><span class="hs-identifier hs-type">isReallyStable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BlockNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621680281927"><span class="annot"><span class="annottext">isReallyStable :: BlockNo -&gt; Bool
</span><a href="#local-6989586621680281927"><span class="hs-identifier hs-var hs-var">isReallyStable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockNo</span></span><span> </span><span id="local-6989586621680281934"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680281934"><span class="hs-identifier hs-var">bno</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680281935"><span class="hs-identifier hs-var">distance</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">BlockCount -&gt; Word64
</span><span class="hs-identifier hs-var">CC.unBlockCount</span></span><span> </span><span class="annot"><span class="annottext">BlockCount
</span><a href="#local-6989586621680281915"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><a href="#local-6989586621680281935"><span class="hs-identifier hs-type">distance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span id="local-6989586621680281935"><span class="annot"><span class="annottext">distance :: Word64
</span><a href="#local-6989586621680281935"><span class="hs-identifier hs-var hs-var">distance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; WithOrigin BlockNo
</span><a href="Ouroboros.Consensus.Byron.Ledger.Ledger.html#byronLedgerTipBlockNo"><span class="hs-identifier hs-var">byronLedgerTipBlockNo</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680281906"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>                     </span><span class="annot"><span class="annottext">WithOrigin BlockNo
</span><span class="hs-identifier hs-var">Origin</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680281934"><span class="hs-identifier hs-var">bno</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-208"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">NotOrigin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockNo</span></span><span> </span><span id="local-6989586621680281941"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680281941"><span class="hs-identifier hs-var">tip</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680281941"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680281934"><span class="hs-identifier hs-var">bno</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- We only expect a single proposal that updates to Shelley, but in case</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- there are multiple, any one will do</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621680281324"><span class="annot"><a href="#local-6989586621680281907"><span class="hs-identifier hs-type">takeAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680281324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281324"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621680281907"><span class="annot"><span class="annottext">takeAny :: forall a. [a] -&gt; Maybe a
</span><a href="#local-6989586621680281907"><span class="hs-identifier hs-var hs-var">takeAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe a
forall a. [a] -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  SingleEraBlock Byron
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SingleEraBlock</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621680282029"><span class="annot"><span class="annottext">singleEraTransition :: PartialLedgerConfig ByronBlock
-&gt; EraParams -&gt; Bound -&gt; LedgerState ByronBlock -&gt; Maybe EpochNo
</span><a href="#local-6989586621680282029"><span class="hs-identifier hs-var hs-var hs-var hs-var">singleEraTransition</span></a></span></span><span> </span><span id="local-6989586621680282031"><span class="annot"><span class="annottext">PartialLedgerConfig ByronBlock
</span><a href="#local-6989586621680282031"><span class="hs-identifier hs-var">pcfg</span></a></span></span><span> </span><span id="local-6989586621680282032"><span class="annot"><span class="annottext">EraParams
</span><a href="#local-6989586621680282032"><span class="hs-identifier hs-var">_eraParams</span></a></span></span><span> </span><span id="local-6989586621680282033"><span class="annot"><span class="annottext">Bound
</span><a href="#local-6989586621680282033"><span class="hs-identifier hs-var">_eraStart</span></a></span></span><span> </span><span id="local-6989586621680282034"><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282034"><span class="hs-identifier hs-var">ledgerState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByronPartialLedgerConfig -&gt; TriggerHardFork
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTriggerHardFork"><span class="hs-identifier hs-var">byronTriggerHardFork</span></a></span><span> </span><span class="annot"><span class="annottext">PartialLedgerConfig ByronBlock
ByronPartialLedgerConfig
</span><a href="#local-6989586621680282031"><span class="hs-identifier hs-var">pcfg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">TriggerHardFork
</span><span class="hs-identifier hs-var">TriggerHardForkNotDuringThisExecution</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">TriggerHardForkAtEpoch</span></span><span>   </span><span id="local-6989586621680282037"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282037"><span class="hs-identifier hs-var">epoch</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; Maybe EpochNo
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282037"><span class="hs-identifier hs-var">epoch</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">TriggerHardForkAtVersion</span></span><span> </span><span id="local-6989586621680282039"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680282039"><span class="hs-identifier hs-var">shelleyMajorVersion</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>            </span><span class="annot"><span class="annottext">PartialLedgerConfig ByronBlock
-&gt; Word16 -&gt; LedgerState ByronBlock -&gt; Maybe EpochNo
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTransition"><span class="hs-identifier hs-var">byronTransition</span></a></span><span>
</span><span id="line-226"></span><span>              </span><span class="annot"><span class="annottext">PartialLedgerConfig ByronBlock
</span><a href="#local-6989586621680282031"><span class="hs-identifier hs-var">pcfg</span></a></span><span>
</span><span id="line-227"></span><span>              </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680282039"><span class="hs-identifier hs-var">shelleyMajorVersion</span></a></span><span>
</span><span id="line-228"></span><span>              </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282034"><span class="hs-identifier hs-var">ledgerState</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621680282042"><span class="annot"><span class="annottext">singleEraInfo :: forall (proxy :: * -&gt; *).
proxy ByronBlock -&gt; SingleEraInfo ByronBlock
</span><a href="#local-6989586621680282042"><span class="hs-identifier hs-var hs-var hs-var hs-var">singleEraInfo</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy ByronBlock
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SingleEraInfo</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">singleEraName :: Text
</span><a href="#local-6989586621680282045"><span class="hs-identifier hs-var">singleEraName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Byron&quot;</span></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680281389"><span id="local-6989586621680282054"><span id="local-6989586621680282059"><span class="annot"><span class="hs-identifier hs-type">PBftCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281389"><span class="hs-identifier hs-type">bc</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasPartialConsensusConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PBft</span></span><span> </span><span class="annot"><a href="#local-6989586621680281389"><span class="hs-identifier hs-type">bc</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">-- Use defaults</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | When Byron is part of the hard-fork combinator, we use the partial ledger</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- config. Standalone Byron uses the regular ledger config. This means that</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- the partial ledger config is the perfect place to store the trigger</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- condition for the hard fork to Shelley, as we don't have to modify the</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- ledger config for standalone Byron.</span><span>
</span><span id="line-242"></span><span class="hs-keyword">data</span><span> </span><span id="ByronPartialLedgerConfig"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-var">ByronPartialLedgerConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ByronPartialLedgerConfig"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-var">ByronPartialLedgerConfig</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-243"></span><span>      </span><span id="byronLedgerConfig"><span class="annot"><span class="annottext">ByronPartialLedgerConfig -&gt; LedgerConfig ByronBlock
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronLedgerConfig"><span class="hs-identifier hs-var hs-var">byronLedgerConfig</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LedgerConfig</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="byronTriggerHardFork"><span class="annot"><span class="annottext">ByronPartialLedgerConfig -&gt; TriggerHardFork
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronTriggerHardFork"><span class="hs-identifier hs-var hs-var">byronTriggerHardFork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">TriggerHardFork</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680282066"><span id="local-6989586621680282068"><span class="annot"><span class="annottext">(forall x.
 ByronPartialLedgerConfig -&gt; Rep ByronPartialLedgerConfig x)
-&gt; (forall x.
    Rep ByronPartialLedgerConfig x -&gt; ByronPartialLedgerConfig)
-&gt; Generic ByronPartialLedgerConfig
forall x.
Rep ByronPartialLedgerConfig x -&gt; ByronPartialLedgerConfig
forall x.
ByronPartialLedgerConfig -&gt; Rep ByronPartialLedgerConfig x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x.
ByronPartialLedgerConfig -&gt; Rep ByronPartialLedgerConfig x
from :: forall x.
ByronPartialLedgerConfig -&gt; Rep ByronPartialLedgerConfig x
$cto :: forall x.
Rep ByronPartialLedgerConfig x -&gt; ByronPartialLedgerConfig
to :: forall x.
Rep ByronPartialLedgerConfig x -&gt; ByronPartialLedgerConfig
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680282072"><span id="local-6989586621680282076"><span id="local-6989586621680282082"><span class="annot"><span class="annottext">Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo)
Proxy ByronPartialLedgerConfig -&gt; String
(Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy ByronPartialLedgerConfig -&gt; String)
-&gt; NoThunks ByronPartialLedgerConfig
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
$cnoThunks :: Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo)
wNoThunks :: Context -&gt; ByronPartialLedgerConfig -&gt; IO (Maybe ThunkInfo)
$cshowTypeOf :: Proxy ByronPartialLedgerConfig -&gt; String
showTypeOf :: Proxy ByronPartialLedgerConfig -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasPartialLedgerConfig</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PartialLedgerConfig"><span class="annot"><span class="hs-identifier hs-var">PartialLedgerConfig</span></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#ByronPartialLedgerConfig"><span class="hs-identifier hs-type">ByronPartialLedgerConfig</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621680282126"><span class="annot"><span class="annottext">completeLedgerConfig :: forall (proxy :: * -&gt; *).
proxy ByronBlock
-&gt; EpochInfo (Except PastHorizonException)
-&gt; PartialLedgerConfig ByronBlock
-&gt; LedgerConfig ByronBlock
</span><a href="#local-6989586621680282126"><span class="hs-identifier hs-var hs-var hs-var hs-var">completeLedgerConfig</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy ByronBlock
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EpochInfo (Except PastHorizonException)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PartialLedgerConfig ByronBlock -&gt; LedgerConfig ByronBlock
ByronPartialLedgerConfig -&gt; LedgerConfig ByronBlock
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#byronLedgerConfig"><span class="hs-identifier hs-var">byronLedgerConfig</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  CanHardFork
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-keyword">type</span><span> </span><span id="CardanoHardForkConstraints"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#CardanoHardForkConstraints"><span class="hs-identifier hs-var">CardanoHardForkConstraints</span></a></span></span><span> </span><span id="local-6989586621680282128"><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TPraos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TranslateProto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span>    </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span>  </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span>  </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span>  </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-comment">-- These equalities allow the transition from Byron to Shelley, since</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- @cardano-ledger-shelley@ requires Ed25519 for Byron bootstrap addresses and</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- the current Byron-to-Shelley translation requires a 224-bit hash for</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- address and a 256-bit hash for header hashes.</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HASH</span></span><span>     </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_256</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ADDRHASH</span></span><span> </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_224</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSIGN</span></span><span>    </span><span class="annot"><a href="#local-6989586621680282128"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed25519DSIGN</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680281533"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#CardanoHardForkConstraints"><span class="hs-identifier hs-type">CardanoHardForkConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281533"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CanHardFork</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Cardano.Block.html#CardanoEras"><span class="hs-identifier hs-type">CardanoEras</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281533"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621680282268"><span class="annot"><span class="annottext">hardForkEraTranslation :: EraTranslation (CardanoEras c)
</span><a href="#local-6989586621680282268"><span class="hs-identifier hs-var hs-var hs-var hs-var">hardForkEraTranslation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraTranslation</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">translateLedgerState :: InPairs
  (RequiringBoth WrapLedgerConfig (Translate LedgerState))
  (CardanoEras c)
</span><a href="#local-6989586621680282271"><span class="hs-identifier hs-var">translateLedgerState</span></a></span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>          </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     (CardanoEras c)
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
forall c.
(ShelleyCompatible (TPraos c) (ShelleyEra c), HASH c ~ Blake2b_256,
 ADDRHASH c ~ Blake2b_224) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateByronToShelleyWrapper"><span class="hs-identifier hs-var">translateLedgerStateByronToShelleyWrapper</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapLedgerConfig (Translate LedgerState))
   '[ShelleyBlock (TPraos c) (ShelleyEra c),
     ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapLedgerConfig (Translate LedgerState))
      (CardanoEras c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     (CardanoEras c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateShelleyToAllegraWrapper"><span class="hs-identifier hs-var">translateLedgerStateShelleyToAllegraWrapper</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapLedgerConfig (Translate LedgerState))
   '[ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapLedgerConfig (Translate LedgerState))
      '[ShelleyBlock (TPraos c) (ShelleyEra c),
        ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateAllegraToMaryWrapper"><span class="hs-identifier hs-var">translateLedgerStateAllegraToMaryWrapper</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapLedgerConfig (Translate LedgerState))
   '[ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapLedgerConfig (Translate LedgerState))
      '[ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateMaryToAlonzoWrapper"><span class="hs-identifier hs-var">translateLedgerStateMaryToAlonzoWrapper</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapLedgerConfig (Translate LedgerState))
   '[ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapLedgerConfig (Translate LedgerState))
      '[ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
forall c.
(PraosCrypto c, PraosCrypto c) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateAlonzoToBabbageWrapper"><span class="hs-identifier hs-var">translateLedgerStateAlonzoToBabbageWrapper</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapLedgerConfig (Translate LedgerState))
   '[ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapLedgerConfig (Translate LedgerState))
      '[ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
forall c.
PraosCrypto c =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateBabbageToConwayWrapper"><span class="hs-identifier hs-var">translateLedgerStateBabbageToConwayWrapper</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapLedgerConfig (Translate LedgerState))
   '[ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapLedgerConfig (Translate LedgerState))
      '[ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapLedgerConfig (Translate LedgerState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs
  (RequiringBoth WrapLedgerConfig (Translate LedgerState))
  '[ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k). InPairs f '[x]
</span><span class="hs-identifier hs-var">PNil</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">translateChainDepState :: InPairs
  (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
  (CardanoEras c)
</span><a href="#local-6989586621680282280"><span class="hs-identifier hs-var">translateChainDepState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>          </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     (CardanoEras c)
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
forall c.
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelleyWrapper"><span class="hs-identifier hs-var">translateChainDepStateByronToShelleyWrapper</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
   '[ShelleyBlock (TPraos c) (ShelleyEra c),
     ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
      (CardanoEras c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     (CardanoEras c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
forall eraFrom eraTo protoFrom protoTo.
TranslateProto protoFrom protoTo =&gt;
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#translateChainDepStateAcrossShelley"><span class="hs-identifier hs-var">translateChainDepStateAcrossShelley</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
   '[ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
      '[ShelleyBlock (TPraos c) (ShelleyEra c),
        ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
forall eraFrom eraTo protoFrom protoTo.
TranslateProto protoFrom protoTo =&gt;
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#translateChainDepStateAcrossShelley"><span class="hs-identifier hs-var">translateChainDepStateAcrossShelley</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
   '[ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
      '[ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
forall eraFrom eraTo protoFrom protoTo.
TranslateProto protoFrom protoTo =&gt;
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#translateChainDepStateAcrossShelley"><span class="hs-identifier hs-var">translateChainDepStateAcrossShelley</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
   '[ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
      '[ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
forall eraFrom eraTo protoFrom protoTo.
TranslateProto protoFrom protoTo =&gt;
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#translateChainDepStateAcrossShelley"><span class="hs-identifier hs-var">translateChainDepStateAcrossShelley</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
   '[ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
      '[ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
forall eraFrom eraTo protoFrom protoTo.
TranslateProto protoFrom protoTo =&gt;
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#translateChainDepStateAcrossShelley"><span class="hs-identifier hs-var">translateChainDepStateAcrossShelley</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
   '[ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
      '[ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs
  (RequiringBoth WrapConsensusConfig (Translate WrapChainDepState))
  '[ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k). InPairs f '[x]
</span><span class="hs-identifier hs-var">PNil</span></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">crossEraForecast :: InPairs
  (RequiringBoth
     WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
  (CardanoEras c)
</span><a href="#local-6989586621680282282"><span class="hs-identifier hs-var">crossEraForecast</span></a></span><span>       </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>          </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     (CardanoEras c)
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
forall c.
Crypto c =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#crossEraForecastByronToShelleyWrapper"><span class="hs-identifier hs-var">crossEraForecastByronToShelleyWrapper</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
   '[ShelleyBlock (TPraos c) (ShelleyEra c),
     ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
      (CardanoEras c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     (CardanoEras c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
forall eraFrom eraTo protoFrom protoTo.
(TranslateProto protoFrom protoTo,
 LedgerSupportsProtocol (ShelleyBlock protoFrom eraFrom)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#crossEraForecastAcrossShelley"><span class="hs-identifier hs-var">crossEraForecastAcrossShelley</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
   '[ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
      '[ShelleyBlock (TPraos c) (ShelleyEra c),
        ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
forall eraFrom eraTo protoFrom protoTo.
(TranslateProto protoFrom protoTo,
 LedgerSupportsProtocol (ShelleyBlock protoFrom eraFrom)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#crossEraForecastAcrossShelley"><span class="hs-identifier hs-var">crossEraForecastAcrossShelley</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
   '[ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
      '[ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
forall eraFrom eraTo protoFrom protoTo.
(TranslateProto protoFrom protoTo,
 LedgerSupportsProtocol (ShelleyBlock protoFrom eraFrom)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#crossEraForecastAcrossShelley"><span class="hs-identifier hs-var">crossEraForecastAcrossShelley</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
   '[ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
      '[ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
forall eraFrom eraTo protoFrom protoTo.
(TranslateProto protoFrom protoTo,
 LedgerSupportsProtocol (ShelleyBlock protoFrom eraFrom)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#crossEraForecastAcrossShelley"><span class="hs-identifier hs-var">crossEraForecastAcrossShelley</span></a></span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
   '[ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
      '[ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
forall eraFrom eraTo protoFrom protoTo.
(TranslateProto protoFrom protoTo,
 LedgerSupportsProtocol (ShelleyBlock protoFrom eraFrom)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  (ShelleyBlock protoFrom eraFrom)
  (ShelleyBlock protoTo eraTo)
</span><a href="Ouroboros.Consensus.Shelley.ShelleyHFC.html#crossEraForecastAcrossShelley"><span class="hs-identifier hs-var">crossEraForecastAcrossShelley</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
   '[ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
      '[ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs
  (RequiringBoth
     WrapLedgerConfig (CrossEraForecaster LedgerState WrapLedgerView))
  '[ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k). InPairs f '[x]
</span><span class="hs-identifier hs-var">PNil</span></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621680282322"><span class="annot"><span class="annottext">hardForkChainSel :: Tails AcrossEraSelection (CardanoEras c)
</span><a href="#local-6989586621680282322"><span class="hs-identifier hs-var hs-var hs-var hs-var">hardForkChainSel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-comment">-- Byron &lt;-&gt; Shelley, ...</span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">NP
  (AcrossEraSelection ByronBlock)
  '[ShelleyBlock (TPraos c) (ShelleyEra c),
    ShelleyBlock (TPraos c) (AllegraEra c),
    ShelleyBlock (TPraos c) (MaryEra c),
    ShelleyBlock (TPraos c) (AlonzoEra c),
    ShelleyBlock (Praos c) (BabbageEra c),
    ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; Tails
     AcrossEraSelection
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; Tails AcrossEraSelection (CardanoEras c)
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (xs1 :: [k]).
NP (f x) xs1 -&gt; Tails f xs1 -&gt; Tails f (x : xs1)
</span><span class="hs-identifier hs-var">TCons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. AcrossEraSelection ByronBlock a)
-&gt; NP
     (AcrossEraSelection ByronBlock)
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall (xs :: [*]) (f :: * -&gt; *).
SListIN NP xs =&gt;
(forall a. f a) -&gt; NP f xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *).
(HPure h, SListIN h xs) =&gt;
(forall (a :: k). f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hpure</span></span><span> </span><span class="annot"><span class="annottext">AcrossEraSelection ByronBlock a
forall a. AcrossEraSelection ByronBlock a
forall a b. AcrossEraSelection a b
</span><span class="hs-identifier hs-var">CompareBlockNo</span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-comment">-- Inter-Shelley-based</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><span class="annottext">(Tails
   AcrossEraSelection
   '[ShelleyBlock (TPraos c) (ShelleyEra c),
     ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; Tails AcrossEraSelection (CardanoEras c))
-&gt; Tails
     AcrossEraSelection
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; Tails AcrossEraSelection (CardanoEras c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (HasPraosSelectView c)
-&gt; (forall x y.
    (HasPraosSelectView c x, HasPraosSelectView c y) =&gt;
    AcrossEraSelection x y)
-&gt; Tails
     AcrossEraSelection
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; k -&gt; *)
       (c :: k -&gt; Constraint) (xs :: [k]).
All c xs =&gt;
proxy c
-&gt; (forall (x :: k) (y :: k). (c x, c y) =&gt; f x y) -&gt; Tails f xs
</span><span class="hs-identifier hs-var">Tails.hcpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
forall (t :: * -&gt; Constraint). Proxy t
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#HasPraosSelectView"><span class="hs-identifier hs-type">HasPraosSelectView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281533"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AcrossEraSelection x y
forall a b.
(SelectView (BlockProtocol a) ~ SelectView (BlockProtocol b)) =&gt;
AcrossEraSelection a b
forall x y.
(HasPraosSelectView c x, HasPraosSelectView c y) =&gt;
AcrossEraSelection x y
</span><span class="hs-identifier hs-var">CompareSameSelectView</span></span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621680282353"><span class="annot"><span class="annottext">hardForkInjectTxs :: InPairs
  (RequiringBoth
     WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
  (CardanoEras c)
</span><a href="#local-6989586621680282353"><span class="hs-identifier hs-var hs-var hs-var hs-var">hardForkInjectTxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>        </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Product2 InjectTx InjectValidatedTx)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     (CardanoEras c)
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Product2
  InjectTx
  InjectValidatedTx
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (h :: k -&gt; *).
f x y -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">ignoringBoth</span></span><span> </span><span class="annot"><span class="annottext">(Product2
   InjectTx
   InjectValidatedTx
   ByronBlock
   (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Product2 InjectTx InjectValidatedTx)
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InjectTx ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; InjectValidatedTx
     ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) x y.
f x y -&gt; g x y -&gt; Product2 f g x y
</span><span class="hs-identifier hs-var">Pair2</span></span><span> </span><span class="annot"><span class="annottext">InjectTx ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c))
forall blk blk'. InjectTx blk blk'
</span><span class="hs-identifier hs-var">cannotInjectTx</span></span><span> </span><span class="annot"><span class="annottext">InjectValidatedTx
  ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c))
forall blk blk'. InjectValidatedTx blk blk'
</span><span class="hs-identifier hs-var">cannotInjectValidatedTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
   '[ShelleyBlock (TPraos c) (ShelleyEra c),
     ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
      (CardanoEras c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     (CardanoEras c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Product2 InjectTx InjectValidatedTx)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="hs-special">(</span><span>   </span><span class="annot"><span class="annottext">Product2
  InjectTx
  InjectValidatedTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (h :: k -&gt; *).
f x y -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">ignoringBoth</span></span><span>
</span><span id="line-318"></span><span>                </span><span class="annot"><span class="annottext">(Product2
   InjectTx
   InjectValidatedTx
   (ShelleyBlock (TPraos c) (ShelleyEra c))
   (ShelleyBlock (TPraos c) (AllegraEra c))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Product2 InjectTx InjectValidatedTx)
      (ShelleyBlock (TPraos c) (ShelleyEra c))
      (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) x y.
f x y -&gt; g x y -&gt; Product2 f g x y
</span><span class="hs-identifier hs-var">Pair2</span></span><span>
</span><span id="line-319"></span><span>                    </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxShelleyToAllegraWrapper"><span class="hs-identifier hs-var">translateTxShelleyToAllegraWrapper</span></a></span><span>
</span><span id="line-320"></span><span>                    </span><span class="annot"><span class="annottext">InjectValidatedTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectValidatedTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxShelleyToAllegraWrapper"><span class="hs-identifier hs-var">translateValidatedTxShelleyToAllegraWrapper</span></a></span><span>
</span><span id="line-321"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
   '[ShelleyBlock (TPraos c) (AllegraEra c),
     ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
      '[ShelleyBlock (TPraos c) (ShelleyEra c),
        ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (ShelleyEra c),
       ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Product2 InjectTx InjectValidatedTx)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="hs-special">(</span><span>   </span><span class="annot"><span class="annottext">Product2
  InjectTx
  InjectValidatedTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (h :: k -&gt; *).
f x y -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">ignoringBoth</span></span><span>
</span><span id="line-323"></span><span>                </span><span class="annot"><span class="annottext">(Product2
   InjectTx
   InjectValidatedTx
   (ShelleyBlock (TPraos c) (AllegraEra c))
   (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Product2 InjectTx InjectValidatedTx)
      (ShelleyBlock (TPraos c) (AllegraEra c))
      (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) x y.
f x y -&gt; g x y -&gt; Product2 f g x y
</span><span class="hs-identifier hs-var">Pair2</span></span><span>
</span><span id="line-324"></span><span>                    </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxAllegraToMaryWrapper"><span class="hs-identifier hs-var">translateTxAllegraToMaryWrapper</span></a></span><span>
</span><span id="line-325"></span><span>                    </span><span class="annot"><span class="annottext">InjectValidatedTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectValidatedTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxAllegraToMaryWrapper"><span class="hs-identifier hs-var">translateValidatedTxAllegraToMaryWrapper</span></a></span><span>
</span><span id="line-326"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
   '[ShelleyBlock (TPraos c) (MaryEra c),
     ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
      '[ShelleyBlock (TPraos c) (AllegraEra c),
        ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AllegraEra c),
       ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Product2 InjectTx InjectValidatedTx)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; Product2
      InjectTx
      InjectValidatedTx
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
  -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; Product2
       InjectTx
       InjectValidatedTx
       (ShelleyBlock (TPraos c) (MaryEra c))
       (ShelleyBlock (TPraos c) (AlonzoEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Product2 InjectTx InjectValidatedTx)
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; (WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Product2
         InjectTx
         InjectValidatedTx
         (ShelleyBlock (TPraos c) (MaryEra c))
         (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282363"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="#local-6989586621680282363"><span class="hs-identifier hs-var">_cfgMary</span></a></span></span><span> </span><span id="local-6989586621680282364"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282364"><span class="hs-identifier hs-var">cfgAlonzo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680282365"><span class="annot"><span class="annottext">ctxt :: TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282365"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; TranslationContext (AlonzoEra c)
forall c.
WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; TranslationContext (AlonzoEra c)
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getAlonzoTranslationContext"><span class="hs-identifier hs-var">getAlonzoTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282364"><span class="hs-identifier hs-var">cfgAlonzo</span></a></span><span>
</span><span id="line-329"></span><span>                </span><span class="hs-keyword">in</span><span>
</span><span id="line-330"></span><span>                </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) x y.
f x y -&gt; g x y -&gt; Product2 f g x y
</span><span class="hs-identifier hs-var">Pair2</span></span><span>
</span><span id="line-331"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
TranslationContext (AlonzoEra c)
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxMaryToAlonzoWrapper"><span class="hs-identifier hs-var">translateTxMaryToAlonzoWrapper</span></a></span><span>          </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282365"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
TranslationContext (AlonzoEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxMaryToAlonzoWrapper"><span class="hs-identifier hs-var">translateValidatedTxMaryToAlonzoWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282365"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
   '[ShelleyBlock (TPraos c) (AlonzoEra c),
     ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
      '[ShelleyBlock (TPraos c) (MaryEra c),
        ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (MaryEra c),
       ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Product2 InjectTx InjectValidatedTx)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; Product2
      InjectTx
      InjectValidatedTx
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; Product2
       InjectTx
       InjectValidatedTx
       (ShelleyBlock (TPraos c) (AlonzoEra c))
       (ShelleyBlock (Praos c) (BabbageEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Product2 InjectTx InjectValidatedTx)
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; (WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Product2
         InjectTx
         InjectValidatedTx
         (ShelleyBlock (TPraos c) (AlonzoEra c))
         (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282369"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282369"><span class="hs-identifier hs-var">_cfgAlonzo</span></a></span></span><span> </span><span id="local-6989586621680282370"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="#local-6989586621680282370"><span class="hs-identifier hs-var">_cfgBabbage</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680282371"><span class="annot"><span class="annottext">ctxt :: ()
</span><a href="#local-6989586621680282371"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>                </span><span class="hs-keyword">in</span><span>
</span><span id="line-337"></span><span>                </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) x y.
f x y -&gt; g x y -&gt; Product2 f g x y
</span><span class="hs-identifier hs-var">Pair2</span></span><span>
</span><span id="line-338"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall c.
PraosCrypto c =&gt;
TranslationContext (BabbageEra c)
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxAlonzoToBabbageWrapper"><span class="hs-identifier hs-var">translateTxAlonzoToBabbageWrapper</span></a></span><span>          </span><span class="annot"><span class="annottext">()
TranslationContext (BabbageEra c)
</span><a href="#local-6989586621680282371"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall c.
PraosCrypto c =&gt;
TranslationContext (BabbageEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxAlonzoToBabbageWrapper"><span class="hs-identifier hs-var">translateValidatedTxAlonzoToBabbageWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">()
TranslationContext (BabbageEra c)
</span><a href="#local-6989586621680282371"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
   '[ShelleyBlock (Praos c) (BabbageEra c),
     ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
      '[ShelleyBlock (TPraos c) (AlonzoEra c),
        ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (TPraos c) (AlonzoEra c),
       ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RequiringBoth
  WrapLedgerConfig
  (Product2 InjectTx InjectValidatedTx)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (zs :: [k]).
f x y -&gt; InPairs f (y : zs) -&gt; InPairs f (x : y : zs)
</span><span class="hs-identifier hs-var">PCons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
 -&gt; Product2
      InjectTx
      InjectValidatedTx
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
  -&gt; Product2
       InjectTx
       InjectValidatedTx
       (ShelleyBlock (Praos c) (BabbageEra c))
       (ShelleyBlock (Praos c) (ConwayEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Product2 InjectTx InjectValidatedTx)
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; (WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
    -&gt; Product2
         InjectTx
         InjectValidatedTx
         (ShelleyBlock (Praos c) (BabbageEra c))
         (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Product2 InjectTx InjectValidatedTx)
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282374"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="#local-6989586621680282374"><span class="hs-identifier hs-var">_cfgBabbage</span></a></span></span><span> </span><span id="local-6989586621680282375"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="#local-6989586621680282375"><span class="hs-identifier hs-var">cfgConway</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680282376"><span class="annot"><span class="annottext">ctxt :: TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282376"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; TranslationContext (ConwayEra c)
forall c.
WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; TranslationContext (ConwayEra c)
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getConwayTranslationContext"><span class="hs-identifier hs-var">getConwayTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="#local-6989586621680282375"><span class="hs-identifier hs-var">cfgConway</span></a></span><span>
</span><span id="line-343"></span><span>                </span><span class="hs-keyword">in</span><span>
</span><span id="line-344"></span><span>                </span><span class="annot"><span class="annottext">InjectTx
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; Product2
     InjectTx
     InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall (f :: * -&gt; * -&gt; *) (g :: * -&gt; * -&gt; *) x y.
f x y -&gt; g x y -&gt; Product2 f g x y
</span><span class="hs-identifier hs-var">Pair2</span></span><span>
</span><span id="line-345"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
-&gt; InjectTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall c.
PraosCrypto c =&gt;
TranslationContext (ConwayEra c)
-&gt; InjectTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxBabbageToConwayWrapper"><span class="hs-identifier hs-var">translateTxBabbageToConwayWrapper</span></a></span><span>          </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282376"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall c.
PraosCrypto c =&gt;
TranslationContext (ConwayEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxBabbageToConwayWrapper"><span class="hs-identifier hs-var">translateValidatedTxBabbageToConwayWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282376"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">(InPairs
   (RequiringBoth
      WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
   '[ShelleyBlock (Praos c) (ConwayEra c)]
 -&gt; InPairs
      (RequiringBoth
         WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
      '[ShelleyBlock (Praos c) (BabbageEra c),
        ShelleyBlock (Praos c) (ConwayEra c)])
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (Praos c) (ConwayEra c)]
-&gt; InPairs
     (RequiringBoth
        WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
     '[ShelleyBlock (Praos c) (BabbageEra c),
       ShelleyBlock (Praos c) (ConwayEra c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs
  (RequiringBoth
     WrapLedgerConfig (Product2 InjectTx InjectValidatedTx))
  '[ShelleyBlock (Praos c) (ConwayEra c)]
forall {k} (f :: k -&gt; k -&gt; *) (x :: k). InPairs f '[x]
</span><span class="hs-identifier hs-var">PNil</span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-keyword">class</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SelectView</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockProtocol</span></span><span> </span><span class="annot"><a href="#local-6989586621680281598"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PraosChainSelectView</span></span><span> </span><span class="annot"><a href="#local-6989586621680281597"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="HasPraosSelectView"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#HasPraosSelectView"><span class="hs-identifier hs-var">HasPraosSelectView</span></a></span></span><span> </span><span id="local-6989586621680281597"><span class="annot"><a href="#local-6989586621680281597"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621680281598"><span class="annot"><a href="#local-6989586621680281598"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-351"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680281571"><span id="local-6989586621680281572"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SelectView</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockProtocol</span></span><span> </span><span class="annot"><a href="#local-6989586621680281571"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PraosChainSelectView</span></span><span> </span><span class="annot"><a href="#local-6989586621680281572"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#HasPraosSelectView"><span class="hs-identifier hs-type">HasPraosSelectView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281572"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281571"><span class="hs-identifier hs-type">blk</span></a></span></span></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Byron to Shelley
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateHeaderHashByronToShelley"><span class="hs-identifier hs-type">translateHeaderHashByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-358"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281632"><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-359"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HASH</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_256</span></span><span>
</span><span id="line-361"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeaderHash</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HeaderHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span id="translateHeaderHashByronToShelley"><span class="annot"><span class="annottext">translateHeaderHashByronToShelley :: forall c.
(ShelleyCompatible (TPraos c) (ShelleyEra c),
 HASH c ~ Blake2b_256) =&gt;
HeaderHash ByronBlock
-&gt; HeaderHash (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateHeaderHashByronToShelley"><span class="hs-identifier hs-var hs-var">translateHeaderHashByronToShelley</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">Proxy (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; ShortByteString
-&gt; HeaderHash (ShelleyBlock (TPraos c) (ShelleyEra c))
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; ShortByteString -&gt; HeaderHash blk
forall (proxy :: * -&gt; *).
proxy (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; ShortByteString
-&gt; HeaderHash (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><span class="hs-identifier hs-var">fromShortRawHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Proxy t
forall {k} (t :: k). Proxy t
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">(ShortByteString -&gt; ShelleyHash c)
-&gt; (ByronHash -&gt; ShortByteString) -&gt; ByronHash -&gt; ShelleyHash c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy ByronBlock -&gt; HeaderHash ByronBlock -&gt; ShortByteString
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; ShortByteString
forall (proxy :: * -&gt; *).
proxy ByronBlock -&gt; HeaderHash ByronBlock -&gt; ShortByteString
</span><span class="hs-identifier hs-var">toShortRawHash</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Proxy t
forall {k} (t :: k). Proxy t
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-comment">-- Byron uses 'Blake2b_256' for header hashes</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (HASH c ~ Blake2b_256) -&gt; ()
forall (c :: Constraint) (proxy :: Constraint -&gt; *).
c =&gt;
proxy c -&gt; ()
</span><span class="hs-identifier hs-var">keepRedundantConstraint</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
forall (t :: Constraint). Proxy t
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HASH</span></span><span> </span><span class="annot"><a href="#local-6989586621680281632"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_256</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span id="local-6989586621680281645"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translatePointByronToShelley"><span class="hs-identifier hs-type">translatePointByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-372"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281645"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281645"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HASH</span></span><span> </span><span class="annot"><a href="#local-6989586621680281645"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_256</span></span><span>
</span><span id="line-374"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WithOrigin</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BlockNo</span></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WithOrigin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyTip"><span class="hs-identifier hs-type">ShelleyTip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281645"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281645"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-378"></span><span id="translatePointByronToShelley"><span class="annot"><span class="annottext">translatePointByronToShelley :: forall c.
(ShelleyCompatible (TPraos c) (ShelleyEra c),
 HASH c ~ Blake2b_256) =&gt;
Point ByronBlock
-&gt; WithOrigin BlockNo
-&gt; WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translatePointByronToShelley"><span class="hs-identifier hs-var hs-var">translatePointByronToShelley</span></a></span></span><span> </span><span id="local-6989586621680282405"><span class="annot"><span class="annottext">Point ByronBlock
</span><a href="#local-6989586621680282405"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span id="local-6989586621680282406"><span class="annot"><span class="annottext">WithOrigin BlockNo
</span><a href="#local-6989586621680282406"><span class="hs-identifier hs-var">bNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point ByronBlock
</span><a href="#local-6989586621680282405"><span class="hs-identifier hs-var">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WithOrigin BlockNo
</span><a href="#local-6989586621680282406"><span class="hs-identifier hs-var">bNo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point ByronBlock
</span><span class="hs-identifier hs-var">GenesisPoint</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WithOrigin BlockNo
</span><span class="hs-identifier hs-var">Origin</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><span class="annottext">WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
forall t. WithOrigin t
</span><span class="hs-identifier hs-var">Origin</span></span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockPoint</span></span><span> </span><span id="local-6989586621680282409"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282409"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680282410"><span class="annot"><span class="annottext">HeaderHash ByronBlock
</span><a href="#local-6989586621680282410"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NotOrigin</span></span><span> </span><span id="local-6989586621680282411"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621680282411"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyTip (TPraos c) (ShelleyEra c)
-&gt; WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
forall t. t -&gt; WithOrigin t
</span><span class="hs-identifier hs-var">NotOrigin</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyTip"><span class="hs-identifier hs-type">ShelleyTip</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-383"></span><span>          </span><span class="annot"><span class="annottext">shelleyTipSlotNo :: SlotNo
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyTipSlotNo"><span class="hs-identifier hs-var">shelleyTipSlotNo</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282409"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shelleyTipBlockNo :: BlockNo
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyTipBlockNo"><span class="hs-identifier hs-var">shelleyTipBlockNo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621680282411"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shelleyTipHash :: HeaderHash (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyTipHash"><span class="hs-identifier hs-var">shelleyTipHash</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HeaderHash ByronBlock
-&gt; HeaderHash (ShelleyBlock (TPraos c) (ShelleyEra c))
forall c.
(ShelleyCompatible (TPraos c) (ShelleyEra c),
 HASH c ~ Blake2b_256) =&gt;
HeaderHash ByronBlock
-&gt; HeaderHash (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateHeaderHashByronToShelley"><span class="hs-identifier hs-var">translateHeaderHashByronToShelley</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderHash ByronBlock
</span><a href="#local-6989586621680282410"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-387"></span><span>      </span><span id="local-6989586621680282416"><span class="annot"><span class="annottext">(Point ByronBlock, WithOrigin BlockNo)
</span><a href="#local-6989586621680282416"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;translatePointByronToShelley: invalid Byron state&quot;</span></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span id="local-6989586621680281545"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateByronToShelleyWrapper"><span class="hs-identifier hs-type">translateLedgerStateByronToShelleyWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-391"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyCompatible"><span class="hs-identifier hs-type">ShelleyCompatible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HASH</span></span><span>     </span><span class="annot"><a href="#local-6989586621680281545"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_256</span></span><span>
</span><span id="line-393"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ADDRHASH</span></span><span> </span><span class="annot"><a href="#local-6989586621680281545"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blake2b_224</span></span><span>
</span><span id="line-394"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-396"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-397"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-399"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-400"></span><span id="translateLedgerStateByronToShelleyWrapper"><span class="annot"><span class="annottext">translateLedgerStateByronToShelleyWrapper :: forall c.
(ShelleyCompatible (TPraos c) (ShelleyEra c), HASH c ~ Blake2b_256,
 ADDRHASH c ~ Blake2b_224) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateByronToShelleyWrapper"><span class="hs-identifier hs-var hs-var">translateLedgerStateByronToShelleyWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">(WrapLedgerConfig ByronBlock
 -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; Translate
      LedgerState ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig ByronBlock
  -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
  -&gt; Translate
       LedgerState ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Translate LedgerState)
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; (WrapLedgerConfig ByronBlock
    -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Translate
         LedgerState ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">WrapLedgerConfig ByronBlock
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span> </span><span id="local-6989586621680282444"><span class="annot"><span class="annottext">LedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="#local-6989586621680282444"><span class="hs-identifier hs-var">cfgShelley</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; LedgerState ByronBlock
 -&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; Translate
     LedgerState ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span>   </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; LedgerState ByronBlock
  -&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; Translate
      LedgerState ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; (EpochNo
    -&gt; LedgerState ByronBlock
    -&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; Translate
     LedgerState ByronBlock (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282446"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282446"><span class="hs-identifier hs-var">epochNo</span></a></span></span><span> </span><span id="local-6989586621680282447"><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282447"><span class="hs-identifier hs-var">ledgerByron</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyLedgerState"><span class="hs-identifier hs-type">ShelleyLedgerState</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="annottext">shelleyLedgerTip :: WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerTip"><span class="hs-identifier hs-var">shelleyLedgerTip</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>          </span><span class="annot"><span class="annottext">Point ByronBlock
-&gt; WithOrigin BlockNo
-&gt; WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
forall c.
(ShelleyCompatible (TPraos c) (ShelleyEra c),
 HASH c ~ Blake2b_256) =&gt;
Point ByronBlock
-&gt; WithOrigin BlockNo
-&gt; WithOrigin (ShelleyTip (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translatePointByronToShelley"><span class="hs-identifier hs-var">translatePointByronToShelley</span></a></span><span>
</span><span id="line-406"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; Point ByronBlock
forall blk. UpdateLedger blk =&gt; LedgerState blk -&gt; Point blk
</span><span class="hs-identifier hs-var">ledgerTipPoint</span></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282447"><span class="hs-identifier hs-var">ledgerByron</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; WithOrigin BlockNo
</span><a href="Ouroboros.Consensus.Byron.Ledger.Ledger.html#byronLedgerTipBlockNo"><span class="hs-identifier hs-var">byronLedgerTipBlockNo</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282447"><span class="hs-identifier hs-var">ledgerByron</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shelleyLedgerState :: NewEpochState (ShelleyEra c)
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerState"><span class="hs-identifier hs-var">shelleyLedgerState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>          </span><span class="annot"><span class="annottext">FromByronTranslationContext c
-&gt; EpochNo -&gt; ChainValidationState -&gt; NewEpochState (ShelleyEra c)
forall c.
(Crypto c, ADDRHASH c ~ Blake2b_224) =&gt;
FromByronTranslationContext c
-&gt; EpochNo -&gt; ChainValidationState -&gt; NewEpochState (ShelleyEra c)
</span><span class="hs-identifier hs-var">SL.translateToShelleyLedgerState</span></span><span>
</span><span id="line-410"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis c -&gt; FromByronTranslationContext c
forall c. ShelleyGenesis c -&gt; FromByronTranslationContext c
</span><span class="hs-identifier hs-var">toFromByronTranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c)
-&gt; ShelleyGenesis (EraCrypto (ShelleyEra c))
forall era.
ShelleyLedgerConfig era -&gt; ShelleyGenesis (EraCrypto era)
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerGenesis"><span class="hs-identifier hs-var">shelleyLedgerGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
ShelleyLedgerConfig (ShelleyEra c)
</span><a href="#local-6989586621680282444"><span class="hs-identifier hs-var">cfgShelley</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>            </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282446"><span class="hs-identifier hs-var">epochNo</span></a></span><span>
</span><span id="line-412"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; ChainValidationState
</span><a href="Ouroboros.Consensus.Byron.Ledger.Ledger.html#byronLedgerState"><span class="hs-identifier hs-var">byronLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282447"><span class="hs-identifier hs-var">ledgerByron</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shelleyLedgerTransition :: ShelleyTransition
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerTransition"><span class="hs-identifier hs-var">shelleyLedgerTransition</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-414"></span><span>          </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyTransitionInfo"><span class="hs-identifier hs-type">ShelleyTransitionInfo</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">shelleyAfterVoting :: Word32
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyAfterVoting"><span class="hs-identifier hs-var">shelleyAfterVoting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span id="local-6989586621680281553"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelleyWrapper"><span class="hs-identifier hs-type">translateChainDepStateByronToShelleyWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-418"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-419"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapConsensusConfig</span></span><span>
</span><span id="line-420"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapChainDepState</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-422"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281553"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281553"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-423"></span><span id="translateChainDepStateByronToShelleyWrapper"><span class="annot"><span class="annottext">translateChainDepStateByronToShelleyWrapper :: forall c.
RequiringBoth
  WrapConsensusConfig
  (Translate WrapChainDepState)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelleyWrapper"><span class="hs-identifier hs-var hs-var">translateChainDepStateByronToShelleyWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">(WrapConsensusConfig ByronBlock
 -&gt; WrapConsensusConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; Translate
      WrapChainDepState
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; RequiringBoth
     WrapConsensusConfig
     (Translate WrapChainDepState)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapConsensusConfig ByronBlock
  -&gt; WrapConsensusConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
  -&gt; Translate
       WrapChainDepState
       ByronBlock
       (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; RequiringBoth
      WrapConsensusConfig
      (Translate WrapChainDepState)
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; (WrapConsensusConfig ByronBlock
    -&gt; WrapConsensusConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Translate
         WrapChainDepState
         ByronBlock
         (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; RequiringBoth
     WrapConsensusConfig
     (Translate WrapChainDepState)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">WrapConsensusConfig ByronBlock
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WrapConsensusConfig</span></span><span> </span><span id="local-6989586621680282459"><span class="annot"><span class="annottext">ConsensusConfig
  (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
</span><a href="#local-6989586621680282459"><span class="hs-identifier hs-var">cfgShelley</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; WrapChainDepState ByronBlock
 -&gt; WrapChainDepState (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; Translate
     WrapChainDepState
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span> </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; WrapChainDepState ByronBlock
  -&gt; WrapChainDepState (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; Translate
      WrapChainDepState
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; (EpochNo
    -&gt; WrapChainDepState ByronBlock
    -&gt; WrapChainDepState (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; Translate
     WrapChainDepState
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WrapChainDepState</span></span><span> </span><span id="local-6989586621680282461"><span class="annot"><span class="annottext">ChainDepState (BlockProtocol ByronBlock)
</span><a href="#local-6989586621680282461"><span class="hs-identifier hs-var">pbftState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">ChainDepState
  (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; WrapChainDepState (ShelleyBlock (TPraos c) (ShelleyEra c))
forall blk.
ChainDepState (BlockProtocol blk) -&gt; WrapChainDepState blk
</span><span class="hs-identifier hs-var">WrapChainDepState</span></span><span> </span><span class="annot"><span class="annottext">(ChainDepState
   (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; WrapChainDepState (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; ChainDepState
     (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; WrapChainDepState (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-427"></span><span>          </span><span class="annot"><span class="annottext">ConsensusConfig (TPraos c)
-&gt; PBftState PBftByronCrypto -&gt; TPraosState c
forall bc c.
ConsensusConfig (TPraos c) -&gt; PBftState bc -&gt; TPraosState c
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelley"><span class="hs-identifier hs-var">translateChainDepStateByronToShelley</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig
  (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
ConsensusConfig (TPraos c)
</span><a href="#local-6989586621680282459"><span class="hs-identifier hs-var">cfgShelley</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDepState (BlockProtocol ByronBlock)
PBftState PBftByronCrypto
</span><a href="#local-6989586621680282461"><span class="hs-identifier hs-var">pbftState</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelley"><span class="hs-identifier hs-type">translateChainDepStateByronToShelley</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-430"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281682"><span class="annot"><a href="#local-6989586621680281682"><span class="hs-identifier hs-type">bc</span></a></span></span><span> </span><span id="local-6989586621680281681"><span class="annot"><a href="#local-6989586621680281681"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-431"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">ConsensusConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281681"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBftState</span></span><span> </span><span class="annot"><a href="#local-6989586621680281682"><span class="hs-identifier hs-type">bc</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TPraosState</span></span><span> </span><span class="annot"><a href="#local-6989586621680281681"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-434"></span><span id="translateChainDepStateByronToShelley"><span class="annot"><span class="annottext">translateChainDepStateByronToShelley :: forall bc c.
ConsensusConfig (TPraos c) -&gt; PBftState bc -&gt; TPraosState c
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateChainDepStateByronToShelley"><span class="hs-identifier hs-var hs-var">translateChainDepStateByronToShelley</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TPraosConfig</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680282464"><span class="annot"><span class="annottext">TPraosParams
tpraosParams :: TPraosParams
tpraosParams :: forall c. ConsensusConfig (TPraos c) -&gt; TPraosParams
</span><a href="#local-6989586621680282464"><span class="hs-identifier hs-var hs-var">tpraosParams</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621680282466"><span class="annot"><span class="annottext">PBftState bc
</span><a href="#local-6989586621680282466"><span class="hs-identifier hs-var">pbftState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-comment">-- Note that the 'PBftState' doesn't know about EBBs. So if the last slot of</span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-comment">-- the Byron era were occupied by an EBB (and no regular block in that same</span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-comment">-- slot), we would pick the wrong slot here, i.e., the slot of the regular</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-comment">-- block before the EBB.</span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-comment">-- Fortunately, this is impossible for two reasons:</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-comment">-- 1. On mainnet we stopped producing EBBs a while before the transition.</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-comment">-- 2. The transition happens at the start of an epoch, so if the last slot</span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-comment">--    were occupied by an EBB, it must have been the EBB at the start of the</span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-comment">--    previous epoch. This means the previous epoch must have been empty,</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-comment">--    which is a violation of the &quot;@k@ blocks per @2k@ slots&quot; property.</span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="annottext">WithOrigin SlotNo -&gt; ChainDepState c -&gt; TPraosState c
forall c. WithOrigin SlotNo -&gt; ChainDepState c -&gt; TPraosState c
</span><span class="hs-identifier hs-var">TPraosState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PBftState bc -&gt; WithOrigin SlotNo
forall c. PBftState c -&gt; WithOrigin SlotNo
</span><span class="hs-identifier hs-var">PBftState.lastSignedSlot</span></span><span> </span><span class="annot"><span class="annottext">PBftState bc
</span><a href="#local-6989586621680282466"><span class="hs-identifier hs-var">pbftState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ChainDepState c -&gt; TPraosState c)
-&gt; ChainDepState c -&gt; TPraosState c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-448"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">SL.ChainDepState</span></span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">csProtocol :: PrtclState c
</span><span class="hs-identifier hs-var">SL.csProtocol</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'BlockIssuer c) Word64
-&gt; Nonce -&gt; Nonce -&gt; PrtclState c
forall c.
Map (KeyHash 'BlockIssuer c) Word64
-&gt; Nonce -&gt; Nonce -&gt; PrtclState c
</span><span class="hs-identifier hs-var">SL.PrtclState</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'BlockIssuer c) Word64
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621680282473"><span class="hs-identifier hs-var">nonce</span></a></span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621680282473"><span class="hs-identifier hs-var">nonce</span></a></span><span>
</span><span id="line-450"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">csTickn :: TicknState
</span><span class="hs-identifier hs-var">SL.csTickn</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TicknState</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-451"></span><span>              </span><span class="annot"><span class="annottext">ticknStateEpochNonce :: Nonce
</span><span class="hs-identifier hs-var">ticknStateEpochNonce</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621680282473"><span class="hs-identifier hs-var">nonce</span></a></span><span>
</span><span id="line-452"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ticknStatePrevHashNonce :: Nonce
</span><span class="hs-identifier hs-var">ticknStatePrevHashNonce</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonce
</span><span class="hs-identifier hs-var">SL.NeutralNonce</span></span><span>
</span><span id="line-453"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-454"></span><span>          </span><span class="hs-comment">-- Overridden before used</span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">csLabNonce :: Nonce
</span><span class="hs-identifier hs-var">SL.csLabNonce</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonce
</span><span class="hs-identifier hs-var">SL.NeutralNonce</span></span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621680282473"><span class="annot"><span class="annottext">nonce :: Nonce
</span><a href="#local-6989586621680282473"><span class="hs-identifier hs-var hs-var">nonce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPraosParams -&gt; Nonce
</span><span class="hs-identifier hs-var">tpraosInitialNonce</span></span><span> </span><span class="annot"><span class="annottext">TPraosParams
</span><a href="#local-6989586621680282464"><span class="hs-identifier hs-var">tpraosParams</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#crossEraForecastByronToShelleyWrapper"><span class="hs-identifier hs-type">crossEraForecastByronToShelleyWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-461"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281558"><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-462"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-463"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-464"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CrossEraForecaster</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerView</span></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-466"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span id="crossEraForecastByronToShelleyWrapper"><span class="annot"><span class="annottext">crossEraForecastByronToShelleyWrapper :: forall c.
Crypto c =&gt;
RequiringBoth
  WrapLedgerConfig
  (CrossEraForecaster LedgerState WrapLedgerView)
  ByronBlock
  (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#crossEraForecastByronToShelleyWrapper"><span class="hs-identifier hs-var hs-var">crossEraForecastByronToShelleyWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">(WrapLedgerConfig ByronBlock
 -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; CrossEraForecaster
      LedgerState
      WrapLedgerView
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (CrossEraForecaster LedgerState WrapLedgerView)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig ByronBlock
  -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
  -&gt; CrossEraForecaster
       LedgerState
       WrapLedgerView
       ByronBlock
       (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (CrossEraForecaster LedgerState WrapLedgerView)
      ByronBlock
      (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; (WrapLedgerConfig ByronBlock
    -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; CrossEraForecaster
         LedgerState
         WrapLedgerView
         ByronBlock
         (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (CrossEraForecaster LedgerState WrapLedgerView)
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">WrapLedgerConfig ByronBlock
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span> </span><span id="local-6989586621680282492"><span class="annot"><span class="annottext">LedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
</span><a href="#local-6989586621680282492"><span class="hs-identifier hs-var">cfgShelley</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="annottext">(Bound
 -&gt; SlotNo
 -&gt; LedgerState ByronBlock
 -&gt; Except
      OutsideForecastRange
      (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))))
-&gt; CrossEraForecaster
     LedgerState
     WrapLedgerView
     ByronBlock
     (ShelleyBlock (TPraos c) (ShelleyEra c))
forall (state :: * -&gt; *) (view :: * -&gt; *) x y.
(Bound
 -&gt; SlotNo -&gt; state x -&gt; Except OutsideForecastRange (view y))
-&gt; CrossEraForecaster state view x y
</span><span class="hs-identifier hs-var">CrossEraForecaster</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c)
-&gt; Bound
-&gt; SlotNo
-&gt; LedgerState ByronBlock
-&gt; Except
     OutsideForecastRange
     (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
</span><a href="#local-6989586621680282494"><span class="hs-identifier hs-var">forecast</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
ShelleyLedgerConfig (ShelleyEra c)
</span><a href="#local-6989586621680282492"><span class="hs-identifier hs-var">cfgShelley</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-comment">-- We ignore the Byron ledger view and create a new Shelley.</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-comment">-- The full Shelley forecast range (stability window) starts from the first</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-comment">-- slot of the Shelley era, no matter how many slots there are between the</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-comment">-- Byron ledger and the first Shelley slot. Note that this number of slots</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-comment">-- is still guaranteed to be less than the forecast range of the HFC in the</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-comment">-- Byron era.</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621680282494"><span class="hs-identifier hs-type">forecast</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-479"></span><span>         </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyLedgerConfig"><span class="hs-identifier hs-type">ShelleyLedgerConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bound</span></span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Byron.Ledger.Block.html#ByronBlock"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#Except"><span class="hs-identifier hs-type">Except</span></a></span><span>
</span><span id="line-484"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">OutsideForecastRange</span></span><span>
</span><span id="line-485"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerView</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281558"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>    </span><span id="local-6989586621680282494"><span class="annot"><span class="annottext">forecast :: ShelleyLedgerConfig (ShelleyEra c)
-&gt; Bound
-&gt; SlotNo
-&gt; LedgerState ByronBlock
-&gt; Except
     OutsideForecastRange
     (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
</span><a href="#local-6989586621680282494"><span class="hs-identifier hs-var hs-var">forecast</span></a></span></span><span> </span><span id="local-6989586621680282495"><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c)
</span><a href="#local-6989586621680282495"><span class="hs-identifier hs-var">cfgShelley</span></a></span></span><span> </span><span id="local-6989586621680282496"><span class="annot"><span class="annottext">Bound
</span><a href="#local-6989586621680282496"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="local-6989586621680282497"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282497"><span class="hs-identifier hs-var">forecastFor</span></a></span></span><span> </span><span id="local-6989586621680282498"><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282498"><span class="hs-identifier hs-var">currentByronState</span></a></span></span><span>
</span><span id="line-487"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282497"><span class="hs-identifier hs-var">forecastFor</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282500"><span class="hs-identifier hs-var">maxFor</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Except
     OutsideForecastRange
     (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
forall a. a -&gt; ExceptT OutsideForecastRange Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; Except
      OutsideForecastRange
      (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))))
-&gt; WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Except
     OutsideForecastRange
     (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-489"></span><span>            </span><span class="annot"><span class="annottext">LedgerView (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))
forall blk. LedgerView (BlockProtocol blk) -&gt; WrapLedgerView blk
</span><span class="hs-identifier hs-var">WrapLedgerView</span></span><span> </span><span class="annot"><span class="annottext">(LedgerView
   (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
 -&gt; WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; LedgerView
     (BlockProtocol (ShelleyBlock (TPraos c) (ShelleyEra c)))
-&gt; WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-490"></span><span>              </span><span class="annot"><span class="annottext">FromByronTranslationContext c -&gt; LedgerView c
forall c. Crypto c =&gt; FromByronTranslationContext c -&gt; LedgerView c
</span><span class="hs-identifier hs-var">SL.mkInitialShelleyLedgerView</span></span><span>
</span><span id="line-491"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis c -&gt; FromByronTranslationContext c
forall c. ShelleyGenesis c -&gt; FromByronTranslationContext c
</span><span class="hs-identifier hs-var">toFromByronTranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c)
-&gt; ShelleyGenesis (EraCrypto (ShelleyEra c))
forall era.
ShelleyLedgerConfig era -&gt; ShelleyGenesis (EraCrypto era)
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerGenesis"><span class="hs-identifier hs-var">shelleyLedgerGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c)
</span><a href="#local-6989586621680282495"><span class="hs-identifier hs-var">cfgShelley</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutsideForecastRange
-&gt; Except
     OutsideForecastRange
     (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
forall a.
OutsideForecastRange -&gt; ExceptT OutsideForecastRange Identity a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/mtl-2.3.1/src/Control.Monad.Error.Class.html#throwError"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(OutsideForecastRange
 -&gt; Except
      OutsideForecastRange
      (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c))))
-&gt; OutsideForecastRange
-&gt; Except
     OutsideForecastRange
     (WrapLedgerView (ShelleyBlock (TPraos c) (ShelleyEra c)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OutsideForecastRange</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-494"></span><span>              </span><span class="annot"><span class="annottext">outsideForecastAt :: WithOrigin SlotNo
</span><span class="hs-identifier hs-var">outsideForecastAt</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; WithOrigin SlotNo
forall blk.
UpdateLedger blk =&gt;
LedgerState blk -&gt; WithOrigin SlotNo
</span><span class="hs-identifier hs-var">ledgerTipSlot</span></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621680282498"><span class="hs-identifier hs-var">currentByronState</span></a></span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">outsideForecastMaxFor :: SlotNo
</span><span class="hs-identifier hs-var">outsideForecastMaxFor</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282500"><span class="hs-identifier hs-var">maxFor</span></a></span><span>
</span><span id="line-496"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">outsideForecastFor :: SlotNo
</span><span class="hs-identifier hs-var">outsideForecastFor</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282497"><span class="hs-identifier hs-var">forecastFor</span></a></span><span>
</span><span id="line-497"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-498"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-499"></span><span>        </span><span id="local-6989586621680282508"><span class="annot"><span class="annottext">globals :: Globals
</span><a href="#local-6989586621680282508"><span class="hs-identifier hs-var hs-var">globals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c) -&gt; Globals
forall era. ShelleyLedgerConfig era -&gt; Globals
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerGlobals"><span class="hs-identifier hs-var">shelleyLedgerGlobals</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ShelleyEra c)
</span><a href="#local-6989586621680282495"><span class="hs-identifier hs-var">cfgShelley</span></a></span><span>
</span><span id="line-500"></span><span>        </span><span id="local-6989586621680282510"><span class="annot"><span class="annottext">swindow :: Word64
</span><a href="#local-6989586621680282510"><span class="hs-identifier hs-var hs-var">swindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Globals -&gt; Word64
</span><span class="hs-identifier hs-var">SL.stabilityWindow</span></span><span> </span><span class="annot"><span class="annottext">Globals
</span><a href="#local-6989586621680282508"><span class="hs-identifier hs-var">globals</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>        </span><span class="hs-comment">-- This is the exclusive upper bound of the forecast range</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-504"></span><span>        </span><span class="hs-comment">-- If Shelley's stability window is 0, it means we can't forecast /at</span><span>
</span><span id="line-505"></span><span>        </span><span class="hs-comment">-- all/ in the Shelley era. Not even to the first slot in the Shelley</span><span>
</span><span id="line-506"></span><span>        </span><span class="hs-comment">-- era! Remember that forecasting to slot @S@ means forecasting the</span><span>
</span><span id="line-507"></span><span>        </span><span class="hs-comment">-- ledger view obtained from the ledger state /after/ applying the block</span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-comment">-- with slot @S@. If the stability window is 0, we can't even forecast</span><span>
</span><span id="line-509"></span><span>        </span><span class="hs-comment">-- after the very first &quot;virtual&quot; Shelley block, meaning we can't</span><span>
</span><span id="line-510"></span><span>        </span><span class="hs-comment">-- forecast into the Shelley era when still in the Byron era.</span><span>
</span><span id="line-511"></span><span>        </span><span class="annot"><a href="#local-6989586621680282500"><span class="hs-identifier hs-type">maxFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-512"></span><span>        </span><span id="local-6989586621680282500"><span class="annot"><span class="annottext">maxFor :: SlotNo
</span><a href="#local-6989586621680282500"><span class="hs-identifier hs-var hs-var">maxFor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo -&gt; SlotNo
</span><span class="hs-identifier hs-var">addSlots</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680282510"><span class="hs-identifier hs-var">swindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bound -&gt; SlotNo
</span><span class="hs-identifier hs-var">boundSlot</span></span><span> </span><span class="annot"><span class="annottext">Bound
</span><a href="#local-6989586621680282496"><span class="hs-identifier hs-var">bound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Shelley to Allegra
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span id="local-6989586621680281546"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateShelleyToAllegraWrapper"><span class="hs-identifier hs-type">translateLedgerStateShelleyToAllegraWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-519"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-521"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-522"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281546"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-525"></span><span id="translateLedgerStateShelleyToAllegraWrapper"><span class="annot"><span class="annottext">translateLedgerStateShelleyToAllegraWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateShelleyToAllegraWrapper"><span class="hs-identifier hs-var hs-var">translateLedgerStateShelleyToAllegraWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="annottext">Translate
  LedgerState
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (h :: k -&gt; *).
f x y -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">ignoringBoth</span></span><span> </span><span class="annot"><span class="annottext">(Translate
   LedgerState
   (ShelleyBlock (TPraos c) (ShelleyEra c))
   (ShelleyBlock (TPraos c) (AllegraEra c))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Translate LedgerState)
      (ShelleyBlock (TPraos c) (ShelleyEra c))
      (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-527"></span><span>      </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span> </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
  -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c)))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (TPraos c) (ShelleyEra c))
      (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; (EpochNo
    -&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282537"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282537"><span class="hs-identifier hs-var">_epochNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-528"></span><span>        </span><span class="annot"><span class="annottext">(:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c)
-&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c)
 -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AllegraEra c)
-&gt; (:.:)
     LedgerState (ShelleyBlock (TPraos c)) (PreviousEra (AllegraEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c)
forall era (f :: * -&gt; *).
(TranslateEra era f, TranslationError era f ~ Void) =&gt;
TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><span class="hs-identifier hs-var">SL.translateEra'</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (TPraos c)) (ShelleyEra c)
 -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (ShelleyEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (ShelleyEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span id="local-6989586621680281612"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxShelleyToAllegraWrapper"><span class="hs-identifier hs-type">translateTxShelleyToAllegraWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-531"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectTx</span></span><span>
</span><span id="line-533"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281612"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-535"></span><span id="translateTxShelleyToAllegraWrapper"><span class="annot"><span class="annottext">translateTxShelleyToAllegraWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxShelleyToAllegraWrapper"><span class="hs-identifier hs-var hs-var">translateTxShelleyToAllegraWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall blk blk'.
(GenTx blk -&gt; Maybe (GenTx blk')) -&gt; InjectTx blk blk'
</span><span class="hs-identifier hs-var">InjectTx</span></span><span> </span><span class="annot"><span class="annottext">((GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
  -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
 -&gt; InjectTx
      (ShelleyBlock (TPraos c) (ShelleyEra c))
      (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
 -&gt; GenTx (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AllegraEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
-&gt; GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
-&gt; (GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AllegraEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
 -&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Either
         DecoderError
         ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
 -&gt; Either
      DecoderError
      ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Except
         DecoderError
         ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AllegraEra c)
-&gt; (:.:)
     GenTx (ShelleyBlock (TPraos c)) (PreviousEra (AllegraEra c))
-&gt; Except
     (TranslationError
        (AllegraEra c) (GenTx :.: ShelleyBlock (TPraos c)))
     ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (TPraos c)) (ShelleyEra c)
 -&gt; Except
      DecoderError
      ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (ShelleyEra c))
-&gt; GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Except
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (ShelleyEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span id="local-6989586621680281613"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxShelleyToAllegraWrapper"><span class="hs-identifier hs-type">translateValidatedTxShelleyToAllegraWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-539"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectValidatedTx</span></span><span>
</span><span id="line-541"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281613"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-543"></span><span id="translateValidatedTxShelleyToAllegraWrapper"><span class="annot"><span class="annottext">translateValidatedTxShelleyToAllegraWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectValidatedTx
  (ShelleyBlock (TPraos c) (ShelleyEra c))
  (ShelleyBlock (TPraos c) (AllegraEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxShelleyToAllegraWrapper"><span class="hs-identifier hs-var hs-var">translateValidatedTxShelleyToAllegraWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall blk blk'.
(WrapValidatedGenTx blk -&gt; Maybe (WrapValidatedGenTx blk'))
-&gt; InjectValidatedTx blk blk'
</span><span class="hs-identifier hs-var">InjectValidatedTx</span></span><span> </span><span class="annot"><span class="annottext">((WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
  -&gt; Maybe
       (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
 -&gt; InjectValidatedTx
      (ShelleyBlock (TPraos c) (ShelleyEra c))
      (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Maybe
         (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (ShelleyEra c))
     (ShelleyBlock (TPraos c) (AllegraEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
 -&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c)))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Maybe
         ((:.:)
            WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
 -&gt; Maybe
      ((:.:)
         WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Either
         DecoderError
         ((:.:)
            WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
 -&gt; Either
      DecoderError
      ((:.:)
         WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; Except
         DecoderError
         ((:.:)
            WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AllegraEra c)
-&gt; (:.:)
     WrapValidatedGenTx
     (ShelleyBlock (TPraos c))
     (PreviousEra (AllegraEra c))
-&gt; Except
     (TranslationError
        (AllegraEra c) (WrapValidatedGenTx :.: ShelleyBlock (TPraos c)))
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (ShelleyEra c)
 -&gt; Except
      DecoderError
      ((:.:)
         WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
    -&gt; (:.:)
         WrapValidatedGenTx (ShelleyBlock (TPraos c)) (ShelleyEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; Except
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapValidatedGenTx (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; (:.:)
     WrapValidatedGenTx (ShelleyBlock (TPraos c)) (ShelleyEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Shelley to Allegra
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span id="local-6989586621680281548"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateAllegraToMaryWrapper"><span class="hs-identifier hs-type">translateLedgerStateAllegraToMaryWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-551"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-553"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-554"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-557"></span><span id="translateLedgerStateAllegraToMaryWrapper"><span class="annot"><span class="annottext">translateLedgerStateAllegraToMaryWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateAllegraToMaryWrapper"><span class="hs-identifier hs-var hs-var">translateLedgerStateAllegraToMaryWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><span class="annottext">Translate
  LedgerState
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall {k} (f :: k -&gt; k -&gt; *) (x :: k) (y :: k) (h :: k -&gt; *).
f x y -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">ignoringBoth</span></span><span> </span><span class="annot"><span class="annottext">(Translate
   LedgerState
   (ShelleyBlock (TPraos c) (AllegraEra c))
   (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Translate LedgerState)
      (ShelleyBlock (TPraos c) (AllegraEra c))
      (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
 -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span> </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
  -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c)))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (TPraos c) (AllegraEra c))
      (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; (EpochNo
    -&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282584"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282584"><span class="hs-identifier hs-var">_epochNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-560"></span><span>        </span><span class="annot"><span class="annottext">(:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c)
-&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c)
 -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (MaryEra c)
-&gt; (:.:)
     LedgerState (ShelleyBlock (TPraos c)) (PreviousEra (MaryEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c)
forall era (f :: * -&gt; *).
(TranslateEra era f, TranslationError era f ~ Void) =&gt;
TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><span class="hs-identifier hs-var">SL.translateEra'</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c)
 -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AllegraEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Allegra to Mary
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span id="local-6989586621680281614"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxAllegraToMaryWrapper"><span class="hs-identifier hs-type">translateTxAllegraToMaryWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-567"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectTx</span></span><span>
</span><span id="line-569"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281614"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-571"></span><span id="translateTxAllegraToMaryWrapper"><span class="annot"><span class="annottext">translateTxAllegraToMaryWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxAllegraToMaryWrapper"><span class="hs-identifier hs-var hs-var">translateTxAllegraToMaryWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (MaryEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall blk blk'.
(GenTx blk -&gt; Maybe (GenTx blk')) -&gt; InjectTx blk blk'
</span><span class="hs-identifier hs-var">InjectTx</span></span><span> </span><span class="annot"><span class="annottext">((GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
  -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (MaryEra c))))
 -&gt; InjectTx
      (ShelleyBlock (TPraos c) (AllegraEra c))
      (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (MaryEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)
 -&gt; GenTx (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (MaryEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)
-&gt; GenTx (ShelleyBlock (TPraos c) (MaryEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (MaryEra c))))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (MaryEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
 -&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Either
         DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
 -&gt; Either
      DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Except
         DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (MaryEra c)
-&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (PreviousEra (MaryEra c))
-&gt; Except
     (TranslationError (MaryEra c) (GenTx :.: ShelleyBlock (TPraos c)))
     ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
 -&gt; Except
      DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Except
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span id="local-6989586621680281615"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxAllegraToMaryWrapper"><span class="hs-identifier hs-type">translateValidatedTxAllegraToMaryWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-575"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectValidatedTx</span></span><span>
</span><span id="line-577"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AllegraEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281615"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-579"></span><span id="translateValidatedTxAllegraToMaryWrapper"><span class="annot"><span class="annottext">translateValidatedTxAllegraToMaryWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
InjectValidatedTx
  (ShelleyBlock (TPraos c) (AllegraEra c))
  (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxAllegraToMaryWrapper"><span class="hs-identifier hs-var hs-var">translateValidatedTxAllegraToMaryWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall blk blk'.
(WrapValidatedGenTx blk -&gt; Maybe (WrapValidatedGenTx blk'))
-&gt; InjectValidatedTx blk blk'
</span><span class="hs-identifier hs-var">InjectValidatedTx</span></span><span> </span><span class="annot"><span class="annottext">((WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
  -&gt; Maybe
       (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))))
 -&gt; InjectValidatedTx
      (ShelleyBlock (TPraos c) (AllegraEra c))
      (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Maybe
         (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AllegraEra c))
     (ShelleyBlock (TPraos c) (MaryEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)
 -&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c)))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; Maybe (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Maybe
         ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Maybe (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
 -&gt; Maybe
      ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Either
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
 -&gt; Either
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; Except
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (MaryEra c)
-&gt; (:.:)
     WrapValidatedGenTx
     (ShelleyBlock (TPraos c))
     (PreviousEra (MaryEra c))
-&gt; Except
     (TranslationError
        (MaryEra c) (WrapValidatedGenTx :.: ShelleyBlock (TPraos c)))
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
 -&gt; Except
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
    -&gt; (:.:)
         WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; Except
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapValidatedGenTx (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; (:.:)
     WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AllegraEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Mary to Alonzo
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span id="local-6989586621680281549"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateMaryToAlonzoWrapper"><span class="hs-identifier hs-type">translateLedgerStateMaryToAlonzoWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-587"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-589"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-590"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281549"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-593"></span><span id="translateLedgerStateMaryToAlonzoWrapper"><span class="annot"><span class="annottext">translateLedgerStateMaryToAlonzoWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (MaryEra c))
  (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateMaryToAlonzoWrapper"><span class="hs-identifier hs-var hs-var">translateLedgerStateMaryToAlonzoWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><span class="annottext">(WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
  -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; Translate
       LedgerState
       (ShelleyBlock (TPraos c) (MaryEra c))
       (ShelleyBlock (TPraos c) (AlonzoEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Translate LedgerState)
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; (WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Translate
         LedgerState
         (ShelleyBlock (TPraos c) (MaryEra c))
         (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282622"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (MaryEra c))
</span><a href="#local-6989586621680282622"><span class="hs-identifier hs-var">_cfgMary</span></a></span></span><span> </span><span id="local-6989586621680282623"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282623"><span class="hs-identifier hs-var">cfgAlonzo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-595"></span><span>      </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span> </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
  -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c)))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; (EpochNo
    -&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282624"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282624"><span class="hs-identifier hs-var">_epochNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-596"></span><span>        </span><span class="annot"><span class="annottext">(:.:) LedgerState (ShelleyBlock (TPraos c)) (AlonzoEra c)
-&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (TPraos c)) (AlonzoEra c)
 -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
-&gt; (:.:)
     LedgerState (ShelleyBlock (TPraos c)) (PreviousEra (AlonzoEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AlonzoEra c)
forall era (f :: * -&gt; *).
(TranslateEra era f, TranslationError era f ~ Void) =&gt;
TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><span class="hs-identifier hs-var">SL.translateEra'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; TranslationContext (AlonzoEra c)
forall c.
WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; TranslationContext (AlonzoEra c)
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getAlonzoTranslationContext"><span class="hs-identifier hs-var">getAlonzoTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282623"><span class="hs-identifier hs-var">cfgAlonzo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c)
 -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (AlonzoEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (TPraos c)) (MaryEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span id="local-6989586621680281622"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getAlonzoTranslationContext"><span class="hs-identifier hs-type">getAlonzoTranslationContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-599"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281622"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281622"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281622"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-601"></span><span id="getAlonzoTranslationContext"><span class="annot"><span class="annottext">getAlonzoTranslationContext :: forall c.
WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; TranslationContext (AlonzoEra c)
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getAlonzoTranslationContext"><span class="hs-identifier hs-var hs-var">getAlonzoTranslationContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><span class="annottext">ShelleyLedgerConfig (AlonzoEra c)
-&gt; TranslationContext (AlonzoEra c)
ShelleyLedgerConfig (AlonzoEra c) -&gt; AlonzoGenesis
forall era. ShelleyLedgerConfig era -&gt; TranslationContext era
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerTranslationContext"><span class="hs-identifier hs-var">shelleyLedgerTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyLedgerConfig (AlonzoEra c) -&gt; AlonzoGenesis)
-&gt; (WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; ShelleyLedgerConfig (AlonzoEra c))
-&gt; WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; AlonzoGenesis
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; LedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; ShelleyLedgerConfig (AlonzoEra c)
forall blk. WrapLedgerConfig blk -&gt; LedgerConfig blk
</span><span class="hs-identifier hs-var">unwrapLedgerConfig</span></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span id="local-6989586621680281623"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxMaryToAlonzoWrapper"><span class="hs-identifier hs-type">translateTxMaryToAlonzoWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-605"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectTx</span></span><span>
</span><span id="line-608"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281623"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-610"></span><span id="translateTxMaryToAlonzoWrapper"><span class="annot"><span class="annottext">translateTxMaryToAlonzoWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
TranslationContext (AlonzoEra c)
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxMaryToAlonzoWrapper"><span class="hs-identifier hs-var hs-var">translateTxMaryToAlonzoWrapper</span></a></span></span><span> </span><span id="local-6989586621680282635"><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282635"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenTx (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall blk blk'.
(GenTx blk -&gt; Maybe (GenTx blk')) -&gt; InjectTx blk blk'
</span><span class="hs-identifier hs-var">InjectTx</span></span><span> </span><span class="annot"><span class="annottext">((GenTx (ShelleyBlock (TPraos c) (MaryEra c))
  -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
 -&gt; InjectTx
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)
 -&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)
-&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
-&gt; (GenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Maybe (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
 -&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Either
         DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
 -&gt; Either
      DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Except
         DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
-&gt; (:.:)
     GenTx (ShelleyBlock (TPraos c)) (PreviousEra (AlonzoEra c))
-&gt; Except
     (TranslationError
        (AlonzoEra c) (GenTx :.: ShelleyBlock (TPraos c)))
     ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282635"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)
 -&gt; Except
      DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; GenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Except
     DecoderError ((:.:) GenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; (:.:) GenTx (ShelleyBlock (TPraos c)) (MaryEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxMaryToAlonzoWrapper"><span class="hs-identifier hs-type">translateValidatedTxMaryToAlonzoWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-614"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281624"><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-615"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSignable</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectValidatedTx</span></span><span>
</span><span id="line-618"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaryEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281624"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span id="translateValidatedTxMaryToAlonzoWrapper"><span class="annot"><span class="annottext">translateValidatedTxMaryToAlonzoWrapper :: forall c.
(PraosCrypto c, DSignable c (Hash c EraIndependentTxBody)) =&gt;
TranslationContext (AlonzoEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxMaryToAlonzoWrapper"><span class="hs-identifier hs-var hs-var">translateValidatedTxMaryToAlonzoWrapper</span></a></span></span><span> </span><span id="local-6989586621680282643"><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282643"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall blk blk'.
(WrapValidatedGenTx blk -&gt; Maybe (WrapValidatedGenTx blk'))
-&gt; InjectValidatedTx blk blk'
</span><span class="hs-identifier hs-var">InjectValidatedTx</span></span><span> </span><span class="annot"><span class="annottext">((WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
  -&gt; Maybe
       (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
 -&gt; InjectValidatedTx
      (ShelleyBlock (TPraos c) (MaryEra c))
      (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Maybe
         (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (MaryEra c))
     (ShelleyBlock (TPraos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)
 -&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Maybe
         ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
 -&gt; Maybe
      ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Either
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
 -&gt; Either
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; Except
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
-&gt; (:.:)
     WrapValidatedGenTx
     (ShelleyBlock (TPraos c))
     (PreviousEra (AlonzoEra c))
-&gt; Except
     (TranslationError
        (AlonzoEra c) (WrapValidatedGenTx :.: ShelleyBlock (TPraos c)))
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext (AlonzoEra c)
</span><a href="#local-6989586621680282643"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)
 -&gt; Except
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
    -&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; Except
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (AlonzoEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapValidatedGenTx (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (TPraos c)) (MaryEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Alonzo to Babbage
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span id="local-6989586621680281550"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateAlonzoToBabbageWrapper"><span class="hs-identifier hs-type">translateLedgerStateAlonzoToBabbageWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-628"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281550"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TPraos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281550"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-630"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-631"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281550"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281550"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281550"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281550"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-634"></span><span id="translateLedgerStateAlonzoToBabbageWrapper"><span class="annot"><span class="annottext">translateLedgerStateAlonzoToBabbageWrapper :: forall c.
(PraosCrypto c, PraosCrypto c) =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (TPraos c) (AlonzoEra c))
  (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateAlonzoToBabbageWrapper"><span class="hs-identifier hs-var hs-var">translateLedgerStateAlonzoToBabbageWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-635"></span><span>    </span><span class="annot"><span class="annottext">(WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; Translate
       LedgerState
       (ShelleyBlock (TPraos c) (AlonzoEra c))
       (ShelleyBlock (Praos c) (BabbageEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Translate LedgerState)
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; (WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Translate
         LedgerState
         (ShelleyBlock (TPraos c) (AlonzoEra c))
         (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282667"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282667"><span class="hs-identifier hs-var">_cfgAlonzo</span></a></span></span><span> </span><span id="local-6989586621680282668"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="#local-6989586621680282668"><span class="hs-identifier hs-var">_cfgBabbage</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-636"></span><span>      </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span> </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c)))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; (EpochNo
    -&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282669"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282669"><span class="hs-identifier hs-var">_epochNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-637"></span><span>        </span><span class="annot"><span class="annottext">(:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
-&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
 -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
-&gt; (:.:)
     LedgerState (ShelleyBlock (Praos c)) (PreviousEra (BabbageEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
forall era (f :: * -&gt; *).
(TranslateEra era f, TranslationError era f ~ Void) =&gt;
TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><span class="hs-identifier hs-var">SL.translateEra'</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (Praos c)) (AlonzoEra c)
 -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (AlonzoEra c))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (Praos c) (AlonzoEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (AlonzoEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState (ShelleyBlock (Praos c) (AlonzoEra c))
 -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (AlonzoEra c))
-&gt; (LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; LedgerState (ShelleyBlock (Praos c) (AlonzoEra c)))
-&gt; LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (AlonzoEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (AlonzoEra c))
forall c.
LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (AlonzoEra c))
</span><a href="#local-6989586621680282670"><span class="hs-identifier hs-var">transPraosLS</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621680281792"><span class="annot"><a href="#local-6989586621680282670"><span class="hs-identifier hs-type">transPraosLS</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-640"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281792"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281792"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-641"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281792"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281792"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621680282670"><span class="annot"><span class="annottext">transPraosLS :: forall c.
LedgerState (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (AlonzoEra c))
</span><a href="#local-6989586621680282670"><span class="hs-identifier hs-var hs-var">transPraosLS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyLedgerState"><span class="hs-identifier hs-type">ShelleyLedgerState</span></a></span><span> </span><span id="local-6989586621680282675"><span class="annot"><span class="annottext">WithOrigin (ShelleyTip (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282675"><span class="hs-identifier hs-var">wo</span></a></span></span><span> </span><span id="local-6989586621680282676"><span class="annot"><span class="annottext">NewEpochState (AlonzoEra c)
</span><a href="#local-6989586621680282676"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621680282677"><span class="annot"><span class="annottext">ShelleyTransition
</span><a href="#local-6989586621680282677"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-643"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#ShelleyLedgerState"><span class="hs-identifier hs-type">ShelleyLedgerState</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">shelleyLedgerTip :: WithOrigin (ShelleyTip (Praos c) (AlonzoEra c))
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerTip"><span class="hs-identifier hs-var">shelleyLedgerTip</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ShelleyTip (TPraos c) (AlonzoEra c)
 -&gt; ShelleyTip (Praos c) (AlonzoEra c))
-&gt; WithOrigin (ShelleyTip (TPraos c) (AlonzoEra c))
-&gt; WithOrigin (ShelleyTip (Praos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; WithOrigin a -&gt; WithOrigin b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyTip (TPraos c) (AlonzoEra c)
-&gt; ShelleyTip (Praos c) (AlonzoEra c)
forall proto era proto' era'.
(HeaderHash (ShelleyBlock proto era)
 ~ HeaderHash (ShelleyBlock proto' era')) =&gt;
ShelleyTip proto era -&gt; ShelleyTip proto' era'
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#castShelleyTip"><span class="hs-identifier hs-var">castShelleyTip</span></a></span><span> </span><span class="annot"><span class="annottext">WithOrigin (ShelleyTip (TPraos c) (AlonzoEra c))
</span><a href="#local-6989586621680282675"><span class="hs-identifier hs-var">wo</span></a></span><span>
</span><span id="line-645"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shelleyLedgerState :: NewEpochState (AlonzoEra c)
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerState"><span class="hs-identifier hs-var">shelleyLedgerState</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState (AlonzoEra c)
</span><a href="#local-6989586621680282676"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-646"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shelleyLedgerTransition :: ShelleyTransition
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerTransition"><span class="hs-identifier hs-var">shelleyLedgerTransition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyTransition
</span><a href="#local-6989586621680282677"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-647"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span id="local-6989586621680281625"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxAlonzoToBabbageWrapper"><span class="hs-identifier hs-type">translateTxAlonzoToBabbageWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-650"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281625"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281625"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectTx</span></span><span>
</span><span id="line-653"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281625"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281625"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281625"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281625"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-655"></span><span id="translateTxAlonzoToBabbageWrapper"><span class="annot"><span class="annottext">translateTxAlonzoToBabbageWrapper :: forall c.
PraosCrypto c =&gt;
TranslationContext (BabbageEra c)
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxAlonzoToBabbageWrapper"><span class="hs-identifier hs-var hs-var">translateTxAlonzoToBabbageWrapper</span></a></span></span><span> </span><span id="local-6989586621680282685"><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
</span><a href="#local-6989586621680282685"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (BabbageEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall blk blk'.
(GenTx blk -&gt; Maybe (GenTx blk')) -&gt; InjectTx blk blk'
</span><span class="hs-identifier hs-var">InjectTx</span></span><span> </span><span class="annot"><span class="annottext">((GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (BabbageEra c))))
 -&gt; InjectTx
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (BabbageEra c))))
-&gt; InjectTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)
 -&gt; GenTx (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; Maybe (GenTx (ShelleyBlock (Praos c) (BabbageEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)
-&gt; GenTx (ShelleyBlock (Praos c) (BabbageEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (BabbageEra c))))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Maybe (GenTx (ShelleyBlock (Praos c) (BabbageEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
 -&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Either
         DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
 -&gt; Either
      DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Except
         DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
-&gt; (:.:)
     GenTx (ShelleyBlock (Praos c)) (PreviousEra (BabbageEra c))
-&gt; Except
     (TranslationError
        (BabbageEra c) (GenTx :.: ShelleyBlock (Praos c)))
     ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
</span><a href="#local-6989586621680282685"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (Praos c)) (AlonzoEra c)
 -&gt; Except
      DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (AlonzoEra c))
-&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Except
     DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenTx (ShelleyBlock (Praos c) (AlonzoEra c))
-&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (AlonzoEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(GenTx (ShelleyBlock (Praos c) (AlonzoEra c))
 -&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (AlonzoEra c))
-&gt; (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; GenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
-&gt; GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (AlonzoEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; GenTx (ShelleyBlock (Praos c) (AlonzoEra c))
forall c.
GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; GenTx (ShelleyBlock (Praos c) (AlonzoEra c))
</span><a href="#local-6989586621680282686"><span class="hs-identifier hs-var">transPraosTx</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-658"></span><span>    </span><span id="local-6989586621680281801"><span class="annot"><a href="#local-6989586621680282686"><span class="hs-identifier hs-type">transPraosTx</span></a></span><span>
</span><span id="line-659"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281801"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281801"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281801"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281801"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621680282686"><span class="annot"><span class="annottext">transPraosTx :: forall c.
GenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; GenTx (ShelleyBlock (Praos c) (AlonzoEra c))
</span><a href="#local-6989586621680282686"><span class="hs-identifier hs-var hs-var">transPraosTx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Mempool.html#ShelleyTx"><span class="hs-identifier hs-type">ShelleyTx</span></a></span><span> </span><span id="local-6989586621680282689"><span class="annot"><span class="annottext">TxId (EraCrypto (AlonzoEra c))
</span><a href="#local-6989586621680282689"><span class="hs-identifier hs-var">ti</span></a></span></span><span> </span><span id="local-6989586621680282690"><span class="annot"><span class="annottext">Tx (AlonzoEra c)
</span><a href="#local-6989586621680282690"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxId (EraCrypto (AlonzoEra c))
-&gt; Tx (AlonzoEra c) -&gt; GenTx (ShelleyBlock (Praos c) (AlonzoEra c))
forall proto era.
TxId (EraCrypto era) -&gt; Tx era -&gt; GenTx (ShelleyBlock proto era)
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Mempool.html#ShelleyTx"><span class="hs-identifier hs-var">ShelleyTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxId (EraCrypto (AlonzoEra c))
</span><a href="#local-6989586621680282689"><span class="hs-identifier hs-var">ti</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlonzoTx (AlonzoEra c) -&gt; AlonzoTx (AlonzoEra c)
forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#coerce"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">Tx (AlonzoEra c)
AlonzoTx (AlonzoEra c)
</span><a href="#local-6989586621680282690"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxAlonzoToBabbageWrapper"><span class="hs-identifier hs-type">translateValidatedTxAlonzoToBabbageWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-664"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281626"><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-665"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectValidatedTx</span></span><span>
</span><span id="line-668"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span id="translateValidatedTxAlonzoToBabbageWrapper"><span class="annot"><span class="annottext">translateValidatedTxAlonzoToBabbageWrapper :: forall c.
PraosCrypto c =&gt;
TranslationContext (BabbageEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxAlonzoToBabbageWrapper"><span class="hs-identifier hs-var hs-var">translateValidatedTxAlonzoToBabbageWrapper</span></a></span></span><span> </span><span id="local-6989586621680282697"><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
</span><a href="#local-6989586621680282697"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall blk blk'.
(WrapValidatedGenTx blk -&gt; Maybe (WrapValidatedGenTx blk'))
-&gt; InjectValidatedTx blk blk'
</span><span class="hs-identifier hs-var">InjectValidatedTx</span></span><span> </span><span class="annot"><span class="annottext">((WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
  -&gt; Maybe
       (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))))
 -&gt; InjectValidatedTx
      (ShelleyBlock (TPraos c) (AlonzoEra c))
      (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Maybe
         (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (TPraos c) (AlonzoEra c))
     (ShelleyBlock (Praos c) (BabbageEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-671"></span><span>  </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)
 -&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><span class="annottext">(Maybe
   ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Maybe
         ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><span class="annottext">(Either
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
 -&gt; Maybe
      ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Either
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="annot"><span class="annottext">(Except
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
 -&gt; Either
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; Except
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
-&gt; (:.:)
     WrapValidatedGenTx
     (ShelleyBlock (Praos c))
     (PreviousEra (BabbageEra c))
-&gt; Except
     (TranslationError
        (BabbageEra c) (WrapValidatedGenTx :.: ShelleyBlock (Praos c)))
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext (BabbageEra c)
</span><a href="#local-6989586621680282697"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (AlonzoEra c)
 -&gt; Except
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (AlonzoEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; Except
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c))
-&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (AlonzoEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><span class="annottext">(WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c))
 -&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (AlonzoEra c))
-&gt; (WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
    -&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (AlonzoEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c))
</span><a href="#local-6989586621680282698"><span class="hs-identifier hs-var">transPraosValidatedTx</span></a></span><span>
</span><span id="line-677"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-678"></span><span>  </span><span class="annot"><a href="#local-6989586621680282698"><span class="hs-identifier hs-type">transPraosValidatedTx</span></a></span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapValidatedGenTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TPraos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapValidatedGenTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlonzoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281626"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>  </span><span id="local-6989586621680282698"><span class="annot"><span class="annottext">transPraosValidatedTx :: WrapValidatedGenTx (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c))
</span><a href="#local-6989586621680282698"><span class="hs-identifier hs-var hs-var">transPraosValidatedTx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WrapValidatedGenTx</span></span><span> </span><span id="local-6989586621680282700"><span class="annot"><span class="annottext">Validated (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
</span><a href="#local-6989586621680282700"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Validated (GenTx (ShelleyBlock (TPraos c) (AlonzoEra c)))
</span><a href="#local-6989586621680282700"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Mempool.html#ShelleyValidatedTx"><span class="hs-identifier hs-type">ShelleyValidatedTx</span></a></span><span> </span><span id="local-6989586621680282702"><span class="annot"><span class="annottext">TxId (EraCrypto (AlonzoEra c))
</span><a href="#local-6989586621680282702"><span class="hs-identifier hs-var">txid</span></a></span></span><span> </span><span id="local-6989586621680282703"><span class="annot"><span class="annottext">Validated (Tx (AlonzoEra c))
</span><a href="#local-6989586621680282703"><span class="hs-identifier hs-var">vtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Validated (GenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c))
forall blk. Validated (GenTx blk) -&gt; WrapValidatedGenTx blk
</span><span class="hs-identifier hs-var">WrapValidatedGenTx</span></span><span> </span><span class="annot"><span class="annottext">(Validated (GenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
 -&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
-&gt; Validated (GenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (AlonzoEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span class="annot"><span class="annottext">TxId (EraCrypto (AlonzoEra c))
-&gt; Validated (Tx (AlonzoEra c))
-&gt; Validated (GenTx (ShelleyBlock (Praos c) (AlonzoEra c)))
forall proto era.
TxId (EraCrypto era)
-&gt; Validated (Tx era) -&gt; Validated (GenTx (ShelleyBlock proto era))
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Mempool.html#ShelleyValidatedTx"><span class="hs-identifier hs-var">ShelleyValidatedTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxId (EraCrypto (AlonzoEra c))
</span><a href="#local-6989586621680282702"><span class="hs-identifier hs-var">txid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Validated (AlonzoTx (AlonzoEra c))
-&gt; Validated (AlonzoTx (AlonzoEra c))
forall a b. Coercible a b =&gt; Validated a -&gt; Validated b
</span><span class="hs-identifier hs-var">SL.coerceValidated</span></span><span> </span><span class="annot"><span class="annottext">Validated (Tx (AlonzoEra c))
Validated (AlonzoTx (AlonzoEra c))
</span><a href="#local-6989586621680282703"><span class="hs-identifier hs-var">vtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Translation from Babbage to Conway
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateBabbageToConwayWrapper"><span class="hs-identifier hs-type">translateLedgerStateBabbageToConwayWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-690"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281551"><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequiringBoth</span></span><span>
</span><span id="line-692"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span>
</span><span id="line-693"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Translate</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span id="translateLedgerStateBabbageToConwayWrapper"><span class="annot"><span class="annottext">translateLedgerStateBabbageToConwayWrapper :: forall c.
PraosCrypto c =&gt;
RequiringBoth
  WrapLedgerConfig
  (Translate LedgerState)
  (ShelleyBlock (Praos c) (BabbageEra c))
  (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateLedgerStateBabbageToConwayWrapper"><span class="hs-identifier hs-var hs-var">translateLedgerStateBabbageToConwayWrapper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-697"></span><span>    </span><span class="annot"><span class="annottext">(WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall {k} (h :: k -&gt; *) (f :: k -&gt; k -&gt; *) (x :: k) (y :: k).
(h x -&gt; h y -&gt; f x y) -&gt; RequiringBoth h f x y
</span><span class="hs-identifier hs-var">RequireBoth</span></span><span> </span><span class="annot"><span class="annottext">((WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
  -&gt; Translate
       LedgerState
       (ShelleyBlock (Praos c) (BabbageEra c))
       (ShelleyBlock (Praos c) (ConwayEra c)))
 -&gt; RequiringBoth
      WrapLedgerConfig
      (Translate LedgerState)
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; (WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
    -&gt; Translate
         LedgerState
         (ShelleyBlock (Praos c) (BabbageEra c))
         (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; RequiringBoth
     WrapLedgerConfig
     (Translate LedgerState)
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282726"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="#local-6989586621680282726"><span class="hs-identifier hs-var">cfgBabbage</span></a></span></span><span> </span><span id="local-6989586621680282727"><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="#local-6989586621680282727"><span class="hs-identifier hs-var">cfgConway</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-698"></span><span>      </span><span class="annot"><span class="annottext">(EpochNo
 -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; LedgerState (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall (f :: * -&gt; *) x y.
(EpochNo -&gt; f x -&gt; f y) -&gt; Translate f x y
</span><span class="hs-identifier hs-var">Translate</span></span><span> </span><span class="annot"><span class="annottext">((EpochNo
  -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; LedgerState (ShelleyBlock (Praos c) (ConwayEra c)))
 -&gt; Translate
      LedgerState
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; (EpochNo
    -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; LedgerState (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; Translate
     LedgerState
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680282728"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282728"><span class="hs-identifier hs-var">epochNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-699"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- It would be cleaner to just pass in the entire 'Bound' instead of</span><span>
</span><span id="line-700"></span><span>            </span><span class="hs-comment">-- just the 'EpochNo'.</span><span>
</span><span id="line-701"></span><span>            </span><span id="local-6989586621680282729"><span class="annot"><span class="annottext">firstSlotNewEra :: SlotNo
</span><a href="#local-6989586621680282729"><span class="hs-identifier hs-var hs-var">firstSlotNewEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity SlotNo -&gt; SlotNo
forall a. Identity a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.Identity.html#runIdentity"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">(Identity SlotNo -&gt; SlotNo) -&gt; Identity SlotNo -&gt; SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochInfo Identity -&gt; EpochNo -&gt; Identity SlotNo
forall (m :: * -&gt; *).
HasCallStack =&gt;
EpochInfo m -&gt; EpochNo -&gt; m SlotNo
</span><span class="hs-identifier hs-var">epochInfoFirst</span></span><span> </span><span class="annot"><span class="annottext">EpochInfo Identity
</span><a href="#local-6989586621680282731"><span class="hs-identifier hs-var">ei</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621680282728"><span class="hs-identifier hs-var">epochNo</span></a></span><span>
</span><span id="line-702"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-703"></span><span>                </span><span id="local-6989586621680282731"><span class="annot"><span class="annottext">ei :: EpochInfo Identity
</span><a href="#local-6989586621680282731"><span class="hs-identifier hs-var hs-var">ei</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>                    </span><span class="annot"><span class="annottext">Globals -&gt; EpochInfo Identity
</span><span class="hs-identifier hs-var">SL.epochInfoPure</span></span><span>
</span><span id="line-705"></span><span>                  </span><span class="annot"><span class="annottext">(Globals -&gt; EpochInfo Identity) -&gt; Globals -&gt; EpochInfo Identity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ConwayEra c) -&gt; Globals
forall era. ShelleyLedgerConfig era -&gt; Globals
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerGlobals"><span class="hs-identifier hs-var">shelleyLedgerGlobals</span></a></span><span>
</span><span id="line-706"></span><span>                  </span><span class="annot"><span class="annottext">(ShelleyLedgerConfig (ConwayEra c) -&gt; Globals)
-&gt; ShelleyLedgerConfig (ConwayEra c) -&gt; Globals
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; LedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
forall blk. WrapLedgerConfig blk -&gt; LedgerConfig blk
</span><span class="hs-identifier hs-var">unwrapLedgerConfig</span></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="#local-6989586621680282727"><span class="hs-identifier hs-var">cfgConway</span></a></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span>            </span><span class="hs-comment">-- HACK to make sure protocol parameters get properly updated on the</span><span>
</span><span id="line-709"></span><span>            </span><span class="hs-comment">-- era transition from Babbage to Conway. This will be replaced by a</span><span>
</span><span id="line-710"></span><span>            </span><span class="hs-comment">-- more principled refactoring in the future.</span><span>
</span><span id="line-711"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-712"></span><span>            </span><span class="hs-comment">-- Pre-Conway, protocol parameters (like the ledger protocol</span><span>
</span><span id="line-713"></span><span>            </span><span class="hs-comment">-- version) were updated by the UPEC rule, which is executed while</span><span>
</span><span id="line-714"></span><span>            </span><span class="hs-comment">-- ticking across an epoch boundary. If sufficiently many Genesis</span><span>
</span><span id="line-715"></span><span>            </span><span class="hs-comment">-- keys submitted the same update proposal, it will update the</span><span>
</span><span id="line-716"></span><span>            </span><span class="hs-comment">-- governance state accordingly.</span><span>
</span><span id="line-717"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-718"></span><span>            </span><span class="hs-comment">-- Conway has a completely different governance scheme (CIP-1694),</span><span>
</span><span id="line-719"></span><span>            </span><span class="hs-comment">-- and thus has no representation for pre-Conway update proposals,</span><span>
</span><span id="line-720"></span><span>            </span><span class="hs-comment">-- which are hence discarded by 'SL.translateEra'' below. Therefore,</span><span>
</span><span id="line-721"></span><span>            </span><span class="hs-comment">-- we monkey-patch the governance state by ticking across the</span><span>
</span><span id="line-722"></span><span>            </span><span class="hs-comment">-- era/epoch boundary using Babbage logic, and set the governance</span><span>
</span><span id="line-723"></span><span>            </span><span class="hs-comment">-- state to the updated one /before/ translating.</span><span>
</span><span id="line-724"></span><span>            </span><span id="local-6989586621680281823"><span class="annot"><a href="#local-6989586621680282733"><span class="hs-identifier hs-type">patchGovState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-725"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281823"><span class="hs-identifier hs-type">proto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LedgerState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680281823"><span class="hs-identifier hs-type">proto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-727"></span><span>            </span><span id="local-6989586621680282733"><span class="annot"><span class="annottext">patchGovState :: forall proto.
LedgerState (ShelleyBlock proto (BabbageEra c))
-&gt; LedgerState (ShelleyBlock proto (BabbageEra c))
</span><a href="#local-6989586621680282733"><span class="hs-identifier hs-var hs-var">patchGovState</span></a></span></span><span> </span><span id="local-6989586621680282740"><span class="annot"><span class="annottext">LedgerState (ShelleyBlock proto (BabbageEra c))
</span><a href="#local-6989586621680282740"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-728"></span><span>                </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock proto (BabbageEra c))
</span><a href="#local-6989586621680282740"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerState"><span class="hs-identifier hs-var">shelleyLedgerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerState"><span class="hs-identifier hs-var">shelleyLedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680282740"><span class="hs-identifier hs-type">st</span></a></span><span>
</span><span id="line-729"></span><span>                       </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Function.html#%26"><span class="hs-operator hs-type">&amp;</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.newEpochStateGovStateL</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.~</span></span><span> </span><span class="annot"><a href="#local-6989586621680282742"><span class="hs-identifier hs-type">newGovState</span></a></span><span>
</span><span id="line-730"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-731"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-732"></span><span>                </span><span id="local-6989586621680282742"><span class="annot"><span class="annottext">newGovState :: ShelleyGovState (BabbageEra c)
</span><a href="#local-6989586621680282742"><span class="hs-identifier hs-var hs-var">newGovState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-733"></span><span>                    </span><span class="annot"><span class="annottext">Getting
  (ShelleyGovState (BabbageEra c))
  (NewEpochState (BabbageEra c))
  (ShelleyGovState (BabbageEra c))
-&gt; NewEpochState (BabbageEra c) -&gt; ShelleyGovState (BabbageEra c)
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (ShelleyGovState (BabbageEra c))
  (NewEpochState (BabbageEra c))
  (ShelleyGovState (BabbageEra c))
(GovState (BabbageEra c)
 -&gt; Const
      (ShelleyGovState (BabbageEra c)) (GovState (BabbageEra c)))
-&gt; NewEpochState (BabbageEra c)
-&gt; Const
     (ShelleyGovState (BabbageEra c)) (NewEpochState (BabbageEra c))
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><span class="hs-identifier hs-var">SL.newEpochStateGovStateL</span></span><span>
</span><span id="line-734"></span><span>                  </span><span class="annot"><span class="annottext">(NewEpochState (BabbageEra c) -&gt; ShelleyGovState (BabbageEra c))
-&gt; (LedgerState (ShelleyBlock proto (BabbageEra c))
    -&gt; NewEpochState (BabbageEra c))
-&gt; LedgerState (ShelleyBlock proto (BabbageEra c))
-&gt; ShelleyGovState (BabbageEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ticked (LedgerState (ShelleyBlock proto (BabbageEra c)))
-&gt; NewEpochState (BabbageEra c)
forall proto era.
Ticked (LedgerState (ShelleyBlock proto era)) -&gt; NewEpochState era
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#tickedShelleyLedgerState"><span class="hs-identifier hs-var">tickedShelleyLedgerState</span></a></span><span>
</span><span id="line-735"></span><span>                  </span><span class="annot"><span class="annottext">(Ticked (LedgerState (ShelleyBlock proto (BabbageEra c)))
 -&gt; NewEpochState (BabbageEra c))
-&gt; (LedgerState (ShelleyBlock proto (BabbageEra c))
    -&gt; Ticked (LedgerState (ShelleyBlock proto (BabbageEra c))))
-&gt; LedgerState (ShelleyBlock proto (BabbageEra c))
-&gt; NewEpochState (BabbageEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerCfg (LedgerState (ShelleyBlock proto (BabbageEra c)))
-&gt; SlotNo
-&gt; LedgerState (ShelleyBlock proto (BabbageEra c))
-&gt; Ticked (LedgerState (ShelleyBlock proto (BabbageEra c)))
forall l. IsLedger l =&gt; LedgerCfg l -&gt; SlotNo -&gt; l -&gt; Ticked l
</span><span class="hs-identifier hs-var">applyChainTick</span></span><span>
</span><span id="line-736"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; LedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
forall blk. WrapLedgerConfig blk -&gt; LedgerConfig blk
</span><span class="hs-identifier hs-var">unwrapLedgerConfig</span></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (BabbageEra c))
</span><a href="#local-6989586621680282726"><span class="hs-identifier hs-var">cfgBabbage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>                      </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680282729"><span class="hs-identifier hs-var">firstSlotNewEra</span></a></span><span>
</span><span id="line-738"></span><span>                  </span><span class="annot"><span class="annottext">(LedgerState (ShelleyBlock proto (BabbageEra c))
 -&gt; ShelleyGovState (BabbageEra c))
-&gt; LedgerState (ShelleyBlock proto (BabbageEra c))
-&gt; ShelleyGovState (BabbageEra c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock proto (BabbageEra c))
</span><a href="#local-6989586621680282740"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>            </span><span class="hs-comment">-- The UPEC rule emits no ledger events, hence this hack is not</span><span>
</span><span id="line-741"></span><span>            </span><span class="hs-comment">-- swallowing anything.</span><span>
</span><span id="line-742"></span><span>            </span><span class="annot"><a href="#local-6989586621680282745"><span class="hs-identifier hs-type">_upecNoLedgerEvents</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-743"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">STS.Event</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Core.EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;UPEC&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281551"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Type.Equality.html#%3A~%3A"><span class="hs-operator hs-type">:~:</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Void"><span class="hs-identifier hs-type">Void</span></a></span><span>
</span><span id="line-744"></span><span>            </span><span id="local-6989586621680282745"><span class="annot"><span class="annottext">_upecNoLedgerEvents :: Event (EraRule &quot;UPEC&quot; (BabbageEra c)) :~: Void
</span><a href="#local-6989586621680282745"><span class="hs-identifier hs-var hs-var">_upecNoLedgerEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Void :~: Void
Event (EraRule &quot;UPEC&quot; (BabbageEra c)) :~: Void
forall {k} (a :: k). a :~: a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Type.Equality.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span>        </span><span class="hs-keyword">in</span><span>    </span><span class="annot"><span class="annottext">(:.:) LedgerState (ShelleyBlock (Praos c)) (ConwayEra c)
-&gt; LedgerState (ShelleyBlock (Praos c) (ConwayEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span>
</span><span id="line-747"></span><span>            </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (Praos c)) (ConwayEra c)
 -&gt; LedgerState (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; (LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
-&gt; (:.:)
     LedgerState (ShelleyBlock (Praos c)) (PreviousEra (ConwayEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (ConwayEra c)
forall era (f :: * -&gt; *).
(TranslateEra era f, TranslationError era f ~ Void) =&gt;
TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><span class="hs-identifier hs-var">SL.translateEra'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; TranslationContext (ConwayEra c)
forall c.
WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; TranslationContext (ConwayEra c)
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getConwayTranslationContext"><span class="hs-identifier hs-var">getConwayTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="#local-6989586621680282727"><span class="hs-identifier hs-var">cfgConway</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>            </span><span class="annot"><span class="annottext">((:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
 -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; (LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (ConwayEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-749"></span><span>            </span><span class="annot"><span class="annottext">(LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; (LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c)))
-&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; (:.:) LedgerState (ShelleyBlock (Praos c)) (BabbageEra c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; LedgerState (ShelleyBlock (Praos c) (BabbageEra c))
forall proto.
LedgerState (ShelleyBlock proto (BabbageEra c))
-&gt; LedgerState (ShelleyBlock proto (BabbageEra c))
</span><a href="#local-6989586621680282733"><span class="hs-identifier hs-var">patchGovState</span></a></span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span id="local-6989586621680281627"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getConwayTranslationContext"><span class="hs-identifier hs-type">getConwayTranslationContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-752"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">WrapLedgerConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281627"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281627"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281627"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-754"></span><span id="getConwayTranslationContext"><span class="annot"><span class="annottext">getConwayTranslationContext :: forall c.
WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; TranslationContext (ConwayEra c)
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#getConwayTranslationContext"><span class="hs-identifier hs-var hs-var">getConwayTranslationContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><span class="annottext">ShelleyLedgerConfig (ConwayEra c)
-&gt; TranslationContext (ConwayEra c)
ShelleyLedgerConfig (ConwayEra c) -&gt; ConwayGenesis c
forall era. ShelleyLedgerConfig era -&gt; TranslationContext era
</span><a href="Ouroboros.Consensus.Shelley.Ledger.Ledger.html#shelleyLedgerTranslationContext"><span class="hs-identifier hs-var">shelleyLedgerTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyLedgerConfig (ConwayEra c) -&gt; ConwayGenesis c)
-&gt; (WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
    -&gt; ShelleyLedgerConfig (ConwayEra c))
-&gt; WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; ConwayGenesis c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; LedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
WrapLedgerConfig (ShelleyBlock (Praos c) (ConwayEra c))
-&gt; ShelleyLedgerConfig (ConwayEra c)
forall blk. WrapLedgerConfig blk -&gt; LedgerConfig blk
</span><span class="hs-identifier hs-var">unwrapLedgerConfig</span></span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span id="local-6989586621680281628"><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxBabbageToConwayWrapper"><span class="hs-identifier hs-type">translateTxBabbageToConwayWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-758"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281628"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281628"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectTx</span></span><span>
</span><span id="line-761"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281628"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281628"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281628"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281628"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-763"></span><span id="translateTxBabbageToConwayWrapper"><span class="annot"><span class="annottext">translateTxBabbageToConwayWrapper :: forall c.
PraosCrypto c =&gt;
TranslationContext (ConwayEra c)
-&gt; InjectTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateTxBabbageToConwayWrapper"><span class="hs-identifier hs-var hs-var">translateTxBabbageToConwayWrapper</span></a></span></span><span> </span><span id="local-6989586621680282753"><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282753"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenTx (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (ConwayEra c))))
-&gt; InjectTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall blk blk'.
(GenTx blk -&gt; Maybe (GenTx blk')) -&gt; InjectTx blk blk'
</span><span class="hs-identifier hs-var">InjectTx</span></span><span> </span><span class="annot"><span class="annottext">((GenTx (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (ConwayEra c))))
 -&gt; InjectTx
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; (GenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (ConwayEra c))))
-&gt; InjectTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)
 -&gt; GenTx (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; Maybe (GenTx (ShelleyBlock (Praos c) (ConwayEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)
-&gt; GenTx (ShelleyBlock (Praos c) (ConwayEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
 -&gt; Maybe (GenTx (ShelleyBlock (Praos c) (ConwayEra c))))
-&gt; (GenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; GenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Maybe (GenTx (ShelleyBlock (Praos c) (ConwayEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
 -&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; (GenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Either
         DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; GenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Maybe ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
 -&gt; Either
      DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; (GenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Except
         DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; GenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Either
     DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
-&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (PreviousEra (ConwayEra c))
-&gt; Except
     (TranslationError (ConwayEra c) (GenTx :.: ShelleyBlock (Praos c)))
     ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282753"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)
 -&gt; Except
      DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; (GenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; GenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Except
     DecoderError ((:.:) GenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; (:.:) GenTx (ShelleyBlock (Praos c)) (BabbageEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="annot"><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxBabbageToConwayWrapper"><span class="hs-identifier hs-type">translateValidatedTxBabbageToConwayWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-767"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680281629"><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-768"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos.PraosCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SL.TranslationContext</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InjectValidatedTx</span></span><span>
</span><span id="line-771"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BabbageEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Shelley.Ledger.Block.html#ShelleyBlock"><span class="hs-identifier hs-type">ShelleyBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Praos</span></span><span> </span><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConwayEra</span></span><span> </span><span class="annot"><a href="#local-6989586621680281629"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span id="translateValidatedTxBabbageToConwayWrapper"><span class="annot"><span class="annottext">translateValidatedTxBabbageToConwayWrapper :: forall c.
PraosCrypto c =&gt;
TranslationContext (ConwayEra c)
-&gt; InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
</span><a href="Ouroboros.Consensus.Cardano.CanHardFork.html#translateValidatedTxBabbageToConwayWrapper"><span class="hs-identifier hs-var hs-var">translateValidatedTxBabbageToConwayWrapper</span></a></span></span><span> </span><span id="local-6989586621680282759"><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282759"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall blk blk'.
(WrapValidatedGenTx blk -&gt; Maybe (WrapValidatedGenTx blk'))
-&gt; InjectValidatedTx blk blk'
</span><span class="hs-identifier hs-var">InjectValidatedTx</span></span><span> </span><span class="annot"><span class="annottext">((WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
  -&gt; Maybe
       (WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c))))
 -&gt; InjectValidatedTx
      (ShelleyBlock (Praos c) (BabbageEra c))
      (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Maybe
         (WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c))))
-&gt; InjectValidatedTx
     (ShelleyBlock (Praos c) (BabbageEra c))
     (ShelleyBlock (Praos c) (ConwayEra c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-774"></span><span>    </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)
 -&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c)))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c)))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c))
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
 -&gt; Maybe
      (WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c))))
-&gt; (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Maybe
         ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Maybe
     (WrapValidatedGenTx (ShelleyBlock (Praos c) (ConwayEra c)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">eitherToMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
 -&gt; Maybe
      ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Either
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Maybe
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except
  DecoderError
  ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall e a. Except e a -&gt; Either e a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExcept"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except
   DecoderError
   ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
 -&gt; Either
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; Except
         DecoderError
         ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Either
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
-&gt; (:.:)
     WrapValidatedGenTx
     (ShelleyBlock (Praos c))
     (PreviousEra (ConwayEra c))
-&gt; Except
     (TranslationError
        (ConwayEra c) (WrapValidatedGenTx :.: ShelleyBlock (Praos c)))
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><span class="hs-identifier hs-var">SL.translateEra</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext (ConwayEra c)
</span><a href="#local-6989586621680282759"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)
 -&gt; Except
      DecoderError
      ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c)))
-&gt; (WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
    -&gt; (:.:)
         WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c))
-&gt; WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; Except
     DecoderError
     ((:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (ConwayEra c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WrapValidatedGenTx (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; (:.:) WrapValidatedGenTx (ShelleyBlock (Praos c)) (BabbageEra c)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span>
</span><span id="line-775"></span></pre></body></html>