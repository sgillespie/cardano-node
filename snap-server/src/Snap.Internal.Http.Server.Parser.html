<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP                #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MagicHash          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types         #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE Trustworthy        #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UnboxedTuples      #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Snap.Internal.Http.Server.Parser</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier">IRequest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#HttpParseException"><span class="hs-identifier">HttpParseException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#readChunkedTransferEncoding"><span class="hs-identifier">readChunkedTransferEncoding</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#writeChunkedTransferEncoding"><span class="hs-identifier">writeChunkedTransferEncoding</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#parseRequest"><span class="hs-identifier">parseRequest</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseFromStream</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseCookie</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseUrlEncoded</span></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdContentLength"><span class="hs-identifier">getStdContentLength</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdHost"><span class="hs-identifier">getStdHost</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdTransferEncoding"><span class="hs-identifier">getStdTransferEncoding</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdCookie"><span class="hs-identifier">getStdCookie</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdContentType"><span class="hs-identifier">getStdContentType</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdConnection"><span class="hs-identifier">getStdConnection</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Applicative</span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Exception.Type.html#Exception"><span class="hs-identifier">Exception</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#throwIO"><span class="hs-identifier">throwIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier">void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier">MonadIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.ByteString.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hexadecimal</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">takeTill</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.html"><span class="hs-identifier">Data.ByteString.Internal</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier">c2w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier">memchr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier">w2c</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_bytestring(0, 10, 6)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.html"><span class="hs-identifier">Data.ByteString.Internal</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier">accursedUnutterablePerformIO</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.ByteString.Internal</span><span>         </span><span class="hs-special">(</span><span class="hs-identifier">inlinePerformIO</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html"><span class="hs-identifier">Data.ByteString.Unsafe</span></a></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#sort"><span class="hs-identifier">sort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.html"><span class="hs-identifier">Data.Typeable</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Mutable</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MV</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.ForeignPtr.html"><span class="hs-identifier">Foreign.ForeignPtr</span></a></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier">withForeignPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#minusPtr"><span class="hs-identifier">minusPtr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier">nullPtr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#plusPtr"><span class="hs-identifier">plusPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span>                          </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#take"><span class="hs-identifier">take</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder.HTTP</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">chunkedTransferEncoding</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">chunkedTransferTerminator</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier">Builder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO.Streams</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">InputStream</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OutputStream</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Generator</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Streams</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Streams</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO.Streams.Attoparsec</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">parseFromStream</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Snap.Internal.Http.Types</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Method</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Snap.Internal.Parsing</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">crlf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseCookie</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseUrlEncoded</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeFromNat</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Snap.Types.Headers</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Headers</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Snap.Types.Headers</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-64"></span><span class="hs-keyword">newtype</span><span> </span><span id="StandardHeaders"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-var">StandardHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StandardHeaders"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-var">StandardHeaders</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">type</span><span> </span><span id="MStandardHeaders"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#MStandardHeaders"><span class="hs-identifier hs-var">MStandardHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MV.IOVector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#contentLengthTag"><span class="hs-identifier hs-type">contentLengthTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#hostTag"><span class="hs-identifier hs-type">hostTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#transferEncodingTag"><span class="hs-identifier hs-type">transferEncodingTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#cookieTag"><span class="hs-identifier hs-type">cookieTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#contentTypeTag"><span class="hs-identifier hs-type">contentTypeTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#connectionTag"><span class="hs-identifier hs-type">connectionTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#nStandardHeaders"><span class="hs-identifier hs-type">nStandardHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-71"></span><span id="contentLengthTag"><span class="annot"><span class="annottext">contentLengthTag :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#contentLengthTag"><span class="hs-identifier hs-var hs-var">contentLengthTag</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-72"></span><span id="hostTag"><span class="annot"><span class="annottext">hostTag :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#hostTag"><span class="hs-identifier hs-var hs-var">hostTag</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-73"></span><span id="transferEncodingTag"><span class="annot"><span class="annottext">transferEncodingTag :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#transferEncodingTag"><span class="hs-identifier hs-var hs-var">transferEncodingTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-74"></span><span id="cookieTag"><span class="annot"><span class="annottext">cookieTag :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#cookieTag"><span class="hs-identifier hs-var hs-var">cookieTag</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-75"></span><span id="contentTypeTag"><span class="annot"><span class="annottext">contentTypeTag :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#contentTypeTag"><span class="hs-identifier hs-var hs-var">contentTypeTag</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-76"></span><span id="connectionTag"><span class="annot"><span class="annottext">connectionTag :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#connectionTag"><span class="hs-identifier hs-var hs-var">connectionTag</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-77"></span><span id="nStandardHeaders"><span class="annot"><span class="annottext">nStandardHeaders :: Int
</span><a href="Snap.Internal.Http.Server.Parser.html#nStandardHeaders"><span class="hs-identifier hs-var hs-var">nStandardHeaders</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-type">findStdHeaderIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-82"></span><span id="findStdHeaderIndex"><span class="annot"><span class="annottext">findStdHeaderIndex :: ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var hs-var">findStdHeaderIndex</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;content-length&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#contentLengthTag"><span class="hs-identifier hs-var">contentLengthTag</span></a></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;host&quot;</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#hostTag"><span class="hs-identifier hs-var">hostTag</span></a></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;transfer-encoding&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#transferEncodingTag"><span class="hs-identifier hs-var">transferEncodingTag</span></a></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;cookie&quot;</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#cookieTag"><span class="hs-identifier hs-var">cookieTag</span></a></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;content-type&quot;</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#contentTypeTag"><span class="hs-identifier hs-var">contentTypeTag</span></a></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;connection&quot;</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#connectionTag"><span class="hs-identifier hs-var">connectionTag</span></a></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdContentLength"><span class="hs-identifier hs-type">getStdContentLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdHost"><span class="hs-identifier hs-type">getStdHost</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdTransferEncoding"><span class="hs-identifier hs-type">getStdTransferEncoding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdCookie"><span class="hs-identifier hs-type">getStdCookie</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdConnection"><span class="hs-identifier hs-type">getStdConnection</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#getStdContentType"><span class="hs-identifier hs-type">getStdContentType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-94"></span><span id="getStdContentLength"><span class="annot"><span class="annottext">getStdContentLength :: StandardHeaders -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#getStdContentLength"><span class="hs-identifier hs-var hs-var">getStdContentLength</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span id="local-6989586621679097841"><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097841"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; Int -&gt; Maybe ByteString
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097841"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#contentLengthTag"><span class="hs-identifier hs-var">contentLengthTag</span></a></span><span>
</span><span id="line-95"></span><span id="getStdHost"><span class="annot"><span class="annottext">getStdHost :: StandardHeaders -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#getStdHost"><span class="hs-identifier hs-var hs-var">getStdHost</span></a></span></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span id="local-6989586621679097843"><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097843"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; Int -&gt; Maybe ByteString
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097843"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#hostTag"><span class="hs-identifier hs-var">hostTag</span></a></span><span>
</span><span id="line-96"></span><span id="getStdTransferEncoding"><span class="annot"><span class="annottext">getStdTransferEncoding :: StandardHeaders -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#getStdTransferEncoding"><span class="hs-identifier hs-var hs-var">getStdTransferEncoding</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span id="local-6989586621679097844"><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; Int -&gt; Maybe ByteString
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#transferEncodingTag"><span class="hs-identifier hs-var">transferEncodingTag</span></a></span><span>
</span><span id="line-97"></span><span id="getStdCookie"><span class="annot"><span class="annottext">getStdCookie :: StandardHeaders -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#getStdCookie"><span class="hs-identifier hs-var hs-var">getStdCookie</span></a></span></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span id="local-6989586621679097845"><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097845"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; Int -&gt; Maybe ByteString
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097845"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#cookieTag"><span class="hs-identifier hs-var">cookieTag</span></a></span><span>
</span><span id="line-98"></span><span id="getStdContentType"><span class="annot"><span class="annottext">getStdContentType :: StandardHeaders -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#getStdContentType"><span class="hs-identifier hs-var hs-var">getStdContentType</span></a></span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span id="local-6989586621679097846"><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097846"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; Int -&gt; Maybe ByteString
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097846"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#contentTypeTag"><span class="hs-identifier hs-var">contentTypeTag</span></a></span><span>
</span><span id="line-99"></span><span id="getStdConnection"><span class="annot"><span class="annottext">getStdConnection :: StandardHeaders -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#getStdConnection"><span class="hs-identifier hs-var hs-var">getStdConnection</span></a></span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span> </span><span id="local-6989586621679097847"><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; Int -&gt; Maybe ByteString
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString)
</span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#connectionTag"><span class="hs-identifier hs-var">connectionTag</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#newMStandardHeaders"><span class="hs-identifier hs-type">newMStandardHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#MStandardHeaders"><span class="hs-identifier hs-type">MStandardHeaders</span></a></span><span>
</span><span id="line-104"></span><span id="newMStandardHeaders"><span class="annot"><span class="annottext">newMStandardHeaders :: IO MStandardHeaders
</span><a href="Snap.Internal.Http.Server.Parser.html#newMStandardHeaders"><span class="hs-identifier hs-var hs-var">newMStandardHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Maybe ByteString
-&gt; IO (MVector (PrimState IO) (Maybe ByteString))
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Int -&gt; a -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#nStandardHeaders"><span class="hs-identifier hs-var">nStandardHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-108"></span><span class="annot"><span class="hs-comment">-- | an internal version of the headers part of an HTTP request</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">data</span><span> </span><span id="IRequest"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-var">IRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IRequest"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-var">IRequest</span></a></span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="iMethod"><span class="annot"><span class="annottext">IRequest -&gt; Method
</span><a href="Snap.Internal.Http.Server.Parser.html#iMethod"><span class="hs-identifier hs-var hs-var">iMethod</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Method</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="iRequestUri"><span class="annot"><span class="annottext">IRequest -&gt; ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#iRequestUri"><span class="hs-identifier hs-var hs-var">iRequestUri</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="iHttpVersion"><span class="annot"><span class="annottext">IRequest -&gt; (Int, Int)
</span><a href="Snap.Internal.Http.Server.Parser.html#iHttpVersion"><span class="hs-identifier hs-var hs-var">iHttpVersion</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="iRequestHeaders"><span class="annot"><span class="annottext">IRequest -&gt; Headers
</span><a href="Snap.Internal.Http.Server.Parser.html#iRequestHeaders"><span class="hs-identifier hs-var hs-var">iRequestHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Headers</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="iStdHeaders"><span class="annot"><span class="annottext">IRequest -&gt; StandardHeaders
</span><a href="Snap.Internal.Http.Server.Parser.html#iStdHeaders"><span class="hs-identifier hs-var hs-var">iStdHeaders</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-type">StandardHeaders</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-118"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097858"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-type">IRequest</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679097885"><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679097886"><span class="annot"><span class="annottext">== :: IRequest -&gt; IRequest -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679097887"><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#and"><span class="hs-identifier hs-var">and</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">IRequest -&gt; Method
</span><a href="Snap.Internal.Http.Server.Parser.html#iMethod"><span class="hs-identifier hs-var">iMethod</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">a</span></a></span><span>      </span><span class="annot"><span class="annottext">Method -&gt; Method -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest -&gt; Method
</span><a href="Snap.Internal.Http.Server.Parser.html#iMethod"><span class="hs-identifier hs-var">iMethod</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-121"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IRequest -&gt; ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#iRequestUri"><span class="hs-identifier hs-var">iRequestUri</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">a</span></a></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest -&gt; ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#iRequestUri"><span class="hs-identifier hs-var">iRequestUri</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-122"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IRequest -&gt; (Int, Int)
</span><a href="Snap.Internal.Http.Server.Parser.html#iHttpVersion"><span class="hs-identifier hs-var">iHttpVersion</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest -&gt; (Int, Int)
</span><a href="Snap.Internal.Http.Server.Parser.html#iHttpVersion"><span class="hs-identifier hs-var">iHttpVersion</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-123"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(CI ByteString, ByteString)] -&gt; [(CI ByteString, ByteString)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Headers -&gt; [(CI ByteString, ByteString)]
</span><span class="hs-identifier hs-var">H.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IRequest -&gt; Headers
</span><a href="Snap.Internal.Http.Server.Parser.html#iRequestHeaders"><span class="hs-identifier hs-var">iRequestHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                  </span><span class="annot"><span class="annottext">[(CI ByteString, ByteString)]
-&gt; [(CI ByteString, ByteString)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI ByteString, ByteString)] -&gt; [(CI ByteString, ByteString)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Headers -&gt; [(CI ByteString, ByteString)]
</span><span class="hs-identifier hs-var">H.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IRequest -&gt; Headers
</span><a href="Snap.Internal.Http.Server.Parser.html#iRequestHeaders"><span class="hs-identifier hs-var">iRequestHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">IRequest
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097891"><span id="local-6989586621679097896"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-type">IRequest</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679097915"><span class="annot"><span class="annottext">show :: IRequest -&gt; String
</span><a href="#local-6989586621679097915"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-type">IRequest</span></a></span><span> </span><span id="local-6989586621679097917"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679097917"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679097918"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097918"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097919"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097919"><span class="hs-identifier hs-var">major</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097920"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097920"><span class="hs-identifier hs-var">minor</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097921"><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679097921"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span> </span><span class="annot"><span class="annottext">StandardHeaders
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Method -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679097917"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-131"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-132"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097918"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-133"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-134"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097919"><span class="hs-identifier hs-var">major</span></a></span><span>
</span><span id="line-135"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-136"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097920"><span class="hs-identifier hs-var">minor</span></a></span><span>
</span><span id="line-137"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-138"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Headers -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679097921"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-139"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-143"></span><span class="hs-keyword">data</span><span> </span><span id="HttpParseException"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#HttpParseException"><span class="hs-identifier hs-var">HttpParseException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpParseException"><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#HttpParseException"><span class="hs-identifier hs-var">HttpParseException</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097925"><span id="local-6989586621679097931"><span id="local-6989586621679097935"><span class="annot"><span class="annottext">Int -&gt; HttpParseException -&gt; ShowS
[HttpParseException] -&gt; ShowS
HttpParseException -&gt; String
(Int -&gt; HttpParseException -&gt; ShowS)
-&gt; (HttpParseException -&gt; String)
-&gt; ([HttpParseException] -&gt; ShowS)
-&gt; Show HttpParseException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; HttpParseException -&gt; ShowS
showsPrec :: Int -&gt; HttpParseException -&gt; ShowS
$cshow :: HttpParseException -&gt; String
show :: HttpParseException -&gt; String
$cshowList :: [HttpParseException] -&gt; ShowS
showList :: [HttpParseException] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097943"><span id="local-6989586621679097947"><span id="local-6989586621679097950"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Exception.Type.html#Exception"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#HttpParseException"><span class="hs-identifier hs-type">HttpParseException</span></a></span></span></span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-148"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#parseRequest"><span class="hs-pragma hs-type">parseRequest</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-149"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#parseRequest"><span class="hs-identifier hs-type">parseRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-type">IRequest</span></a></span><span>
</span><span id="line-150"></span><span id="parseRequest"><span class="annot"><span class="annottext">parseRequest :: InputStream ByteString -&gt; IO IRequest
</span><a href="Snap.Internal.Http.Server.Parser.html#parseRequest"><span class="hs-identifier hs-var hs-var">parseRequest</span></a></span></span><span> </span><span id="local-6989586621679097953"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679097953"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679097954"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097954"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#pLine"><span class="hs-identifier hs-var">pLine</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679097953"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679097956"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097956"><span class="hs-identifier hs-var">mStr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679097957"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097957"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">bSp</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097954"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679097959"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var">uri</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679097960"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097960"><span class="hs-identifier hs-var">vStr</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">bSp</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097957"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097961"><span class="annot"><span class="annottext">method :: Method
</span><a href="#local-6989586621679097961"><span class="hs-identifier hs-var hs-var">method</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Method
</span><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097956"><span class="hs-identifier hs-var">mStr</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679097972"><span class="annot"><span class="annottext">version :: (Int, Int)
</span><a href="#local-6989586621679097972"><span class="hs-identifier hs-var hs-var">version</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (Int, Int)
forall {a} {b}.
(Enum a, Enum b, Num a, Num b, Bits a, Bits b) =&gt;
ByteString -&gt; (a, b)
</span><a href="#local-6989586621679097973"><span class="hs-identifier hs-var">pVer</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097960"><span class="hs-identifier hs-var">vStr</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097974"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679097974"><span class="hs-identifier hs-var">host</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097975"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097975"><span class="hs-identifier hs-var">uri'</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (Maybe ByteString, ByteString)
</span><a href="#local-6989586621679097976"><span class="hs-identifier hs-var">getHost</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097978"><span class="annot"><span class="annottext">uri'' :: ByteString
</span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var hs-var">uri''</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097975"><span class="hs-identifier hs-var">uri'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097975"><span class="hs-identifier hs-var">uri'</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679097980"><span class="annot"><span class="annottext">MStandardHeaders
</span><a href="#local-6989586621679097980"><span class="hs-identifier hs-var">stdHdrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO MStandardHeaders
</span><a href="Snap.Internal.Http.Server.Parser.html#newMStandardHeaders"><span class="hs-identifier hs-var">newMStandardHeaders</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">MVector (PrimState IO) (Maybe ByteString)
-&gt; Int -&gt; Maybe ByteString -&gt; IO ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.unsafeWrite</span></span><span> </span><span class="annot"><span class="annottext">MStandardHeaders
MVector (PrimState IO) (Maybe ByteString)
</span><a href="#local-6989586621679097980"><span class="hs-identifier hs-var">stdHdrs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Snap.Internal.Http.Server.Parser.html#hostTag"><span class="hs-identifier hs-var">hostTag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679097974"><span class="hs-identifier hs-var">host</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679097982"><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679097982"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MStandardHeaders -&gt; InputStream ByteString -&gt; IO Headers
</span><a href="Snap.Internal.Http.Server.Parser.html#pHeaders"><span class="hs-identifier hs-var">pHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">MStandardHeaders
</span><a href="#local-6989586621679097980"><span class="hs-identifier hs-var">stdHdrs</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679097953"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679097984"><span class="annot"><span class="annottext">StandardHeaders
</span><a href="#local-6989586621679097984"><span class="hs-identifier hs-var">outStd</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Vector (Maybe ByteString) -&gt; StandardHeaders
</span><a href="Snap.Internal.Http.Server.Parser.html#StandardHeaders"><span class="hs-identifier hs-var">StandardHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Maybe ByteString) -&gt; StandardHeaders)
-&gt; IO (Vector (Maybe ByteString)) -&gt; IO StandardHeaders
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState IO) (Maybe ByteString)
-&gt; IO (Vector (Maybe ByteString))
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.unsafeFreeze</span></span><span> </span><span class="annot"><span class="annottext">MStandardHeaders
MVector (PrimState IO) (Maybe ByteString)
</span><a href="#local-6989586621679097980"><span class="hs-identifier hs-var">stdHdrs</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">IRequest -&gt; IO IRequest
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(IRequest -&gt; IO IRequest) -&gt; IRequest -&gt; IO IRequest
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Method
-&gt; ByteString
-&gt; (Int, Int)
-&gt; Headers
-&gt; StandardHeaders
-&gt; IRequest
</span><a href="Snap.Internal.Http.Server.Parser.html#IRequest"><span class="hs-identifier hs-var">IRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679097961"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var">uri''</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679097972"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679097982"><span class="hs-identifier hs-var">hdrs</span></a></span><span> </span><span class="annot"><span class="annottext">StandardHeaders
</span><a href="#local-6989586621679097984"><span class="hs-identifier hs-var">outStd</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679097976"><span class="annot"><span class="annottext">getHost :: ByteString -&gt; (Maybe ByteString, ByteString)
</span><a href="#local-6989586621679097976"><span class="hs-identifier hs-var hs-var">getHost</span></a></span></span><span> </span><span id="local-6989586621679097990"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;http://&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#isPrefixOf"><span class="hs-operator hs-var">`S.isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-167"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097992"><span class="annot"><span class="annottext">s' :: ByteString
</span><a href="#local-6989586621679097992"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-168"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679097994"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097994"><span class="hs-identifier hs-var">host</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679097995"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097995"><span class="hs-identifier hs-var">uri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#breakCh"><span class="hs-identifier hs-var">breakCh</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097992"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-169"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097994"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097995"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#isPrefixOf"><span class="hs-operator hs-var">`S.isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-171"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097997"><span class="annot"><span class="annottext">s' :: ByteString
</span><a href="#local-6989586621679097997"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-172"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679097998"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097998"><span class="hs-identifier hs-var">host</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679097999"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097999"><span class="hs-identifier hs-var">uri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#breakCh"><span class="hs-identifier hs-var">breakCh</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097997"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-173"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097998"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097999"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679097973"><span class="annot"><span class="annottext">pVer :: ByteString -&gt; (a, b)
</span><a href="#local-6989586621679097973"><span class="hs-identifier hs-var hs-var">pVer</span></a></span></span><span> </span><span id="local-6989586621679098020"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098020"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HTTP/&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#isPrefixOf"><span class="hs-operator hs-var">`S.isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098020"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-177"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (a, b)
forall {a} {b}.
(Enum a, Enum b, Num a, Num b, Bits a, Bits b) =&gt;
ByteString -&gt; (a, b)
</span><a href="#local-6989586621679098021"><span class="hs-identifier hs-var">pVers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098020"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679097958"><span class="annot"><span class="annottext">bSp :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var hs-var">bSp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#splitCh"><span class="hs-identifier hs-var">splitCh</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679098021"><span class="annot"><span class="annottext">pVers :: ByteString -&gt; (a, b)
</span><a href="#local-6989586621679098021"><span class="hs-identifier hs-var hs-var">pVers</span></a></span></span><span> </span><span id="local-6989586621679098031"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098031"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098032"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679098033"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679098034"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098034"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098035"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098035"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#splitCh"><span class="hs-identifier hs-var">splitCh</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098031"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098032"><span class="annot"><span class="annottext">c :: a
</span><a href="#local-6989586621679098032"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; a
forall a. (Enum a, Num a, Bits a) =&gt; ByteString -&gt; a
</span><span class="hs-identifier hs-var">unsafeFromNat</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098034"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098033"><span class="annot"><span class="annottext">d :: b
</span><a href="#local-6989586621679098033"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; b
forall a. (Enum a, Num a, Bits a) =&gt; ByteString -&gt; a
</span><span class="hs-identifier hs-var">unsafeFromNat</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098035"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#pLine"><span class="hs-identifier hs-type">pLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-191"></span><span id="pLine"><span class="annot"><span class="annottext">pLine :: InputStream ByteString -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#pLine"><span class="hs-identifier hs-var hs-var">pLine</span></a></span></span><span> </span><span id="local-6989586621679098044"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; IO ByteString
</span><a href="#local-6989586621679098045"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679098047"><span class="annot"><span class="annottext">throwNoCRLF :: IO a
</span><a href="#local-6989586621679098047"><span class="hs-identifier hs-var hs-var">throwNoCRLF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><span class="annottext">HttpParseException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpParseException -&gt; IO a) -&gt; HttpParseException -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; HttpParseException
</span><a href="Snap.Internal.Http.Server.Parser.html#HttpParseException"><span class="hs-identifier hs-var">HttpParseException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parse error: expected line ending in crlf&quot;</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679098049"><span class="annot"><span class="annottext">throwBadCRLF :: IO a
</span><a href="#local-6989586621679098049"><span class="hs-identifier hs-var hs-var">throwBadCRLF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="annottext">HttpParseException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpParseException -&gt; IO a) -&gt; HttpParseException -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; HttpParseException
</span><a href="Snap.Internal.Http.Server.Parser.html#HttpParseException"><span class="hs-identifier hs-var">HttpParseException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parse error: got cr without subsequent lf&quot;</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679098045"><span class="annot"><span class="annottext">go :: [ByteString] -&gt; IO ByteString
</span><a href="#local-6989586621679098045"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098064"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098064"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098065"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679098065"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO (Maybe ByteString)
forall a. InputStream a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">Streams.read</span></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098067"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString
-&gt; (ByteString -&gt; IO ByteString)
-&gt; Maybe ByteString
-&gt; IO ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString
forall {a}. IO a
</span><a href="#local-6989586621679098047"><span class="hs-identifier hs-var">throwNoCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679098065"><span class="hs-identifier hs-var">mb</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098069"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-207"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString -&gt; IO ByteString
</span><a href="#local-6989586621679098072"><span class="hs-identifier hs-var">noCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098064"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>                 </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">S.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679098075"><span class="hs-identifier hs-var">lastIsCR</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098064"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-210"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-identifier hs-var">S.unsafeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">foundCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098064"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-211"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ByteString
forall {a}. IO a
</span><a href="#local-6989586621679098049"><span class="hs-identifier hs-var">throwBadCRLF</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679098077"><span class="annot"><span class="annottext">foundCRLF :: [ByteString] -&gt; ByteString -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var hs-var">foundCRLF</span></a></span></span><span> </span><span id="local-6989586621679098083"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098083"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679098084"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098085"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098085"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098088"><span class="annot"><span class="annottext">i2 :: Int
</span><a href="#local-6989586621679098088"><span class="hs-identifier hs-var hs-var">i2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098085"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098089"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679098089"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">S.unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098085"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098088"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">S.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098091"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679098091"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098088"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; InputStream ByteString -&gt; IO ()
forall a. a -&gt; InputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.unRead</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098091"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-comment">-- Optimize for the common case: dl is almost always &quot;id&quot;</span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098094"><span class="annot"><span class="annottext">out :: ByteString
</span><a href="#local-6989586621679098094"><span class="hs-identifier hs-var hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098083"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098089"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098089"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098083"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098094"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679098072"><span class="annot"><span class="annottext">noCRLF :: [ByteString] -&gt; ByteString -&gt; IO ByteString
</span><a href="#local-6989586621679098072"><span class="hs-identifier hs-var hs-var">noCRLF</span></a></span></span><span> </span><span id="local-6989586621679098098"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098098"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679098099"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098099"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; IO ByteString
</span><a href="#local-6989586621679098045"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098099"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098098"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679098075"><span class="annot"><span class="annottext">lastIsCR :: [ByteString] -&gt; ByteString -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679098075"><span class="hs-identifier hs-var hs-var">lastIsCR</span></a></span></span><span> </span><span id="local-6989586621679098108"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098108"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679098109"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098109"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098110"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098110"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098111"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098111"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO (Maybe ByteString)
forall a. InputStream a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">Streams.read</span></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; (Maybe ByteString -&gt; IO ByteString) -&gt; IO ByteString
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString
-&gt; (ByteString -&gt; IO ByteString)
-&gt; Maybe ByteString
-&gt; IO ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString
forall {a}. IO a
</span><a href="#local-6989586621679098047"><span class="hs-identifier hs-var">throwNoCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098111"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679098075"><span class="hs-identifier hs-var">lastIsCR</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098108"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098109"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098110"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098112"><span class="annot"><span class="annottext">c :: Word8
</span><a href="#local-6989586621679098112"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeHead"><span class="hs-identifier hs-var">S.unsafeHead</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098111"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679098112"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">10</span></span><span>
</span><span id="line-233"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO ByteString
forall {a}. IO a
</span><a href="#local-6989586621679098049"><span class="hs-identifier hs-var">throwBadCRLF</span></a></span><span>
</span><span id="line-234"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098115"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679098115"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">S.unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098110"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098109"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-236"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098116"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679098116"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098111"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-237"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098116"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; InputStream ByteString -&gt; IO ()
forall a. a -&gt; InputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.unRead</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098116"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-238"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098119"><span class="annot"><span class="annottext">out :: ByteString
</span><a href="#local-6989586621679098119"><span class="hs-identifier hs-var hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098108"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098115"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098115"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098108"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                  </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098119"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-243"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#splitCh"><span class="hs-identifier hs-type">splitCh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span id="splitCh"><span class="annot"><span class="annottext">splitCh :: Char -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#splitCh"><span class="hs-identifier hs-var hs-var">splitCh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098120"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098120"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098121"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098122"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-245"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098124"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679098124"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">S.unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098122"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-247"></span><span>                           </span><span class="hs-glyph">!</span><span id="local-6989586621679098127"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679098127"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098122"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-248"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098124"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098127"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679098122"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679098122"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098120"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-251"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#splitCh"><span class="hs-pragma hs-type">splitCh</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-255"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#breakCh"><span class="hs-identifier hs-type">breakCh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span id="breakCh"><span class="annot"><span class="annottext">breakCh :: Char -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#breakCh"><span class="hs-identifier hs-var hs-var">breakCh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098128"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098128"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098129"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098129"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098130"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-257"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098129"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098131"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679098131"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">S.unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098130"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098129"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-259"></span><span>                           </span><span class="hs-glyph">!</span><span id="local-6989586621679098132"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098130"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098129"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-260"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098131"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679098130"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679098130"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098128"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098129"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-263"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#breakCh"><span class="hs-pragma hs-type">breakCh</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#splitHeader"><span class="hs-identifier hs-type">splitHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span id="splitHeader"><span class="annot"><span class="annottext">splitHeader :: ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#splitHeader"><span class="hs-identifier hs-var hs-var">splitHeader</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098134"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098135"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-269"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098136"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679098136"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">S.unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098135"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-271"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString
</span><a href="#local-6989586621679098137"><span class="hs-identifier hs-var">skipSp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098135"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679098135"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679098135"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679098138"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679098138"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">S.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679098137"><span class="annot"><span class="annottext">skipSp :: Int -&gt; ByteString
</span><a href="#local-6989586621679098137"><span class="hs-identifier hs-var hs-var">skipSp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098142"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098142"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098142"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098138"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-277"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098143"><span class="annot"><span class="annottext">c :: Word8
</span><a href="#local-6989586621679098143"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-identifier hs-var">S.unsafeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098142"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-278"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Snap.Internal.Http.Server.Parser.html#isLWS"><span class="hs-identifier hs-var">isLWS</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Char -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Char
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier hs-var">w2c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679098143"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-279"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString
</span><a href="#local-6989586621679098137"><span class="hs-identifier hs-var">skipSp</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ByteString) -&gt; Int -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098142"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-280"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">S.unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098142"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#splitHeader"><span class="hs-pragma hs-type">splitHeader</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#isLWS"><span class="hs-identifier hs-type">isLWS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-288"></span><span id="isLWS"><span class="annot"><span class="annottext">isLWS :: Char -&gt; Bool
</span><a href="Snap.Internal.Http.Server.Parser.html#isLWS"><span class="hs-identifier hs-var hs-var">isLWS</span></a></span></span><span> </span><span id="local-6989586621679098145"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098145"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098145"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098145"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span>
</span><span id="line-289"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#isLWS"><span class="hs-pragma hs-type">isLWS</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#pHeaders"><span class="hs-identifier hs-type">pHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#MStandardHeaders"><span class="hs-identifier hs-type">MStandardHeaders</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Headers</span></span><span>
</span><span id="line-294"></span><span id="pHeaders"><span class="annot"><span class="annottext">pHeaders :: MStandardHeaders -&gt; InputStream ByteString -&gt; IO Headers
</span><a href="Snap.Internal.Http.Server.Parser.html#pHeaders"><span class="hs-identifier hs-var hs-var">pHeaders</span></a></span></span><span> </span><span id="local-6989586621679098147"><span class="annot"><span class="annottext">MStandardHeaders
</span><a href="#local-6989586621679098147"><span class="hs-identifier hs-var">stdHdrs</span></a></span></span><span> </span><span id="local-6989586621679098148"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098148"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679098149"><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679098149"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Headers
</span><span class="hs-identifier hs-var">H.unsafeFromCaseFoldedList</span></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Headers)
-&gt; IO [(ByteString, ByteString)] -&gt; IO Headers
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; IO [(ByteString, ByteString)]
</span><a href="#local-6989586621679098151"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">Headers -&gt; IO Headers
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679098149"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679098151"><span class="annot"><span class="annottext">go :: [(ByteString, ByteString)] -&gt; IO [(ByteString, ByteString)]
</span><a href="#local-6989586621679098151"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098160"><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679098160"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>        </span><span id="local-6989586621679098161"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098161"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#pLine"><span class="hs-identifier hs-var">pLine</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098148"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098161"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-302"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; IO [(ByteString, ByteString)]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679098160"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-303"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679098162"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098162"><span class="hs-identifier hs-var">k0</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679098163"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098163"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#splitHeader"><span class="hs-identifier hs-var">splitHeader</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098161"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098164"><span class="annot"><span class="annottext">k :: ByteString
</span><a href="#local-6989586621679098164"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#toLower"><span class="hs-identifier hs-var">toLower</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098162"><span class="hs-identifier hs-var">k0</span></a></span><span>
</span><span id="line-306"></span><span>            </span><span id="local-6989586621679098166"><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679098166"><span class="hs-identifier hs-var">vf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; IO ([ByteString] -&gt; [ByteString])
forall {c}. ([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
</span><a href="#local-6989586621679098167"><span class="hs-identifier hs-var">pCont</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-307"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098169"><span class="annot"><span class="annottext">vs :: [ByteString]
</span><a href="#local-6989586621679098169"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679098166"><span class="hs-identifier hs-var">vf</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098170"><span class="annot"><span class="annottext">v' :: ByteString
</span><a href="#local-6989586621679098170"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098163"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679098169"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098171"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679098171"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#findStdHeaderIndex"><span class="hs-identifier hs-var">findStdHeaderIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098164"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098171"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState IO) (Maybe ByteString)
-&gt; Int -&gt; Maybe ByteString -&gt; IO ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.unsafeWrite</span></span><span> </span><span class="annot"><span class="annottext">MStandardHeaders
MVector (PrimState IO) (Maybe ByteString)
</span><a href="#local-6989586621679098147"><span class="hs-identifier hs-var">stdHdrs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098171"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; IO ()) -&gt; Maybe ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098170"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098172"><span class="annot"><span class="annottext">l' :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679098172"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098164"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098170"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(ByteString, ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679098160"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; IO [(ByteString, ByteString)]
</span><a href="#local-6989586621679098151"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679098172"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679098173"><span class="annot"><span class="annottext">trimBegin :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679098173"><span class="hs-identifier hs-var hs-var">trimBegin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#dropWhile"><span class="hs-identifier hs-var">S.dropWhile</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Snap.Internal.Http.Server.Parser.html#isLWS"><span class="hs-identifier hs-var">isLWS</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679098167"><span class="annot"><span class="annottext">pCont :: ([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
</span><a href="#local-6989586621679098167"><span class="hs-identifier hs-var hs-var">pCont</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098181"><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">dlist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621679098182"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679098182"><span class="hs-identifier hs-var">mbS</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO (Maybe ByteString)
forall a. InputStream a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">Streams.peek</span></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098148"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="annottext">IO ([ByteString] -&gt; c)
-&gt; (ByteString -&gt; IO ([ByteString] -&gt; c))
-&gt; Maybe ByteString
-&gt; IO ([ByteString] -&gt; c)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">dlist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679098184"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098184"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098184"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Snap.Internal.Http.Server.Parser.html#isLWS"><span class="hs-identifier hs-var">isLWS</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Char -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Char
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier hs-var">w2c</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Char) -&gt; Word8 -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeHead"><span class="hs-identifier hs-var">S.unsafeHead</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098184"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-322"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">dlist</span></a></span><span>
</span><span id="line-323"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
</span><a href="#local-6989586621679098185"><span class="hs-identifier hs-var">procCont</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">dlist</span></a></span><span>
</span><span id="line-324"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO (Maybe ByteString)
forall a. InputStream a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">Streams.read</span></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098148"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; IO ([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
</span><a href="#local-6989586621679098167"><span class="hs-identifier hs-var">pCont</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">dlist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>              </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679098182"><span class="hs-identifier hs-var">mbS</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621679098185"><span class="annot"><span class="annottext">procCont :: ([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
</span><a href="#local-6989586621679098185"><span class="hs-identifier hs-var hs-var">procCont</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098186"><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098186"><span class="hs-identifier hs-var">dlist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>        </span><span id="local-6989586621679098187"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098187"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#pLine"><span class="hs-identifier hs-var">pLine</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098148"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098188"><span class="annot"><span class="annottext">t :: ByteString
</span><a href="#local-6989586621679098188"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679098173"><span class="hs-identifier hs-var">trimBegin</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098187"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">([ByteString] -&gt; c) -&gt; IO ([ByteString] -&gt; c)
</span><a href="#local-6989586621679098167"><span class="hs-identifier hs-var">pCont</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; c
</span><a href="#local-6989586621679098186"><span class="hs-identifier hs-var">dlist</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; c)
-&gt; ([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098188"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-type">methodFromString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Method</span></span><span>
</span><span id="line-335"></span><span id="methodFromString"><span class="annot"><span class="annottext">methodFromString :: ByteString -&gt; Method
</span><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var hs-var">methodFromString</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;GET&quot;</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">GET</span></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">POST</span></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HEAD&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">HEAD</span></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;PUT&quot;</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">PUT</span></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">DELETE</span></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;TRACE&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">TRACE</span></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;OPTIONS&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">OPTIONS</span></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;CONNECT&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">CONNECT</span></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;PATCH&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier hs-var">PATCH</span></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#methodFromString"><span class="hs-identifier hs-var">methodFromString</span></a></span><span> </span><span id="local-6989586621679098199"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098199"><span class="hs-identifier hs-var">s</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Method
</span><span class="hs-identifier hs-var">Method</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098199"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-348"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#readChunkedTransferEncoding"><span class="hs-identifier hs-type">readChunkedTransferEncoding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-349"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span id="readChunkedTransferEncoding"><span class="annot"><span class="annottext">readChunkedTransferEncoding :: InputStream ByteString -&gt; IO (InputStream ByteString)
</span><a href="Snap.Internal.Http.Server.Parser.html#readChunkedTransferEncoding"><span class="hs-identifier hs-var hs-var">readChunkedTransferEncoding</span></a></span></span><span> </span><span id="local-6989586621679098201"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098201"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">Generator ByteString () -&gt; IO (InputStream ByteString)
forall r a. Generator r a -&gt; IO (InputStream r)
</span><span class="hs-identifier hs-var">Streams.fromGenerator</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InputStream ByteString -&gt; Generator ByteString ()
</span><a href="Snap.Internal.Http.Server.Parser.html#consumeChunks"><span class="hs-identifier hs-var">consumeChunks</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098201"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#writeChunkedTransferEncoding"><span class="hs-identifier hs-type">writeChunkedTransferEncoding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span>
</span><span id="line-355"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span id="writeChunkedTransferEncoding"><span class="annot"><span class="annottext">writeChunkedTransferEncoding :: OutputStream Builder -&gt; IO (OutputStream Builder)
</span><a href="Snap.Internal.Http.Server.Parser.html#writeChunkedTransferEncoding"><span class="hs-identifier hs-var hs-var">writeChunkedTransferEncoding</span></a></span></span><span> </span><span id="local-6989586621679098204"><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679098204"><span class="hs-identifier hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Builder -&gt; IO ()) -&gt; IO (OutputStream Builder)
forall a. (Maybe a -&gt; IO ()) -&gt; IO (OutputStream a)
</span><span class="hs-identifier hs-var">Streams.makeOutputStream</span></span><span> </span><span class="annot"><span class="annottext">Maybe Builder -&gt; IO ()
</span><a href="#local-6989586621679098206"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679098206"><span class="annot"><span class="annottext">f :: Maybe Builder -&gt; IO ()
</span><a href="#local-6989586621679098206"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">Maybe Builder -&gt; OutputStream Builder -&gt; IO ()
forall a. Maybe a -&gt; OutputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.write</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Maybe Builder
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-identifier hs-var">chunkedTransferTerminator</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679098204"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><span class="annottext">Maybe Builder -&gt; OutputStream Builder -&gt; IO ()
forall a. Maybe a -&gt; OutputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.write</span></span><span> </span><span class="annot"><span class="annottext">Maybe Builder
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679098204"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="#local-6989586621679098206"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621679098211"><span class="annot"><span class="annottext">Maybe Builder
</span><a href="#local-6989586621679098211"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Builder -&gt; OutputStream Builder -&gt; IO ()
forall a. Maybe a -&gt; OutputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.write</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Builder
</span><span class="hs-identifier hs-var">chunkedTransferEncoding</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Builder) -&gt; Maybe Builder -&gt; Maybe Builder
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-operator hs-var">`fmap`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Builder
</span><a href="#local-6989586621679098211"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679098204"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>                             </span><span class="hs-comment">---------------------</span><span>
</span><span id="line-365"></span><span>                             </span><span class="hs-comment">-- parse functions --</span><span>
</span><span id="line-366"></span><span>                             </span><span class="hs-comment">---------------------</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-369"></span><span class="hs-comment">{-
    For a response body in chunked transfer encoding, iterate over
    the individual chunks, reading the size parameter, then
    looping over that chunk in bites of at most bUFSIZ,
    yielding them to the receiveResponse InputStream accordingly.
-}</span><span>
</span><span id="line-375"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#consumeChunks"><span class="hs-identifier hs-type">consumeChunks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generator</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span id="consumeChunks"><span class="annot"><span class="annottext">consumeChunks :: InputStream ByteString -&gt; Generator ByteString ()
</span><a href="Snap.Internal.Http.Server.Parser.html#consumeChunks"><span class="hs-identifier hs-var hs-var">consumeChunks</span></a></span></span><span> </span><span id="local-6989586621679098212"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098212"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679098213"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098213"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Generator ByteString Int
</span><a href="#local-6989586621679098214"><span class="hs-identifier hs-var">parseSize</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098213"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>            </span><span class="hs-comment">-- read one or more bytes, then loop to next chunk</span><span>
</span><span id="line-381"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Generator ByteString ()
</span><a href="#local-6989586621679098216"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098213"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><span class="annottext">Generator ByteString ()
</span><a href="#local-6989586621679098217"><span class="hs-identifier hs-var">skipCRLF</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="annottext">InputStream ByteString -&gt; Generator ByteString ()
</span><a href="Snap.Internal.Http.Server.Parser.html#consumeChunks"><span class="hs-identifier hs-var">consumeChunks</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098212"><span class="hs-identifier hs-var">i1</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>            </span><span class="hs-comment">-- NB: snap-server doesn't yet support chunked trailer parts</span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-comment">-- (see RFC7230#sec4.1.2)</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span>            </span><span class="hs-comment">-- consume final CRLF</span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">Generator ByteString ()
</span><a href="#local-6989586621679098217"><span class="hs-identifier hs-var">skipCRLF</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679098216"><span class="annot"><span class="annottext">go :: Int -&gt; Generator ByteString ()
</span><a href="#local-6989586621679098216"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Generator ByteString ()
forall a. a -&gt; Generator ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="#local-6989586621679098216"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098225"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098225"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679098226"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098226"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679098227"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098227"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (ByteString, Int) -&gt; Generator ByteString (ByteString, Int)
forall a. IO a -&gt; Generator ByteString a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (ByteString, Int) -&gt; Generator ByteString (ByteString, Int))
-&gt; IO (ByteString, Int) -&gt; Generator ByteString (ByteString, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; InputStream ByteString -&gt; IO (ByteString, Int)
</span><a href="#local-6989586621679098228"><span class="hs-identifier hs-var">readN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098225"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098212"><span class="hs-identifier hs-var">i1</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Generator ByteString ()
forall r. r -&gt; Generator r ()
</span><span class="hs-identifier hs-var">Streams.yield</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098226"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Generator ByteString ()
</span><a href="#local-6989586621679098216"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098227"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621679098214"><span class="annot"><span class="annottext">parseSize :: Generator ByteString Int
</span><a href="#local-6989586621679098214"><span class="hs-identifier hs-var hs-var">parseSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">IO Int -&gt; Generator ByteString Int
forall a. IO a -&gt; Generator ByteString a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; Generator ByteString Int)
-&gt; IO Int -&gt; Generator ByteString Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Int -&gt; InputStream ByteString -&gt; IO Int
forall r. Parser r -&gt; InputStream ByteString -&gt; IO r
</span><span class="hs-identifier hs-var">parseFromStream</span></span><span> </span><span class="annot"><span class="annottext">Parser Int
</span><a href="#local-6989586621679098236"><span class="hs-identifier hs-var">transferChunkSize</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098212"><span class="hs-identifier hs-var">i1</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679098217"><span class="annot"><span class="annottext">skipCRLF :: Generator ByteString ()
</span><a href="#local-6989586621679098217"><span class="hs-identifier hs-var hs-var">skipCRLF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; Generator ByteString ()
forall a. IO a -&gt; Generator ByteString a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Generator ByteString ())
-&gt; IO () -&gt; Generator ByteString ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ByteString -&gt; InputStream ByteString -&gt; IO ByteString
forall r. Parser r -&gt; InputStream ByteString -&gt; IO r
</span><span class="hs-identifier hs-var">parseFromStream</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString
</span><span class="hs-identifier hs-var">crlf</span></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098212"><span class="hs-identifier hs-var">i1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><a href="#local-6989586621679098236"><span class="hs-identifier hs-type">transferChunkSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679098236"><span class="annot"><span class="annottext">transferChunkSize :: Parser Int
</span><a href="#local-6989586621679098236"><span class="hs-identifier hs-var hs-var">transferChunkSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098242"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098242"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Int
forall a. (Integral a, Bits a) =&gt; Parser a
</span><span class="hs-identifier hs-var">hexadecimal</span></span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-comment">-- skip over any chunk extensions (see RFC7230#sec4.1.1)</span><span>
</span><span id="line-408"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">takeTill</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString
</span><span class="hs-identifier hs-var">crlf</span></span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Parser Int
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098242"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-comment">{-
        The chunk size coming down from the client is somewhat arbitrary;
        it's really just an indication of how many bytes need to be read
        before the next size marker or end marker - neither of which has
        anything to do with streaming on our side. Instead, we'll feed
        bytes into our InputStream at an appropriate intermediate size.
    -}</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="#local-6989586621679098243"><span class="hs-identifier hs-type">bUFSIZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621679098243"><span class="annot"><span class="annottext">bUFSIZ :: Int
</span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var hs-var">bUFSIZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32752</span></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-comment">{-
        Read the specified number of bytes up to a maximum of bUFSIZ,
        returning a resultant ByteString and the number of bytes remaining.
    -}</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><a href="#local-6989586621679098228"><span class="hs-identifier hs-type">readN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621679098228"><span class="annot"><span class="annottext">readN :: Int -&gt; InputStream ByteString -&gt; IO (ByteString, Int)
</span><a href="#local-6989586621679098228"><span class="hs-identifier hs-var hs-var">readN</span></a></span></span><span> </span><span id="local-6989586621679098244"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679098245"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098245"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098246"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098246"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; InputStream ByteString -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Streams.readExactly</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098248"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679098245"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">(ByteString, Int) -&gt; IO (ByteString, Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679098246"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098249"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098251"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679098251"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var">bUFSIZ</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098248"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679098248"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098251"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var">bUFSIZ</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098249"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679098249"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098251"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098251"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#toLower"><span class="hs-identifier hs-type">toLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-437"></span><span id="toLower"><span class="annot"><span class="annottext">toLower :: ByteString -&gt; ByteString
</span><a href="Snap.Internal.Http.Server.Parser.html#toLower"><span class="hs-identifier hs-var hs-var">toLower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#map"><span class="hs-identifier hs-var">S.map</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><a href="#local-6989586621679098258"><span class="hs-identifier hs-var">lower</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679098258"><span class="annot"><span class="annottext">lower :: Char -&gt; Char
</span><a href="#local-6989586621679098258"><span class="hs-identifier hs-var hs-var">lower</span></a></span></span><span> </span><span id="local-6989586621679098266"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098266"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098267"><span class="annot"><span class="annottext">c :: Word8
</span><a href="#local-6989586621679098267"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Word8
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var">c2w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098266"><span class="hs-identifier hs-var">c0</span></a></span><span>
</span><span id="line-440"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">65</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679098267"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679098267"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">90</span></span><span>
</span><span id="line-441"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Char
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier hs-var">w2c</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Char) -&gt; Word8 -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679098267"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">32</span></span><span>
</span><span id="line-442"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098266"><span class="hs-identifier hs-var">c0</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | A version of elemIndex that doesn't allocate a Maybe. (It returns -1 on</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- not found.)</span><span>
</span><span id="line-448"></span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-identifier hs-type">elemIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-cpp">
#if MIN_VERSION_bytestring(0, 10, 6)
</span><span id="elemIndex"><span class="annot"><span class="annottext">elemIndex :: Char -&gt; ByteString -&gt; Int
</span><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-identifier hs-var hs-var">elemIndex</span></a></span></span><span> </span><span id="local-6989586621679098270"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098270"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#PS"><span class="hs-identifier hs-type">PS</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098272"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679098272"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098273"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098273"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098274"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098274"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; Int
forall a. IO a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; Int) -&gt; IO Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">elemIndex</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PS</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">fp</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inlinePerformIO</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>                                   </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679098272"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679098275"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679098275"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098276"><span class="annot"><span class="annottext">p :: Ptr b
</span><a href="#local-6989586621679098276"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679098275"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098273"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621679098277"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679098277"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-var">memchr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
forall {b}. Ptr b
</span><a href="#local-6989586621679098276"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679098278"><span class="hs-identifier hs-var">w8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098274"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO Int) -&gt; Int -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679098277"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
forall {b}. Ptr b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679098277"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Any -&gt; Int
forall a b. Ptr a -&gt; Ptr b -&gt; Int
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Ptr.html#minusPtr"><span class="hs-operator hs-var">`minusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any
forall {b}. Ptr b
</span><a href="#local-6989586621679098276"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679098278"><span class="annot"><span class="annottext">w8 :: Word8
</span><a href="#local-6989586621679098278"><span class="hs-identifier hs-var hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Word8
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var">c2w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679098270"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-460"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Server.Parser.html#elemIndex"><span class="hs-pragma hs-type">elemIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-461"></span></pre></body></html>