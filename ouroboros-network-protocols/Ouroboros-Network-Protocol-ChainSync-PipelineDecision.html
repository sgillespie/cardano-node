<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Network.Protocol.ChainSync.PipelineDecision</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-network-protocols-0.7.0.0: Ouroboros Network Protocols</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Network.Protocol.ChainSync.PipelineDecision</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:PipelineDecision">PipelineDecision</a> n <span class="keyword">where</span><ul class="subs"><li><a href="#v:Request">Request</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> Z</li><li><a href="#v:Pipeline">Pipeline</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n</li><li><a href="#v:CollectOrPipeline">CollectOrPipeline</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> (S n)</li><li><a href="#v:Collect">Collect</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> (S n)</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:MkPipelineDecision">MkPipelineDecision</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:MkPipelineDecision">MkPipelineDecision</a> :: (<span class="keyword">forall</span> n. Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; (<a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n, <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a>)) -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a></li></ul></li><li class="src short"><a href="#v:runPipelineDecision">runPipelineDecision</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a> -&gt; Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; (<a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n, <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a>)</li><li class="src short"><a href="#v:constantPipelineDecision">constantPipelineDecision</a> :: (<span class="keyword">forall</span> n. Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n) -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a></li><li class="src short"><a href="#v:pipelineDecisionMax">pipelineDecisionMax</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n</li><li class="src short"><a href="#v:pipelineDecisionMin">pipelineDecisionMin</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n</li><li class="src short"><a href="#v:pipelineDecisionLowHighMark">pipelineDecisionLowHighMark</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PipelineDecision" class="def">PipelineDecision</a> n <span class="keyword">where</span> <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#PipelineDecision" class="link">Source</a> <a href="#t:PipelineDecision" class="selflink">#</a></p><div class="doc"><p>Pipeline decision: we can do either one of these:</p><ul><li>non-pipelined request</li><li>pipeline a request</li><li>collect or pipeline, but only when there are pipelined requests</li><li>collect, as above, only when there are pipelined requests</li></ul><p>There might be other useful pipelining scenarios: collect a given number of
 requests (which also can be used to collect all outstanding requests).</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Request" class="def">Request</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> Z</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Pipeline" class="def">Pipeline</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CollectOrPipeline" class="def">CollectOrPipeline</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> (S n)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Collect" class="def">Collect</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> (S n)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MkPipelineDecision" class="def">MkPipelineDecision</a> <span class="keyword">where</span> <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#MkPipelineDecision" class="link">Source</a> <a href="#t:MkPipelineDecision" class="selflink">#</a></p><div class="doc"><p>The callback gets the following arguments:</p><ul><li>how many requests are not yet collected (in flight or
   already queued)</li><li>block number of client's tip</li><li>block number of server's tip</li></ul><p>Client's tip block number and server's tip block number can only be equal
 (from the client's perspective) when both the client's and the server's tip
 headers agree. If they would not agree (server forked), then the server
 sends <code>MsgRollBackward</code>, which rolls back one block and causes the client's
 tip and the server's tip to differ.</p><p>In this module we implement three pipelining strategies:</p><ul><li><code><a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#v:pipelineDecisionMax" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">pipelineDecisionMax</a></code></li><li><code><a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#v:pipelineDecisionMin" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">pipelineDecisionMin</a></code></li><li><code><a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#v:pipelineDecisionLowHighMark" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">pipelineDecisionLowHighMark</a></code></li></ul></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MkPipelineDecision" class="def">MkPipelineDecision</a> :: (<span class="keyword">forall</span> n. Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; (<a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n, <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a>)) -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:runPipelineDecision" class="def">runPipelineDecision</a> :: <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a> -&gt; Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; (<a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n, <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a>) <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#runPipelineDecision" class="link">Source</a> <a href="#v:runPipelineDecision" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:constantPipelineDecision" class="def">constantPipelineDecision</a> :: (<span class="keyword">forall</span> n. Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n) -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a> <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#constantPipelineDecision" class="link">Source</a> <a href="#v:constantPipelineDecision" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pipelineDecisionMax" class="def">pipelineDecisionMax</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#pipelineDecisionMax" class="link">Source</a> <a href="#v:pipelineDecisionMax" class="selflink">#</a></p><div class="doc"><p>Present maximal pipelining of at most <code>omax</code> requests.  Collect responses
 either when we are at the same block number as the server or when we sent
 more than <code>omax</code> requests.</p><p>If <code>omax = 3</code> this pipelining strategy will generate a sequence:
 <code>
    Pipeline
    Pipeline
    Pipeline
    Collect
    Pipeline
    Collect
    ....
    Pipeline
    Collect
    Collect
    Collect
 </code></p></div></div><div class="top"><p class="src"><a id="v:pipelineDecisionMin" class="def">pipelineDecisionMin</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; Nat n -&gt; WithOrigin BlockNo -&gt; WithOrigin BlockNo -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:PipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">PipelineDecision</a> n <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#pipelineDecisionMin" class="link">Source</a> <a href="#v:pipelineDecisionMin" class="selflink">#</a></p><div class="doc"><p>Present minimum pipelining of at most <code>omax</code> requests, collect responses
 eagerly.</p></div></div><div class="top"><p class="src"><a id="v:pipelineDecisionLowHighMark" class="def">pipelineDecisionLowHighMark</a> :: <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; <a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> -&gt; <a href="Ouroboros-Network-Protocol-ChainSync-PipelineDecision.html#t:MkPipelineDecision" title="Ouroboros.Network.Protocol.ChainSync.PipelineDecision">MkPipelineDecision</a> <a href="src/Ouroboros.Network.Protocol.ChainSync.PipelineDecision.html#pipelineDecisionLowHighMark" class="link">Source</a> <a href="#v:pipelineDecisionLowHighMark" class="selflink">#</a></p><div class="doc"><p>Pipelining strategy which pipelines up to <code>highMark</code> requests; if the
 number of pipelined messages exceeds the high mark, it collects messages
 until there are at most <code>lowMark</code> outstanding requests.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>