<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns              #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP                       #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls            #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances         #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings         #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types                #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances      #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- | An internal Snap module containing HTTP types.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- /N.B./ this is an internal interface, please don't write user code that</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- depends on it. Most of these declarations (except for the</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- unsafe/encapsulation-breaking ones) are re-exported from &quot;Snap.Core&quot;.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Snap.Internal.Http.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier">Builder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#byteString"><span class="hs-identifier">byteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#toLazyByteString"><span class="hs-identifier">toLazyByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Char8.html"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CI</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>                  </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#take"><span class="hs-identifier">take</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier">maybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier">mconcat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.html"><span class="hs-identifier">Data.Time.Clock</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier">UTCTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.POSIX.html"><span class="hs-identifier">Data.Time.Clock.POSIX</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.POSIX.html#utcTimeToPOSIXSeconds"><span class="hs-identifier">utcTimeToPOSIXSeconds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier">CTime</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier">Bool</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier">FilePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier">IO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#Integral"><span class="hs-identifier">Integral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Monad"><span class="hs-identifier">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#Num"><span class="hs-identifier">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Ordering"><span class="hs-identifier">Ordering</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier">Read</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#String"><span class="hs-identifier">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#fromInteger"><span class="hs-identifier">fromInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier">fromIntegral</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier">not</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier">otherwise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#truncate"><span class="hs-identifier">truncate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator">($)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator">(.)</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#ifdef PORTABLE
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Prelude</span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">realToFrac</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">$!</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.IOMode.html#IOMode"><span class="hs-identifier">IOMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.IOMode.html#ReadMode"><span class="hs-identifier">ReadMode</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Device.html#SeekMode"><span class="hs-identifier">SeekMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Device.html#AbsoluteSeek"><span class="hs-identifier">AbsoluteSeek</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Handle.html#hSeek"><span class="hs-identifier">hSeek</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.StdHandles.html#withBinaryFile"><span class="hs-identifier">withBinaryFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO.Streams</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">InputStream</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OutputStream</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Streams</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Streams</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier">unsafePerformIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span class="hs-cpp">
#ifdef PORTABLE
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Time.Clock.POSIX</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Time.Clock.POSIX</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Time.Format</span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Time</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Time.Locale.Compat</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">defaultTimeLocale</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Time.LocalTime</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html"><span class="hs-identifier">Data.ByteString.Unsafe</span></a></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Format.html"><span class="hs-identifier">Data.Time.Format</span></a></span><span>           </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.String.html"><span class="hs-identifier">Foreign.C.String</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Foreign.html#CString"><span class="hs-identifier">CString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.Marshal.Alloc.html"><span class="hs-identifier">Foreign.Marshal.Alloc</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.Marshal.Alloc.html#mallocBytes"><span class="hs-identifier">mallocBytes</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-61"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Snap.Types.Headers.html"><span class="hs-identifier">Snap.Types.Headers</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier">Headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html"><span class="hs-identifier">Snap.Types.Headers</span></a></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span class="hs-cpp">


#ifndef PORTABLE
</span><span>
</span><span id="line-68"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- foreign imports from cbits</span><span>
</span><span id="line-70"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;set_c_locale&quot;</span></span><span>
</span><span id="line-71"></span><span>        </span><span id="set_c_locale"><span class="annot"><a href="Snap.Internal.Http.Types.html#set_c_locale"><span class="hs-identifier hs-var">set_c_locale</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;c_parse_http_time&quot;</span></span><span>
</span><span id="line-74"></span><span>        </span><span id="c_parse_http_time"><span class="annot"><a href="Snap.Internal.Http.Types.html#c_parse_http_time"><span class="hs-identifier hs-var">c_parse_http_time</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;c_format_http_time&quot;</span></span><span>
</span><span id="line-77"></span><span>        </span><span id="c_format_http_time"><span class="annot"><a href="Snap.Internal.Http.Types.html#c_format_http_time"><span class="hs-identifier hs-var">c_format_http_time</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;c_format_log_time&quot;</span></span><span>
</span><span id="line-80"></span><span>        </span><span id="c_format_log_time"><span class="annot"><a href="Snap.Internal.Http.Types.html#c_format_log_time"><span class="hs-identifier hs-var">c_format_log_time</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">

#endif
</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | A typeclass for datatypes which contain HTTP headers.</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">class</span><span> </span><span id="HasHeaders"><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-var">HasHeaders</span></a></span></span><span> </span><span id="local-6989586621679112756"><span class="annot"><a href="#local-6989586621679112756"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- | Modify the datatype's headers.</span><span>
</span><span id="line-89"></span><span>    </span><span id="updateHeaders"><span class="annot"><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-type">updateHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112756"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112756"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- | Retrieve the headers from a datatype that has headers.</span><span>
</span><span id="line-92"></span><span>    </span><span id="headers"><span class="annot"><a href="Snap.Internal.Http.Types.html#headers"><span class="hs-identifier hs-type">headers</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679112756"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Adds a header key-value-pair to the 'HasHeaders' datatype. If a header</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- with the same name already exists, the new value is appended to the headers</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- list.</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-101"></span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Types.Headers&quot; as H</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- ghci&gt; 'addHeader' \&quot;Host\&quot; &quot;localhost&quot; H.'empty'</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- H {unH = [(&quot;host&quot;,&quot;localhost&quot;)]}</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- ghci&gt; 'addHeader' \&quot;Host\&quot; &quot;127.0.0.1&quot; it</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- H {unH = [(&quot;host&quot;,&quot;localhost,127.0.0.1&quot;)]}</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-109"></span><span id="local-6989586621679112753"><span class="annot"><a href="Snap.Internal.Http.Types.html#addHeader"><span class="hs-identifier hs-type">addHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679112753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112753"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-110"></span><span id="addHeader"><span class="annot"><span class="annottext">addHeader :: forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#addHeader"><span class="hs-identifier hs-var hs-var">addHeader</span></a></span></span><span> </span><span id="local-6989586621679113020"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113020"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113021"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113021"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; Headers) -&gt; a -&gt; a
forall a. HasHeaders a =&gt; (Headers -&gt; Headers) -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-var">updateHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">((Headers -&gt; Headers) -&gt; a -&gt; a) -&gt; (Headers -&gt; Headers) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Headers -&gt; Headers
</span><a href="Snap.Types.Headers.html#insert"><span class="hs-identifier hs-var">H.insert</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113020"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113021"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Sets a header key-value-pair in a 'HasHeaders' datatype. If a header with</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- the same name already exists, it is overwritten with the new value.</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Types.Headers&quot; as H</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- ghci&gt; 'setHeader' \&quot;Host\&quot; &quot;localhost&quot; H.'empty'</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- H {unH = [(\&quot;host\&quot;,\&quot;localhost\&quot;)]}</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- ghci&gt; setHeader \&quot;Host\&quot; &quot;127.0.0.1&quot; it</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- H {unH = [(&quot;host&quot;,&quot;127.0.0.1&quot;)]}</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-126"></span><span id="local-6989586621679113024"><span class="annot"><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-type">setHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113024"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679113024"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679113024"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-127"></span><span id="setHeader"><span class="annot"><span class="annottext">setHeader :: forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-var hs-var">setHeader</span></a></span></span><span> </span><span id="local-6989586621679113027"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113027"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113028"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113028"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; Headers) -&gt; a -&gt; a
forall a. HasHeaders a =&gt; (Headers -&gt; Headers) -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-var">updateHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">((Headers -&gt; Headers) -&gt; a -&gt; a) -&gt; (Headers -&gt; Headers) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Headers -&gt; Headers
</span><a href="Snap.Types.Headers.html#set"><span class="hs-identifier hs-var">H.set</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113027"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113028"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Gets a header value out of a 'HasHeaders' datatype.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Types.Headers&quot; as H</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- ghci&gt; 'getHeader' \&quot;Host\&quot; $ 'setHeader' \&quot;Host\&quot; &quot;localhost&quot; H.'empty'</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- Just &quot;localhost&quot;</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-140"></span><span id="local-6989586621679112761"><span class="annot"><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-type">getHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679112761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112761"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span>
</span><span id="line-141"></span><span id="getHeader"><span class="annot"><span class="annottext">getHeader :: forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-var hs-var">getHeader</span></a></span></span><span> </span><span id="local-6989586621679113033"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113033"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113034"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679113034"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Headers -&gt; Maybe ByteString
</span><a href="Snap.Types.Headers.html#lookup"><span class="hs-identifier hs-var">H.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113033"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; Maybe ByteString) -&gt; Headers -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Headers
forall a. HasHeaders a =&gt; a -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#headers"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679113034"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Lists all the headers out of a 'HasHeaders' datatype. If many</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- headers came in with the same name, they will be catenated together.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Types.Headers&quot; as H</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- ghci&gt; 'listHeaders' $ 'setHeader' \&quot;Host\&quot; &quot;localhost&quot; H.'empty'</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- [(&quot;host&quot;,&quot;localhost&quot;)]</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-155"></span><span id="local-6989586621679112763"><span class="annot"><a href="Snap.Internal.Http.Types.html#listHeaders"><span class="hs-identifier hs-type">listHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679112763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112763"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-156"></span><span id="listHeaders"><span class="annot"><span class="annottext">listHeaders :: forall a. HasHeaders a =&gt; a -&gt; [(CI ByteString, ByteString)]
</span><a href="Snap.Internal.Http.Types.html#listHeaders"><span class="hs-identifier hs-var hs-var">listHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Headers -&gt; [(CI ByteString, ByteString)]
</span><a href="Snap.Types.Headers.html#toList"><span class="hs-identifier hs-var">H.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; [(CI ByteString, ByteString)])
-&gt; (a -&gt; Headers) -&gt; a -&gt; [(CI ByteString, ByteString)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Headers
forall a. HasHeaders a =&gt; a -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#headers"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Clears a header value from a 'HasHeaders' datatype.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Types.Headers&quot; as H</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- ghci&gt; 'deleteHeader' \&quot;Host\&quot; $ 'setHeader' \&quot;Host\&quot; &quot;localhost&quot; H.'empty'</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- H {unH = []}</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-169"></span><span id="local-6989586621679112768"><span class="annot"><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier hs-type">deleteHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679112768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679112768"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-170"></span><span id="deleteHeader"><span class="annot"><span class="annottext">deleteHeader :: forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier hs-var hs-var">deleteHeader</span></a></span></span><span> </span><span id="local-6989586621679113043"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113043"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; Headers) -&gt; a -&gt; a
forall a. HasHeaders a =&gt; (Headers -&gt; Headers) -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-var">updateHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">((Headers -&gt; Headers) -&gt; a -&gt; a) -&gt; (Headers -&gt; Headers) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Headers -&gt; Headers
</span><a href="Snap.Types.Headers.html#delete"><span class="hs-identifier hs-var">H.delete</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113043"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Enumerates the HTTP method values (see</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- &lt;http://tools.ietf.org/html/rfc2068.html#section-5.1.1&gt;).</span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="Method"><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-var">Method</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GET"><span class="annot"><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-var">GET</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="HEAD"><span class="annot"><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="POST"><span class="annot"><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-var">POST</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="PUT"><span class="annot"><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DELETE"><span class="annot"><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="TRACE"><span class="annot"><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="OPTIONS"><span class="annot"><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="CONNECT"><span class="annot"><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span></span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-177"></span><span>               </span><span id="PATCH"><span class="annot"><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Method"><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-var">Method</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-178"></span><span>               </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span id="local-6989586621679113056"><span id="local-6989586621679113062"><span id="local-6989586621679113066"><span class="annot"><span class="annottext">Int -&gt; Method -&gt; ShowS
[Method] -&gt; ShowS
Method -&gt; String
(Int -&gt; Method -&gt; ShowS)
-&gt; (Method -&gt; String) -&gt; ([Method] -&gt; ShowS) -&gt; Show Method
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Method -&gt; ShowS
showsPrec :: Int -&gt; Method -&gt; ShowS
$cshow :: Method -&gt; String
show :: Method -&gt; String
$cshowList :: [Method] -&gt; ShowS
showList :: [Method] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679113070"><span id="local-6989586621679113074"><span id="local-6989586621679113077"><span id="local-6989586621679113094"><span class="annot"><span class="annottext">ReadPrec [Method]
ReadPrec Method
Int -&gt; ReadS Method
ReadS [Method]
(Int -&gt; ReadS Method)
-&gt; ReadS [Method]
-&gt; ReadPrec Method
-&gt; ReadPrec [Method]
-&gt; Read Method
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS Method
readsPrec :: Int -&gt; ReadS Method
$creadList :: ReadS [Method]
readList :: ReadS [Method]
$creadPrec :: ReadPrec Method
readPrec :: ReadPrec Method
$creadListPrec :: ReadPrec [Method]
readListPrec :: ReadPrec [Method]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679113099"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679113103"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113103"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679113104"><span class="annot"><span class="annottext">== :: Method -&gt; Method -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679113105"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113105"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Method -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-var">normalizeMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113103"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Method -&gt; Method -&gt; Bool
</span><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-var">normalizeMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113105"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span>       </span><span id="local-6989586621679113107"><span class="annot"><span class="annottext">eq :: Method -&gt; Method -&gt; Bool
</span><a href="#local-6989586621679113107"><span class="hs-operator hs-var hs-var">`eq`</span></a></span></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span><span>      </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>      </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span>       </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span>    </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span> </span><span id="local-6989586621679113109"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113109"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span> </span><span id="local-6989586621679113110"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113110"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113109"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113110"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier">_</span></span><span>         </span><span class="annot"><a href="#local-6989586621679113107"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679113115"><span id="local-6989586621679113119"><span id="local-6989586621679113122"><span id="local-6989586621679113125"><span id="local-6989586621679113128"><span id="local-6989586621679113131"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621679113134"><span class="annot"><span class="annottext">compare :: Method -&gt; Method -&gt; Ordering
</span><a href="#local-6989586621679113134"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span id="local-6989586621679113136"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113136"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679113137"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113137"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>            </span><span class="annot"><span class="annottext">Method -&gt; Method -&gt; Ordering
</span><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Method -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-var">normalizeMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Method -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-var">normalizeMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113137"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>            </span><span id="local-6989586621679113138"><span class="annot"><span class="annottext">check :: Method -&gt; Method -&gt; Ordering
</span><a href="#local-6989586621679113138"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span>          </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-201"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span><span>         </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-202"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>         </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span>          </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-204"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span>       </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-205"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span><span>      </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span><span>      </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span>        </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span>  </span><span id="local-6989586621679113141"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113141"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span>   </span><span id="local-6989586621679113142"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113142"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113141"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113142"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><a href="#local-6989586621679113138"><span class="hs-identifier hs-var">check</span></a></span><span>   </span><span id="local-6989586621679113143"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113143"><span class="hs-identifier hs-var">x</span></a></span></span><span>            </span><span id="local-6989586621679113144"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113144"><span class="hs-identifier hs-var">y</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Method -&gt; Int
</span><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113143"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Method -&gt; Int
</span><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113144"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span id="local-6989586621679113145"><span class="annot"><span class="annottext">tag :: Method -&gt; Int
</span><a href="#local-6989586621679113145"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-type">GET</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-214"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-type">HEAD</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-215"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-type">POST</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-216"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-type">PUT</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-217"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-type">DELETE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-218"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-type">TRACE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-219"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-type">OPTIONS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-type">CONNECT</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-221"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-type">PATCH</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-222"></span><span>            </span><span class="annot"><a href="#local-6989586621679113145"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Equate the special case constructors with their corresponding</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- @Method name@ variant.</span><span>
</span><span id="line-226"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-pragma hs-type">normalizeMethod</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-type">normalizeMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span>
</span><span id="line-228"></span><span id="normalizeMethod"><span class="annot"><span class="annottext">normalizeMethod :: Method -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-var hs-var">normalizeMethod</span></a></span></span><span> </span><span id="local-6989586621679113146"><span class="annot"><span class="annottext">m :: Method
</span><a href="#local-6989586621679113146"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span> </span><span id="local-6989586621679113147"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113147"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113147"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;GET&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span>
</span><span id="line-230"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HEAD&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span><span>
</span><span id="line-231"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>
</span><span id="line-232"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;PUT&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span>
</span><span id="line-233"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span>
</span><span id="line-234"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;TRACE&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span><span>
</span><span id="line-235"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;OPTIONS&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span><span>
</span><span id="line-236"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;CONNECT&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span><span>
</span><span id="line-237"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;PATCH&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Snap.Internal.Http.Types.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span>
</span><span id="line-238"></span><span>                                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113146"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#normalizeMethod"><span class="hs-identifier hs-var">normalizeMethod</span></a></span><span> </span><span id="local-6989586621679113148"><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113148"><span class="hs-identifier hs-var">m</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679113148"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">-- | Represents a (major, minor) version of the HTTP protocol.</span></span><span>
</span><span id="line-244"></span><span class="hs-keyword">type</span><span> </span><span id="HttpVersion"><span class="annot"><a href="Snap.Internal.Http.Types.html#HttpVersion"><span class="hs-identifier hs-var">HttpVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">-- | A datatype representing an HTTP cookie.</span></span><span>
</span><span id="line-249"></span><span class="hs-keyword">data</span><span> </span><span id="Cookie"><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-var">Cookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cookie"><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-var">Cookie</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="hs-comment">-- | The name of the cookie.</span></span><span>
</span><span id="line-251"></span><span>      </span><span id="cookieName"><span class="annot"><span class="annottext">Cookie -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#cookieName"><span class="hs-identifier hs-var hs-var">cookieName</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="hs-comment">-- | The cookie's string value.</span></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cookieValue"><span class="annot"><span class="annottext">Cookie -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#cookieValue"><span class="hs-identifier hs-var hs-var">cookieValue</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="hs-comment">-- | The cookie's expiration value, if it has one.</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cookieExpires"><span class="annot"><span class="annottext">Cookie -&gt; Maybe UTCTime
</span><a href="Snap.Internal.Http.Types.html#cookieExpires"><span class="hs-identifier hs-var hs-var">cookieExpires</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="hs-comment">-- | The cookie's \&quot;domain\&quot; value, if it has one.</span></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cookieDomain"><span class="annot"><span class="annottext">Cookie -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#cookieDomain"><span class="hs-identifier hs-var hs-var">cookieDomain</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="hs-comment">-- | The cookie path.</span></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cookiePath"><span class="annot"><span class="annottext">Cookie -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#cookiePath"><span class="hs-identifier hs-var hs-var">cookiePath</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Tag as secure cookie?</span></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cookieSecure"><span class="annot"><span class="annottext">Cookie -&gt; Bool
</span><a href="Snap.Internal.Http.Types.html#cookieSecure"><span class="hs-identifier hs-var hs-var">cookieSecure</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><span class="hs-comment">-- | HTTP only?</span></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cookieHttpOnly"><span class="annot"><span class="annottext">Cookie -&gt; Bool
</span><a href="Snap.Internal.Http.Types.html#cookieHttpOnly"><span class="hs-identifier hs-var hs-var">cookieHttpOnly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-270"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679113158"><span id="local-6989586621679113170"><span class="annot"><span class="annottext">Cookie -&gt; Cookie -&gt; Bool
(Cookie -&gt; Cookie -&gt; Bool)
-&gt; (Cookie -&gt; Cookie -&gt; Bool) -&gt; Eq Cookie
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Cookie -&gt; Cookie -&gt; Bool
== :: Cookie -&gt; Cookie -&gt; Bool
$c/= :: Cookie -&gt; Cookie -&gt; Bool
/= :: Cookie -&gt; Cookie -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679113175"><span id="local-6989586621679113188"><span id="local-6989586621679113192"><span class="annot"><span class="annottext">Int -&gt; Cookie -&gt; ShowS
[Cookie] -&gt; ShowS
Cookie -&gt; String
(Int -&gt; Cookie -&gt; ShowS)
-&gt; (Cookie -&gt; String) -&gt; ([Cookie] -&gt; ShowS) -&gt; Show Cookie
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Cookie -&gt; ShowS
showsPrec :: Int -&gt; Cookie -&gt; ShowS
$cshow :: Cookie -&gt; String
show :: Cookie -&gt; String
$cshowList :: [Cookie] -&gt; ShowS
showList :: [Cookie] -&gt; ShowS
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | A type alias for the HTTP parameters mapping. Each parameter</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- key maps to a list of 'ByteString' values; if a parameter is specified</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- multiple times (e.g.: \&quot;@GET /foo?param=bar1&amp;param=bar2@\&quot;), looking up</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- \&quot;@param@\&quot; in the mapping will give you @[\&quot;bar1\&quot;, \&quot;bar2\&quot;]@.</span><span>
</span><span id="line-278"></span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Snap.Internal.Http.Types.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- request type</span><span>
</span><span id="line-283"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">-- | Contains all of the information about an incoming HTTP request.</span></span><span>
</span><span id="line-287"></span><span class="hs-keyword">data</span><span> </span><span id="Request"><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-var">Request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Request"><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-var">Request</span></a></span></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | The server name of the request, as it came in from the request's</span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-comment">-- @Host:@ header.</span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-comment">-- ghci|         T.get &quot;\/foo\/bar&quot; M.empty</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-comment">-- ghci|         T.setHeader &quot;host&quot; &quot;example.com&quot;</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqHostName rq</span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-comment">-- &quot;example.com&quot;</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-305"></span><span>      </span><span id="rqHostName"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqHostName"><span class="hs-identifier hs-var hs-var">rqHostName</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-comment">-- | The remote IP address.</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqClientAddr \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-comment">-- &quot;127.0.0.1&quot;</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqClientAddr"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqClientAddr"><span class="hs-identifier hs-var hs-var">rqClientAddr</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-comment">-- | The remote TCP port number.</span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqClientPort \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-comment">-- &quot;60000&quot;</span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqClientPort"><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rqClientPort"><span class="hs-identifier hs-var hs-var">rqClientPort</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-comment">-- | The local IP address for this request.</span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqServerAddr \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-comment">-- &quot;127.0.0.1&quot;</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqServerAddr"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqServerAddr"><span class="hs-identifier hs-var hs-var">rqServerAddr</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-comment">-- | Returns the port number the HTTP server is listening on. This may be</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-comment">-- useless from the perspective of external requests, e.g. if the server</span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-comment">-- is running behind a proxy.</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqServerPort \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-comment">-- 8080</span><span>
</span><span id="line-358"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqServerPort"><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rqServerPort"><span class="hs-identifier hs-var hs-var">rqServerPort</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-comment">-- | Returns the HTTP server's idea of its local hostname, including</span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-comment">-- port. This is as configured with the @Config@ object at startup.</span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqLocalHostname \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-371"></span><span>      </span><span class="hs-comment">-- &quot;localhost&quot;</span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqLocalHostname"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqLocalHostname"><span class="hs-identifier hs-var hs-var">rqLocalHostname</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-comment">-- | Returns @True@ if this is an HTTPS session.</span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-377"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-383"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqIsSecure \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-384"></span><span>      </span><span class="hs-comment">-- False</span><span>
</span><span id="line-385"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqIsSecure"><span class="annot"><span class="annottext">Request -&gt; Bool
</span><a href="Snap.Internal.Http.Types.html#rqIsSecure"><span class="hs-identifier hs-var hs-var">rqIsSecure</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-comment">-- | Contains all HTTP 'Headers' associated with this request.</span><span>
</span><span id="line-389"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-391"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-393"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-394"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqHeaders \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">-- H {unH = [(&quot;host&quot;,&quot;localhost&quot;)]}</span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqHeaders"><span class="annot"><span class="annottext">Request -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#rqHeaders"><span class="hs-identifier hs-var hs-var">rqHeaders</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Actual body of the request.</span></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqBody"><span class="annot"><span class="annottext">Request -&gt; InputStream ByteString
</span><a href="Snap.Internal.Http.Types.html#rqBody"><span class="hs-identifier hs-var hs-var">rqBody</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-comment">-- | Returns the @Content-Length@ of the HTTP request body.</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-411"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-412"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqContentLength \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-414"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqContentLength"><span class="annot"><span class="annottext">Request -&gt; Maybe Word64
</span><a href="Snap.Internal.Http.Types.html#rqContentLength"><span class="hs-identifier hs-var hs-var">rqContentLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-comment">-- | Returns the HTTP request method.</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-422"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-423"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqMethod \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-comment">-- GET</span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqMethod"><span class="annot"><span class="annottext">Request -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#rqMethod"><span class="hs-identifier hs-var hs-var">rqMethod</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-comment">-- | Returns the HTTP version used by the client.</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-436"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqVersion \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-comment">-- (1,1)</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqVersion"><span class="annot"><span class="annottext">Request -&gt; HttpVersion
</span><a href="Snap.Internal.Http.Types.html#rqVersion"><span class="hs-identifier hs-var hs-var">rqVersion</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Snap.Internal.Http.Types.html#HttpVersion"><span class="hs-identifier hs-type">HttpVersion</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span>      </span><span class="hs-comment">-- | Returns a list of the cookies that came in from the HTTP request</span><span>
</span><span id="line-444"></span><span>      </span><span class="hs-comment">-- headers.</span><span>
</span><span id="line-445"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqCookies \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-453"></span><span>      </span><span class="hs-comment">-- []</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqCookies"><span class="annot"><span class="annottext">Request -&gt; [Cookie]
</span><a href="Snap.Internal.Http.Types.html#rqCookies"><span class="hs-identifier hs-var hs-var">rqCookies</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-comment">-- | Handlers can be hung on a @URI@ \&quot;entry point\&quot;; this is called the</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-comment">-- \&quot;context path\&quot;. If a handler is hung on the context path</span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-comment">-- @\&quot;\/foo\/\&quot;@, and you request @\&quot;\/foo\/bar\&quot;@, the value of</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-comment">-- 'rqPathInfo' will be @\&quot;bar\&quot;@.</span><span>
</span><span id="line-461"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-comment">-- The following identity holds:</span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-comment">-- &gt; rqURI r == S.concat [ rqContextPath r</span><span>
</span><span id="line-465"></span><span>      </span><span class="hs-comment">-- &gt;                     , rqPathInfo r</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-comment">-- &gt;                     , let q = rqQueryString r</span><span>
</span><span id="line-467"></span><span>      </span><span class="hs-comment">-- &gt;                       in if S.null q</span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-comment">-- &gt;                            then &quot;&quot;</span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-comment">-- &gt;                            else S.append &quot;?&quot; q</span><span>
</span><span id="line-470"></span><span>      </span><span class="hs-comment">-- &gt;                     ]</span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-473"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-475"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-477"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-478"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqPathInfo \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-comment">-- &quot;foo/bar&quot;</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqPathInfo"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqPathInfo"><span class="hs-identifier hs-var hs-var">rqPathInfo</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-comment">-- | The \&quot;context path\&quot; of the request; catenating 'rqContextPath',</span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-comment">-- and 'rqPathInfo' should get you back to the original 'rqURI'</span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-comment">-- (ignoring query strings). The 'rqContextPath' always begins and ends</span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-comment">-- with a slash (@\&quot;\/\&quot;@) character, and represents the path (relative</span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-comment">-- to your component\/snaplet) you took to get to your handler.</span><span>
</span><span id="line-488"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-490"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-492"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-494"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqContextPath \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-comment">-- &quot;/&quot;</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqContextPath"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqContextPath"><span class="hs-identifier hs-var hs-var">rqContextPath</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-comment">-- | Returns the @URI@ requested by the client.</span><span>
</span><span id="line-501"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-503"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-504"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-505"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-507"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqURI \`fmap\` T.buildRequest (T.get &quot;\/foo\/bar&quot; M.empty)</span><span>
</span><span id="line-509"></span><span>      </span><span class="hs-comment">-- &quot;foo/bar&quot;</span><span>
</span><span id="line-510"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqURI"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqURI"><span class="hs-identifier hs-var hs-var">rqURI</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>      </span><span class="hs-comment">-- | Returns the HTTP query string for this 'Request'.</span><span>
</span><span id="line-514"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-515"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-516"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-517"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-518"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-519"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-520"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-521"></span><span>      </span><span class="hs-comment">-- ghci&gt; rq &lt;- T.buildRequest (T.get &quot;\/foo\/bar&quot; (M.fromList [(&quot;name&quot;, [&quot;value&quot;])]))</span><span>
</span><span id="line-522"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqQueryString rq</span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-comment">-- &quot;name=value&quot;</span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqQueryString"><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqQueryString"><span class="hs-identifier hs-var hs-var">rqQueryString</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-comment">-- | Returns the parameters mapping for this 'Request'. \&quot;Parameters\&quot;</span><span>
</span><span id="line-528"></span><span>      </span><span class="hs-comment">-- are automatically decoded from the URI's query string and @POST@ body</span><span>
</span><span id="line-529"></span><span>      </span><span class="hs-comment">-- and entered into this mapping. The 'rqParams' value is thus a union of</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-comment">-- 'rqQueryParams' and 'rqPostParams'.</span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-532"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-534"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-535"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-536"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-537"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-538"></span><span>      </span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-539"></span><span>      </span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-540"></span><span>      </span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-541"></span><span>      </span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-542"></span><span>      </span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-543"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqParams rq</span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-comment">-- fromList [(&quot;baz&quot;,[&quot;qux&quot;,&quot;quux&quot;])]</span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqParams"><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqParams"><span class="hs-identifier hs-var hs-var">rqParams</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>      </span><span class="hs-comment">-- | The parameter mapping decoded from the URI's query string.</span><span>
</span><span id="line-549"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-550"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-551"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-552"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-553"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-554"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-555"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-556"></span><span>      </span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-557"></span><span>      </span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-558"></span><span>      </span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-559"></span><span>      </span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-560"></span><span>      </span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-561"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqQueryParams rq</span><span>
</span><span id="line-562"></span><span>      </span><span class="hs-comment">-- fromList [(&quot;baz&quot;,[&quot;quux&quot;])]</span><span>
</span><span id="line-563"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqQueryParams"><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqQueryParams"><span class="hs-identifier hs-var hs-var">rqQueryParams</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>      </span><span class="hs-comment">-- | The parameter mapping decoded from the POST body. Note that Snap</span><span>
</span><span id="line-567"></span><span>      </span><span class="hs-comment">-- only auto-decodes POST request bodies when the request's</span><span>
</span><span id="line-568"></span><span>      </span><span class="hs-comment">-- @Content-Type@ is @application\/x-www-form-urlencoded@.</span><span>
</span><span id="line-569"></span><span>      </span><span class="hs-comment">-- For @multipart\/form-data@ use 'Snap.Util.FileUploads.handleFileUploads'</span><span>
</span><span id="line-570"></span><span>      </span><span class="hs-comment">-- to decode the POST request and fill this mapping.</span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-572"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-573"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-574"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-582"></span><span>      </span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-comment">-- ghci&gt; rqPostParams rq</span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-comment">-- fromList [(&quot;baz&quot;,[&quot;qux&quot;])]</span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-586"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rqPostParams"><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqPostParams"><span class="hs-identifier hs-var hs-var">rqPostParams</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-587"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-591"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679113217"><span id="local-6989586621679113222"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-592"></span><span>  </span><span id="local-6989586621679113236"><span class="annot"><span class="annottext">show :: Request -&gt; String
</span><a href="#local-6989586621679113236"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679113238"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113240"><span class="hs-identifier hs-var">method</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113241"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; HTTP/&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113242"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-593"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113243"><span class="hs-identifier hs-var">hdrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span>
</span><span id="line-594"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sn=\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113244"><span class="hs-identifier hs-var">sname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot; c=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113245"><span class="hs-identifier hs-var">clntAddr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; s=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113246"><span class="hs-identifier hs-var">srvAddr</span></a></span><span>
</span><span id="line-595"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ctx=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113247"><span class="hs-identifier hs-var">contextpath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; clen=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113248"><span class="hs-identifier hs-var">contentlength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113249"><span class="hs-identifier hs-var">secure</span></a></span><span>
</span><span id="line-596"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113250"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113251"><span class="hs-identifier hs-var">cookies</span></a></span><span>
</span><span id="line-597"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-599"></span><span>      </span><span id="local-6989586621679113240"><span class="annot"><span class="annottext">method :: String
</span><a href="#local-6989586621679113240"><span class="hs-identifier hs-var hs-var">method</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Method -&gt; String) -&gt; Method -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Method
</span><a href="Snap.Internal.Http.Types.html#rqMethod"><span class="hs-identifier hs-var">rqMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span id="local-6989586621679113241"><span class="annot"><span class="annottext">uri :: String
</span><a href="#local-6989586621679113241"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqURI"><span class="hs-identifier hs-var">rqURI</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span id="local-6989586621679113242"><span class="annot"><span class="annottext">version :: String
</span><a href="#local-6989586621679113242"><span class="hs-identifier hs-var hs-var">version</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679113259"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113259"><span class="hs-identifier hs-var">mj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679113260"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113260"><span class="hs-identifier hs-var">mn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; HttpVersion
</span><a href="Snap.Internal.Http.Types.html#rqVersion"><span class="hs-identifier hs-var">rqVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113259"><span class="hs-identifier hs-var">mj</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113260"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span id="local-6989586621679113243"><span class="annot"><span class="annottext">hdrs :: String
</span><a href="#local-6989586621679113243"><span class="hs-identifier hs-var hs-var">hdrs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((CI ByteString, ByteString) -&gt; String)
-&gt; [(CI ByteString, ByteString)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(CI ByteString, ByteString) -&gt; String
</span><a href="#local-6989586621679113264"><span class="hs-identifier hs-var">showHdr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Headers -&gt; [(CI ByteString, ByteString)]
</span><a href="Snap.Types.Headers.html#toList"><span class="hs-identifier hs-var">H.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; [(CI ByteString, ByteString)])
-&gt; Headers -&gt; [(CI ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#rqHeaders"><span class="hs-identifier hs-var">rqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>      </span><span id="local-6989586621679113264"><span class="annot"><span class="annottext">showHdr :: (CI ByteString, ByteString) -&gt; String
</span><a href="#local-6989586621679113264"><span class="hs-identifier hs-var hs-var">showHdr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679113267"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113267"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679113268"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113268"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113267"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113268"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span id="local-6989586621679113244"><span class="annot"><span class="annottext">sname :: String
</span><a href="#local-6989586621679113244"><span class="hs-identifier hs-var hs-var">sname</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqLocalHostname"><span class="hs-identifier hs-var">rqLocalHostname</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span id="local-6989586621679113245"><span class="annot"><span class="annottext">clntAddr :: String
</span><a href="#local-6989586621679113245"><span class="hs-identifier hs-var hs-var">clntAddr</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqClientAddr"><span class="hs-identifier hs-var">rqClientAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rqClientPort"><span class="hs-identifier hs-var">rqClientPort</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-606"></span><span>      </span><span id="local-6989586621679113246"><span class="annot"><span class="annottext">srvAddr :: String
</span><a href="#local-6989586621679113246"><span class="hs-identifier hs-var hs-var">srvAddr</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqServerAddr"><span class="hs-identifier hs-var">rqServerAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rqServerPort"><span class="hs-identifier hs-var">rqServerPort</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span>      </span><span id="local-6989586621679113247"><span class="annot"><span class="annottext">contextpath :: String
</span><a href="#local-6989586621679113247"><span class="hs-identifier hs-var hs-var">contextpath</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqContextPath"><span class="hs-identifier hs-var">rqContextPath</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-608"></span><span>      </span><span id="local-6989586621679113248"><span class="annot"><span class="annottext">contentlength :: String
</span><a href="#local-6989586621679113248"><span class="hs-identifier hs-var hs-var">contentlength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Word64 -&gt; String) -&gt; Maybe Word64 -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;n/a&quot;</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Maybe Word64
</span><a href="Snap.Internal.Http.Types.html#rqContentLength"><span class="hs-identifier hs-var">rqContentLength</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>      </span><span id="local-6989586621679113249"><span class="annot"><span class="annottext">secure :: String
</span><a href="#local-6989586621679113249"><span class="hs-identifier hs-var hs-var">secure</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Bool
</span><a href="Snap.Internal.Http.Types.html#rqIsSecure"><span class="hs-identifier hs-var">rqIsSecure</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; secure&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>      </span><span id="local-6989586621679113250"><span class="annot"><span class="annottext">params :: String
</span><a href="#local-6989586621679113250"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; [String] -&gt; String
</span><a href="#local-6989586621679113289"><span class="hs-identifier hs-var">showFlds</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nparams: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-612"></span><span>                      </span><span class="annot"><span class="annottext">((ByteString, [ByteString]) -&gt; String)
-&gt; [(ByteString, [ByteString])] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679113290"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113290"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679113291"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679113291"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113290"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679113291"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; [(ByteString, [ByteString])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toAscList"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; [(ByteString, [ByteString])])
-&gt; Params -&gt; [(ByteString, [ByteString])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqParams"><span class="hs-identifier hs-var">rqParams</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>      </span><span id="local-6989586621679113251"><span class="annot"><span class="annottext">cookies :: String
</span><a href="#local-6989586621679113251"><span class="hs-identifier hs-var hs-var">cookies</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; [String] -&gt; String
</span><a href="#local-6989586621679113289"><span class="hs-identifier hs-var">showFlds</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\ncookies: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n         &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-615"></span><span>                      </span><span class="annot"><span class="annottext">(Cookie -&gt; String) -&gt; [Cookie] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Cookie -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; [Cookie]
</span><a href="Snap.Internal.Http.Types.html#rqCookies"><span class="hs-identifier hs-var">rqCookies</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113238"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>      </span><span id="local-6989586621679113289"><span class="annot"><span class="annottext">showFlds :: String -&gt; String -&gt; [String] -&gt; String
</span><a href="#local-6989586621679113289"><span class="hs-identifier hs-var hs-var">showFlds</span></a></span></span><span> </span><span id="local-6989586621679113295"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113295"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679113296"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113296"><span class="hs-identifier hs-var">delim</span></a></span></span><span> </span><span id="local-6989586621679113297"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679113297"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-618"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([String] -&gt; Bool) -&gt; [String] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Bool) -&gt; [String] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679113297"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113295"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113296"><span class="hs-identifier hs-var">delim</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679113297"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-622"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621679113303"><span class="annot"><span class="annottext">headers :: Request -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#headers"><span class="hs-identifier hs-var hs-var hs-var hs-var">headers</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#rqHeaders"><span class="hs-identifier hs-var">rqHeaders</span></a></span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679113304"><span class="annot"><span class="annottext">updateHeaders :: (Headers -&gt; Headers) -&gt; Request -&gt; Request
</span><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateHeaders</span></a></span></span><span> </span><span id="local-6989586621679113305"><span class="annot"><span class="annottext">Headers -&gt; Headers
</span><a href="#local-6989586621679113305"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679113306"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113306"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113306"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqHeaders"><span class="hs-identifier hs-var">rqHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679113305"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqHeaders"><span class="hs-identifier hs-var">rqHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113306"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-628"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679113310"><span class="annot"><span class="annottext">headers :: Headers -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#headers"><span class="hs-identifier hs-var hs-var hs-var hs-var">headers</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Headers -&gt; Headers
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span id="local-6989586621679113311"><span class="annot"><span class="annottext">updateHeaders :: (Headers -&gt; Headers) -&gt; Headers -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; Headers) -&gt; Headers -&gt; Headers
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- response type</span><span>
</span><span id="line-634"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span class="hs-keyword">type</span><span> </span><span id="StreamProc"><span class="annot"><a href="Snap.Internal.Http.Types.html#StreamProc"><span class="hs-identifier hs-var">StreamProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span class="hs-keyword">data</span><span> </span><span id="ResponseBody"><span class="annot"><a href="Snap.Internal.Http.Types.html#ResponseBody"><span class="hs-identifier hs-var">ResponseBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Stream"><span class="annot"><a href="Snap.Internal.Http.Types.html#Stream"><span class="hs-identifier hs-var">Stream</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#StreamProc"><span class="hs-identifier hs-type">StreamProc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>                      </span><span class="hs-comment">-- ^ output body is a function that writes to a 'Builder'</span><span>
</span><span id="line-639"></span><span>                      </span><span class="hs-comment">-- stream</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="SendFile"><span class="annot"><a href="Snap.Internal.Http.Types.html#SendFile"><span class="hs-identifier hs-var">SendFile</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>                      </span><span class="hs-comment">-- ^ output body is sendfile(), optional second argument</span><span>
</span><span id="line-643"></span><span>                      </span><span class="hs-comment">--   is a byte range to send</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-647"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBodyMap"><span class="hs-identifier hs-type">rspBodyMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#StreamProc"><span class="hs-identifier hs-type">StreamProc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#StreamProc"><span class="hs-identifier hs-type">StreamProc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#ResponseBody"><span class="hs-identifier hs-type">ResponseBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#ResponseBody"><span class="hs-identifier hs-type">ResponseBody</span></a></span><span>
</span><span id="line-648"></span><span id="rspBodyMap"><span class="annot"><span class="annottext">rspBodyMap :: (StreamProc -&gt; StreamProc) -&gt; ResponseBody -&gt; ResponseBody
</span><a href="Snap.Internal.Http.Types.html#rspBodyMap"><span class="hs-identifier hs-var hs-var">rspBodyMap</span></a></span></span><span> </span><span id="local-6989586621679113315"><span class="annot"><span class="annottext">StreamProc -&gt; StreamProc
</span><a href="#local-6989586621679113315"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679113316"><span class="annot"><span class="annottext">ResponseBody
</span><a href="#local-6989586621679113316"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StreamProc -&gt; ResponseBody
</span><a href="Snap.Internal.Http.Types.html#Stream"><span class="hs-identifier hs-var">Stream</span></a></span><span> </span><span class="annot"><span class="annottext">(StreamProc -&gt; ResponseBody) -&gt; StreamProc -&gt; ResponseBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StreamProc -&gt; StreamProc
</span><a href="#local-6989586621679113315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(StreamProc -&gt; StreamProc) -&gt; StreamProc -&gt; StreamProc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ResponseBody -&gt; StreamProc
</span><a href="Snap.Internal.Http.Types.html#rspBodyToEnum"><span class="hs-identifier hs-var">rspBodyToEnum</span></a></span><span> </span><span class="annot"><span class="annottext">ResponseBody
</span><a href="#local-6989586621679113316"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-652"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBodyToEnum"><span class="hs-identifier hs-type">rspBodyToEnum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#ResponseBody"><span class="hs-identifier hs-type">ResponseBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#StreamProc"><span class="hs-identifier hs-type">StreamProc</span></a></span><span>
</span><span id="line-653"></span><span id="rspBodyToEnum"><span class="annot"><span class="annottext">rspBodyToEnum :: ResponseBody -&gt; StreamProc
</span><a href="Snap.Internal.Http.Types.html#rspBodyToEnum"><span class="hs-identifier hs-var hs-var">rspBodyToEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span id="local-6989586621679113318"><span class="annot"><span class="annottext">StreamProc
</span><a href="#local-6989586621679113318"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StreamProc
</span><a href="#local-6989586621679113318"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBodyToEnum"><span class="hs-identifier hs-var">rspBodyToEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#SendFile"><span class="hs-identifier hs-type">SendFile</span></a></span><span> </span><span id="local-6989586621679113319"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113319"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Word64, Word64)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679113320"><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113320"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><span class="annottext">String
-&gt; (InputStream ByteString -&gt; IO (OutputStream Builder))
-&gt; IO (OutputStream Builder)
forall a. String -&gt; (InputStream ByteString -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">Streams.withFileAsInput</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113319"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((InputStream ByteString -&gt; IO (OutputStream Builder))
 -&gt; IO (OutputStream Builder))
-&gt; (InputStream ByteString -&gt; IO (OutputStream Builder))
-&gt; IO (OutputStream Builder)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679113322"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679113322"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-657"></span><span>        </span><span id="local-6989586621679113323"><span class="annot"><span class="annottext">InputStream Builder
</span><a href="#local-6989586621679113323"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO Builder)
-&gt; InputStream ByteString -&gt; IO (InputStream Builder)
forall a b. (a -&gt; IO b) -&gt; InputStream a -&gt; IO (InputStream b)
</span><span class="hs-identifier hs-var">Streams.mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; IO Builder)
-&gt; (ByteString -&gt; Builder) -&gt; ByteString -&gt; IO Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#byteString"><span class="hs-identifier hs-var">byteString</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679113322"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-658"></span><span>        </span><span class="annot"><span class="annottext">InputStream Builder -&gt; OutputStream Builder -&gt; IO ()
forall a. InputStream a -&gt; OutputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.connect</span></span><span> </span><span class="annot"><span class="annottext">InputStream Builder
</span><a href="#local-6989586621679113323"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113320"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span class="annot"><span class="annottext">StreamProc
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113320"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBodyToEnum"><span class="hs-identifier hs-var">rspBodyToEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#SendFile"><span class="hs-identifier hs-type">SendFile</span></a></span><span> </span><span id="local-6989586621679113326"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113326"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679113327"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113327"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679113328"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113328"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679113329"><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113329"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><span class="annottext">String
-&gt; IOMode
-&gt; (Handle -&gt; IO (OutputStream Builder))
-&gt; IO (OutputStream Builder)
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.StdHandles.html#withBinaryFile"><span class="hs-identifier hs-var">withBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113326"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.IOMode.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO (OutputStream Builder))
 -&gt; IO (OutputStream Builder))
-&gt; (Handle -&gt; IO (OutputStream Builder))
-&gt; IO (OutputStream Builder)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679113330"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679113330"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113327"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; SeekMode -&gt; Integer -&gt; IO ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Handle.html#hSeek"><span class="hs-identifier hs-var">hSeek</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679113330"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">SeekMode
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Device.html#AbsoluteSeek"><span class="hs-identifier hs-var">AbsoluteSeek</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; IO ()) -&gt; Integer -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113327"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-664"></span><span>        </span><span id="local-6989586621679113331"><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679113331"><span class="hs-identifier hs-var">is</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO (InputStream ByteString)
</span><span class="hs-identifier hs-var">Streams.handleToInputStream</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679113330"><span class="hs-identifier hs-var">handle</span></a></span><span>
</span><span id="line-665"></span><span>        </span><span id="local-6989586621679113333"><span class="annot"><span class="annottext">InputStream Builder
</span><a href="#local-6989586621679113333"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; InputStream ByteString -&gt; IO (InputStream ByteString)
</span><span class="hs-identifier hs-var">Streams.takeBytes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int64) -&gt; Word64 -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113328"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113327"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InputStream ByteString
</span><a href="#local-6989586621679113331"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">IO (InputStream ByteString)
-&gt; (InputStream ByteString -&gt; IO (InputStream Builder))
-&gt; IO (InputStream Builder)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-666"></span><span>               </span><span class="annot"><span class="annottext">(ByteString -&gt; IO Builder)
-&gt; InputStream ByteString -&gt; IO (InputStream Builder)
forall a b. (a -&gt; IO b) -&gt; InputStream a -&gt; IO (InputStream b)
</span><span class="hs-identifier hs-var">Streams.mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; IO Builder)
-&gt; (ByteString -&gt; Builder) -&gt; ByteString -&gt; IO Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#byteString"><span class="hs-identifier hs-var">byteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">InputStream Builder -&gt; OutputStream Builder -&gt; IO ()
forall a. InputStream a -&gt; OutputStream a -&gt; IO ()
</span><span class="hs-identifier hs-var">Streams.connect</span></span><span> </span><span class="annot"><span class="annottext">InputStream Builder
</span><a href="#local-6989586621679113333"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113329"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-668"></span><span>        </span><span class="annot"><span class="annottext">StreamProc
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113329"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-672"></span><span class="annot"><span class="hs-comment">-- | Represents an HTTP response.</span></span><span>
</span><span id="line-673"></span><span class="hs-keyword">data</span><span> </span><span id="Response"><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-var">Response</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Response"><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-var">Response</span></a></span></span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="rspHeaders"><span class="annot"><span class="annottext">Response -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#rspHeaders"><span class="hs-identifier hs-var hs-var">rspHeaders</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rspCookies"><span class="annot"><span class="annottext">Response -&gt; Map ByteString Cookie
</span><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var hs-var">rspCookies</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span>      </span><span class="hs-comment">-- | We will need to inspect the content length no matter what, and</span><span>
</span><span id="line-678"></span><span>      </span><span class="hs-comment">--   looking up \&quot;content-length\&quot; in the headers and parsing the number</span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-comment">--   out of the text will be too expensive.</span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rspContentLength"><span class="annot"><span class="annottext">Response -&gt; Maybe Word64
</span><a href="Snap.Internal.Http.Types.html#rspContentLength"><span class="hs-identifier hs-var hs-var">rspContentLength</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rspBody"><span class="annot"><span class="annottext">Response -&gt; ResponseBody
</span><a href="Snap.Internal.Http.Types.html#rspBody"><span class="hs-identifier hs-var hs-var">rspBody</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#ResponseBody"><span class="hs-identifier hs-type">ResponseBody</span></a></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span>      </span><span class="hs-comment">-- | Returns the HTTP status code.</span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-685"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-686"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-688"></span><span>      </span><span class="hs-comment">-- ghci&gt; rspStatus 'emptyResponse'</span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-comment">-- 200</span><span>
</span><span id="line-690"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rspStatus"><span class="annot"><span class="annottext">Response -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rspStatus"><span class="hs-identifier hs-var hs-var">rspStatus</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-comment">-- | Returns the HTTP status explanation string.</span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-697"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-698"></span><span>      </span><span class="hs-comment">-- ghci&gt; rspStatusReason 'emptyResponse'</span><span>
</span><span id="line-699"></span><span>      </span><span class="hs-comment">-- &quot;OK&quot;</span><span>
</span><span id="line-700"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rspStatusReason"><span class="annot"><span class="annottext">Response -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rspStatusReason"><span class="hs-identifier hs-var hs-var">rspStatusReason</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>      </span><span class="hs-comment">-- | If true, we are transforming the request body with</span><span>
</span><span id="line-704"></span><span>      </span><span class="hs-comment">-- 'transformRequestBody'</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rspTransformingRqBody"><span class="annot"><span class="annottext">Response -&gt; Bool
</span><a href="Snap.Internal.Http.Types.html#rspTransformingRqBody"><span class="hs-identifier hs-var hs-var">rspTransformingRqBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-710"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679113345"><span id="local-6989586621679113350"><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-711"></span><span>  </span><span id="local-6989586621679113355"><span class="annot"><span class="annottext">show :: Response -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679113356"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113357"><span class="hs-identifier hs-var">statusline</span></a></span><span>
</span><span id="line-712"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113358"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-713"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113359"><span class="hs-identifier hs-var">contentLength</span></a></span><span>
</span><span id="line-714"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span>
</span><span id="line-715"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679113360"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-716"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-718"></span><span>      </span><span id="local-6989586621679113357"><span class="annot"><span class="annottext">statusline :: String
</span><a href="#local-6989586621679113357"><span class="hs-identifier hs-var hs-var">statusline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP/1.1 &quot;</span></span><span>
</span><span id="line-719"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rspStatus"><span class="hs-identifier hs-var">rspStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-720"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-721"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rspStatusReason"><span class="hs-identifier hs-var">rspStatusReason</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-722"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span>      </span><span id="local-6989586621679113358"><span class="annot"><span class="annottext">hdrs :: String
</span><a href="#local-6989586621679113358"><span class="hs-identifier hs-var hs-var">hdrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI ByteString, ByteString) -&gt; String)
-&gt; [(CI ByteString, ByteString)] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(CI ByteString, ByteString) -&gt; String
</span><a href="#local-6989586621679113369"><span class="hs-identifier hs-var">showHdr</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI ByteString, ByteString)] -&gt; String)
-&gt; [(CI ByteString, ByteString)] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Headers -&gt; [(CI ByteString, ByteString)]
</span><a href="Snap.Types.Headers.html#toList"><span class="hs-identifier hs-var">H.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; [(CI ByteString, ByteString)])
-&gt; Headers -&gt; [(CI ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Headers -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#renderCookies"><span class="hs-identifier hs-var">renderCookies</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-725"></span><span>             </span><span class="annot"><span class="annottext">(Headers -&gt; Headers) -&gt; Headers -&gt; Headers
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#rspHeaders"><span class="hs-identifier hs-var">rspHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; Headers) -&gt; Response -&gt; Headers
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#clearContentLength"><span class="hs-identifier hs-var">clearContentLength</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span>      </span><span id="local-6989586621679113359"><span class="annot"><span class="annottext">contentLength :: String
</span><a href="#local-6989586621679113359"><span class="hs-identifier hs-var hs-var">contentLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Word64 -&gt; String) -&gt; Maybe Word64 -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679113378"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113378"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Content-Length: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113378"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response -&gt; Maybe Word64
</span><a href="Snap.Internal.Http.Types.html#rspContentLength"><span class="hs-identifier hs-var">rspContentLength</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>      </span><span id="local-6989586621679113369"><span class="annot"><span class="annottext">showHdr :: (CI ByteString, ByteString) -&gt; String
</span><a href="#local-6989586621679113369"><span class="hs-identifier hs-var hs-var">showHdr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679113383"><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113383"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679113384"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113384"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621679113383"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#unpack"><span class="hs-identifier hs-var">S.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113384"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span>      </span><span class="hs-comment">-- io-streams are impure, so we're forced to use 'unsafePerformIO'.</span><span>
</span><span id="line-732"></span><span>      </span><span id="local-6989586621679113360"><span class="annot"><span class="annottext">body :: String
</span><a href="#local-6989586621679113360"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; String
forall a. IO a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; String) -&gt; IO String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-733"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679113391"><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113391"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679113392"><span class="annot"><span class="annottext">IO [Builder]
</span><a href="#local-6989586621679113392"><span class="hs-identifier hs-var">grab</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (OutputStream Builder, IO [Builder])
forall c. IO (OutputStream c, IO [c])
</span><span class="hs-identifier hs-var">Streams.listOutputStream</span></span><span>
</span><span id="line-734"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679113394"><span class="annot"><span class="annottext">f :: StreamProc
</span><a href="#local-6989586621679113394"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResponseBody -&gt; StreamProc
</span><a href="Snap.Internal.Http.Types.html#rspBodyToEnum"><span class="hs-identifier hs-var">rspBodyToEnum</span></a></span><span> </span><span class="annot"><span class="annottext">(ResponseBody -&gt; StreamProc) -&gt; ResponseBody -&gt; StreamProc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; ResponseBody
</span><a href="Snap.Internal.Http.Types.html#rspBody"><span class="hs-identifier hs-var">rspBody</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><span class="annottext">OutputStream Builder
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StreamProc
</span><a href="#local-6989586621679113394"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder
</span><a href="#local-6989586621679113391"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-736"></span><span>        </span><span class="annot"><span class="annottext">([Builder] -&gt; String) -&gt; IO [Builder] -&gt; IO String
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Char8.html#unpack"><span class="hs-identifier hs-var">L.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String)
-&gt; ([Builder] -&gt; ByteString) -&gt; [Builder] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#toLazyByteString"><span class="hs-identifier hs-var">toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString)
-&gt; ([Builder] -&gt; Builder) -&gt; [Builder] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO [Builder]
</span><a href="#local-6989586621679113392"><span class="hs-identifier hs-var">grab</span></a></span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-741"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#HasHeaders"><span class="hs-identifier hs-type">HasHeaders</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-742"></span><span>    </span><span id="local-6989586621679113398"><span class="annot"><span class="annottext">headers :: Response -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#headers"><span class="hs-identifier hs-var hs-var hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#rspHeaders"><span class="hs-identifier hs-var">rspHeaders</span></a></span><span>
</span><span id="line-743"></span><span>    </span><span id="local-6989586621679113399"><span class="annot"><span class="annottext">updateHeaders :: (Headers -&gt; Headers) -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#updateHeaders"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateHeaders</span></a></span></span><span> </span><span id="local-6989586621679113400"><span class="annot"><span class="annottext">Headers -&gt; Headers
</span><a href="#local-6989586621679113400"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679113401"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113401"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113401"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspHeaders"><span class="hs-identifier hs-var">rspHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679113400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspHeaders"><span class="hs-identifier hs-var">rspHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113401"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- | Looks up the value(s) for the given named parameter. Parameters initially</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- come from the request's query string and any decoded POST body (if the</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- request's @Content-Type@ is @application\/x-www-form-urlencoded@).</span><span>
</span><span id="line-750"></span><span class="hs-comment">-- Parameter values can be modified within handlers using &quot;rqModifyParams&quot;.</span><span>
</span><span id="line-751"></span><span class="hs-comment">--</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-753"></span><span class="hs-comment">--</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- ghci&gt; 'rqParam' &quot;baz&quot; rq</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- Just [&quot;qux&quot;,&quot;quux&quot;]</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-766"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqParam"><span class="hs-identifier hs-type">rqParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ parameter name to look up</span></span><span>
</span><span id="line-767"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ HTTP request</span></span><span>
</span><span id="line-768"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-769"></span><span id="rqParam"><span class="annot"><span class="annottext">rqParam :: ByteString -&gt; Request -&gt; Maybe [ByteString]
</span><a href="Snap.Internal.Http.Types.html#rqParam"><span class="hs-identifier hs-var hs-var">rqParam</span></a></span></span><span> </span><span id="local-6989586621679113403"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113403"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113404"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113404"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Params -&gt; Maybe [ByteString]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113403"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Maybe [ByteString]) -&gt; Params -&gt; Maybe [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqParams"><span class="hs-identifier hs-var">rqParams</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113404"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-770"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqParam"><span class="hs-pragma hs-type">rqParam</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- | Looks up the value(s) for the given named parameter in the POST parameters</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- mapping.</span><span>
</span><span id="line-776"></span><span class="hs-comment">--</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-778"></span><span class="hs-comment">--</span><span>
</span><span id="line-779"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-782"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-783"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-788"></span><span class="hs-comment">-- ghci&gt; 'rqPostParam' &quot;baz&quot; rq</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- Just [&quot;qux&quot;]</span><span>
</span><span id="line-790"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-791"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqPostParam"><span class="hs-identifier hs-type">rqPostParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ parameter name to look up</span></span><span>
</span><span id="line-792"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ HTTP request</span></span><span>
</span><span id="line-793"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-794"></span><span id="rqPostParam"><span class="annot"><span class="annottext">rqPostParam :: ByteString -&gt; Request -&gt; Maybe [ByteString]
</span><a href="Snap.Internal.Http.Types.html#rqPostParam"><span class="hs-identifier hs-var hs-var">rqPostParam</span></a></span></span><span> </span><span id="local-6989586621679113407"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113407"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113408"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113408"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Params -&gt; Maybe [ByteString]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113407"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Maybe [ByteString]) -&gt; Params -&gt; Maybe [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqPostParams"><span class="hs-identifier hs-var">rqPostParams</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113408"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-795"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqPostParam"><span class="hs-pragma hs-type">rqPostParam</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- | Looks up the value(s) for the given named parameter in the query</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- parameters mapping.</span><span>
</span><span id="line-801"></span><span class="hs-comment">--</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-803"></span><span class="hs-comment">--</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-806"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-808"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- ghci&gt; 'rqQueryParam' &quot;baz&quot; rq</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- Just [&quot;quux&quot;]</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-816"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqQueryParam"><span class="hs-identifier hs-type">rqQueryParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ parameter name to look up</span></span><span>
</span><span id="line-817"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ HTTP request</span></span><span>
</span><span id="line-818"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-819"></span><span id="rqQueryParam"><span class="annot"><span class="annottext">rqQueryParam :: ByteString -&gt; Request -&gt; Maybe [ByteString]
</span><a href="Snap.Internal.Http.Types.html#rqQueryParam"><span class="hs-identifier hs-var hs-var">rqQueryParam</span></a></span></span><span> </span><span id="local-6989586621679113410"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113410"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113411"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113411"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Params -&gt; Maybe [ByteString]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113410"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Maybe [ByteString]) -&gt; Params -&gt; Maybe [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqQueryParams"><span class="hs-identifier hs-var">rqQueryParams</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113411"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-820"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqQueryParam"><span class="hs-pragma hs-type">rqQueryParam</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- | Modifies the parameters mapping (which is a @Map ByteString ByteString@)</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- in a 'Request' using the given function.</span><span>
</span><span id="line-826"></span><span class="hs-comment">--</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-828"></span><span class="hs-comment">--</span><span>
</span><span id="line-829"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-836"></span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-837"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- ghci&gt; 'rqParams' rq</span><span>
</span><span id="line-839"></span><span class="hs-comment">-- fromList [(&quot;baz&quot;,[&quot;qux&quot;,&quot;quux&quot;])]</span><span>
</span><span id="line-840"></span><span class="hs-comment">-- ghci&gt; 'rqParams' $ 'rqModifyParams' (M.delete &quot;baz&quot;) rq</span><span>
</span><span id="line-841"></span><span class="hs-comment">-- fromList []</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-843"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqModifyParams"><span class="hs-identifier hs-type">rqModifyParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-844"></span><span id="rqModifyParams"><span class="annot"><span class="annottext">rqModifyParams :: (Params -&gt; Params) -&gt; Request -&gt; Request
</span><a href="Snap.Internal.Http.Types.html#rqModifyParams"><span class="hs-identifier hs-var hs-var">rqModifyParams</span></a></span></span><span> </span><span id="local-6989586621679113413"><span class="annot"><span class="annottext">Params -&gt; Params
</span><a href="#local-6989586621679113413"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679113414"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113414"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113414"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqParams"><span class="hs-identifier hs-var">rqParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679113415"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-846"></span><span>    </span><span id="local-6989586621679113415"><span class="annot"><span class="annottext">p :: Params
</span><a href="#local-6989586621679113415"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Params
</span><a href="#local-6989586621679113413"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Params) -&gt; Params -&gt; Params
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Params
</span><a href="Snap.Internal.Http.Types.html#rqParams"><span class="hs-identifier hs-var">rqParams</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679113414"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-847"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqModifyParams"><span class="hs-pragma hs-type">rqModifyParams</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- | Writes a key-value pair to the parameters mapping within the given</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- request.</span><span>
</span><span id="line-853"></span><span class="hs-comment">--</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-855"></span><span class="hs-comment">--</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- ghci| rq &lt;- T.buildRequest $ do</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- ghci|         T.postUrlEncoded &quot;\/foo\/bar&quot; $ M.fromList [(&quot;baz&quot;, [&quot;qux&quot;])]</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- ghci|         T.setQueryStringRaw &quot;baz=quux&quot;</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- ghci&gt; 'rqParams' rq</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- fromList [(&quot;baz&quot;,[&quot;qux&quot;,&quot;quux&quot;])]</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- ghci&gt; 'rqParams' $ 'rqSetParam' &quot;baz&quot; [&quot;corge&quot;] rq</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- fromList [(&quot;baz&quot;, [&quot;corge&quot;])]</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-870"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqSetParam"><span class="hs-identifier hs-type">rqSetParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ parameter name</span></span><span>
</span><span id="line-871"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ parameter values</span></span><span>
</span><span id="line-872"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ request</span></span><span>
</span><span id="line-873"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-874"></span><span id="rqSetParam"><span class="annot"><span class="annottext">rqSetParam :: ByteString -&gt; [ByteString] -&gt; Request -&gt; Request
</span><a href="Snap.Internal.Http.Types.html#rqSetParam"><span class="hs-identifier hs-var hs-var">rqSetParam</span></a></span></span><span> </span><span id="local-6989586621679113417"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113417"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113418"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679113418"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Params) -&gt; Request -&gt; Request
</span><a href="Snap.Internal.Http.Types.html#rqModifyParams"><span class="hs-identifier hs-var">rqModifyParams</span></a></span><span> </span><span class="annot"><span class="annottext">((Params -&gt; Params) -&gt; Request -&gt; Request)
-&gt; (Params -&gt; Params) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; Params -&gt; Params
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113417"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679113418"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-875"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqSetParam"><span class="hs-pragma hs-type">rqSetParam</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span>                                </span><span class="hs-comment">---------------</span><span>
</span><span id="line-879"></span><span>                                </span><span class="hs-comment">-- responses --</span><span>
</span><span id="line-880"></span><span>                                </span><span class="hs-comment">---------------</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-883"></span><span class="hs-comment">-- | An empty 'Response'.</span><span>
</span><span id="line-884"></span><span class="hs-comment">--</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-886"></span><span class="hs-comment">--</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- ghci&gt; 'emptyResponse'</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-890"></span><span class="hs-comment">--</span><span>
</span><span id="line-891"></span><span class="hs-comment">--</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-893"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#emptyResponse"><span class="hs-identifier hs-type">emptyResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-894"></span><span id="emptyResponse"><span class="annot"><span class="annottext">emptyResponse :: Response
</span><a href="Snap.Internal.Http.Types.html#emptyResponse"><span class="hs-identifier hs-var hs-var">emptyResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Headers
-&gt; Map ByteString Cookie
-&gt; Maybe Word64
-&gt; ResponseBody
-&gt; Int
-&gt; ByteString
-&gt; Bool
-&gt; Response
</span><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Snap.Types.Headers.html#empty"><span class="hs-identifier hs-var">H.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map ByteString Cookie
forall k a. Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-895"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StreamProc -&gt; ResponseBody
</span><a href="Snap.Internal.Http.Types.html#Stream"><span class="hs-identifier hs-var">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StreamProc
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">StreamProc
-&gt; (OutputStream Builder -&gt; OutputStream Builder) -&gt; StreamProc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder -&gt; OutputStream Builder
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-896"></span><span>                         </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;OK&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- | Sets an HTTP response body to the given stream procedure.</span><span>
</span><span id="line-901"></span><span class="hs-comment">--</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-903"></span><span class="hs-comment">--</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;System.IO.Streams&quot; as Streams</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.ByteString.Builder&quot; as Builder</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- ghci| let r = 'setResponseBody'</span><span>
</span><span id="line-910"></span><span class="hs-comment">-- ghci|         (\out -&gt; do</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- ghci|             Streams.write (Just $ Builder.'byteString' \&quot;Hello, world!\&quot;) out</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- ghci|             return out)</span><span>
</span><span id="line-913"></span><span class="hs-comment">-- ghci|         'emptyResponse'</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- ghci&gt; r</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-917"></span><span class="hs-comment">--</span><span>
</span><span id="line-918"></span><span class="hs-comment">-- Hello, world!</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-920"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseBody"><span class="hs-identifier hs-type">setResponseBody</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>                                   </span><span class="annot"><span class="hs-comment">-- ^ new response body</span></span><span>
</span><span id="line-922"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ response to modify</span></span><span>
</span><span id="line-923"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-924"></span><span id="setResponseBody"><span class="annot"><span class="annottext">setResponseBody :: StreamProc -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseBody"><span class="hs-identifier hs-var hs-var">setResponseBody</span></a></span></span><span> </span><span id="local-6989586621679113423"><span class="annot"><span class="annottext">StreamProc
</span><a href="#local-6989586621679113423"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679113424"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113424"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113424"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBody"><span class="hs-identifier hs-var">rspBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113423"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-925"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseBody"><span class="hs-pragma hs-type">setResponseBody</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- | Sets the HTTP response status. Note: normally you would use</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- 'setResponseCode' unless you needed a custom response explanation.</span><span>
</span><span id="line-931"></span><span class="hs-comment">--</span><span>
</span><span id="line-932"></span><span class="hs-comment">--</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-934"></span><span class="hs-comment">--</span><span>
</span><span id="line-935"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-936"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-937"></span><span class="hs-comment">-- ghci&gt; setResponseStatus 500 \&quot;Internal Server Error\&quot; 'emptyResponse'</span><span>
</span><span id="line-938"></span><span class="hs-comment">-- HTTP\/1.1 500 Internal Server Error</span><span>
</span><span id="line-939"></span><span class="hs-comment">--</span><span>
</span><span id="line-940"></span><span class="hs-comment">--</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-942"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseStatus"><span class="hs-identifier hs-type">setResponseStatus</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ HTTP response integer code</span></span><span>
</span><span id="line-943"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ HTTP response explanation</span></span><span>
</span><span id="line-944"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Response to be modified</span></span><span>
</span><span id="line-945"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-946"></span><span id="setResponseStatus"><span class="annot"><span class="annottext">setResponseStatus :: Int -&gt; ByteString -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseStatus"><span class="hs-identifier hs-var hs-var">setResponseStatus</span></a></span></span><span> </span><span id="local-6989586621679113427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113427"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679113428"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113428"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span id="local-6989586621679113429"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113429"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113429"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspStatus"><span class="hs-identifier hs-var">rspStatus</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="#local-6989586621679113427"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspStatusReason"><span class="hs-identifier hs-var">rspStatusReason</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="#local-6989586621679113428"><span class="hs-identifier hs-type">reason</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-947"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseStatus"><span class="hs-pragma hs-type">setResponseStatus</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-951"></span><span class="hs-comment">-- | Sets the HTTP response code.</span><span>
</span><span id="line-952"></span><span class="hs-comment">--</span><span>
</span><span id="line-953"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-954"></span><span class="hs-comment">--</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-956"></span><span class="hs-comment">-- ghci&gt; setResponseCode 404 'emptyResponse'</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- HTTP\/1.1 404 Not Found</span><span>
</span><span id="line-958"></span><span class="hs-comment">--</span><span>
</span><span id="line-959"></span><span class="hs-comment">--</span><span>
</span><span id="line-960"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-961"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier hs-type">setResponseCode</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ HTTP response integer code</span></span><span>
</span><span id="line-962"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Response to be modified</span></span><span>
</span><span id="line-963"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-964"></span><span id="setResponseCode"><span class="annot"><span class="annottext">setResponseCode :: Int -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier hs-var hs-var">setResponseCode</span></a></span></span><span> </span><span id="local-6989586621679113430"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113430"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679113431"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113431"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseStatus"><span class="hs-identifier hs-var">setResponseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113430"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113432"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113431"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-965"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-966"></span><span>    </span><span id="local-6989586621679113432"><span class="annot"><span class="annottext">reason :: ByteString
</span><a href="#local-6989586621679113432"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString -&gt; ByteString
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Unknown&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap ByteString -&gt; Maybe ByteString
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#lookup"><span class="hs-identifier hs-var">IM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679113430"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ByteString
</span><a href="Snap.Internal.Http.Types.html#statusReasonMap"><span class="hs-identifier hs-var">statusReasonMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-pragma hs-type">setResponseCode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span>
</span><span id="line-970"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-971"></span><span class="hs-comment">-- | Modifies a response body.</span><span>
</span><span id="line-972"></span><span class="hs-comment">--</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-974"></span><span class="hs-comment">--</span><span>
</span><span id="line-975"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-976"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-977"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;System.IO.Streams&quot; as Streams</span><span>
</span><span id="line-978"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.ByteString.Builder&quot; as Builder</span><span>
</span><span id="line-979"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-980"></span><span class="hs-comment">-- ghci| let r = 'setResponseBody'</span><span>
</span><span id="line-981"></span><span class="hs-comment">-- ghci|         (\out -&gt; do</span><span>
</span><span id="line-982"></span><span class="hs-comment">-- ghci|             Streams.write (Just $ Builder.'byteString' \&quot;Hello, world!\&quot;) out</span><span>
</span><span id="line-983"></span><span class="hs-comment">-- ghci|             return out)</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- ghci|         'emptyResponse'</span><span>
</span><span id="line-985"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-986"></span><span class="hs-comment">-- ghci&gt; r</span><span>
</span><span id="line-987"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-988"></span><span class="hs-comment">--</span><span>
</span><span id="line-989"></span><span class="hs-comment">-- Hello, world!</span><span>
</span><span id="line-990"></span><span class="hs-comment">-- ghci&gt; :{</span><span>
</span><span id="line-991"></span><span class="hs-comment">-- ghci| let r' = 'modifyResponseBody'</span><span>
</span><span id="line-992"></span><span class="hs-comment">-- ghci|          (\f out -&gt; do</span><span>
</span><span id="line-993"></span><span class="hs-comment">-- ghci|              out' &lt;- f out</span><span>
</span><span id="line-994"></span><span class="hs-comment">-- ghci|              Streams.write (Just $ Builder.'byteString' \&quot;\\nBye, world!\&quot;) out'</span><span>
</span><span id="line-995"></span><span class="hs-comment">-- ghci|              return out') r</span><span>
</span><span id="line-996"></span><span class="hs-comment">-- ghci| :}</span><span>
</span><span id="line-997"></span><span class="hs-comment">-- ghci&gt; r'</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-999"></span><span class="hs-comment">--</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- Hello, world!</span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- Bye, world!</span><span>
</span><span id="line-1002"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1003"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#modifyResponseBody"><span class="hs-identifier hs-type">modifyResponseBody</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1004"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OutputStream</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1005"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1006"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1007"></span><span id="modifyResponseBody"><span class="annot"><span class="annottext">modifyResponseBody :: (StreamProc -&gt; StreamProc) -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#modifyResponseBody"><span class="hs-identifier hs-var hs-var">modifyResponseBody</span></a></span></span><span> </span><span id="local-6989586621679113437"><span class="annot"><span class="annottext">StreamProc -&gt; StreamProc
</span><a href="#local-6989586621679113437"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679113438"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113438"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113438"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBody"><span class="hs-identifier hs-var">rspBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBodyMap"><span class="hs-identifier hs-type">rspBodyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113437"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspBody"><span class="hs-identifier hs-var">rspBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113438"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1008"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#modifyResponseBody"><span class="hs-pragma hs-type">modifyResponseBody</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1009"></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1012"></span><span class="hs-comment">-- | Sets the @Content-Type@ in the 'Response' headers.</span><span>
</span><span id="line-1013"></span><span class="hs-comment">--</span><span>
</span><span id="line-1014"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1015"></span><span class="hs-comment">--</span><span>
</span><span id="line-1016"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1017"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-1018"></span><span class="hs-comment">-- ghci&gt; setContentType \&quot;text\/html\&quot; 'emptyResponse'</span><span>
</span><span id="line-1019"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-1020"></span><span class="hs-comment">-- content-type: text\/html</span><span>
</span><span id="line-1021"></span><span class="hs-comment">--</span><span>
</span><span id="line-1022"></span><span class="hs-comment">--</span><span>
</span><span id="line-1023"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1024"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#setContentType"><span class="hs-identifier hs-type">setContentType</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1025"></span><span id="setContentType"><span class="annot"><span class="annottext">setContentType :: ByteString -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentType"><span class="hs-identifier hs-var hs-var">setContentType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span>
</span><span id="line-1026"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setContentType"><span class="hs-pragma hs-type">setContentType</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1027"></span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1030"></span><span class="hs-comment">-- | Convert 'Cookie' into 'ByteString' for output.</span><span>
</span><span id="line-1031"></span><span class="hs-comment">--</span><span>
</span><span id="line-1032"></span><span class="hs-comment">-- TODO: Remove duplication. This function is copied from</span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- snap-server/Snap.Internal.Http.Server.Session.</span><span>
</span><span id="line-1034"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#cookieToBS"><span class="hs-identifier hs-type">cookieToBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1035"></span><span id="cookieToBS"><span class="annot"><span class="annottext">cookieToBS :: Cookie -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#cookieToBS"><span class="hs-identifier hs-var hs-var">cookieToBS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span> </span><span id="local-6989586621679113441"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113441"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679113442"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113442"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679113443"><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679113443"><span class="hs-identifier hs-var">mbExpTime</span></a></span></span><span> </span><span id="local-6989586621679113444"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679113444"><span class="hs-identifier hs-var">mbDomain</span></a></span></span><span> </span><span id="local-6989586621679113445"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679113445"><span class="hs-identifier hs-var">mbPath</span></a></span></span><span> </span><span id="local-6989586621679113446"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679113446"><span class="hs-identifier hs-var">isSec</span></a></span></span><span> </span><span id="local-6989586621679113447"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679113447"><span class="hs-identifier hs-var">isHOnly</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113448"><span class="hs-identifier hs-var">cookie</span></a></span><span>
</span><span id="line-1036"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1037"></span><span>    </span><span id="local-6989586621679113448"><span class="annot"><span class="annottext">cookie :: ByteString
</span><a href="#local-6989586621679113448"><span class="hs-identifier hs-var hs-var">cookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113441"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113442"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113451"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113452"><span class="hs-identifier hs-var">exptime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113453"><span class="hs-identifier hs-var">domain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113454"><span class="hs-identifier hs-var">secure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113455"><span class="hs-identifier hs-var">hOnly</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1038"></span><span>    </span><span id="local-6989586621679113451"><span class="annot"><span class="annottext">path :: ByteString
</span><a href="#local-6989586621679113451"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; path=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679113445"><span class="hs-identifier hs-var">mbPath</span></a></span><span>
</span><span id="line-1039"></span><span>    </span><span id="local-6989586621679113453"><span class="annot"><span class="annottext">domain :: ByteString
</span><a href="#local-6989586621679113453"><span class="hs-identifier hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; domain=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679113444"><span class="hs-identifier hs-var">mbDomain</span></a></span><span>
</span><span id="line-1040"></span><span>    </span><span id="local-6989586621679113452"><span class="annot"><span class="annottext">exptime :: ByteString
</span><a href="#local-6989586621679113452"><span class="hs-identifier hs-var hs-var">exptime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (UTCTime -&gt; ByteString) -&gt; Maybe UTCTime -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; expires=&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (UTCTime -&gt; ByteString) -&gt; UTCTime -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; ByteString
</span><a href="#local-6989586621679113463"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679113443"><span class="hs-identifier hs-var">mbExpTime</span></a></span><span>
</span><span id="line-1041"></span><span>    </span><span id="local-6989586621679113454"><span class="annot"><span class="annottext">secure :: ByteString
</span><a href="#local-6989586621679113454"><span class="hs-identifier hs-var hs-var">secure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679113446"><span class="hs-identifier hs-var">isSec</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; Secure&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-1042"></span><span>    </span><span id="local-6989586621679113455"><span class="annot"><span class="annottext">hOnly :: ByteString
</span><a href="#local-6989586621679113455"><span class="hs-identifier hs-var hs-var">hOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679113447"><span class="hs-identifier hs-var">isHOnly</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; HttpOnly&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-1043"></span><span>
</span><span id="line-1044"></span><span>    </span><span class="hs-comment">-- TODO: 'formatHttpTime' uses &quot;DD MMM YYYY&quot; instead of &quot;DD-MMM-YYYY&quot;,</span><span>
</span><span id="line-1045"></span><span>    </span><span class="hs-comment">-- unlike the code in 'Snap.Internal.Http.Server.Session'. Is this form</span><span>
</span><span id="line-1046"></span><span>    </span><span class="hs-comment">-- allowed?</span><span>
</span><span id="line-1047"></span><span>    </span><span id="local-6989586621679113463"><span class="annot"><span class="annottext">fmt :: UTCTime -&gt; ByteString
</span><a href="#local-6989586621679113463"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; ByteString)
-&gt; (UTCTime -&gt; IO ByteString) -&gt; UTCTime -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Types.html#formatHttpTime"><span class="hs-identifier hs-var">formatHttpTime</span></a></span><span> </span><span class="annot"><span class="annottext">(CTime -&gt; IO ByteString)
-&gt; (UTCTime -&gt; CTime) -&gt; UTCTime -&gt; IO ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; CTime
</span><a href="#local-6989586621679113469"><span class="hs-identifier hs-var">toCTime</span></a></span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span>    </span><span class="annot"><a href="#local-6989586621679113469"><span class="hs-identifier hs-type">toCTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span>
</span><span id="line-1050"></span><span>    </span><span id="local-6989586621679113469"><span class="annot"><span class="annottext">toCTime :: UTCTime -&gt; CTime
</span><a href="#local-6989586621679113469"><span class="hs-identifier hs-var hs-var">toCTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CTime
forall a. Num a =&gt; Integer -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#fromInteger"><span class="hs-identifier hs-var">fromInteger</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; CTime) -&gt; (UTCTime -&gt; Integer) -&gt; UTCTime -&gt; CTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Integer
forall b. Integral b =&gt; POSIXTime -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#truncate"><span class="hs-identifier hs-var">truncate</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Integer)
-&gt; (UTCTime -&gt; POSIXTime) -&gt; UTCTime -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; POSIXTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/time-1.12.2/src/Data.Time.Clock.POSIX.html#utcTimeToPOSIXSeconds"><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></a></span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1053"></span><span class="hs-comment">-- | Render cookies from a given 'Response' to 'Headers'.</span><span>
</span><span id="line-1054"></span><span class="hs-comment">--</span><span>
</span><span id="line-1055"></span><span class="hs-comment">-- TODO: Remove duplication. This function is copied from</span><span>
</span><span id="line-1056"></span><span class="hs-comment">-- snap-server/Snap.Internal.Http.Server.Session.</span><span>
</span><span id="line-1057"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#renderCookies"><span class="hs-identifier hs-type">renderCookies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Types.Headers.html#Headers"><span class="hs-identifier hs-type">Headers</span></a></span><span>
</span><span id="line-1058"></span><span id="renderCookies"><span class="annot"><span class="annottext">renderCookies :: Response -&gt; Headers -&gt; Headers
</span><a href="Snap.Internal.Http.Types.html#renderCookies"><span class="hs-identifier hs-var hs-var">renderCookies</span></a></span></span><span> </span><span id="local-6989586621679113470"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113470"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679113471"><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679113471"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span>
</span><span id="line-1059"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679113472"><span class="hs-identifier hs-var">cookies</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679113471"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-1060"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Headers -&gt; ByteString -&gt; Headers)
-&gt; Headers -&gt; [ByteString] -&gt; Headers
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679113474"><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679113474"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679113475"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113475"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Headers -&gt; Headers
</span><a href="Snap.Types.Headers.html#unsafeInsert"><span class="hs-identifier hs-var">H.unsafeInsert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;set-cookie&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113475"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679113474"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="#local-6989586621679113471"><span class="hs-identifier hs-var">hdrs</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679113472"><span class="hs-identifier hs-var">cookies</span></a></span><span>
</span><span id="line-1061"></span><span>
</span><span id="line-1062"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1063"></span><span>    </span><span id="local-6989586621679113472"><span class="annot"><span class="annottext">cookies :: [ByteString]
</span><a href="#local-6989586621679113472"><span class="hs-identifier hs-var hs-var">cookies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Cookie -&gt; ByteString) -&gt; [Cookie] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Cookie -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#cookieToBS"><span class="hs-identifier hs-var">cookieToBS</span></a></span><span> </span><span class="annot"><span class="annottext">([Cookie] -&gt; [ByteString])
-&gt; (Map ByteString Cookie -&gt; [Cookie])
-&gt; Map ByteString Cookie
-&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map ByteString Cookie -&gt; [Cookie]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">Map.elems</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ByteString Cookie -&gt; [ByteString])
-&gt; Map ByteString Cookie -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Map ByteString Cookie
</span><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113470"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1066"></span><span class="hs-comment">-- | Adds an HTTP 'Cookie' to 'Response' headers.</span><span>
</span><span id="line-1067"></span><span class="hs-comment">--</span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1069"></span><span class="hs-comment">--</span><span>
</span><span id="line-1070"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1071"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- ghci&gt; let cookie = 'Cookie' \&quot;name\&quot; \&quot;value\&quot; Nothing Nothing Nothing False False</span><span>
</span><span id="line-1073"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;name\&quot; $ 'addResponseCookie' cookie 'emptyResponse'</span><span>
</span><span id="line-1074"></span><span class="hs-comment">-- Just (Cookie {cookieName = \&quot;name\&quot;, cookieValue = \&quot;value\&quot;, ...})</span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1076"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#addResponseCookie"><span class="hs-identifier hs-type">addResponseCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ cookie value</span></span><span>
</span><span id="line-1077"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ response to modify</span></span><span>
</span><span id="line-1078"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1079"></span><span id="addResponseCookie"><span class="annot"><span class="annottext">addResponseCookie :: Cookie -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#addResponseCookie"><span class="hs-identifier hs-var hs-var">addResponseCookie</span></a></span></span><span> </span><span id="local-6989586621679113482"><span class="annot"><span class="annottext">ck :: Cookie
</span><a href="#local-6989586621679113482"><span class="hs-identifier hs-var">ck</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span> </span><span id="local-6989586621679113483"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113483"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679113484"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113484"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113484"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679113485"><span class="hs-identifier hs-type">cks'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1080"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1081"></span><span>    </span><span id="local-6989586621679113485"><span class="annot"><span class="annottext">cks' :: Map ByteString Cookie
</span><a href="#local-6989586621679113485"><span class="hs-identifier hs-var hs-var">cks'</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; Cookie -&gt; Map ByteString Cookie -&gt; Map ByteString Cookie
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113483"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Cookie
</span><a href="#local-6989586621679113482"><span class="hs-identifier hs-var">ck</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ByteString Cookie -&gt; Map ByteString Cookie)
-&gt; Map ByteString Cookie -&gt; Map ByteString Cookie
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Map ByteString Cookie
</span><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113484"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1082"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#addResponseCookie"><span class="hs-pragma hs-type">addResponseCookie</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1086"></span><span class="hs-comment">-- | Gets an HTTP 'Cookie' with the given name from 'Response' headers.</span><span>
</span><span id="line-1087"></span><span class="hs-comment">--</span><span>
</span><span id="line-1088"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1089"></span><span class="hs-comment">--</span><span>
</span><span id="line-1090"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1091"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-1092"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;cookie-name\&quot; 'emptyResponse'</span><span>
</span><span id="line-1093"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-1094"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1095"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#getResponseCookie"><span class="hs-identifier hs-type">getResponseCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ cookie name</span></span><span>
</span><span id="line-1096"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ response to query</span></span><span>
</span><span id="line-1097"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span>
</span><span id="line-1098"></span><span id="getResponseCookie"><span class="annot"><span class="annottext">getResponseCookie :: ByteString -&gt; Response -&gt; Maybe Cookie
</span><a href="Snap.Internal.Http.Types.html#getResponseCookie"><span class="hs-identifier hs-var hs-var">getResponseCookie</span></a></span></span><span> </span><span id="local-6989586621679113487"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113487"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span id="local-6989586621679113488"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113488"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Map ByteString Cookie -&gt; Maybe Cookie
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113487"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ByteString Cookie -&gt; Maybe Cookie)
-&gt; Map ByteString Cookie -&gt; Maybe Cookie
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Map ByteString Cookie
</span><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113488"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1099"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#getResponseCookie"><span class="hs-pragma hs-type">getResponseCookie</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span>
</span><span id="line-1102"></span><span class="hs-comment">-- | Returns a list of 'Cookie's present in 'Response'</span><span>
</span><span id="line-1103"></span><span class="hs-comment">--</span><span>
</span><span id="line-1104"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1105"></span><span class="hs-comment">--</span><span>
</span><span id="line-1106"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1107"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookies' 'emptyResponse'</span><span>
</span><span id="line-1108"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-1109"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1110"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#getResponseCookies"><span class="hs-identifier hs-type">getResponseCookies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ response to query</span></span><span>
</span><span id="line-1111"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1112"></span><span id="getResponseCookies"><span class="annot"><span class="annottext">getResponseCookies :: Response -&gt; [Cookie]
</span><a href="Snap.Internal.Http.Types.html#getResponseCookies"><span class="hs-identifier hs-var hs-var">getResponseCookies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ByteString Cookie -&gt; [Cookie]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">Map.elems</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ByteString Cookie -&gt; [Cookie])
-&gt; (Response -&gt; Map ByteString Cookie) -&gt; Response -&gt; [Cookie]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Map ByteString Cookie
</span><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span>
</span><span id="line-1113"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#getResponseCookies"><span class="hs-pragma hs-type">getResponseCookies</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1114"></span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1117"></span><span class="hs-comment">-- | Deletes an HTTP 'Cookie' from the 'Response' headers. Please note</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- this does not necessarily erase the cookie from the client browser.</span><span>
</span><span id="line-1119"></span><span class="hs-comment">--</span><span>
</span><span id="line-1120"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1121"></span><span class="hs-comment">--</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-1124"></span><span class="hs-comment">-- ghci&gt; let cookie = 'Cookie' \&quot;name\&quot; \&quot;value\&quot; Nothing Nothing Nothing False False</span><span>
</span><span id="line-1125"></span><span class="hs-comment">-- ghci&gt; let rsp    = 'addResponseCookie' cookie 'emptyResponse'</span><span>
</span><span id="line-1126"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;name\&quot; rsp</span><span>
</span><span id="line-1127"></span><span class="hs-comment">-- Just (Cookie {cookieName = \&quot;name\&quot;, cookieValue = \&quot;value\&quot;, ...})</span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;name\&quot; $ 'deleteResponseCookie' \&quot;name\&quot; rsp</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1131"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#deleteResponseCookie"><span class="hs-identifier hs-type">deleteResponseCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ cookie name</span></span><span>
</span><span id="line-1132"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ response to modify</span></span><span>
</span><span id="line-1133"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1134"></span><span id="deleteResponseCookie"><span class="annot"><span class="annottext">deleteResponseCookie :: ByteString -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#deleteResponseCookie"><span class="hs-identifier hs-var hs-var">deleteResponseCookie</span></a></span></span><span> </span><span id="local-6989586621679113491"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113491"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span id="local-6989586621679113492"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113492"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113492"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679113493"><span class="hs-identifier hs-type">cks'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1135"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1136"></span><span>    </span><span id="local-6989586621679113493"><span class="annot"><span class="annottext">cks' :: Map ByteString Cookie
</span><a href="#local-6989586621679113493"><span class="hs-identifier hs-var hs-var">cks'</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Map ByteString Cookie -&gt; Map ByteString Cookie
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113491"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ByteString Cookie -&gt; Map ByteString Cookie)
-&gt; Map ByteString Cookie -&gt; Map ByteString Cookie
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Map ByteString Cookie
</span><a href="Snap.Internal.Http.Types.html#rspCookies"><span class="hs-identifier hs-var">rspCookies</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113492"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1137"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#deleteResponseCookie"><span class="hs-pragma hs-type">deleteResponseCookie</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1138"></span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- | Modifies an HTTP 'Cookie' with given name in 'Response' headers.</span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- Nothing will happen if a matching 'Cookie' can not be found in 'Response'.</span><span>
</span><span id="line-1143"></span><span class="hs-comment">--</span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1145"></span><span class="hs-comment">--</span><span>
</span><span id="line-1146"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1147"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-1148"></span><span class="hs-comment">-- ghci&gt; import &quot;Data.Monoid&quot;</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- ghci&gt; let cookie = 'Cookie' \&quot;name\&quot; \&quot;value\&quot; Nothing Nothing Nothing False False</span><span>
</span><span id="line-1150"></span><span class="hs-comment">-- ghci&gt; let rsp    = 'addResponseCookie' cookie 'emptyResponse'</span><span>
</span><span id="line-1151"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;name\&quot; rsp</span><span>
</span><span id="line-1152"></span><span class="hs-comment">-- Just (Cookie {cookieName = \&quot;name\&quot;, cookieValue = \&quot;value\&quot;, ...})</span><span>
</span><span id="line-1153"></span><span class="hs-comment">-- ghci&gt; let f ck@('Cookie' { cookieName = name }) = ck { cookieName = name &lt;&gt; \&quot;\'\&quot;}</span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- ghci&gt; let rsp' = 'modifyResponseCookie' \&quot;name\&quot; f rsp</span><span>
</span><span id="line-1155"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;name\'\&quot; rsp\'</span><span>
</span><span id="line-1156"></span><span class="hs-comment">-- Just (Cookie {cookieName = \&quot;name\'\&quot;, ...})</span><span>
</span><span id="line-1157"></span><span class="hs-comment">-- ghci&gt; 'getResponseCookie' \&quot;name\&quot; rsp\'</span><span>
</span><span id="line-1158"></span><span class="hs-comment">-- Just (Cookie {cookieName = \&quot;name\&quot;, ...})</span><span>
</span><span id="line-1159"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1160"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#modifyResponseCookie"><span class="hs-identifier hs-type">modifyResponseCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ cookie name</span></span><span>
</span><span id="line-1161"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ modifier function</span></span><span>
</span><span id="line-1162"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ response to modify</span></span><span>
</span><span id="line-1163"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1164"></span><span id="modifyResponseCookie"><span class="annot"><span class="annottext">modifyResponseCookie :: ByteString -&gt; (Cookie -&gt; Cookie) -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#modifyResponseCookie"><span class="hs-identifier hs-var hs-var">modifyResponseCookie</span></a></span></span><span> </span><span id="local-6989586621679113497"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113497"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span id="local-6989586621679113498"><span class="annot"><span class="annottext">Cookie -&gt; Cookie
</span><a href="#local-6989586621679113498"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679113499"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113499"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response -&gt; (Cookie -&gt; Response) -&gt; Maybe Cookie -&gt; Response
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113499"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Cookie -&gt; Response
</span><a href="#local-6989586621679113500"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Cookie -&gt; Response) -&gt; Maybe Cookie -&gt; Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Response -&gt; Maybe Cookie
</span><a href="Snap.Internal.Http.Types.html#getResponseCookie"><span class="hs-identifier hs-var">getResponseCookie</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113497"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113499"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1166"></span><span>    </span><span id="local-6989586621679113500"><span class="annot"><span class="annottext">modify :: Cookie -&gt; Response
</span><a href="#local-6989586621679113500"><span class="hs-identifier hs-var hs-var">modify</span></a></span></span><span> </span><span id="local-6989586621679113501"><span class="annot"><span class="annottext">Cookie
</span><a href="#local-6989586621679113501"><span class="hs-identifier hs-var">ck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cookie -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#addResponseCookie"><span class="hs-identifier hs-var">addResponseCookie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cookie -&gt; Cookie
</span><a href="#local-6989586621679113498"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Cookie
</span><a href="#local-6989586621679113501"><span class="hs-identifier hs-var">ck</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113499"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1167"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#modifyResponseCookie"><span class="hs-pragma hs-type">modifyResponseCookie</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span>
</span><span id="line-1170"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1171"></span><span class="hs-comment">-- | A note here: if you want to set the @Content-Length@ for the response,</span><span>
</span><span id="line-1172"></span><span class="hs-comment">-- Snap forces you to do it with this function rather than by setting it in</span><span>
</span><span id="line-1173"></span><span class="hs-comment">-- the headers; the @Content-Length@ in the headers will be ignored.</span><span>
</span><span id="line-1174"></span><span class="hs-comment">--</span><span>
</span><span id="line-1175"></span><span class="hs-comment">-- The reason for this is that Snap needs to look up the value of</span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- @Content-Length@ for each request, and looking the string value up in the</span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- headers and parsing the number out of the text will be too expensive.</span><span>
</span><span id="line-1178"></span><span class="hs-comment">--</span><span>
</span><span id="line-1179"></span><span class="hs-comment">-- If you don't set a content length in your response, HTTP keep-alive will be</span><span>
</span><span id="line-1180"></span><span class="hs-comment">-- disabled for HTTP\/1.0 clients, forcing a @Connection: close@. For</span><span>
</span><span id="line-1181"></span><span class="hs-comment">-- HTTP\/1.1 clients, Snap will switch to the chunked transfer encoding if</span><span>
</span><span id="line-1182"></span><span class="hs-comment">-- @Content-Length@ is not specified.</span><span>
</span><span id="line-1183"></span><span class="hs-comment">--</span><span>
</span><span id="line-1184"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1185"></span><span class="hs-comment">--</span><span>
</span><span id="line-1186"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1187"></span><span class="hs-comment">-- ghci&gt; setContentLength 400 'emptyResponse'</span><span>
</span><span id="line-1188"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-1189"></span><span class="hs-comment">-- Content-Length: 400</span><span>
</span><span id="line-1190"></span><span class="hs-comment">--</span><span>
</span><span id="line-1191"></span><span class="hs-comment">--</span><span>
</span><span id="line-1192"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1193"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-identifier hs-type">setContentLength</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1194"></span><span id="setContentLength"><span class="annot"><span class="annottext">setContentLength :: Word64 -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-identifier hs-var hs-var">setContentLength</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679113503"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679113503"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679113504"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113504"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113504"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspContentLength"><span class="hs-identifier hs-var">rspContentLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679113503"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1195"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-pragma hs-type">setContentLength</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1196"></span><span>
</span><span id="line-1197"></span><span>
</span><span id="line-1198"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1199"></span><span class="hs-comment">-- | Removes any @Content-Length@ set in the 'Response'.</span><span>
</span><span id="line-1200"></span><span class="hs-comment">--</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1202"></span><span class="hs-comment">--</span><span>
</span><span id="line-1203"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1204"></span><span class="hs-comment">-- ghci&gt; clearContentLength $ 'setContentLength' 400 'emptyResponse'</span><span>
</span><span id="line-1205"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-1206"></span><span class="hs-comment">--</span><span>
</span><span id="line-1207"></span><span class="hs-comment">--</span><span>
</span><span id="line-1208"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1209"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#clearContentLength"><span class="hs-identifier hs-type">clearContentLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-1210"></span><span id="clearContentLength"><span class="annot"><span class="annottext">clearContentLength :: Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#clearContentLength"><span class="hs-identifier hs-var hs-var">clearContentLength</span></a></span></span><span> </span><span id="local-6989586621679113505"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113505"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679113505"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rspContentLength"><span class="hs-identifier hs-var">rspContentLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-type">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1211"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#clearContentLength"><span class="hs-pragma hs-type">clearContentLength</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span>                               </span><span class="hs-comment">----------------</span><span>
</span><span id="line-1215"></span><span>                               </span><span class="hs-comment">-- HTTP dates --</span><span>
</span><span id="line-1216"></span><span>                               </span><span class="hs-comment">----------------</span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1219"></span><span class="hs-comment">-- | Convert a 'CTime' into an HTTP timestamp.</span><span>
</span><span id="line-1220"></span><span class="hs-comment">--</span><span>
</span><span id="line-1221"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1222"></span><span class="hs-comment">--</span><span>
</span><span id="line-1223"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1224"></span><span class="hs-comment">-- ghci&gt; 'formatHttpTime' . 'fromIntegral' $ 10</span><span>
</span><span id="line-1225"></span><span class="hs-comment">-- \&quot;Thu, 01 Jan 1970 00:00:10 GMT\&quot;</span><span>
</span><span id="line-1226"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1227"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#formatHttpTime"><span class="hs-identifier hs-type">formatHttpTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1228"></span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1231"></span><span class="annot"><span class="hs-comment">-- | Convert a 'CTime' into common log entry format.</span></span><span>
</span><span id="line-1232"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#formatLogTime"><span class="hs-identifier hs-type">formatLogTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1233"></span><span>
</span><span id="line-1234"></span><span>
</span><span id="line-1235"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- | Converts an HTTP timestamp into a 'CTime'.</span><span>
</span><span id="line-1237"></span><span class="hs-comment">--</span><span>
</span><span id="line-1238"></span><span class="hs-comment">-- If the given time string is unparseable, this function will return 0.</span><span>
</span><span id="line-1239"></span><span class="hs-comment">--</span><span>
</span><span id="line-1240"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1241"></span><span class="hs-comment">--</span><span>
</span><span id="line-1242"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1243"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-1244"></span><span class="hs-comment">-- ghci&gt; 'parseHttpTime' \&quot;Thu, 01 Jan 1970 00:00:10 GMT\&quot;</span><span>
</span><span id="line-1245"></span><span class="hs-comment">-- 10</span><span>
</span><span id="line-1246"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1247"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#parseHttpTime"><span class="hs-identifier hs-type">parseHttpTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.C.Types.html#CTime"><span class="hs-identifier hs-type">CTime</span></a></span><span class="hs-cpp">

#ifdef PORTABLE
</span><span>
</span><span id="line-1251"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1252"></span><span class="hs-comment">-- local definitions</span><span>
</span><span id="line-1253"></span><span class="hs-identifier">fromStr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ByteString</span><span>
</span><span id="line-1254"></span><span class="hs-identifier">fromStr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">S.pack</span><span>                </span><span class="hs-comment">-- only because we know there's no unicode</span><span>
</span><span id="line-1255"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fromStr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1256"></span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1259"></span><span class="hs-identifier">formatHttpTime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">format</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">toUTCTime</span><span>
</span><span id="line-1260"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1261"></span><span>    </span><span class="hs-identifier">format</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">UTCTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ByteString</span><span>
</span><span id="line-1262"></span><span>    </span><span class="hs-identifier">format</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromStr</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">formatTime</span><span> </span><span class="hs-identifier">defaultTimeLocale</span><span> </span><span class="hs-string">&quot;%a, %d %b %Y %X GMT&quot;</span><span>
</span><span id="line-1263"></span><span>
</span><span id="line-1264"></span><span>    </span><span class="hs-identifier">toUTCTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">UTCTime</span><span>
</span><span id="line-1265"></span><span>    </span><span class="hs-identifier">toUTCTime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">posixSecondsToUTCTime</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">realToFrac</span><span>
</span><span id="line-1266"></span><span>
</span><span id="line-1267"></span><span>
</span><span id="line-1268"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1269"></span><span class="hs-identifier">formatLogTime</span><span> </span><span class="hs-identifier">ctime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1270"></span><span>  </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">utcToLocalZonedTime</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">toUTCTime</span><span> </span><span class="hs-identifier">ctime</span><span>
</span><span id="line-1271"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">format</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-1272"></span><span>
</span><span id="line-1273"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1274"></span><span>    </span><span class="hs-identifier">format</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ZonedTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ByteString</span><span>
</span><span id="line-1275"></span><span>    </span><span class="hs-identifier">format</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromStr</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">formatTime</span><span> </span><span class="hs-identifier">defaultTimeLocale</span><span> </span><span class="hs-string">&quot;%d/%b/%Y:%H:%M:%S %z&quot;</span><span>
</span><span id="line-1276"></span><span>
</span><span id="line-1277"></span><span>    </span><span class="hs-identifier">toUTCTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">UTCTime</span><span>
</span><span id="line-1278"></span><span>    </span><span class="hs-identifier">toUTCTime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">posixSecondsToUTCTime</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">realToFrac</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1282"></span><span class="hs-identifier">parseHttpTime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">toCTime</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">prs</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">S.unpack</span><span>
</span><span id="line-1283"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1284"></span><span>    </span><span class="hs-identifier">parseTime</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if MIN_VERSION_time(1,10,0)
</span><span>      </span><span class="hs-identifier">parseTimeM</span><span> </span><span class="hs-identifier">True</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">Time.parseTime</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1291"></span><span>    </span><span class="hs-identifier">prs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">UTCTime</span><span>
</span><span id="line-1292"></span><span>    </span><span class="hs-identifier">prs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parseTime</span><span> </span><span class="hs-identifier">defaultTimeLocale</span><span> </span><span class="hs-string">&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span>    </span><span class="hs-identifier">toCTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">UTCTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CTime</span><span>
</span><span id="line-1295"></span><span>    </span><span class="hs-identifier">toCTime</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">truncate</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">utcTimeToPOSIXSeconds</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-1296"></span><span>    </span><span class="hs-identifier">toCTime</span><span> </span><span class="hs-identifier">Nothing</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-number">0</span><span class="hs-cpp">

#else
</span><span>
</span><span id="line-1300"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1301"></span><span id="formatLogTime"><span class="annot"><span class="annottext">formatLogTime :: CTime -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Types.html#formatLogTime"><span class="hs-identifier hs-var hs-var">formatLogTime</span></a></span></span><span> </span><span id="local-6989586621679113509"><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679113509"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1302"></span><span>    </span><span id="local-6989586621679113510"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113510"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Ptr CChar)
forall a. Int -&gt; IO (Ptr a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.Marshal.Alloc.html#mallocBytes"><span class="hs-identifier hs-var">mallocBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span>
</span><span id="line-1303"></span><span>    </span><span class="annot"><span class="annottext">CTime -&gt; Ptr CChar -&gt; IO ()
</span><a href="Snap.Internal.Http.Types.html#c_format_log_time"><span class="hs-identifier hs-var">c_format_log_time</span></a></span><span> </span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679113509"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113510"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-1304"></span><span>    </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafePackMallocCString"><span class="hs-identifier hs-var">S.unsafePackMallocCString</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113510"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-1305"></span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1308"></span><span id="formatHttpTime"><span class="annot"><span class="annottext">formatHttpTime :: CTime -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Types.html#formatHttpTime"><span class="hs-identifier hs-var hs-var">formatHttpTime</span></a></span></span><span> </span><span id="local-6989586621679113512"><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679113512"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1309"></span><span>    </span><span id="local-6989586621679113513"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113513"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Ptr CChar)
forall a. Int -&gt; IO (Ptr a)
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Foreign.Marshal.Alloc.html#mallocBytes"><span class="hs-identifier hs-var">mallocBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span>
</span><span id="line-1310"></span><span>    </span><span class="annot"><span class="annottext">CTime -&gt; Ptr CChar -&gt; IO ()
</span><a href="Snap.Internal.Http.Types.html#c_format_http_time"><span class="hs-identifier hs-var">c_format_http_time</span></a></span><span> </span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679113512"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113513"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-1311"></span><span>    </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafePackMallocCString"><span class="hs-identifier hs-var">S.unsafePackMallocCString</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113513"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-1312"></span><span>
</span><span id="line-1313"></span><span>
</span><span id="line-1314"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1315"></span><span id="parseHttpTime"><span class="annot"><span class="annottext">parseHttpTime :: ByteString -&gt; IO CTime
</span><a href="Snap.Internal.Http.Types.html#parseHttpTime"><span class="hs-identifier hs-var hs-var">parseHttpTime</span></a></span></span><span> </span><span id="local-6989586621679113514"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113514"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (Ptr CChar -&gt; IO CTime) -&gt; IO CTime
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Unsafe.html#unsafeUseAsCString"><span class="hs-identifier hs-var">S.unsafeUseAsCString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679113514"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CChar -&gt; IO CTime) -&gt; IO CTime)
-&gt; (Ptr CChar -&gt; IO CTime) -&gt; IO CTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679113516"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113516"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1316"></span><span>    </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO CTime
</span><a href="Snap.Internal.Http.Types.html#c_parse_http_time"><span class="hs-identifier hs-var">c_parse_http_time</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679113516"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-cpp">

#endif
</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1322"></span><span class="hs-comment">-- | Adapted from:</span><span>
</span><span id="line-1323"></span><span class="hs-comment">--</span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- &lt;https://www.iana.org/assignments/http-status-codes/http-status-codes.txt&gt;</span><span>
</span><span id="line-1325"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#statusReasonMap"><span class="hs-identifier hs-type">statusReasonMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1326"></span><span id="statusReasonMap"><span class="annot"><span class="annottext">statusReasonMap :: IntMap ByteString
</span><a href="Snap.Internal.Http.Types.html#statusReasonMap"><span class="hs-identifier hs-var hs-var">statusReasonMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)] -&gt; IntMap ByteString
forall a. [(Int, a)] -&gt; IntMap a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#fromList"><span class="hs-identifier hs-var">IM.fromList</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-1327"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Continue&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1328"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Switching Protocols&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1329"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">102</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Processing&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1330"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">103</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Early Hints&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1331"></span><span>        </span><span class="hs-comment">-- 104-199 Unassigned</span><span>
</span><span id="line-1332"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;OK&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1333"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">201</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Created&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1334"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">202</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Accepted&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1335"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">203</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Non-Authoritative Information&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1336"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">204</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;No Content&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1337"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">205</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Reset Content&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1338"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">206</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Partial Content&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1339"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">207</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Multi-Status&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1340"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">208</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Already Reported&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1341"></span><span>        </span><span class="hs-comment">-- 209-225 Unassigned</span><span>
</span><span id="line-1342"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">226</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;IM Used&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1343"></span><span>        </span><span class="hs-comment">-- 227-299 Unassigned,</span><span>
</span><span id="line-1344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">300</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Multiple Choices&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1345"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">301</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Moved Permanently&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1346"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">302</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Found&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1347"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">303</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;See Other&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1348"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">304</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Not Modified&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1349"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">305</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Use Proxy&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1350"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">306</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;(Unused)&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1351"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">307</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Temporary Redirect&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1352"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">308</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Permanent Redirect&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1353"></span><span>        </span><span class="hs-comment">-- 309-399 Unassigned</span><span>
</span><span id="line-1354"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">400</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Bad Request&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1355"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">401</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Unauthorized&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1356"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">402</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Payment Required&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1357"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">403</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Forbidden&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1358"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">404</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Not Found&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1359"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">405</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Method Not Allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1360"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">406</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Not Acceptable&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1361"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">407</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Proxy Authentication Required&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1362"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">408</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Request Timeout&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1363"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">409</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Conflict&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1364"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">410</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Gone&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1365"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">411</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Length Required&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1366"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">412</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Precondition Failed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1367"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">413</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Payload Too Large&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1368"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">414</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;URI Too Long&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1369"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">415</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Unsupported Media Type&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1370"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">416</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Range Not Satisfiable&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1371"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">417</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Expectation Failed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1372"></span><span>        </span><span class="hs-comment">-- 418-420 Unassigned</span><span>
</span><span id="line-1373"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">421</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Misdirected Request&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1374"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">422</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Unprocessable Entity&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1375"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">423</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Locked&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1376"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">424</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Failed Dependency&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1377"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">425</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Too Early&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1378"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">426</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Upgrade Required&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1379"></span><span>        </span><span class="hs-comment">-- 427 Unassigned</span><span>
</span><span id="line-1380"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">428</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Precondition Required&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1381"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">429</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Too Many Requests&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1382"></span><span>        </span><span class="hs-comment">-- 430 Unassigned</span><span>
</span><span id="line-1383"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">431</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Request Header Fields Too Large&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1384"></span><span>        </span><span class="hs-comment">-- 432-450 Unassigned</span><span>
</span><span id="line-1385"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">451</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Unavailable For Legal Reasons&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1386"></span><span>        </span><span class="hs-comment">-- 452-499 Unassigned</span><span>
</span><span id="line-1387"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">500</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Internal Server Error&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1388"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">501</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Not Implemented&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1389"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">502</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Bad Gateway&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1390"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">503</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Service Unavailable&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1391"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">504</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Gateway Timeout&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1392"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">505</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HTTP Version Not Supported&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1393"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">506</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Variant Also Negotiates&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1394"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">507</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Insufficient Storage&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1395"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">508</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Loop Detected&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1396"></span><span>        </span><span class="hs-comment">-- 509 Unassigned</span><span>
</span><span id="line-1397"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">510</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Not Extended&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1398"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">511</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Network Authentication Required&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1399"></span><span>        </span><span class="hs-comment">-- 512-599 Unassigned</span><span>
</span><span id="line-1400"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1401"></span><span>
</span><span id="line-1402"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- Deprecated functions</span><span>
</span><span id="line-1404"></span><span>
</span><span id="line-1405"></span><span class="annot"><span class="hs-comment">-- | See 'rqClientAddr'.</span></span><span>
</span><span id="line-1406"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqRemoteAddr"><span class="hs-identifier hs-type">rqRemoteAddr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1407"></span><span id="rqRemoteAddr"><span class="annot"><span class="annottext">rqRemoteAddr :: Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqRemoteAddr"><span class="hs-identifier hs-var hs-var">rqRemoteAddr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqClientAddr"><span class="hs-identifier hs-var">rqClientAddr</span></a></span><span>
</span><span id="line-1408"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">rqRemoteAddr</span><span> </span><span class="hs-pragma">&quot;(snap-core &gt;= 1.0.0.0) please use 'rqClientAddr', this will be removed in 1.1.*&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span class="annot"><span class="hs-comment">-- | See 'rqClientPort'.</span></span><span>
</span><span id="line-1411"></span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqRemotePort"><span class="hs-identifier hs-type">rqRemotePort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1412"></span><span id="rqRemotePort"><span class="annot"><span class="annottext">rqRemotePort :: Request -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rqRemotePort"><span class="hs-identifier hs-var hs-var">rqRemotePort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Snap.Internal.Http.Types.html#rqClientPort"><span class="hs-identifier hs-var">rqClientPort</span></a></span><span>
</span><span id="line-1413"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">rqRemotePort</span><span> </span><span class="hs-pragma">&quot;(snap-core &gt;= 1.0.0.0) please use 'rqClientPort', this will be removed in 1.1.*&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1414"></span></pre></body></html>