<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns        #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP                 #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="annot"><span class="hs-comment">-- | Contains web handlers to serve files from a directory.</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Snap.Internal.Util.FileServe</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Helper functions</span></span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#getSafePath"><span class="hs-identifier">getSafePath</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Configuration for directory serving</span></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#MimeMap"><span class="hs-identifier">MimeMap</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#HandlerMap"><span class="hs-identifier">HandlerMap</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier">DirectoryConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#simpleDirectoryConfig"><span class="hs-identifier">simpleDirectoryConfig</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultDirectoryConfig"><span class="hs-identifier">defaultDirectoryConfig</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#fancyDirectoryConfig"><span class="hs-identifier">fancyDirectoryConfig</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultIndexGenerator"><span class="hs-identifier">defaultIndexGenerator</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier">defaultMimeTypes</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#fileType"><span class="hs-identifier">fileType</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * File servers</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveDirectory"><span class="hs-identifier">serveDirectory</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveDirectoryWith"><span class="hs-identifier">serveDirectoryWith</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveFile"><span class="hs-identifier">serveFile</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveFileAs"><span class="hs-identifier">serveFileAs</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal functions</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#decodeFilePath"><span class="hs-identifier">decodeFilePath</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#checkRangeReq"><span class="hs-identifier">checkRangeReq</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Alternative"><span class="hs-identifier">Alternative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Applicative"><span class="hs-identifier">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2A%3E"><span class="hs-operator">(*&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%2A"><span class="hs-operator">(&lt;*)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator">(&lt;$&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception.Lifted</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Exception.Type.html#SomeException"><span class="hs-identifier">SomeException</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evaluate</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Monad"><span class="hs-identifier">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator">(&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator">(&gt;&gt;=)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier">return</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#filterM"><span class="hs-identifier">filterM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier">forM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier">liftM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier">void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator">(=&lt;&lt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier">MonadIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.ByteString.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">endOfInput</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">option</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">string</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier">Builder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#byteString"><span class="hs-identifier">byteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#char8"><span class="hs-identifier">char8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#stringUtf8"><span class="hs-identifier">stringUtf8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#toLazyByteString"><span class="hs-identifier">toLazyByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier">append</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier">concat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#intercalate"><span class="hs-identifier">intercalate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#isSuffixOf"><span class="hs-identifier">isSuffixOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier">null</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#pack"><span class="hs-identifier">pack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.Char8.html"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HashMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#drop"><span class="hs-identifier">drop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier">elem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier">filter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier">null</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#sort"><span class="hs-identifier">sort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator">(++)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>                       </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#isNothing"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#Monoid"><span class="hs-identifier">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier">mconcat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier">Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier">pack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier">unpack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html#decodeUtf8"><span class="hs-identifier">decodeUtf8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html#encodeUtf8"><span class="hs-identifier">encodeUtf8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span>                          </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier">Bool</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier">FilePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier">IO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier">Just</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#Num"><span class="hs-identifier">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier">show</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#String"><span class="hs-identifier">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier">const</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#either"><span class="hs-identifier">either</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier">flip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier">fromIntegral</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier">maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier">not</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator">($)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator">($!)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator">(.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator">(||)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Snap.Core.html"><span class="hs-identifier">Snap.Core</span></a></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier">MonadSnap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier">Request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqPathInfo"><span class="hs-identifier">rqPathInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqQueryString"><span class="hs-identifier">rqQueryString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#rqURI"><span class="hs-identifier">rqURI</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier">deleteHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#emptyResponse"><span class="hs-identifier">emptyResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#finishWith"><span class="hs-identifier">finishWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#formatHttpTime"><span class="hs-identifier">formatHttpTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier">getHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#getRequest"><span class="hs-identifier">getRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#modifyResponse"><span class="hs-identifier">modifyResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#parseHttpTime"><span class="hs-identifier">parseHttpTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier">pass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#redirect"><span class="hs-identifier">redirect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#sendFile"><span class="hs-identifier">sendFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#sendFilePartial"><span class="hs-identifier">sendFilePartial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-identifier">setContentLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setContentType"><span class="hs-identifier">setContentType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier">setHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseBody"><span class="hs-identifier">setResponseBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier">setResponseCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Parsing.html#urlDecode"><span class="hs-identifier">urlDecode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier">writeBS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Snap.Internal.Debug.html"><span class="hs-identifier">Snap.Internal.Debug</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Debug.html#debug"><span class="hs-identifier">debug</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Snap.Internal.Parsing.html"><span class="hs-identifier">Snap.Internal.Parsing</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Parsing.html#fullyParse"><span class="hs-identifier">fullyParse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Snap.Internal.Parsing.html#parseNum"><span class="hs-identifier">parseNum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier">doesDirectoryExist</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesFileExist"><span class="hs-identifier">doesFileExist</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#getDirectoryContents"><span class="hs-identifier">getDirectoryContents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/template-haskell-2.20.0.0/src/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#isRelative"><span class="hs-identifier">isRelative</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#joinPath"><span class="hs-identifier">joinPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#splitDirectories"><span class="hs-identifier">splitDirectories</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#takeExtensions"><span class="hs-identifier">takeExtensions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#takeFileName"><span class="hs-identifier">takeFileName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator">(&lt;/&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.PosixCompat.Files</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.Common.html#fileSize"><span class="hs-identifier">fileSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.html#getFileStatus"><span class="hs-identifier">getFileStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.Common.html#modificationTime"><span class="hs-identifier">modificationTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Gets a path from the 'Request' using 'rqPathInfo' and makes sure it is</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- safe to use for opening files.  A path is safe if it is a relative path</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- and has no &quot;..&quot; elements to escape the intended directory structure.</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- ghci&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.Map&quot; as M</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Snap.Test&quot; as T</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- ghci&gt; import qualified &quot;Data.ByteString.Char8&quot; as B8</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- ghci&gt; T.runHandler (T.get \&quot;\/foo\/bar\&quot; M.empty) ('getSafePath' &gt;&gt;= 'writeBS' . B8.pack)</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- HTTP\/1.1 200 OK</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- server: Snap\/test</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- date: Fri, 08 Aug 2014 16:13:20 GMT</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- foo\/bar</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- ghci&gt; T.runHandler (T.get \&quot;\/foo\/..\/bar\&quot; M.empty) ('getSafePath' &gt;&gt;= 'writeBS' . B8.pack)</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- HTTP\/1.1 404 Not Found</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-80"></span><span id="local-6989586621679118684"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#getSafePath"><span class="hs-identifier hs-type">getSafePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span></span><span>
</span><span id="line-81"></span><span id="getSafePath"><span class="annot"><span class="annottext">getSafePath :: forall (m :: * -&gt; *). MonadSnap m =&gt; m FilePath
</span><a href="Snap.Internal.Util.FileServe.html#getSafePath"><span class="hs-identifier hs-var hs-var">getSafePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679119214"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119214"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Request
forall (m :: * -&gt; *). MonadSnap m =&gt; m Request
</span><a href="Snap.Internal.Core.html#getRequest"><span class="hs-identifier hs-var">getRequest</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119215"><span class="annot"><span class="annottext">mp :: Maybe ByteString
</span><a href="#local-6989586621679119215"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
</span><a href="Snap.Internal.Parsing.html#urlDecode"><span class="hs-identifier hs-var">urlDecode</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqPathInfo"><span class="hs-identifier hs-var">rqPathInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119214"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679119216"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119216"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m FilePath
-&gt; (ByteString -&gt; m FilePath) -&gt; Maybe ByteString -&gt; m FilePath
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">m FilePath
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; m FilePath
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m FilePath)
-&gt; (ByteString -&gt; FilePath) -&gt; ByteString -&gt; m FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FilePath)
-&gt; (ByteString -&gt; Text) -&gt; ByteString -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html#decodeUtf8"><span class="hs-identifier hs-var">T.decodeUtf8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679119215"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- relative paths only!</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119216"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- check that we don't have any sneaky .. paths</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119217"><span class="annot"><span class="annottext">dirs :: [FilePath]
</span><a href="#local-6989586621679119217"><span class="hs-identifier hs-var hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#splitDirectories"><span class="hs-identifier hs-var">splitDirectories</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119216"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;..&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119217"><span class="hs-identifier hs-var">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; m FilePath
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m FilePath) -&gt; FilePath -&gt; m FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#joinPath"><span class="hs-identifier hs-var">joinPath</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119217"><span class="hs-identifier hs-var">dirs</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- | A type alias for dynamic handlers</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span id="HandlerMap"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#HandlerMap"><span class="hs-identifier hs-var">HandlerMap</span></a></span></span><span> </span><span id="local-6989586621679119218"><span class="annot"><a href="#local-6989586621679119218"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119218"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-103"></span><span class="annot"><span class="hs-comment">-- | A type alias for MIME type</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">type</span><span> </span><span id="MimeMap"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#MimeMap"><span class="hs-identifier hs-var">MimeMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | The default set of mime type mappings we use when serving files. Its</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- value:</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt; Map.fromList [</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt;   ( &quot;.asc&quot;     , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;   ( &quot;.asf&quot;     , &quot;video/x-ms-asf&quot;                                         ),</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- &gt;   ( &quot;.asx&quot;     , &quot;video/x-ms-asf&quot;                                         ),</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &gt;   ( &quot;.au&quot;      , &quot;audio/basic&quot;                                            ),</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt;   ( &quot;.avi&quot;     , &quot;video/x-msvideo&quot;                                        ),</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- &gt;   ( &quot;.bmp&quot;     , &quot;image/bmp&quot;                                              ),</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &gt;   ( &quot;.bz2&quot;     , &quot;application/x-bzip&quot;                                     ),</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &gt;   ( &quot;.c&quot;       , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- &gt;   ( &quot;.class&quot;   , &quot;application/octet-stream&quot;                               ),</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;   ( &quot;.conf&quot;    , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &gt;   ( &quot;.cpp&quot;     , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- &gt;   ( &quot;.css&quot;     , &quot;text/css&quot;                                               ),</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- &gt;   ( &quot;.csv&quot;     , &quot;text/csv&quot;                                               ),</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- &gt;   ( &quot;.cxx&quot;     , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- &gt;   ( &quot;.doc&quot;     , &quot;application/msword&quot;                                     ),</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;   ( &quot;.docx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument&quot;</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- &gt;                           &quot;.wordprocessingml.document&quot;                    ),</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- &gt;   ( &quot;.dotx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument&quot;</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- &gt;                           &quot;.wordprocessingml.template&quot;                    ),</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt;   ( &quot;.dtd&quot;     , &quot;application/xml-dtd&quot;                                    ),</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &gt;   ( &quot;.dvi&quot;     , &quot;application/x-dvi&quot;                                      ),</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- &gt;   ( &quot;.exe&quot;     , &quot;application/octet-stream&quot;                               ),</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- &gt;   ( &quot;.flv&quot;     , &quot;video/x-flv&quot;                                            ),</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- &gt;   ( &quot;.gif&quot;     , &quot;image/gif&quot;                                              ),</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- &gt;   ( &quot;.gz&quot;      , &quot;application/x-gzip&quot;                                     ),</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- &gt;   ( &quot;.hs&quot;      , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- &gt;   ( &quot;.htm&quot;     , &quot;text/html&quot;                                              ),</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- &gt;   ( &quot;.html&quot;    , &quot;text/html&quot;                                              ),</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- &gt;   ( &quot;.ico&quot;     , &quot;image/x-icon&quot;                                           ),</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- &gt;   ( &quot;.jar&quot;     , &quot;application/x-java-archive&quot;                             ),</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- &gt;   ( &quot;.jpeg&quot;    , &quot;image/jpeg&quot;                                             ),</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- &gt;   ( &quot;.jpg&quot;     , &quot;image/jpeg&quot;                                             ),</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- &gt;   ( &quot;.js&quot;      , &quot;text/javascript&quot;                                        ),</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- &gt;   ( &quot;.json&quot;    , &quot;application/json&quot;                                       ),</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- &gt;   ( &quot;.log&quot;     , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- &gt;   ( &quot;.m3u&quot;     , &quot;audio/x-mpegurl&quot;                                        ),</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- &gt;   ( &quot;.m3u8&quot;    , &quot;application/x-mpegURL&quot;                                  ),</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- &gt;   ( &quot;.mka&quot;     , &quot;audio/x-matroska&quot;                                       ),</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- &gt;   ( &quot;.mk3d&quot;    , &quot;video/x-matroska&quot;                                       ),</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- &gt;   ( &quot;.mkv&quot;     , &quot;video/x-matroska&quot;                                       ),</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- &gt;   ( &quot;.mov&quot;     , &quot;video/quicktime&quot;                                        ),</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;   ( &quot;.mp3&quot;     , &quot;audio/mpeg&quot;                                             ),</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- &gt;   ( &quot;.mp4&quot;     , &quot;video/mp4&quot;                                              ),</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &gt;   ( &quot;.mpeg&quot;    , &quot;video/mpeg&quot;                                             ),</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- &gt;   ( &quot;.mpg&quot;     , &quot;video/mpeg&quot;                                             ),</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- &gt;   ( &quot;.ogg&quot;     , &quot;application/ogg&quot;                                        ),</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- &gt;   ( &quot;.pac&quot;     , &quot;application/x-ns-proxy-autoconfig&quot;                      ),</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt;   ( &quot;.pdf&quot;     , &quot;application/pdf&quot;                                        ),</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- &gt;   ( &quot;.png&quot;     , &quot;image/png&quot;                                              ),</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;   ( &quot;.potx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument&quot;</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- &gt;                           &quot;.presentationml.template&quot;                      ),</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- &gt;   ( &quot;.ppsx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument&quot;</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- &gt;                           &quot;.presentationml.slideshow&quot;                     ),</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- &gt;   ( &quot;.ppt&quot;     , &quot;application/vnd.ms-powerpoint&quot;                          ),</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- &gt;   ( &quot;.pptx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument&quot;</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &gt;                           &quot;.presentationml.presentation&quot;                  ),</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- &gt;   ( &quot;.ps&quot;      , &quot;application/postscript&quot;                                 ),</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- &gt;   ( &quot;.qt&quot;      , &quot;video/quicktime&quot;                                        ),</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- &gt;   ( &quot;.rtf&quot;     , &quot;text/rtf&quot;                                               ),</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- &gt;   ( &quot;.sig&quot;     , &quot;application/pgp-signature&quot;                              ),</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- &gt;   ( &quot;.sldx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument&quot;</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- &gt;                           &quot;.presentationml.slide&quot;                         ),</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- &gt;   ( &quot;.spl&quot;     , &quot;application/futuresplash&quot;                               ),</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- &gt;   ( &quot;.svg&quot;     , &quot;image/svg+xml&quot;                                          ),</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- &gt;   ( &quot;.swf&quot;     , &quot;application/x-shockwave-flash&quot;                          ),</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- &gt;   ( &quot;.tar&quot;     , &quot;application/x-tar&quot;                                      ),</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- &gt;   ( &quot;.tar.bz2&quot; , &quot;application/x-bzip-compressed-tar&quot;                      ),</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- &gt;   ( &quot;.tar.gz&quot;  , &quot;application/x-tgz&quot;                                      ),</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt;   ( &quot;.tbz&quot;     , &quot;application/x-bzip-compressed-tar&quot;                      ),</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- &gt;   ( &quot;.text&quot;    , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- &gt;   ( &quot;.tgz&quot;     , &quot;application/x-tgz&quot;                                      ),</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt;   ( &quot;.tif&quot;     , &quot;image/tiff&quot;                                             ),</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt;   ( &quot;.tiff&quot;    , &quot;image/tiff&quot;                                             ),</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- &gt;   ( &quot;.torrent&quot; , &quot;application/x-bittorrent&quot;                               ),</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- &gt;   ( &quot;.ts&quot;      , &quot;video/mp2t&quot;                                             ),</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- &gt;   ( &quot;.txt&quot;     , &quot;text/plain&quot;                                             ),</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- &gt;   ( &quot;.wav&quot;     , &quot;audio/x-wav&quot;                                            ),</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- &gt;   ( &quot;.wax&quot;     , &quot;audio/x-ms-wax&quot;                                         ),</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &gt;   ( &quot;.webm&quot;    , &quot;video/webm&quot;                                             ),</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- &gt;   ( &quot;.wma&quot;     , &quot;audio/x-ms-wma&quot;                                         ),</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- &gt;   ( &quot;.wmv&quot;     , &quot;video/x-ms-wmv&quot;                                         ),</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- &gt;   ( &quot;.xbm&quot;     , &quot;image/x-xbitmap&quot;                                        ),</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt;   ( &quot;.xlam&quot;    , &quot;application/vnd.ms-excel.addin.macroEnabled.12&quot;         ),</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- &gt;   ( &quot;.xls&quot;     , &quot;application/vnd.ms-excel&quot;                               ),</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- &gt;   ( &quot;.xlsb&quot;    , &quot;application/vnd.ms-excel.sheet.binary.macroEnabled.12&quot;  ),</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- &gt;   ( &quot;.xlsx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument.&quot;</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- &gt;                           &quot;spreadsheetml.sheet&quot;                           ),</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- &gt;   ( &quot;.xltx&quot;    , S.append &quot;application/vnd.openxmlformats-officedocument.&quot;</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- &gt;                           &quot;spreadsheetml.template&quot;                        ),</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- &gt;   ( &quot;.xml&quot;     , &quot;text/xml&quot;                                               ),</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- &gt;   ( &quot;.xpm&quot;     , &quot;image/x-xpixmap&quot;                                        ),</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- &gt;   ( &quot;.xwd&quot;     , &quot;image/x-xwindowdump&quot;                                    ),</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- &gt;   ( &quot;.zip&quot;     , &quot;application/zip&quot;                                        ) ]</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-type">defaultMimeTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#MimeMap"><span class="hs-identifier hs-type">MimeMap</span></a></span><span>
</span><span id="line-207"></span><span id="defaultMimeTypes"><span class="annot"><span class="annottext">defaultMimeTypes :: MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-var hs-var">defaultMimeTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">[(FilePath, ByteString)] -&gt; MimeMap
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.asc&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.asf&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-ms-asf&quot;</span></span><span>                                         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.asx&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-ms-asf&quot;</span></span><span>                                         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.au&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/basic&quot;</span></span><span>                                            </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.avi&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-msvideo&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.bmp&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/bmp&quot;</span></span><span>                                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.bz2&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-bzip&quot;</span></span><span>                                     </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.c&quot;</span></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.class&quot;</span></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/octet-stream&quot;</span></span><span>                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.conf&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.cpp&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.css&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/css&quot;</span></span><span>                                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.csv&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/csv&quot;</span></span><span>                                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.cxx&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.doc&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/msword&quot;</span></span><span>                                     </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.docx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument&quot;</span></span><span>
</span><span id="line-225"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.wordprocessingml.document&quot;</span></span><span>                    </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.dotx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument&quot;</span></span><span>
</span><span id="line-227"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.wordprocessingml.template&quot;</span></span><span>                    </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.dtd&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/xml-dtd&quot;</span></span><span>                                    </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.dvi&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-dvi&quot;</span></span><span>                                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.exe&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/octet-stream&quot;</span></span><span>                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.flv&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-flv&quot;</span></span><span>                                            </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.gif&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/gif&quot;</span></span><span>                                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.gz&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-gzip&quot;</span></span><span>                                     </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.hs&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.htm&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/html&quot;</span></span><span>                                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.html&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/html&quot;</span></span><span>                                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ico&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/x-icon&quot;</span></span><span>                                           </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.jar&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-java-archive&quot;</span></span><span>                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.jpeg&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/jpeg&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.jpg&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/jpeg&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.js&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/javascript&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.json&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/json&quot;</span></span><span>                                       </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.log&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.m3u&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/x-mpegurl&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.m3u8&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-mpegURL&quot;</span></span><span>                                  </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mka&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/x-matroska&quot;</span></span><span>                                       </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mk3d&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-matroska&quot;</span></span><span>                                       </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mkv&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-matroska&quot;</span></span><span>                                       </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mov&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/quicktime&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mp3&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/mpeg&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mp4&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/mp4&quot;</span></span><span>                                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mpeg&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/mpeg&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.mpg&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/mpeg&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ogg&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/ogg&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.pac&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-ns-proxy-autoconfig&quot;</span></span><span>                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.pdf&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/pdf&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.png&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/png&quot;</span></span><span>                                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.potx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument&quot;</span></span><span>
</span><span id="line-259"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.presentationml.template&quot;</span></span><span>                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ppsx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument&quot;</span></span><span>
</span><span id="line-261"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.presentationml.slideshow&quot;</span></span><span>                     </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ppt&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.ms-powerpoint&quot;</span></span><span>                          </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.pptx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument&quot;</span></span><span>
</span><span id="line-264"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.presentationml.presentation&quot;</span></span><span>                  </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ps&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/postscript&quot;</span></span><span>                                 </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.qt&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/quicktime&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.rtf&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/rtf&quot;</span></span><span>                                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.sig&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/pgp-signature&quot;</span></span><span>                              </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.sldx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument&quot;</span></span><span>
</span><span id="line-270"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.presentationml.slide&quot;</span></span><span>                         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.spl&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/futuresplash&quot;</span></span><span>                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.svg&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/svg+xml&quot;</span></span><span>                                          </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.swf&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-shockwave-flash&quot;</span></span><span>                          </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tar&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-tar&quot;</span></span><span>                                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tar.bz2&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-bzip-compressed-tar&quot;</span></span><span>                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tar.gz&quot;</span></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-tgz&quot;</span></span><span>                                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tbz&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-bzip-compressed-tar&quot;</span></span><span>                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.text&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tgz&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-tgz&quot;</span></span><span>                                      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tiff&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/tiff&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.tif&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/tiff&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.torrent&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-bittorrent&quot;</span></span><span>                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ts&quot;</span></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/mp2t&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ttf&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;font/ttf&quot;</span></span><span>                                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.txt&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.wav&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/x-wav&quot;</span></span><span>                                            </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.wax&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/x-ms-wax&quot;</span></span><span>                                         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.webm&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/webm&quot;</span></span><span>                                             </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.wma&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;audio/x-ms-wma&quot;</span></span><span>                                         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.wmv&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;video/x-ms-wmv&quot;</span></span><span>                                         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xbm&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/x-xbitmap&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xlam&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.ms-excel.addin.macroEnabled.12&quot;</span></span><span>         </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xls&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.ms-excel&quot;</span></span><span>                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xlsb&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.ms-excel.sheet.binary.macroEnabled.12&quot;</span></span><span>  </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xlsx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument.&quot;</span></span><span>
</span><span id="line-296"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;spreadsheetml.sheet&quot;</span></span><span>                           </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xltx&quot;</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-identifier hs-var">S.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/vnd.openxmlformats-officedocument.&quot;</span></span><span>
</span><span id="line-298"></span><span>                            </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;spreadsheetml.template&quot;</span></span><span>                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xml&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/xml&quot;</span></span><span>                                               </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xpm&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/x-xpixmap&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.xwd&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;image/x-xwindowdump&quot;</span></span><span>                                    </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.zip&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/zip&quot;</span></span><span>                                        </span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-306"></span><span class="annot"><span class="hs-comment">-- | A collection of options for serving static files out of a directory.</span></span><span>
</span><span id="line-307"></span><span class="hs-keyword">data</span><span> </span><span id="DirectoryConfig"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-var">DirectoryConfig</span></a></span></span><span> </span><span id="local-6989586621679118710"><span class="annot"><a href="#local-6989586621679118710"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DirectoryConfig"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-var">DirectoryConfig</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Files to look for when a directory is requested (e.g., index.html)</span></span><span>
</span><span id="line-309"></span><span>    </span><span id="indexFiles"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). DirectoryConfig m -&gt; [FilePath]
</span><a href="Snap.Internal.Util.FileServe.html#indexFiles"><span class="hs-identifier hs-var hs-var">indexFiles</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Handler to generate a directory listing if there is no index.</span></span><span>
</span><span id="line-312"></span><span>    </span><span id="indexGenerator"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). DirectoryConfig m -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#indexGenerator"><span class="hs-identifier hs-var hs-var">indexGenerator</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- | Map of extensions to pass to dynamic file handlers.  This could be</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- used, for example, to implement CGI dispatch, pretty printing of source</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-comment">-- code, etc.</span><span>
</span><span id="line-317"></span><span>    </span><span id="dynamicHandlers"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). DirectoryConfig m -&gt; HandlerMap m
</span><a href="Snap.Internal.Util.FileServe.html#dynamicHandlers"><span class="hs-identifier hs-var hs-var">dynamicHandlers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#HandlerMap"><span class="hs-identifier hs-type">HandlerMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118710"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="hs-comment">-- | MIME type map to look up content types.</span></span><span>
</span><span id="line-320"></span><span>    </span><span id="mimeTypes"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). DirectoryConfig m -&gt; MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#mimeTypes"><span class="hs-identifier hs-var hs-var">mimeTypes</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#MimeMap"><span class="hs-identifier hs-type">MimeMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- | Handler that is called before a file is served.  It will only be</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- called when a file is actually found, not for generated index pages.</span><span>
</span><span id="line-324"></span><span>    </span><span id="preServeHook"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). DirectoryConfig m -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#preServeHook"><span class="hs-identifier hs-var hs-var">preServeHook</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-329"></span><span class="annot"><span class="hs-comment">-- | Style information for the default directory index generator.</span></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#snapIndexStyles"><span class="hs-identifier hs-type">snapIndexStyles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-331"></span><span id="snapIndexStyles"><span class="annot"><span class="annottext">snapIndexStyles :: ByteString
</span><a href="Snap.Internal.Util.FileServe.html#snapIndexStyles"><span class="hs-identifier hs-var hs-var">snapIndexStyles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#intercalate"><span class="hs-identifier hs-var">S.intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-333"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;body { margin: 0px 0px 0px 0px; font-family: sans-serif }&quot;</span></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;div.header {&quot;</span></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;padding: 40px 40px 0px 40px; height:35px;&quot;</span></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background:rgb(25,50,87);&quot;</span></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background-image:-webkit-gradient(&quot;</span></span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;linear,left bottom,left top,&quot;</span></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;color-stop(0.00, rgb(31,62,108)),&quot;</span></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;color-stop(1.00, rgb(19,38,66)));&quot;</span></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background-image:-moz-linear-gradient(&quot;</span></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;center bottom,rgb(31,62,108) 0%,rgb(19,38,66) 100%);&quot;</span></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text-shadow:-1px 3px 1px rgb(16,33,57);&quot;</span></span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;font-size:16pt; letter-spacing: 2pt; color:white;&quot;</span></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;border-bottom:10px solid rgb(46,93,156) }&quot;</span></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;div.content {&quot;</span></span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background:rgb(255,255,255);&quot;</span></span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background-image:-webkit-gradient(&quot;</span></span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;linear,left bottom, left top,&quot;</span></span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;color-stop(0.50, rgb(255,255,255)),&quot;</span></span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;color-stop(1.00, rgb(224,234,247)));&quot;</span></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background-image:-moz-linear-gradient(&quot;</span></span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;center bottom, white 50%, rgb(224,234,247) 100%);&quot;</span></span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;padding: 40px 40px 40px 40px }&quot;</span></span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;div.footer {&quot;</span></span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;padding: 16px 0px 10px 10px; height:31px;&quot;</span></span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;border-top: 1px solid rgb(194,209,225);&quot;</span></span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;color: rgb(160,172,186); font-size:10pt;&quot;</span></span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;background: rgb(245,249,255) }&quot;</span></span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;table { max-width:100%; margin: 0 auto;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#append"><span class="hs-operator hs-var">`S.append`</span></a></span><span>
</span><span id="line-361"></span><span>          </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; border-collapse: collapse; }&quot;</span></span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;tr:hover { background:rgb(256,256,224) }&quot;</span></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;td { border:0; font-family:monospace; padding: 2px 0; }&quot;</span></span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;td.filename, td.type { padding-right: 2em; }&quot;</span></span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;th { border:0; background:rgb(28,56,97);&quot;</span></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text-shadow:-1px 3px 1px rgb(16,33,57); color: white}&quot;</span></span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | An automatic index generator, which is fairly small and does not rely on</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- any external files (which may not be there depending on external request</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- routing).</span><span>
</span><span id="line-374"></span><span class="hs-comment">--</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- A 'MimeMap' is passed in to display the types of files in the directory</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- listing based on their extension.  Preferably, this is the same as the map</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- in the 'DirectoryConfig'</span><span>
</span><span id="line-378"></span><span class="hs-comment">--</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- The styles parameter allows you to apply styles to the directory listing.</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- The listing itself consists of a table, containing a header row using</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- th elements, and one row per file using td elements, so styles for those</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- pieces may be attached to the appropriate tags.</span><span>
</span><span id="line-383"></span><span id="local-6989586621679118718"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultIndexGenerator"><span class="hs-identifier hs-type">defaultIndexGenerator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-384"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#MimeMap"><span class="hs-identifier hs-type">MimeMap</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ MIME type mapping for reporting types</span></span><span>
</span><span id="line-385"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Style info to insert in header</span></span><span>
</span><span id="line-386"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Directory to generate index for</span></span><span>
</span><span id="line-387"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118718"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-388"></span><span id="defaultIndexGenerator"><span class="annot"><span class="annottext">defaultIndexGenerator :: forall (m :: * -&gt; *).
MonadSnap m =&gt;
MimeMap -&gt; ByteString -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#defaultIndexGenerator"><span class="hs-identifier hs-var hs-var">defaultIndexGenerator</span></a></span></span><span> </span><span id="local-6989586621679119362"><span class="annot"><span class="annottext">MimeMap
</span><a href="#local-6989586621679119362"><span class="hs-identifier hs-var">mm</span></a></span></span><span> </span><span id="local-6989586621679119363"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119363"><span class="hs-identifier hs-var">styles</span></a></span></span><span> </span><span id="local-6989586621679119364"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="annottext">(Response -&gt; Response) -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; (Response -&gt; Response) -&gt; m ()
</span><a href="Snap.Internal.Core.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((Response -&gt; Response) -&gt; m ()) -&gt; (Response -&gt; Response) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentType"><span class="hs-identifier hs-var">setContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/html; charset=utf-8&quot;</span></span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679119365"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119365"><span class="hs-identifier hs-var">rq</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Request
forall (m :: * -&gt; *). MonadSnap m =&gt; m Request
</span><a href="Snap.Internal.Core.html#getRequest"><span class="hs-identifier hs-var">getRequest</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119366"><span class="annot"><span class="annottext">uri :: ByteString
</span><a href="#local-6989586621679119366"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#uriWithoutQueryString"><span class="hs-identifier hs-var">uriWithoutQueryString</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119365"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119368"><span class="annot"><span class="annottext">pInfo :: ByteString
</span><a href="#local-6989586621679119368"><span class="hs-identifier hs-var hs-var">pInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqPathInfo"><span class="hs-identifier hs-var">rqPathInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119365"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;&quot;</span></span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;title&gt;Directory Listing: &quot;</span></span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119366"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/title&gt;&quot;</span></span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;style type='text/css'&gt;&quot;</span></span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119363"><span class="hs-identifier hs-var">styles</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&quot;</span></span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;div class=\&quot;header\&quot;&gt;Directory Listing: &quot;</span></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119366"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/div&gt;&lt;div class=\&quot;content\&quot;&gt;&quot;</span></span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;table&gt;&lt;tr&gt;&lt;th&gt;File Name&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;th&gt;Last Modified&quot;</span></span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/th&gt;&lt;/tr&gt;&quot;</span></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119368"><span class="hs-identifier hs-var">pInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;tr&gt;&lt;td&gt;&lt;a href='../'&gt;..&lt;/a&gt;&lt;/td&gt;&lt;td colspan=2&gt;DIR&lt;/td&gt;&lt;/tr&gt;&quot;</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679119370"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119370"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [FilePath] -&gt; m [FilePath]
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [FilePath] -&gt; m [FilePath]) -&gt; IO [FilePath] -&gt; m [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [FilePath]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#getDirectoryContents"><span class="hs-identifier hs-var">getDirectoryContents</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679119372"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119372"><span class="hs-identifier hs-var">dirs</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [FilePath] -&gt; m [FilePath]
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [FilePath] -&gt; m [FilePath]) -&gt; IO [FilePath] -&gt; m [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; [FilePath] -&gt; IO [FilePath]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#filterM"><span class="hs-identifier hs-var">filterM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-var">doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool)
-&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119370"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679119373"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119373"><span class="hs-identifier hs-var">files</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [FilePath] -&gt; m [FilePath]
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [FilePath] -&gt; m [FilePath]) -&gt; IO [FilePath] -&gt; m [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; [FilePath] -&gt; IO [FilePath]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#filterM"><span class="hs-identifier hs-var">filterM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool)
-&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119370"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">[FilePath] -&gt; (FilePath -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [FilePath]) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; [FilePath] -&gt; [FilePath]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (FilePath -&gt; Bool) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119372"><span class="hs-identifier hs-var">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; m ()) -&gt; m ()) -&gt; (FilePath -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119374"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119374"><span class="hs-identifier hs-var">f0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>        </span><span id="local-6989586621679119375"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119375"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; m ByteString
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; m ByteString) -&gt; IO ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; IO Text -&gt; IO ByteString
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679119376"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679119376"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html#encodeUtf8"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679119376"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mappend"><span class="hs-operator hs-var">`mappend`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>                    </span><span class="annot"><span class="annottext">(IO Text -&gt; IO ByteString) -&gt; IO Text -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Text
</span><a href="Snap.Internal.Util.FileServe.html#decodeFilePath"><span class="hs-identifier hs-var">decodeFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119374"><span class="hs-identifier hs-var">f0</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;tr&gt;&lt;td class='filename'&gt;&lt;a href='&quot;</span></span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119375"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;'&gt;&quot;</span></span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119375"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/a&gt;&lt;/td&gt;&lt;td class='type' colspan=2&gt;DIR&lt;/td&gt;&lt;/tr&gt;&quot;</span></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">[FilePath] -&gt; (FilePath -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.OldList.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119373"><span class="hs-identifier hs-var">files</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; m ()) -&gt; m ()) -&gt; (FilePath -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119377"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119377"><span class="hs-identifier hs-var">f0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>        </span><span id="local-6989586621679119378"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119378"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; m ByteString
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; m ByteString) -&gt; IO ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; IO Text -&gt; IO ByteString
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html#encodeUtf8"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Text -&gt; IO ByteString) -&gt; IO Text -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Text
</span><a href="Snap.Internal.Util.FileServe.html#decodeFilePath"><span class="hs-identifier hs-var">decodeFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119377"><span class="hs-identifier hs-var">f0</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span id="local-6989586621679119379"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679119379"><span class="hs-identifier hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileStatus -&gt; m FileStatus
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO FileStatus -&gt; m FileStatus) -&gt; IO FileStatus -&gt; m FileStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FileStatus
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">getFileStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119377"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>        </span><span id="local-6989586621679119380"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119380"><span class="hs-identifier hs-var">tm</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; m ByteString
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; m ByteString) -&gt; IO ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Types.html#formatHttpTime"><span class="hs-identifier hs-var">formatHttpTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileStatus -&gt; CTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.Common.html#modificationTime"><span class="hs-identifier hs-var">modificationTime</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679119379"><span class="hs-identifier hs-var">stat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;tr&gt;&lt;td class='filename'&gt;&lt;a href='&quot;</span></span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119378"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;'&gt;&quot;</span></span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119378"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/a&gt;&lt;/td&gt;&lt;td class='type'&gt;&quot;</span></span><span>
</span><span id="line-433"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MimeMap -&gt; FilePath -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#fileType"><span class="hs-identifier hs-var">fileType</span></a></span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="#local-6989586621679119362"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119377"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span></span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119380"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/tr&gt;&quot;</span></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/table&gt;&lt;/div&gt;&lt;div class=\&quot;footer\&quot;&gt;Powered by &quot;</span></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;b&gt;&lt;a href=\&quot;http://snapframework.com/\&quot;&gt;Snap&lt;/a&gt;&lt;/b&gt;&lt;/div&gt;&quot;</span></span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; m ()
</span><a href="Snap.Internal.Core.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;/body&gt;&quot;</span></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-444"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#decodeFilePath"><span class="hs-identifier hs-type">decodeFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-445"></span><span id="decodeFilePath"><span class="annot"><span class="annottext">decodeFilePath :: FilePath -&gt; IO Text
</span><a href="Snap.Internal.Util.FileServe.html#decodeFilePath"><span class="hs-identifier hs-var hs-var">decodeFilePath</span></a></span></span><span> </span><span id="local-6989586621679119381"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119381"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall (m :: * -&gt; *) a. MonadBase IO m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Encoding.html#decodeUtf8"><span class="hs-identifier hs-var">T.decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119382"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO Text -&gt; (SomeException -&gt; IO Text) -&gt; IO Text
forall (m :: * -&gt; *) e a.
(MonadBaseControl IO m, Exception e) =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-operator hs-var">`catch`</span></span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException
</span><span class="hs-identifier">_</span></span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Exception.Type.html#SomeException"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119381"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621679119382"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679119382"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#pack"><span class="hs-identifier hs-var">S.pack</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119381"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- | A very simple configuration for directory serving.  This configuration</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- uses built-in MIME types from 'defaultMimeTypes', and has no index files,</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- index generator, dynamic file handlers, or 'preServeHook'.</span><span>
</span><span id="line-455"></span><span id="local-6989586621679118751"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#simpleDirectoryConfig"><span class="hs-identifier hs-type">simpleDirectoryConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118751"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-456"></span><span id="simpleDirectoryConfig"><span class="annot"><span class="annottext">simpleDirectoryConfig :: forall (m :: * -&gt; *). MonadSnap m =&gt; DirectoryConfig m
</span><a href="Snap.Internal.Util.FileServe.html#simpleDirectoryConfig"><span class="hs-identifier hs-var hs-var">simpleDirectoryConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">indexFiles :: [FilePath]
</span><a href="Snap.Internal.Util.FileServe.html#indexFiles"><span class="hs-identifier hs-var">indexFiles</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">indexGenerator :: FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#indexGenerator"><span class="hs-identifier hs-var">indexGenerator</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; FilePath -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><span class="annottext">dynamicHandlers :: HandlerMap m
</span><a href="Snap.Internal.Util.FileServe.html#dynamicHandlers"><span class="hs-identifier hs-var">dynamicHandlers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandlerMap m
forall k v. HashMap k v
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><span class="annottext">mimeTypes :: MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#mimeTypes"><span class="hs-identifier hs-var">mimeTypes</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-var">defaultMimeTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">preServeHook :: FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#preServeHook"><span class="hs-identifier hs-var">preServeHook</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; FilePath -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; FilePath -&gt; m ()) -&gt; m () -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(() -&gt; m ()) -&gt; () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | A reasonable default configuration for directory serving.  This</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- configuration uses built-in MIME types from 'defaultMimeTypes', serves</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- common index files @index.html@ and @index.htm@, but does not autogenerate</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- directory indexes, nor have any dynamic file handlers. The 'preServeHook'</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- will not do anything.</span><span>
</span><span id="line-471"></span><span id="local-6989586621679119387"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultDirectoryConfig"><span class="hs-identifier hs-type">defaultDirectoryConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119387"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-472"></span><span id="defaultDirectoryConfig"><span class="annot"><span class="annottext">defaultDirectoryConfig :: forall (m :: * -&gt; *). MonadSnap m =&gt; DirectoryConfig m
</span><a href="Snap.Internal.Util.FileServe.html#defaultDirectoryConfig"><span class="hs-identifier hs-var hs-var">defaultDirectoryConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><span class="annottext">indexFiles :: [FilePath]
</span><a href="Snap.Internal.Util.FileServe.html#indexFiles"><span class="hs-identifier hs-var">indexFiles</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index.html&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index.htm&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><span class="annottext">indexGenerator :: FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#indexGenerator"><span class="hs-identifier hs-var">indexGenerator</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; FilePath -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="annottext">dynamicHandlers :: HandlerMap m
</span><a href="Snap.Internal.Util.FileServe.html#dynamicHandlers"><span class="hs-identifier hs-var">dynamicHandlers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandlerMap m
forall k v. HashMap k v
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><span class="annottext">mimeTypes :: MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#mimeTypes"><span class="hs-identifier hs-var">mimeTypes</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-var">defaultMimeTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><span class="annottext">preServeHook :: FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#preServeHook"><span class="hs-identifier hs-var">preServeHook</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; FilePath -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; FilePath -&gt; m ()) -&gt; m () -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(() -&gt; m ()) -&gt; () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | A more elaborate configuration for file serving.  This configuration</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- uses built-in MIME types from 'defaultMimeTypes', serves common index files</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- @index.html@ and @index.htm@, and autogenerates directory indexes with a</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- Snap-like feel.  It still has no dynamic file handlers, nor 'preServeHook',</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- which should be added as needed.</span><span>
</span><span id="line-487"></span><span class="hs-comment">--</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- Files recognized as indexes include @index.html@, @index.htm@,</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- @default.html@, @default.htm@, @home.html@</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- Example of how the autogenerated directory index looks like:</span><span>
</span><span id="line-492"></span><span class="hs-comment">--</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- &lt;&lt;data:image/png;base64,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&gt;&gt;</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span id="local-6989586621679119392"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#fancyDirectoryConfig"><span class="hs-identifier hs-type">fancyDirectoryConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119392"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119392"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-496"></span><span id="fancyDirectoryConfig"><span class="annot"><span class="annottext">fancyDirectoryConfig :: forall (m :: * -&gt; *). MonadSnap m =&gt; DirectoryConfig m
</span><a href="Snap.Internal.Util.FileServe.html#fancyDirectoryConfig"><span class="hs-identifier hs-var hs-var">fancyDirectoryConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><span class="annottext">indexFiles :: [FilePath]
</span><a href="Snap.Internal.Util.FileServe.html#indexFiles"><span class="hs-identifier hs-var">indexFiles</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index.html&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index.htm&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">indexGenerator :: FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#indexGenerator"><span class="hs-identifier hs-var">indexGenerator</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimeMap -&gt; ByteString -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *).
MonadSnap m =&gt;
MimeMap -&gt; ByteString -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#defaultIndexGenerator"><span class="hs-identifier hs-var">defaultIndexGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-var">defaultMimeTypes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Snap.Internal.Util.FileServe.html#snapIndexStyles"><span class="hs-identifier hs-var">snapIndexStyles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><span class="annottext">dynamicHandlers :: HandlerMap m
</span><a href="Snap.Internal.Util.FileServe.html#dynamicHandlers"><span class="hs-identifier hs-var">dynamicHandlers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandlerMap m
forall k v. HashMap k v
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="annottext">mimeTypes :: MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#mimeTypes"><span class="hs-identifier hs-var">mimeTypes</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-var">defaultMimeTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><span class="annottext">preServeHook :: FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#preServeHook"><span class="hs-identifier hs-var">preServeHook</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; FilePath -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; FilePath -&gt; m ()) -&gt; m () -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(() -&gt; m ()) -&gt; () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- | Serves static files from a directory using the default configuration</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- as given in 'defaultDirectoryConfig'.</span><span>
</span><span id="line-508"></span><span id="local-6989586621679118759"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveDirectory"><span class="hs-identifier hs-type">serveDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118759"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-509"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Directory to serve from</span></span><span>
</span><span id="line-510"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118759"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-511"></span><span id="serveDirectory"><span class="annot"><span class="annottext">serveDirectory :: forall (m :: * -&gt; *). MonadSnap m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveDirectory"><span class="hs-identifier hs-var hs-var">serveDirectory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *).
MonadSnap m =&gt;
DirectoryConfig m -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveDirectoryWith"><span class="hs-identifier hs-var">serveDirectoryWith</span></a></span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m
forall (m :: * -&gt; *). MonadSnap m =&gt; DirectoryConfig m
</span><a href="Snap.Internal.Util.FileServe.html#defaultDirectoryConfig"><span class="hs-identifier hs-var">defaultDirectoryConfig</span></a></span><span>
</span><span id="line-512"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveDirectory"><span class="hs-pragma hs-type">serveDirectory</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | Serves static files from a directory.  Configuration options are</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- passed in a 'DirectoryConfig' that captures various choices about desired</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- behavior.  The relative path given in 'rqPathInfo' is searched for a</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- requested file, and the file is served with the appropriate mime type if it</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- is found. Absolute paths and \&quot;@..@\&quot; are prohibited to prevent files from</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- being served from outside the sandbox.</span><span>
</span><span id="line-522"></span><span id="local-6989586621679118761"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveDirectoryWith"><span class="hs-identifier hs-type">serveDirectoryWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118761"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-523"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#DirectoryConfig"><span class="hs-identifier hs-type">DirectoryConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118761"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Configuration options</span></span><span>
</span><span id="line-524"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Directory to serve from</span></span><span>
</span><span id="line-525"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118761"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-526"></span><span id="serveDirectoryWith"><span class="annot"><span class="annottext">serveDirectoryWith :: forall (m :: * -&gt; *).
MonadSnap m =&gt;
DirectoryConfig m -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveDirectoryWith"><span class="hs-identifier hs-var hs-var">serveDirectoryWith</span></a></span></span><span> </span><span id="local-6989586621679119417"><span class="annot"><span class="annottext">DirectoryConfig m
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679119418"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119418"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-527"></span><span>    </span><span id="local-6989586621679119419"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119419"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Bool
</span><a href="#local-6989586621679119420"><span class="hs-identifier hs-var">directory</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall a. m a -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool
</span><a href="#local-6989586621679119421"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall a. m a -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool
forall {b}. m b
</span><a href="#local-6989586621679119422"><span class="hs-identifier hs-var">redir</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119419"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621679119423"><span class="annot"><span class="annottext">idxs :: [FilePath]
</span><a href="#local-6989586621679119423"><span class="hs-identifier hs-var hs-var">idxs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m -&gt; [FilePath]
forall (m :: * -&gt; *). DirectoryConfig m -&gt; [FilePath]
</span><a href="Snap.Internal.Util.FileServe.html#indexFiles"><span class="hs-identifier hs-var">indexFiles</span></a></span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621679119424"><span class="annot"><span class="annottext">generate :: FilePath -&gt; m ()
</span><a href="#local-6989586621679119424"><span class="hs-identifier hs-var hs-var">generate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *). DirectoryConfig m -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#indexGenerator"><span class="hs-identifier hs-var">indexGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679119425"><span class="annot"><span class="annottext">mimes :: MimeMap
</span><a href="#local-6989586621679119425"><span class="hs-identifier hs-var hs-var">mimes</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m -&gt; MimeMap
forall (m :: * -&gt; *). DirectoryConfig m -&gt; MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#mimeTypes"><span class="hs-identifier hs-var">mimeTypes</span></a></span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-534"></span><span>    </span><span id="local-6989586621679119426"><span class="annot"><span class="annottext">dyns :: HandlerMap m
</span><a href="#local-6989586621679119426"><span class="hs-identifier hs-var hs-var">dyns</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m -&gt; HandlerMap m
forall (m :: * -&gt; *). DirectoryConfig m -&gt; HandlerMap m
</span><a href="Snap.Internal.Util.FileServe.html#dynamicHandlers"><span class="hs-identifier hs-var">dynamicHandlers</span></a></span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621679119427"><span class="annot"><span class="annottext">pshook :: FilePath -&gt; m ()
</span><a href="#local-6989586621679119427"><span class="hs-identifier hs-var hs-var">pshook</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *). DirectoryConfig m -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#preServeHook"><span class="hs-identifier hs-var">preServeHook</span></a></span><span> </span><span class="annot"><span class="annottext">DirectoryConfig m
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-comment">-- Serves a file if it exists; passes if not</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679119471"><span class="annot"><span class="annottext">serve :: FilePath -&gt; m Bool
</span><a href="#local-6989586621679119471"><span class="hs-identifier hs-var hs-var">serve</span></a></span></span><span> </span><span id="local-6989586621679119472"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">IO Bool -&gt; m Bool
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; (Bool -&gt; m ()) -&gt; m ()
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m () -&gt; m ()) -&gt; m () -&gt; Bool -&gt; m ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-540"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119473"><span class="annot"><span class="annottext">fname :: FilePath
</span><a href="#local-6989586621679119473"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-541"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119507"><span class="annot"><span class="annottext">staticServe :: FilePath -&gt; m ()
</span><a href="#local-6989586621679119507"><span class="hs-identifier hs-var hs-var">staticServe</span></a></span></span><span> </span><span id="local-6989586621679119508"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119508"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
</span><a href="#local-6989586621679119427"><span class="hs-identifier hs-var">pshook</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveFileAs"><span class="hs-identifier hs-var">serveFileAs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MimeMap -&gt; FilePath -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#fileType"><span class="hs-identifier hs-var">fileType</span></a></span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="#local-6989586621679119425"><span class="hs-identifier hs-var">mimes</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119473"><span class="hs-identifier hs-var">fname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119508"><span class="hs-identifier hs-var">f'</span></a></span><span>
</span><span id="line-542"></span><span>        </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; HandlerMap m -&gt; FilePath -&gt; FilePath -&gt; m ()
forall a. a -&gt; HashMap FilePath a -&gt; FilePath -&gt; a
</span><a href="Snap.Internal.Util.FileServe.html#lookupExt"><span class="hs-identifier hs-var">lookupExt</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
</span><a href="#local-6989586621679119507"><span class="hs-identifier hs-var">staticServe</span></a></span><span> </span><span class="annot"><span class="annottext">HandlerMap m
</span><a href="#local-6989586621679119426"><span class="hs-identifier hs-var">dyns</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119473"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m Bool -&gt; m Bool
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-comment">-- Serves a directory via indices if available.  Returns True on success,</span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-comment">-- False on failure to find an index.  Passes /only/ if the request was</span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-comment">-- not for a directory (no trailing slash).</span><span>
</span><span id="line-547"></span><span>    </span><span id="local-6989586621679119420"><span class="annot"><span class="annottext">directory :: m Bool
</span><a href="#local-6989586621679119420"><span class="hs-identifier hs-var hs-var">directory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-548"></span><span>        </span><span id="local-6989586621679119567"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119567"><span class="hs-identifier hs-var">rq</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Request
forall (m :: * -&gt; *). MonadSnap m =&gt; m Request
</span><a href="Snap.Internal.Core.html#getRequest"><span class="hs-identifier hs-var">getRequest</span></a></span><span>
</span><span id="line-549"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119568"><span class="annot"><span class="annottext">uri :: ByteString
</span><a href="#local-6989586621679119568"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#uriWithoutQueryString"><span class="hs-identifier hs-var">uriWithoutQueryString</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119567"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-550"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#isSuffixOf"><span class="hs-operator hs-var">`S.isSuffixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119568"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-551"></span><span>        </span><span id="local-6989586621679119569"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119569"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119418"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; m FilePath -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m FilePath
forall (m :: * -&gt; *). MonadSnap m =&gt; m FilePath
</span><a href="Snap.Internal.Util.FileServe.html#getSafePath"><span class="hs-identifier hs-var">getSafePath</span></a></span><span>
</span><span id="line-552"></span><span>        </span><span id="local-6989586621679119570"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119570"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; m Bool
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; m Bool) -&gt; IO Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-var">doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119569"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-553"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119570"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119571"><span class="annot"><span class="annottext">serveRel :: FilePath -&gt; m Bool
</span><a href="#local-6989586621679119571"><span class="hs-identifier hs-var hs-var">serveRel</span></a></span></span><span> </span><span id="local-6989586621679119572"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119572"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m Bool
</span><a href="#local-6989586621679119471"><span class="hs-identifier hs-var">serve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119569"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119572"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>                     </span><span class="annot"><span class="annottext">(m Bool -&gt; m Bool -&gt; m Bool) -&gt; m Bool -&gt; [m Bool] -&gt; m Bool
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall a. m a -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">(&lt;|&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; m Bool) -&gt; [FilePath] -&gt; [m Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">Prelude.map</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m Bool
</span><a href="#local-6989586621679119571"><span class="hs-identifier hs-var">serveRel</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679119423"><span class="hs-identifier hs-var">idxs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>                         </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall a. m a -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; m ()
</span><a href="#local-6989586621679119424"><span class="hs-identifier hs-var">generate</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119569"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m Bool -&gt; m Bool
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>                         </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall a. m a -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-557"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-comment">-- Serves a file requested by name.  Passes if the file doesn't exist.</span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621679119421"><span class="annot"><span class="annottext">file :: m Bool
</span><a href="#local-6989586621679119421"><span class="hs-identifier hs-var hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m Bool
</span><a href="#local-6989586621679119471"><span class="hs-identifier hs-var">serve</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m Bool) -&gt; m FilePath -&gt; m Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119418"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; m FilePath -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m FilePath
forall (m :: * -&gt; *). MonadSnap m =&gt; m FilePath
</span><a href="Snap.Internal.Util.FileServe.html#getSafePath"><span class="hs-identifier hs-var">getSafePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-comment">-- If the request is for a directory but lacks a trailing slash, redirects</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-comment">-- to the directory name with a trailing slash.</span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621679119422"><span class="annot"><span class="annottext">redir :: m b
</span><a href="#local-6989586621679119422"><span class="hs-identifier hs-var hs-var">redir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-565"></span><span>        </span><span id="local-6989586621679119653"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119653"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119418"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; m FilePath -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m FilePath
forall (m :: * -&gt; *). MonadSnap m =&gt; m FilePath
</span><a href="Snap.Internal.Util.FileServe.html#getSafePath"><span class="hs-identifier hs-var">getSafePath</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="annot"><span class="annottext">IO Bool -&gt; m Bool
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/directory-1.3.8.1/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-var">doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119653"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; (Bool -&gt; m ()) -&gt; m ()
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m () -&gt; m ()) -&gt; m () -&gt; Bool -&gt; m ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadSnap m =&gt; m a
</span><a href="Snap.Internal.Core.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621679119654"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119654"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Request
forall (m :: * -&gt; *). MonadSnap m =&gt; m Request
</span><a href="Snap.Internal.Core.html#getRequest"><span class="hs-identifier hs-var">getRequest</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119655"><span class="annot"><span class="annottext">uri :: ByteString
</span><a href="#local-6989586621679119655"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#uriWithoutQueryString"><span class="hs-identifier hs-var">uriWithoutQueryString</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119654"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119656"><span class="annot"><span class="annottext">qss :: ByteString
</span><a href="#local-6989586621679119656"><span class="hs-identifier hs-var hs-var">qss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#queryStringSuffix"><span class="hs-identifier hs-var">queryStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119654"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119659"><span class="annot"><span class="annottext">u :: ByteString
</span><a href="#local-6989586621679119659"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119655"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119656"><span class="hs-identifier hs-var">qss</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-571"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; m b
forall (m :: * -&gt; *) a. MonadSnap m =&gt; ByteString -&gt; m a
</span><a href="Snap.Internal.Core.html#redirect"><span class="hs-identifier hs-var">redirect</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119659"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | Serves a single file specified by a full or relative path.  If the file</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- does not exist, throws an exception (not that it does /not/ pass to the</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- next handler).   The path restrictions on 'serveDirectory' don't apply to</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- this function since the path is not being supplied by the user.</span><span>
</span><span id="line-579"></span><span id="local-6989586621679119660"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveFile"><span class="hs-identifier hs-type">serveFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119660"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-580"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ path to file</span></span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119660"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-582"></span><span id="serveFile"><span class="annot"><span class="annottext">serveFile :: forall (m :: * -&gt; *). MonadSnap m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveFile"><span class="hs-identifier hs-var hs-var">serveFile</span></a></span></span><span> </span><span id="local-6989586621679119663"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119663"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveFileAs"><span class="hs-identifier hs-var">serveFileAs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MimeMap -&gt; FilePath -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#fileType"><span class="hs-identifier hs-var">fileType</span></a></span><span> </span><span class="annot"><span class="annottext">MimeMap
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeTypes"><span class="hs-identifier hs-var">defaultMimeTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119663"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119663"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-583"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveFile"><span class="hs-pragma hs-type">serveFile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-587"></span><span class="annot"><span class="hs-comment">-- | Same as 'serveFile', with control over the MIME mapping used.</span></span><span>
</span><span id="line-588"></span><span id="local-6989586621679118774"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#serveFileAs"><span class="hs-identifier hs-type">serveFileAs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118774"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-589"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ MIME type</span></span><span>
</span><span id="line-590"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ path to file</span></span><span>
</span><span id="line-591"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-592"></span><span id="serveFileAs"><span class="annot"><span class="annottext">serveFileAs :: forall (m :: * -&gt; *). MonadSnap m =&gt; ByteString -&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#serveFileAs"><span class="hs-identifier hs-var hs-var">serveFileAs</span></a></span></span><span> </span><span id="local-6989586621679119733"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119733"><span class="hs-identifier hs-var">mime</span></a></span></span><span> </span><span id="local-6989586621679119734"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119734"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679119735"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119735"><span class="hs-identifier hs-var">reqOrig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Request
forall (m :: * -&gt; *). MonadSnap m =&gt; m Request
</span><a href="Snap.Internal.Core.html#getRequest"><span class="hs-identifier hs-var">getRequest</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-comment">-- If-Range header must be ignored if there is no Range: header in the</span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-comment">-- request (RFC 2616 section 14.27)</span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119742"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679119742"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Bool) -&gt; Maybe ByteString -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Request -&gt; Maybe ByteString
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-var">getHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;range&quot;</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119735"><span class="hs-identifier hs-var">reqOrig</span></a></span><span>
</span><span id="line-598"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Request -&gt; Request
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier hs-var">deleteHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;if-range&quot;</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119735"><span class="hs-identifier hs-var">reqOrig</span></a></span><span>
</span><span id="line-599"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119735"><span class="hs-identifier hs-var">reqOrig</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-comment">-- check &quot;If-Modified-Since&quot; and &quot;If-Range&quot; headers</span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119747"><span class="annot"><span class="annottext">mbH :: Maybe ByteString
</span><a href="#local-6989586621679119747"><span class="hs-identifier hs-var hs-var">mbH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Request -&gt; Maybe ByteString
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-var">getHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;if-modified-since&quot;</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119742"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679119748"><span class="annot"><span class="annottext">Maybe CTime
</span><a href="#local-6989586621679119748"><span class="hs-identifier hs-var">mbIfModified</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe CTime) -&gt; m (Maybe CTime)
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe CTime) -&gt; m (Maybe CTime))
-&gt; IO (Maybe CTime) -&gt; m (Maybe CTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679119747"><span class="hs-identifier hs-var">mbH</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-604"></span><span>                               </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CTime -&gt; IO (Maybe CTime)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CTime
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-605"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679119749"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119749"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CTime -&gt; Maybe CTime) -&gt; IO CTime -&gt; IO (Maybe CTime)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; Maybe CTime
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(IO CTime -&gt; IO (Maybe CTime)) -&gt; IO CTime -&gt; IO (Maybe CTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO CTime
</span><a href="Snap.Internal.Http.Types.html#parseHttpTime"><span class="hs-identifier hs-var">parseHttpTime</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119749"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-comment">-- If-Range header could contain an entity, but then parseHttpTime will</span><span>
</span><span id="line-608"></span><span>    </span><span class="hs-comment">-- fail and return 0 which means a 200 response will be generated anyways</span><span>
</span><span id="line-609"></span><span>    </span><span id="local-6989586621679119750"><span class="annot"><span class="annottext">Maybe CTime
</span><a href="#local-6989586621679119750"><span class="hs-identifier hs-var">mbIfRange</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe CTime) -&gt; m (Maybe CTime)
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe CTime) -&gt; m (Maybe CTime))
-&gt; IO (Maybe CTime) -&gt; m (Maybe CTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Request -&gt; Maybe ByteString
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-var">getHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;if-range&quot;</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119742"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-610"></span><span>                            </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CTime -&gt; IO (Maybe CTime)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CTime
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-611"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679119751"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119751"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CTime -&gt; Maybe CTime) -&gt; IO CTime -&gt; IO (Maybe CTime)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; Maybe CTime
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(IO CTime -&gt; IO (Maybe CTime)) -&gt; IO CTime -&gt; IO (Maybe CTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO CTime
</span><a href="Snap.Internal.Http.Types.html#parseHttpTime"><span class="hs-identifier hs-var">parseHttpTime</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119751"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;mbIfModified: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CTime -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CTime
</span><a href="#local-6989586621679119748"><span class="hs-identifier hs-var">mbIfModified</span></a></span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;mbIfRange: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CTime -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CTime
</span><a href="#local-6989586621679119750"><span class="hs-identifier hs-var">mbIfRange</span></a></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span>    </span><span class="hs-comment">-- check modification time and bug out early if the file is not modified.</span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-comment">-- TODO: a stat cache would be nice here, but it'd need the date thread</span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-comment">-- stuff from snap-server to be folded into snap-core</span><span>
</span><span id="line-620"></span><span>    </span><span id="local-6989586621679119753"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679119753"><span class="hs-identifier hs-var">filestat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileStatus -&gt; m FileStatus
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO FileStatus -&gt; m FileStatus) -&gt; IO FileStatus -&gt; m FileStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FileStatus
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">getFileStatus</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119734"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119754"><span class="annot"><span class="annottext">mt :: CTime
</span><a href="#local-6989586621679119754"><span class="hs-identifier hs-var hs-var">mt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; CTime
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.Common.html#modificationTime"><span class="hs-identifier hs-var">modificationTime</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679119753"><span class="hs-identifier hs-var">filestat</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><span class="annottext">m () -&gt; (CTime -&gt; m ()) -&gt; Maybe CTime -&gt; m ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(() -&gt; m ()) -&gt; () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679119755"><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119755"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119754"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; CTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119755"><span class="hs-identifier hs-var">lt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m ()
forall {a}. m a
</span><a href="#local-6989586621679119757"><span class="hs-identifier hs-var">notModified</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CTime
</span><a href="#local-6989586621679119748"><span class="hs-identifier hs-var">mbIfModified</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119762"><span class="annot"><span class="annottext">sz :: Word64
</span><a href="#local-6989586621679119762"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileOffset -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(FileOffset -&gt; Word64) -&gt; FileOffset -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; FileOffset
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/unix-2.8.1.0/src/System.Posix.Files.Common.html#fileSize"><span class="hs-identifier hs-var">fileSize</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679119753"><span class="hs-identifier hs-var">filestat</span></a></span><span>
</span><span id="line-625"></span><span>    </span><span id="local-6989586621679119763"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119763"><span class="hs-identifier hs-var">lm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; m ByteString
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; m ByteString) -&gt; IO ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; IO ByteString
</span><a href="Snap.Internal.Http.Types.html#formatHttpTime"><span class="hs-identifier hs-var">formatHttpTime</span></a></span><span> </span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119754"><span class="hs-identifier hs-var">mt</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-comment">-- ok, at this point we know the last-modified time and the</span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-comment">-- content-type. set those.</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><span class="annottext">(Response -&gt; Response) -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; (Response -&gt; Response) -&gt; m ()
</span><a href="Snap.Internal.Core.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((Response -&gt; Response) -&gt; m ()) -&gt; (Response -&gt; Response) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Last-Modified&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119763"><span class="hs-identifier hs-var">lm</span></a></span><span>
</span><span id="line-630"></span><span>                   </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Accept-Ranges&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;bytes&quot;</span></span><span>
</span><span id="line-631"></span><span>                   </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentType"><span class="hs-identifier hs-var">setContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119733"><span class="hs-identifier hs-var">mime</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-comment">-- now check: is this a range request? If there is an 'If-Range' header</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-comment">-- with an old modification time we skip this check and send a 200</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-comment">-- response</span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119765"><span class="annot"><span class="annottext">skipRangeCheck :: Bool
</span><a href="#local-6989586621679119765"><span class="hs-identifier hs-var hs-var">skipRangeCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (CTime -&gt; Bool) -&gt; Maybe CTime -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>                               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679119766"><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119766"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119754"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">CTime -&gt; CTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CTime
</span><a href="#local-6989586621679119766"><span class="hs-identifier hs-var">lt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>                               </span><span class="annot"><span class="annottext">Maybe CTime
</span><a href="#local-6989586621679119750"><span class="hs-identifier hs-var">mbIfRange</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-comment">-- checkRangeReq checks for a Range: header in the request and sends a</span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-comment">-- partial response if it matches.</span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679119768"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119768"><span class="hs-identifier hs-var">wasRange</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119765"><span class="hs-identifier hs-var">skipRangeCheck</span></a></span><span>
</span><span id="line-644"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-645"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Snap Bool -&gt; m Bool
forall a. Snap a -&gt; m a
forall (m :: * -&gt; *) a. MonadSnap m =&gt; Snap a -&gt; m a
</span><a href="Snap.Internal.Core.html#liftSnap"><span class="hs-identifier hs-var">liftSnap</span></a></span><span> </span><span class="annot"><span class="annottext">(Snap Bool -&gt; m Bool) -&gt; Snap Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; FilePath -&gt; Word64 -&gt; Snap Bool
forall (m :: * -&gt; *).
MonadSnap m =&gt;
Request -&gt; FilePath -&gt; Word64 -&gt; m Bool
</span><a href="Snap.Internal.Util.FileServe.html#checkRangeReq"><span class="hs-identifier hs-var">checkRangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119742"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119734"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119762"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;was this a range request? &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119768"><span class="hs-identifier hs-var">wasRange</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-comment">-- if we didn't have a range request, we just do normal sendfile</span><span>
</span><span id="line-650"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679119768"><span class="hs-identifier hs-var">wasRange</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-651"></span><span>      </span><span class="annot"><span class="annottext">(Response -&gt; Response) -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; (Response -&gt; Response) -&gt; m ()
</span><a href="Snap.Internal.Core.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((Response -&gt; Response) -&gt; m ()) -&gt; (Response -&gt; Response) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier hs-var">setResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span>
</span><span id="line-652"></span><span>                     </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-identifier hs-var">setContentLength</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119762"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-653"></span><span>      </span><span class="annot"><span class="annottext">Snap () -&gt; m ()
forall a. Snap a -&gt; m a
forall (m :: * -&gt; *) a. MonadSnap m =&gt; Snap a -&gt; m a
</span><a href="Snap.Internal.Core.html#liftSnap"><span class="hs-identifier hs-var">liftSnap</span></a></span><span> </span><span class="annot"><span class="annottext">(Snap () -&gt; m ()) -&gt; Snap () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Snap ()
forall (m :: * -&gt; *). MonadSnap m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Core.html#sendFile"><span class="hs-identifier hs-var">sendFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119734"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679119757"><span class="annot"><span class="annottext">notModified :: m a
</span><a href="#local-6989586621679119757"><span class="hs-identifier hs-var hs-var">notModified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response -&gt; m a
forall (m :: * -&gt; *) a. MonadSnap m =&gt; Response -&gt; m a
</span><a href="Snap.Internal.Core.html#finishWith"><span class="hs-identifier hs-var">finishWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; m a) -&gt; Response -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-658"></span><span>                  </span><span class="annot"><span class="annottext">Int -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier hs-var">setResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">304</span></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="Snap.Internal.Http.Types.html#emptyResponse"><span class="hs-identifier hs-var">emptyResponse</span></a></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-662"></span><span id="local-6989586621679118775"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#lookupExt"><span class="hs-identifier hs-type">lookupExt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679118775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118775"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-663"></span><span id="lookupExt"><span class="annot"><span class="annottext">lookupExt :: forall a. a -&gt; HashMap FilePath a -&gt; FilePath -&gt; a
</span><a href="Snap.Internal.Util.FileServe.html#lookupExt"><span class="hs-identifier hs-var hs-var">lookupExt</span></a></span></span><span> </span><span id="local-6989586621679119801"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119801"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679119802"><span class="annot"><span class="annottext">HashMap FilePath a
</span><a href="#local-6989586621679119802"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679119803"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119803"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119804"><span class="hs-identifier hs-var">ext</span></a></span><span>
</span><span id="line-665"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119801"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; a
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; HashMap FilePath a -&gt; FilePath -&gt; a
forall a. a -&gt; HashMap FilePath a -&gt; FilePath -&gt; a
</span><a href="Snap.Internal.Util.FileServe.html#lookupExt"><span class="hs-identifier hs-var">lookupExt</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119801"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FilePath a
</span><a href="#local-6989586621679119802"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679119805"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119804"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679119806"><span class="hs-identifier hs-var">mbe</span></a></span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621679119805"><span class="annot"><span class="annottext">next :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679119805"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; FilePath
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621679119804"><span class="annot"><span class="annottext">ext :: FilePath
</span><a href="#local-6989586621679119804"><span class="hs-identifier hs-var hs-var">ext</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/filepath-1.4.100.4/src/System.FilePath.Posix.html#takeExtensions"><span class="hs-identifier hs-var">takeExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119803"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-671"></span><span>    </span><span id="local-6989586621679119806"><span class="annot"><span class="annottext">mbe :: Maybe a
</span><a href="#local-6989586621679119806"><span class="hs-identifier hs-var hs-var">mbe</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; HashMap FilePath a -&gt; Maybe a
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119804"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FilePath a
</span><a href="#local-6989586621679119802"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- | Determine a given file's MIME type from its filename and the provided MIME</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- map.</span><span>
</span><span id="line-677"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#fileType"><span class="hs-identifier hs-type">fileType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#MimeMap"><span class="hs-identifier hs-type">MimeMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-678"></span><span id="fileType"><span class="annot"><span class="annottext">fileType :: MimeMap -&gt; FilePath -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#fileType"><span class="hs-identifier hs-var hs-var">fileType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; MimeMap -&gt; FilePath -&gt; ByteString
forall a. a -&gt; HashMap FilePath a -&gt; FilePath -&gt; a
</span><a href="Snap.Internal.Util.FileServe.html#lookupExt"><span class="hs-identifier hs-var">lookupExt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeType"><span class="hs-identifier hs-var">defaultMimeType</span></a></span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-682"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#defaultMimeType"><span class="hs-identifier hs-type">defaultMimeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-683"></span><span id="defaultMimeType"><span class="annot"><span class="annottext">defaultMimeType :: ByteString
</span><a href="Snap.Internal.Util.FileServe.html#defaultMimeType"><span class="hs-identifier hs-var hs-var">defaultMimeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/octet-stream&quot;</span></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-687"></span><span class="hs-keyword">data</span><span> </span><span id="RangeReq"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#RangeReq"><span class="hs-identifier hs-var">RangeReq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RangeReq"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#RangeReq"><span class="hs-identifier hs-var">RangeReq</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="SuffixRangeReq"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#SuffixRangeReq"><span class="hs-identifier hs-var">SuffixRangeReq</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-692"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#rangeParser"><span class="hs-identifier hs-type">rangeParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#RangeReq"><span class="hs-identifier hs-type">RangeReq</span></a></span><span>
</span><span id="line-693"></span><span id="rangeParser"><span class="annot"><span class="annottext">rangeParser :: Parser RangeReq
</span><a href="Snap.Internal.Util.FileServe.html#rangeParser"><span class="hs-identifier hs-var hs-var">rangeParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;bytes=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Parser RangeReq -&gt; Parser RangeReq
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span>
</span><span id="line-694"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser RangeReq
</span><a href="#local-6989586621679119816"><span class="hs-identifier hs-var">byteRangeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Parser RangeReq -&gt; Parser RangeReq -&gt; Parser RangeReq
forall a.
Parser ByteString a -&gt; Parser ByteString a -&gt; Parser ByteString a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser RangeReq
</span><a href="#local-6989586621679119817"><span class="hs-identifier hs-var">suffixByteRangeSpec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser RangeReq -&gt; Parser ByteString () -&gt; Parser RangeReq
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a></span><span>
</span><span id="line-695"></span><span>              </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-697"></span><span>    </span><span id="local-6989586621679119816"><span class="annot"><span class="annottext">byteRangeSpec :: Parser RangeReq
</span><a href="#local-6989586621679119816"><span class="hs-identifier hs-var hs-var">byteRangeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-698"></span><span>        </span><span id="local-6989586621679119835"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119835"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Word64)
-&gt; Parser ByteString Int64 -&gt; Parser ByteString Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Int64
</span><a href="Snap.Internal.Parsing.html#parseNum"><span class="hs-identifier hs-var">parseNum</span></a></span><span>
</span><span id="line-699"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString Char -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser ByteString Char -&gt; Parser ByteString ())
-&gt; Parser ByteString Char -&gt; Parser ByteString ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser ByteString Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-700"></span><span>        </span><span id="local-6989586621679119836"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679119836"><span class="hs-identifier hs-var">end</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
-&gt; Parser ByteString (Maybe Int64)
-&gt; Parser ByteString (Maybe Int64)
forall (f :: * -&gt; *) a. Alternative f =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser ByteString (Maybe Int64)
 -&gt; Parser ByteString (Maybe Int64))
-&gt; Parser ByteString (Maybe Int64)
-&gt; Parser ByteString (Maybe Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Maybe Int64)
-&gt; Parser ByteString Int64 -&gt; Parser ByteString (Maybe Int64)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Int64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Int64
</span><a href="Snap.Internal.Parsing.html#parseNum"><span class="hs-identifier hs-var">parseNum</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span>        </span><span class="annot"><span class="annottext">RangeReq -&gt; Parser RangeReq
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(RangeReq -&gt; Parser RangeReq) -&gt; RangeReq -&gt; Parser RangeReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64 -&gt; RangeReq
</span><a href="Snap.Internal.Util.FileServe.html#RangeReq"><span class="hs-identifier hs-var">RangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119835"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Word64) -&gt; Maybe Int64 -&gt; Maybe Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679119836"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621679119817"><span class="annot"><span class="annottext">suffixByteRangeSpec :: Parser RangeReq
</span><a href="#local-6989586621679119817"><span class="hs-identifier hs-var hs-var">suffixByteRangeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-705"></span><span>        </span><span class="annot"><span class="annottext">(Int64 -&gt; RangeReq) -&gt; Parser ByteString Int64 -&gt; Parser RangeReq
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; RangeReq
</span><a href="Snap.Internal.Util.FileServe.html#SuffixRangeReq"><span class="hs-identifier hs-var">SuffixRangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; RangeReq) -&gt; (Int64 -&gt; Word64) -&gt; Int64 -&gt; RangeReq
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser ByteString Int64 -&gt; Parser RangeReq)
-&gt; Parser ByteString Int64 -&gt; Parser RangeReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser ByteString Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Char
-&gt; Parser ByteString Int64 -&gt; Parser ByteString Int64
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Int64
</span><a href="Snap.Internal.Parsing.html#parseNum"><span class="hs-identifier hs-var">parseNum</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-709"></span><span id="local-6989586621679118809"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#checkRangeReq"><span class="hs-identifier hs-type">checkRangeReq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Core.html#MonadSnap"><span class="hs-identifier hs-type">MonadSnap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118809"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118809"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-710"></span><span id="checkRangeReq"><span class="annot"><span class="annottext">checkRangeReq :: forall (m :: * -&gt; *).
MonadSnap m =&gt;
Request -&gt; FilePath -&gt; Word64 -&gt; m Bool
</span><a href="Snap.Internal.Util.FileServe.html#checkRangeReq"><span class="hs-identifier hs-var hs-var">checkRangeReq</span></a></span></span><span> </span><span id="local-6989586621679119855"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119855"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679119856"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119856"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679119857"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-comment">-- TODO/FIXME: multiple ranges</span><span>
</span><span id="line-712"></span><span>    </span><span class="annot"><span class="annottext">m Bool -&gt; (ByteString -&gt; m Bool) -&gt; Maybe ByteString -&gt; m Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679119858"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119858"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m Bool)
-&gt; (RangeReq -&gt; m Bool) -&gt; Either FilePath RangeReq -&gt; m Bool
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Either.html#either"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m Bool -&gt; FilePath -&gt; m Bool
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m Bool -&gt; FilePath -&gt; m Bool) -&gt; m Bool -&gt; FilePath -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>                        </span><span class="annot"><span class="annottext">RangeReq -&gt; m Bool
</span><a href="#local-6989586621679119859"><span class="hs-identifier hs-var">withRange</span></a></span><span>
</span><span id="line-715"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Parser RangeReq -&gt; Either FilePath RangeReq
forall a. ByteString -&gt; Parser a -&gt; Either FilePath a
</span><a href="Snap.Internal.Parsing.html#fullyParse"><span class="hs-identifier hs-var">fullyParse</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119858"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Parser RangeReq
</span><a href="Snap.Internal.Util.FileServe.html#rangeParser"><span class="hs-identifier hs-var">rangeParser</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI ByteString -&gt; Request -&gt; Maybe ByteString
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-var">getHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;range&quot;</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119855"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-719"></span><span>    </span><span id="local-6989586621679119859"><span class="annot"><span class="annottext">withRange :: RangeReq -&gt; m Bool
</span><a href="#local-6989586621679119859"><span class="hs-identifier hs-var hs-var">withRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#RangeReq"><span class="hs-identifier hs-type">RangeReq</span></a></span><span> </span><span id="local-6989586621679119921"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119921"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679119922"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679119922"><span class="hs-identifier hs-var">mend</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-720"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119925"><span class="annot"><span class="annottext">end :: Word64
</span><a href="#local-6989586621679119925"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64 -&gt; Word64
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679119922"><span class="hs-identifier hs-var">mend</span></a></span><span>
</span><span id="line-721"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;withRange: start=&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119921"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-722"></span><span>                  </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, end=&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119925"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119921"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119925"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119921"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119921"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119925"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-725"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m Bool
</span><a href="#local-6989586621679119927"><span class="hs-identifier hs-var">send416</span></a></span><span>
</span><span id="line-726"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; m Bool
forall {m :: * -&gt; *}. MonadSnap m =&gt; Word64 -&gt; Word64 -&gt; m Bool
</span><a href="#local-6989586621679119928"><span class="hs-identifier hs-var">send206</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119921"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119925"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>    </span><span class="annot"><a href="#local-6989586621679119859"><span class="hs-identifier hs-var">withRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#SuffixRangeReq"><span class="hs-identifier hs-type">SuffixRangeReq</span></a></span><span> </span><span id="local-6989586621679119929"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119929"><span class="hs-identifier hs-var">nbytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-729"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119932"><span class="annot"><span class="annottext">end :: Word64
</span><a href="#local-6989586621679119932"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-730"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119934"><span class="annot"><span class="annottext">start :: Word64
</span><a href="#local-6989586621679119934"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119929"><span class="hs-identifier hs-var">nbytes</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;withRange: start=&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119934"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-733"></span><span>                  </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, end=&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119932"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119934"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119932"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119934"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119934"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119932"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-736"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m Bool
</span><a href="#local-6989586621679119927"><span class="hs-identifier hs-var">send416</span></a></span><span>
</span><span id="line-737"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; m Bool
forall {m :: * -&gt; *}. MonadSnap m =&gt; Word64 -&gt; Word64 -&gt; m Bool
</span><a href="#local-6989586621679119928"><span class="hs-identifier hs-var">send206</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119934"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119932"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-comment">-- note: start and end INCLUSIVE here</span><span>
</span><span id="line-740"></span><span>    </span><span id="local-6989586621679119928"><span class="annot"><span class="annottext">send206 :: Word64 -&gt; Word64 -&gt; m Bool
</span><a href="#local-6989586621679119928"><span class="hs-identifier hs-var hs-var">send206</span></a></span></span><span> </span><span id="local-6989586621679120001"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120001"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679120002"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120002"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-741"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;inside send206&quot;</span></span><span>
</span><span id="line-742"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679120006"><span class="annot"><span class="annottext">len :: Word64
</span><a href="#local-6989586621679120006"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120002"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120001"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-743"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120014"><span class="annot"><span class="annottext">crng :: ByteString
</span><a href="#local-6989586621679120014"><span class="hs-identifier hs-var hs-var">crng</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (ByteString -&gt; [ByteString]) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.html#toChunks"><span class="hs-identifier hs-var">L.toChunks</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-744"></span><span>                   </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#toLazyByteString"><span class="hs-identifier hs-var">toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-745"></span><span>                   </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#byteString"><span class="hs-identifier hs-var">byteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;bytes &quot;</span></span><span>
</span><span id="line-746"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
forall a. Show a =&gt; a -&gt; Builder
</span><a href="Snap.Internal.Util.FileServe.html#fromShow"><span class="hs-identifier hs-var">fromShow</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120001"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-747"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#char8"><span class="hs-identifier hs-var">char8</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-748"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
forall a. Show a =&gt; a -&gt; Builder
</span><a href="Snap.Internal.Util.FileServe.html#fromShow"><span class="hs-identifier hs-var">fromShow</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120002"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-749"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#char8"><span class="hs-identifier hs-var">char8</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span>
</span><span id="line-750"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
forall a. Show a =&gt; a -&gt; Builder
</span><a href="Snap.Internal.Util.FileServe.html#fromShow"><span class="hs-identifier hs-var">fromShow</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">(Response -&gt; Response) -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; (Response -&gt; Response) -&gt; m ()
</span><a href="Snap.Internal.Core.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((Response -&gt; Response) -&gt; m ()) -&gt; (Response -&gt; Response) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier hs-var">setResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">206</span></span><span>
</span><span id="line-753"></span><span>                       </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Content-Range&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120014"><span class="hs-identifier hs-var">crng</span></a></span><span>
</span><span id="line-754"></span><span>                       </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-identifier hs-var">setContentLength</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120006"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;send206: sending range (&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120001"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-757"></span><span>                </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120002"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;) to sendFilePartial&quot;</span></span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span>        </span><span class="hs-comment">-- end here was inclusive, sendFilePartial is exclusive</span><span>
</span><span id="line-760"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; (Word64, Word64) -&gt; m ()
forall (m :: * -&gt; *).
MonadSnap m =&gt;
FilePath -&gt; (Word64, Word64) -&gt; m ()
</span><a href="Snap.Internal.Core.html#sendFilePartial"><span class="hs-identifier hs-var">sendFilePartial</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679119856"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120001"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679120002"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span>    </span><span id="local-6989586621679119927"><span class="annot"><span class="annottext">send416 :: m Bool
</span><a href="#local-6989586621679119927"><span class="hs-identifier hs-var hs-var">send416</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-765"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;inside send416&quot;</span></span><span>
</span><span id="line-766"></span><span>        </span><span class="hs-comment">-- if there's an &quot;If-Range&quot; header in the request, then we just send</span><span>
</span><span id="line-767"></span><span>        </span><span class="hs-comment">-- back 200</span><span>
</span><span id="line-768"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Request -&gt; Maybe ByteString
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; Maybe ByteString
</span><a href="Snap.Internal.Http.Types.html#getHeader"><span class="hs-identifier hs-var">getHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;If-Range&quot;</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679119855"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Maybe ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-769"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-770"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-771"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679120077"><span class="annot"><span class="annottext">crng :: ByteString
</span><a href="#local-6989586621679120077"><span class="hs-identifier hs-var hs-var">crng</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (ByteString -&gt; [ByteString]) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Lazy.html#toChunks"><span class="hs-identifier hs-var">L.toChunks</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-772"></span><span>                          </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#toLazyByteString"><span class="hs-identifier hs-var">toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-773"></span><span>                          </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#byteString"><span class="hs-identifier hs-var">byteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;bytes */&quot;</span></span><span>
</span><span id="line-774"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
forall a. Show a =&gt; a -&gt; Builder
</span><a href="Snap.Internal.Util.FileServe.html#fromShow"><span class="hs-identifier hs-var">fromShow</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679119857"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span>               </span><span class="annot"><span class="annottext">(Response -&gt; Response) -&gt; m ()
forall (m :: * -&gt; *). MonadSnap m =&gt; (Response -&gt; Response) -&gt; m ()
</span><a href="Snap.Internal.Core.html#modifyResponse"><span class="hs-identifier hs-var">modifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">((Response -&gt; Response) -&gt; m ()) -&gt; (Response -&gt; Response) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseCode"><span class="hs-identifier hs-var">setResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">416</span></span><span>
</span><span id="line-777"></span><span>                              </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#setHeader"><span class="hs-identifier hs-var">setHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Content-Range&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120077"><span class="hs-identifier hs-var">crng</span></a></span><span>
</span><span id="line-778"></span><span>                              </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setContentLength"><span class="hs-identifier hs-var">setContentLength</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-779"></span><span>                              </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier hs-var">deleteHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span>
</span><span id="line-780"></span><span>                              </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier hs-var">deleteHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Content-Encoding&quot;</span></span><span>
</span><span id="line-781"></span><span>                              </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Response -&gt; Response
forall a. HasHeaders a =&gt; CI ByteString -&gt; a -&gt; a
</span><a href="Snap.Internal.Http.Types.html#deleteHeader"><span class="hs-identifier hs-var">deleteHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><span class="hs-string">&quot;Transfer-Encoding&quot;</span></span><span>
</span><span id="line-782"></span><span>                              </span><span class="annot"><span class="annottext">(Response -&gt; Response)
-&gt; (Response -&gt; Response) -&gt; Response -&gt; Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(OutputStream Builder -&gt; IO (OutputStream Builder))
-&gt; Response -&gt; Response
</span><a href="Snap.Internal.Http.Types.html#setResponseBody"><span class="hs-identifier hs-var">setResponseBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputStream Builder -&gt; IO (OutputStream Builder)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(OutputStream Builder -&gt; IO (OutputStream Builder))
-&gt; (OutputStream Builder -&gt; OutputStream Builder)
-&gt; OutputStream Builder
-&gt; IO (OutputStream Builder)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">OutputStream Builder -&gt; OutputStream Builder
forall a. a -&gt; a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-788"></span><span id="local-6989586621679118799"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-type">dbg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118799"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118799"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-789"></span><span id="dbg"><span class="annot"><span class="annottext">dbg :: forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Util.FileServe.html#dbg"><span class="hs-identifier hs-var hs-var">dbg</span></a></span></span><span> </span><span id="local-6989586621679120081"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679120081"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="Snap.Internal.Debug.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m ()) -&gt; FilePath -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;FileServe:&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679120081"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-793"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#uriWithoutQueryString"><span class="hs-identifier hs-type">uriWithoutQueryString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-794"></span><span id="uriWithoutQueryString"><span class="annot"><span class="annottext">uriWithoutQueryString :: Request -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#uriWithoutQueryString"><span class="hs-identifier hs-var hs-var">uriWithoutQueryString</span></a></span></span><span> </span><span id="local-6989586621679120082"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679120082"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Char8.html#takeWhile"><span class="hs-identifier hs-var">S.takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120083"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-795"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-796"></span><span>    </span><span id="local-6989586621679120083"><span class="annot"><span class="annottext">uri :: ByteString
</span><a href="#local-6989586621679120083"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqURI"><span class="hs-identifier hs-var">rqURI</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679120082"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-800"></span><span class="annot"><a href="Snap.Internal.Util.FileServe.html#queryStringSuffix"><span class="hs-identifier hs-type">queryStringSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Snap.Internal.Http.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-801"></span><span id="queryStringSuffix"><span class="annot"><span class="annottext">queryStringSuffix :: Request -&gt; ByteString
</span><a href="Snap.Internal.Util.FileServe.html#queryStringSuffix"><span class="hs-identifier hs-var hs-var">queryStringSuffix</span></a></span></span><span> </span><span id="local-6989586621679120084"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679120084"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">S.concat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120085"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-803"></span><span>    </span><span id="local-6989586621679120086"><span class="annot"><span class="annottext">qs :: ByteString
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Snap.Internal.Http.Types.html#rqQueryString"><span class="hs-identifier hs-var">rqQueryString</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679120084"><span class="hs-identifier hs-var">rq</span></a></span><span>
</span><span id="line-804"></span><span>    </span><span id="local-6989586621679120085"><span class="annot"><span class="annottext">s :: ByteString
</span><a href="#local-6989586621679120085"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-808"></span><span id="local-6989586621679118841"><span class="annot"><a href="Snap.Internal.Util.FileServe.html#fromShow"><span class="hs-identifier hs-type">fromShow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span></span><span>
</span><span id="line-809"></span><span id="fromShow"><span class="annot"><span class="annottext">fromShow :: forall a. Show a =&gt; a -&gt; Builder
</span><a href="Snap.Internal.Util.FileServe.html#fromShow"><span class="hs-identifier hs-var hs-var">fromShow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Builder
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/bytestring-0.11.5.2/src/Data.ByteString.Builder.html#stringUtf8"><span class="hs-identifier hs-var">stringUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Builder) -&gt; (a -&gt; FilePath) -&gt; a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/9f69j6hfgwz5xdil7lfn1c1mbhrhidl1-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-810"></span></pre></body></html>